{"version":3,"sources":["syncgraph/UndoQueue.js","metadoc/EventCoalescer.js","vr/AuthModule.js","syncgraph/PubnubSyncWrapper.js","syncgraph/utils.js","syncgraph/MissingDocDialog.js","syncgraph/SyncGraphProvider.js","vr/TransformControls.js","vr/SkeletonUtils.js","vr/defs/ObjectDef.js","vr/defs/CubeDef.js","vr/defs/SphereDef.js","vr/defs/PlaneDef.js","vr/defs/ModelDef.js","vr/defs/BG360Def.js","vr/defs/TextDef.js","vr/defs/Image2DDef.js","vr/defs/GroupDef.js","vr/defs/GPUParticles.js","vr/defs/ParticlesDef.js","vr/defs/PortalDef.js","vr/defs/LocalAnchorDef.js","vr/defs/ImageAnchorDef.js","vr/defs/GeoAnchorDef.js","vr/defs/HudAnchorDef.js","vr/defs/CloneDef.js","vr/Common.js","vr/defs/SceneDef.js","vr/GLTFLoader.js","vr/ScriptManager.js","vr/tween.js","vr/XRSupport.js","vr/OrbitControls.js","vr/VRCanvas.js","vr/TranslationArrow.js","vr/TranslateControl.js","vr/panel2d/panel2d.js","vr/panel2d/component2d.js","vr/panel2d/button2d.js","vr/panel2d/group2d.js","vr/3dof.js","vr/Actions.js","vr/ImmersiveVREditor.js","vr/AssetActions.js","vr/dialogs/AddImageAssetDialog.js","vr/dialogs/AddGLTFAssetDialog.js","vr/dialogs/AddGLBAssetDialog.js","vr/dialogs/AddAudioAssetDialog.js","vr/dialogs/UnsavedDocumentDialog.js","vr/DRACOLoader.js","vr/GLTFAssetView.js","vr/GeoAssetView.js","metadoc/AssetView.js","syncgraph/GraphAccessor.js","vr/dialogs/OpenFileDialog.js","vr/dialogs/OpenAssetDialog.js","vr/ScriptEditor.js","vr/dialogs/OpenScriptDialog.js","vr/Templates.js","vr/dialogs/QRDialog.js","vr/dialogs/PasswordDialog.js","vr/dialogs/GithubAuthDialog.js","vr/ErrorCatcher.js","vr/GifSupport.js","vr/AssetsManager.js","vr/dialogs/SaveDocumentAsDialog.js","vr/dialogs/BadAssetsDialog.js","vr/ToasterNotification.js","vr/ConsoleView.js","vr/dialogs/SimpleMessageDialog.js","vr/VREditor.js","vr/XRWorldInfo.js","vr/ImmersivePlayer.js","App.js","index.js","vr/ToasterManager.js","vr/startup-sound.m4a"],"names":["require","SET_PROPERTY","CREATE_PROPERTY","DELETE_PROPERTY","CREATE_OBJECT","DELETE_OBJECT","INSERT_ELEMENT","DELETE_ELEMENT","UndoQueue","graph","Object","classCallCheck","this","history","current","createClass","key","value","op","push","length","last","type","Error","concat","host","getHostId","seq","nextSeq","timestamp","Date","now","array","entry","entryid","process","id","object","name","prevValue","console","warn","log","makeGUID","prev","map","i","EventCoalescer","_this","onChange","cb","listeners","onRawChange","rawlisteners","fire","forEach","fireRaw","getPropertiesForObject","obj","getArrayLength","getElementAt","index","paused","buffer","first","_this2","keys","getPropertyValue","bufferOp","USER_CHANGE","AuthModule","AuthModuleSingleton","login","res","win","window","open","url","addEventListener","authCallback","focus","logout","localStorage","clear","doclistSupported","msg","setUserData","data","payload","close","removeEventListener","ToasterMananager","supported","docDeleteSupported","assetUploadSupported","scriptEditingSupported","passwordSupported","connected","serverID","genID","isLoggedIn","fetch","getInfoURL","then","json","info","authentication","assetUpload","scriptEditing","replace","getJSON","getUserURL","success","getItem","password","_this3","setItem","accessToken","getAccessToken","options","mode","cache","headers","status","statusText","method","Content-Type","file","getAssetsURL","body","settings","publishKey","subscribeKey","PubnubSyncWrapper","provider","e","handleGraphChange","pubnub","PubNub","logger","PubnubLogger","getDocId","getServerID","addListener","operation","category","sendHistoryRequest","message","m","handleMessage","subscribe","channels","calculateChannelName","calculateLoggerChannelName","sendMessage","unsubscribe","stop","str","uuid","publish","channel","response","getDataGraph","hist","getHistory","slice","count","chunk","splice","_this4","evt","publisher","getUUID","handleGetHistory","handleReceiveHistory","error","docid","_this5","remote","getListeners","makePayload","Array","from","arguments","JSON","parse","prune","arr","ConsoleLogger","listToArray","list","prototype","call","fetchGraphObject","objid","propToArray","doc","CH","len","ch","insertAsFirstChild","parent","child","setProperty","insertAfter","insertAsLastChild","MissingDocDialog","_Component","_getPrototypeOf2","_len","args","_key","possibleConstructorReturn","getPrototypeOf","apply","cancel","DialogManager","hide","okay","props","createNewDocument","inherits","react_default","a","createElement","es","visible","onScrimClick","onClick","Component","DocGraph","CommandGenerator","toDocGraphFromObjectGraph","toObjectGraphFromDocGraph","SyncGraphProvider","getDocTitle","getDocHistory","getDocGraph","root","getObjectByProperty","getRawGraph","coalescer","syncdoc","getSceneRoot","hasChildren","item","hasPropertyValue","getChildren","isExpanded","expanded","save","preventDefault","payload_obj","getDocType","title","payload_string","stringify","opts","getDocsURL","toQueryString","setQuery","doctype","TREE_ITEM_PROVIDER","SAVED","catch","docLoaded","Promise","resolve","toggleConnected","unpause","pause","isConnected","pauseQueue","unpauseQueue","performUndo","undoqueue","canUndo","undo","performRedo","canRedo","redo","datalisteners","loadDoc","EXPANDED_CHANGED","def","cmd","PROPERTY_CHANGED","propKey","oldValue","newValue","showMissingDocDialog","makeDocFromServerHistory","setupDocFlow","makeDocFromServerGraph","makeEmptyRoot","shutdown","submit","STRUCTURE_CHANGED","CLEAR_DIRTY","SelectionManager","clearSelection","start","DOCUMENT_SWAPPED","newDocId","setDocTitle","new_doc","show","MissingDocDialog_MissingDocDialog","TreeItemProvider","THREE","TransformControls","camera","domElement","Object3D","undefined","document","_gizmo","TransformControlsGizmo","add","_plane","TransformControlsPlane","scope","defineProperty","changeEvent","mouseDownEvent","mouseUpEvent","objectChangeEvent","ray","Raycaster","_tempVector","Vector3","_tempVector2","_tempQuaternion","Quaternion","_unit","X","Y","Z","_identityQuaternion","_alignVector","pointStart","pointEnd","rotationAxis","rotationAngle","cameraPosition","cameraQuaternion","cameraScale","parentPosition","parentQuaternion","parentScale","worldPositionStart","worldQuaternionStart","worldScaleStart","worldPosition","worldQuaternion","worldScale","eye","_positionStart","_quaternionStart","_scaleStart","propName","defaultValue","propValue","get","set","dispatchEvent","getPointer","event","pointer","changedTouches","rect","getBoundingClientRect","x","clientX","left","width","y","clientY","top","height","button","onContext","onPointerHover","enabled","pointerHover","onPointerDown","onPointerMove","pointerDown","pointerMove","onPointerUp","pointerUp","dispose","attach","detach","axis","updateMatrixWorld","matrixWorld","decompose","PerspectiveCamera","copy","sub","normalize","OrthographicCamera","dragging","setFromCamera","intersect","intersectObjects","picker","children","planeIntersect","space","snap","rotationSnap","rotation","Math","round","z","position","quaternion","scale","point","applyQuaternion","clone","inverse","search","translationSnap","setFromMatrixPosition","d","dot","divide","multiply","ROTATION_SPEED","distanceTo","unit","cross","angleTo","setFromAxisAngle","getMode","setMode","setTranslationSnap","setRotationSnap","setSize","size","setSpace","update","assign","create","constructor","isTransformControls","gizmoMaterial","MeshBasicMaterial","depthTest","depthWrite","transparent","side","DoubleSide","fog","gizmoLineMaterial","LineBasicMaterial","linewidth","matInvisible","opacity","matHelper","matRed","color","matGreen","matBlue","matWhiteTransperent","matYellowTransparent","matCyanTransparent","matMagentaTransparent","matLineRed","matLineGreen","matLineBlue","matLineCyan","matLineMagenta","matLineYellow","matLineGray","matLineYellowTransparent","arrowGeometry","CylinderBufferGeometry","scaleHandleGeometry","BoxBufferGeometry","lineGeometry","BufferGeometry","addAttribute","Float32BufferAttribute","geometry","CircleGeometry","radius","arc","vertices","cos","PI","sin","gizmoTranslate","Mesh","Line","XYZ","OctahedronBufferGeometry","XY","PlaneBufferGeometry","YZ","XZ","pickerTranslate","helperTranslate","START","END","DELTA","gizmoRotate","E","XYZE","helperRotate","AXIS","pickerRotate","TorusBufferGeometry","SphereBufferGeometry","gizmoScale","XYZX","XYZY","XYZZ","pickerScale","helperScale","setupGizmo","gizmoMap","gizmo","tag","updateMatrix","tempGeometry","applyMatrix","matrix","tempVector","tempEuler","Euler","alignVector","zeroVector","lookAtMatrix","Matrix4","tempQuaternion","tempQuaternion2","identityQuaternion","unitX","unitY","unitZ","helper","handles","handle","eyeDistance","multiplyScalar","abs","setFromRotationMatrix","lookAt","atan2","multiplyQuaternions","indexOf","showX","showY","showZ","material","_opacity","_color","lerp","Color","split","some","setFromEuler","isTransformControlsGizmo","wireframe","dirVector","tempMatrix","isTransformControlsPlane","targetParentPos","targetPos","sourceParentPos","sourcePos","targetDir","sourceDir","pos","quat","bindBoneMatrix","relativeMatrix","globalMatrix","ObjectDef","node","parseFloat","substring","parseInt","tx","ty","tz","asset","NONE_ASSET","assetsManager","getTexture","tex","getLogger","alphaTest","MeshLambertMaterial","err","COUNTER","CubeDef","scene","createObject","OBJ_TYPES","cube","depth","rx","ry","rz","sx","sy","sz","createArray","BoxGeometry","userData","clickable","attachAsset","PROP_DEFS","esm_get","SphereDef","sphere","PlaneDef","SkeletonUtils","retarget","target","source","preserveMatrix","preservePosition","preserveHipPosition","useTargetMatrix","hip","names","bindBones","bone","boneTo","bonesPosition","sourceBones","isObject3D","skeleton","bones","getBones","pose","identity","offsets","getBoneByName","getInverse","setFromMatrixScale","makeRotationFromQuaternion","boneIndex","wBindMatrix","boneInverses","copyPosition","isBone","setPosition","retargetClip","clip","useFirstFramePosition","fps","getHelperFromSkeleton","positionOffset","boneData","j","numFrames","duration","delta","convertedTracks","mixer","AnimationMixer","boneDatas","clipAction","play","time","times","Float32Array","values","toArray","VectorKeyframeTrack","QuaternionKeyframeTrack","uncacheAction","AnimationClip","SkeletonHelper","getSkeletonOffsets","Vector2","nameKeys","nameValues","boneParent","getNearestBone","boneToParent","subVectors","laterialAngle","angle","offset","makeRotationFromEuler","renameBones","isArray","findBoneTrackData","tracks","regexp","result","trackData","exec","getEqualsBonesNames","targetSkeleton","targetBones","boneName","sourceLookup","Map","cloneLookup","parallelTraverse","b","callback","sourceNode","clonedNode","traverse","isSkinnedMesh","clonedMesh","sourceMesh","bindMatrix","bind","ModelDef","clicker","enter","scriptManager","model","currentClip","action","shouldPlay","exit","accessObject","tick","dt","deltaTime","useClip","findByName","clips","currentClipName","stopAllAction","uncacheRoot","getRoot","validate","optimize","remove","getGLTF","gltf","scenes","animations","boundingBox","setFromObject","boundingBoxSize","getSize","BoundingBoxCenter","getCenter","setClips","BG360Def","bg360","imageOffsetAngle","imageCropStartAngle","imageCropEndAngle","mat","onBeforeCompile","shader","uniforms","vertexShader","fragmentShader","matShader","customize","TextDef","text","cssStyle","div","innerHTML","classList","setAttribute","divLayer","WebLayer3D","pixelRatio","devicePixelRatio","onLayerCreate","layer","mesh","graphid","refresh","previewUpdate","setText","regenerateText","Image2DDef","img2d","ratio","GroupDef","group","Group","GPUParticleShader","UPDATEABLE_ATTRIBUTES","GPUParticles","blending","NormalBlending","PARTICLE_COUNT","maxParticles","PARTICLE_CURSOR","DPR","particleUpdate","onTick","reverseTime","fadeIn","fadeOut","rand","random","sprite","particleSpriteTex","can","ctx","getContext","fillStyle","fillRect","beginPath","fill","CanvasTexture","wrapS","wrapT","RepeatWrapping","ShaderMaterial","uTime","uScale","tSprite","defaultAttributeValues","particlePositionsStartTime","particleVelColSizeLife","BufferAttribute","setDynamic","particleSystem","Points","frustumCulled","attr","getAttribute","updateRange","itemSize","needsUpdate","ttime","geometryUpdate","old","velocity","acceleration","endColor","positionStartAttribute","startTimeAttribute","velocityAttribute","accelerationAttribute","colorAttribute","endcolorAttribute","sizeAttribute","lifeTimeAttribute","lifetime","sizeRandomness","r","g","min","max","ParticlesDef","particles","pointSize","startColor","texture","positionRandomness","baseVelocity","velocityRandomness","baseColor","colorRandomness","AdditiveBlending","system","spawnParticle","attachTexture","exists","getAssetURL","TextureLoader","load","updateSprite","THREEReflectorShader","tDiffuse","textureMatrix","join","THREEReflector","childrenMode","textureWidth","textureHeight","clipBias","recursion","reflectorPlane","normal","reflectorWorldPosition","cameraWorldPosition","scratchMatrix","clipPlane","viewport","view","q","virtualCamera","parameters","minFilter","magFilter","format","stencilBuffer","renderTarget","isPowerOfTwo","generateMipmaps","privateScene","privateLight1","intensity","privateLight2","assertThisInitialized","renderer","onBeforeRender","repaint","extractRotation","portalDirection","applyMatrix4","portalInverse","projectionMatrix","matrixWorldInverse","setFromNormalAndCoplanarPoint","constant","sign","elements","w","currentRenderTarget","getRenderTarget","currentVrEnabled","vr","currentShadowAutoUpdate","shadowMap","autoUpdate","currentClearColor","getClearColor","currentClearAlpha","getClearAlpha","setRenderTarget","setClearColor","setClearAlpha","render","bounds","getPixelRatio","state","PortalDef","portal","LocalAnchorDef","localanchor","recType","REC_TYPES","SCENE_START","sgp","startLocalAnchor","stopLocalAnchor","ImageAnchorDef","imageanchor","reactivate","targetImage","imageRealworldWidth","preview","toRad","updateImagePreview","image","getGraphObjectById","fireEventAtTarget","startImageRecognizer","stopImageRecognizer","GeoAnchorDef","geoanchor","targetGeoLocation","location","startGeoTracker","stopGeoTracker","HudAnchorDef","_ObjectDef","hudanchor","getCamera","getThreeObject","CloneDef","cloneTarget","theClone","find","fireSceneLifecycleEventAtChild","stdhints","incrementValue","PROP_TYPES","STRING","description","NUMBER","hints","COLOR","custom","defaultFloor","BOOLEAN","src","locked","ENUM","subtype","splashImage","multiline","fontSize","padding","borderWidth","borderRadius","horizontalAlign","textColor","backgroundColor","borderColor","drawBackground","scriptBody","defaultScene","latitude","longitude","altitude","useAltitude","autoRecenter","SIMPLE_COLORS","plane","TOTAL_OBJ_TYPES","SCENE","ASSET","BEHAVIOR","BEHAVIOR_SCRIPT","ASSETS_LIST","BEHAVIORS_LIST","ROOT","HORIZONTAL_ALIGNMENT","LEFT","CENTER","RIGHT","is3DObjectType","canHaveShape","canBeDeleted","get3DObjectDef","degrees","MIME_TYPES","PNG","JPEG","GIF","MP3","AAC","WAV","JAVASCRIPT","GLB","MP4","MOV","ASSET_TYPES","IMAGE","GLTF","AUDIO","VIDEO","GEOLOCATION","isImageType","toLowerCase","ITEM_ICONS","assets","behavior","behavior_script","audio","video","geolocation","cut","paste","delete","parseBehaviorScript","contents","Function","SceneDef","createGraphObjectFromObject","generateUniqueTitle","prefix","sc","setDefaultFloor","sceneAnchor","chNode","chObj","val","floor","parts","GLTFLoader","manager","DefaultLoadingManager","dracoLoader","GLTFRegistry","objects","removeAll","crossOrigin","onLoad","onProgress","onError","resourcePath","path","LoaderUtils","extractUrlBase","itemStart","_onError","itemError","itemEnd","loader","FileLoader","setPath","setResponseType","setCrossOrigin","setResourcePath","setDRACOLoader","content","extensions","decodeText","Uint8Array","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","KHR_BINARY_GLTF","GLTFBinaryExtension","version","extensionsUsed","extensionName","extensionsRequired","KHR_LIGHTS_PUNCTUAL","GLTFLightsExtension","KHR_MATERIALS_UNLIT","GLTFMaterialsUnlitExtension","KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS","GLTFMaterialsPbrSpecularGlossinessExtension","KHR_DRACO_MESH_COMPRESSION","GLTFDracoMeshCompressionExtension","MSFT_TEXTURE_DDS","GLTFTextureDDSExtension","KHR_TEXTURE_TRANSFORM","GLTFTextureTransformExtension","GLTFParser","DDSLoader","ddsLoader","extension","lightDefs","lights","loadLight","lightIndex","lightNode","lightDef","fromArray","range","DirectionalLight","PointLight","distance","SpotLight","spot","innerConeAngle","outerConeAngle","penumbra","decay","getMaterialType","extendParams","materialParams","materialDef","parser","pending","metallicRoughness","pbrMetallicRoughness","baseColorFactor","baseColorTexture","assignTexture","all","BINARY_EXTENSION_HEADER_LENGTH","BINARY_EXTENSION_CHUNK_TYPES","BIN","headerView","DataView","header","magic","getUint32","chunkView","chunkIndex","byteLength","chunkLength","chunkType","contentArray","byteOffset","specularGlossinessParams","pbrSpecularGlossiness","ShaderLib","UniformsUtils","specularMapParsFragmentChunk","glossinessMapParsFragmentChunk","specularMapFragmentChunk","glossinessMapFragmentChunk","lightPhysicalFragmentChunk","roughness","metalness","roughnessMap","metalnessMap","specular","setHex","glossiness","specularMap","glossinessMap","defines","STANDARD","diffuseFactor","diffuseTexture","emissive","glossinessFactor","specularFactor","specularGlossinessTexture","specGlossMapDef","createMaterial","params","isGLTFSpecularGlossinessMaterial","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalScale","displacementMap","displacementScale","displacementBias","alphaMap","envMap","envMapIntensity","refractionRatio","derivatives","cloneMaterial","il","refreshUniforms","uvScaleMap","diffuse","isWebGLRenderTarget","matrixAutoUpdate","uvTransform","flipEnvMap","isCubeTexture","reflectivity","maxMipLevel","properties","__maxMipLevel","USE_GLOSSINESSMAP","USE_ROUGHNESSMAP","GLTFCubicSplineInterpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","Interpolant","decodePrimitive","primitive","bufferViewIndex","bufferView","gltfAttributeMap","attributes","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","attributeName","threeAttributeName","ATTRIBUTES","accessorDef","accessors","componentType","WEBGL_COMPONENT_TYPES","normalized","getDependency","decodeDracoFile","attribute","extendTexture","transform","repeat","texCoord","copySampleValue_","valueSize","beforeStart_","afterEnd_","interpolate_","i1","t0","t","t1","stride","stride2","stride3","td","p","pp","ppp","offset1","offset0","s2","s3","s0","s1","p0","m0","p1","m1","defaultMaterial","WEBGL_CONSTANTS","Number","Matrix3","Vector4","Texture","5120","Int8Array","5121","5122","Int16Array","5123","Uint16Array","5125","Uint32Array","5126","WEBGL_FILTERS","9728","NearestFilter","9729","LinearFilter","9984","NearestMipMapNearestFilter","9985","LinearMipMapNearestFilter","9986","NearestMipMapLinearFilter","9987","LinearMipMapLinearFilter","WEBGL_WRAPPINGS","33071","ClampToEdgeWrapping","33648","MirroredRepeatWrapping","10497","WEBGL_TYPE_SIZES","BackSide","FrontSide","NeverDepth","LessDepth","EqualDepth","LessEqualDepth","GreaterEqualDepth","NotEqualDepth","AlwaysDepth","AddEquation","SubtractEquation","ReverseSubtractEquation","ZeroFactor","OneFactor","SrcColorFactor","OneMinusSrcColorFactor","SrcAlphaFactor","OneMinusSrcAlphaFactor","DstAlphaFactor","OneMinusDstAlphaFactor","DstColorFactor","OneMinusDstColorFactor","SrcAlphaSaturateFactor","SCALAR","VEC2","VEC3","VEC4","MAT2","MAT3","MAT4","POSITION","NORMAL","TANGENT","TEXCOORD_0","TEXCOORD_1","COLOR_0","WEIGHTS_0","JOINTS_0","PATH_PROPERTIES","translation","weights","INTERPOLATION","CUBICSPLINE","LINEAR","InterpolateLinear","STEP","InterpolateDiscrete","ALPHA_MODES","MIME_TYPE_FORMATS","image/png","RGBAFormat","image/jpeg","RGBFormat","resolveURL","test","addUnknownExtensionsToUserData","knownExtensions","objectDef","gltfExtensions","assignExtrasToUserData","gltfDef","extras","updateMorphTargets","meshDef","morphTargetInfluences","targetNames","morphTargetDictionary","createAttributesKey","attributesKey","sort","cloneBufferAttribute","isInterleavedBufferAttribute","getX","getY","getZ","getW","primitiveCache","textureLoader","fileLoader","addPrimitiveAttributes","primitiveDef","assignAttributeAccessor","accessorIndex","accessor","gltfAttributeName","indices","setIndex","targets","hasMorphPosition","hasMorphNormal","pendingPositionAccessors","pendingNormalAccessors","pendingAccessor","morphPositions","morphNormals","positionAttribute","jl","setXYZ","normalAttribute","morphAttributes","addMorphTargets","markDefs","getDependencies","dependencies","cameras","nodeDefs","nodes","skinDefs","skins","meshDefs","meshes","meshReferences","meshUses","skinIndex","skinLength","joints","nodeIndex","nodeLength","nodeDef","skin","cacheKey","dependency","loadScene","loadNode","loadMesh","loadAccessor","loadBufferView","loadBuffer","loadMaterial","loadTexture","loadSkin","loadAnimation","loadCamera","defs","bufferIndex","bufferDef","buffers","uri","reject","bufferViewDef","bufferViews","sparse","pendingBufferViews","bufferAttribute","TypedArray","elementBytes","BYTES_PER_ELEMENT","itemBytes","byteStride","ibCacheKey","ib","InterleavedBuffer","InterleavedBufferAttribute","itemSizeIndices","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","setArray","setX","setY","setZ","setW","textureIndex","URL","webkitURL","textureDef","textures","textureExtensions","sourceURI","images","isObjectURL","blob","Blob","mimeType","createObjectURL","Loader","Handlers","revokeObjectURL","flipY","sampler","samplers","mapName","mapDef","isCompressedTexture","assignFinalMaterial","useVertexTangents","tangent","useVertexColors","useFlatShading","useSkinning","useMorphTargets","useMorphNormals","isPoints","pointsMaterial","PointsMaterial","Material","isLine","lineMaterial","cachedMaterial","skinning","vertexTangents","vertexColors","VertexColors","flatShading","morphTargets","uv2","uv","materialIndex","materialType","materials","materialExtensions","sgExtension","kmuExtension","MeshStandardMaterial","metallicFactor","roughnessFactor","metallicRoughnessTexture","doubleSided","alphaMode","alphaCutoff","normalTexture","occlusionTexture","strength","emissiveFactor","emissiveTexture","encoding","sRGBEncoding","loadGeometries","primitives","createDracoPrimitive","dracoExtension","geometryPromise","cached","promise","meshIndex","originalMaterials","geometries","SkinnedMesh","normalizeSkinWeights","drawMode","TriangleStripDrawMode","TriangleFanDrawMode","LineSegments","LineLoop","cameraIndex","cameraDef","radToDeg","yfov","aspectRatio","znear","zfar","xmag","ymag","skinDef","skinEntry","inverseBindMatrices","animationIndex","animationDef","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","input","output","inputAccessors","outputAccessors","inputAccessor","outputAccessor","TypedKeyframeTrack","NumberKeyframeTrack","targetName","interpolation","isMesh","track","createInterpolant","getValueSize","isInterpolantFactoryMethodGLTFCubicSpline","Bone","instanceNum","o","light","PropertyBinding","sanitizeNodeName","buildNodeHierachy","nodeId","parentObject","pendingJoints","jointNodes","isGroup","jointNode","Skeleton","sceneIndex","sceneDef","Scene","nodeIds","SceneGraphProvider","beh","vol","SystemFacade","tween","getTweenManager","globalStorage","storage","getGraphObjectByName","trusted","_event","isTrusted","AssetFacade","getObjectById","getCurrentScene","fireSceneLifecycleEvent","navigateScene","fireMessageAtTarget","captureEvent","ScriptManager","sceneGraphProvider","running","system_cache","bubbling","getAllScenes","graphTarget","getParsedBehaviorAsset","getSystemFacadeFromCache","code","startTime","lastTime","session","parentId","stopRunning","fireLifecycleEvent","destroyListeners","getBehaviorsForObject","playMediaAsset","isMediaAssetPlaying","stopMediaAsset","setMediaVolume","Tween","WaitTween","dur","ActionTween","fn","ForeverTween","diff","SINGLE","COMPOUND","LERP_TYPES","ELASTIC","easeLinear","to","PropTween","property","propertyType","lerp_type","lerpType","loop","loopCount","reversed","autoReverse","setPropertyValue","pow","easeOutElastic","ClipTween","_this6","speed","setLoop","Infinity","setEffectiveTimeScale","prevTime","ParallelTween","_this7","subs","s","isAlive","SequentialTween","_this8","n","_startNext","cur","TweenManager","Cesium","XRGeospatialAnchor","XRSupport","imageDetectorMap","geoAnchorMap","_workingMatrix","mat4","_identity","_vec","vec3","lastFrameTime","heightAboveFloor","canvas","device","xrCanvas","xrContext","context","_anchoredNodes","that","navigator","xr","requestDevice","xrDevice","requestSession","outputContext","alignEUS","worldSensing","xrSession","useEstimatedElevation","updateGeoElevationLoop","nonStandard_setNumberOfTrackedImages","compatibleXRDevice","baseLayer","XRWebGLLayer","_updateGeoElevationLoop","asyncToGenerator","regenerator_default","mark","_callee","sleep","wrap","_context","next","setTimeout","userAnimationCallback","requestFrameOfReference","frameOfReference","headFrameOfReference","eyeLevelFrameOfReference","__handleAnimationFrame","_handleAnimationFrame","requestAnimationFrame","frame","ended","getDevicePose","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","views","Symbol","iterator","done","getViewport","getViewMatrix","return","anchor","uid","modelMatrix","_handleAnchorUpdateCallback","_handleAnchorUpdate","_handleAnchorDeleteCallback","_handleAnchorDelete","_createSceneAnchor","_callee2","sceneNode","eyeLevel","newAnchor","_context2","abrupt","sent","getTransformTo","getTranslation","fromTranslation","addAnchor","addAnchoredNode","_x","_x2","_removeAnchorFromNode","removeAnchor","screenx","screeny","normalizedX","normalizedY","rayorigin","invert","raydir","fromValues","transformMat4","headLevel","requestHitTest","xrhitresults","_removeAnchorForNode","rej","img","Image","onload","det","realWorldWidth","_fetchImage","idata","toConsumableArray","toString","drawImage","getImageData","documentURI","ToasterManager","nonStandard_createDetectionImage","anchorName","nonStandard_activateDetectionImage","anchorStyle","nonStandard_deactivateDetectionImage","lla","Cartographic","createGeoAnchor","getDefaultElevation","getDeviceCartographic","cartographic","details","_this9","anchoredNode","_mozillaXRViewer","OrbitControls","quatInverse","lastPosition","lastQuaternion","minDistance","maxDistance","minZoom","maxZoom","minPolarAngle","maxPolarAngle","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","keyPanSpeed","autoRotate","autoRotateSpeed","enableKeys","UP","BOTTOM","mouseButtons","ORBIT","MOUSE","ZOOM","MIDDLE","PAN","target0","position0","zoom0","zoom","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","saveState","reset","updateProjectionMatrix","STATE","NONE","setFromUnitVectors","up","setFromVector3","rotateLeft","sphericalDelta","makeSafe","panOffset","setFromSpherical","zoomChanged","distanceToSquared","EPS","onContextMenu","onMouseDown","onMouseWheel","onTouchStart","onTouchEnd","onTouchMove","onMouseMove","onMouseUp","onKeyDown","startEvent","endEvent","ROTATE","DOLLY","TOUCH_ROTATE","TOUCH_DOLLY","TOUCH_PAN","Spherical","rotateStart","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","getZoomScale","rotateUp","v","panLeft","objectMatrix","setFromMatrixColumn","panUp","pan","deltaX","deltaY","element","isPerspectiveCamera","targetDistance","tan","fov","clientHeight","isOrthographicCamera","right","clientWidth","bottom","dollyIn","dollyScale","dollyOut","handleMouseDownRotate","handleMouseDownDolly","handleMouseDownPan","handleMouseMoveRotate","handleMouseMoveDolly","handleMouseMovePan","stopPropagation","handleMouseWheel","keyCode","handleKeyDown","touches","pageX","pageY","handleTouchStartRotate","dx","dy","sqrt","handleTouchStartDolly","handleTouchStartPan","handleTouchMoveRotate","handleTouchMoveDolly","handleTouchMovePan","EventDispatcher","defineProperties","center","noZoom","noRotate","noPan","noKeys","staticMoving","dynamicDampingFactor","Adapter","getSelectedSceneObject","filter","findNode","prov","getCachedBehaviorAsset","setSelection","tweenManager","getFloorNear","MOVE_SPEED","VRCanvas","moveCameraForward","moveCameraBackward","handleKeyPress","recenterOnSelection","sel","getSelection","orbitControls","cam","transformChanged","quick_setPropertyValue","transformDraggingChanged","docSwapped","obj_node_map","setState","rebuildNode","sceneObj","setCurrentSceneWrapper","selectionChanged","transformControls","findSceneObjectParent","clickedCanvas","raycaster","getCurrentSceneWrapper","findKnownParent","performClickAction","previewUpdateNodes","current_scene_wrapper","inset","makeNode","insertNodeMapping","addSceneWrapper","wrapper","h","aspect","supportsARKit","setupRenderer","setAnimationLoop","animationLoopWithCamera","animationLoop","saveOrbitControlsState","off","SELECTION_MANAGER","CHANGED","antialias","setPixelRatio","gammaOutput","audioListener","setAudioListener","background","updateScene","on","checkAspectRatio","viewMatrix","matrixWorldNeedsUpdate","removeNodeMapping","updateProperty","populateNode","nextProps","nextState","nextContext","stopAllMedia","resetSceneGraph","stopRecognizers","startRecognizers","startRunning","startFirstScene","style","boxSizing","display","flexDirection","margin","flex","overflow","ref","c","className","tabIndex","nodeid","obj3d","rebuildParentLink","ch3","orbit_state","changed","restoreOrbitControlsState","dump","_this10","graphObj","threeObj","elem","TranslationArrow","control","startHover","arrow","endHover","beginDrag","startPoint","intersection","worldToLocal","oldFilter","intersectionFilter","draggable","startPosition","POINTER_MOVE","updateDrag","POINTER_RELEASE","endDrag","endPoint","finalPoint","end","makePlane","makeArrow","makeInputGrabber","POINTER_ENTER","POINTER_EXIT","POINTER_PRESS","TranslateControl","_THREE$Group","Panel2D","canvasTexture","redrawHandler","redraw","comps","inside","fpt","contains","comp","findAt","POINTER_CLICK","startDrag","pt","draw","dragSphere","moveDrag","Component2D","Button2D","fsize","normalBg","hoverBg","bg","font","metrics","measureText","fillText","strokeStyle","strokeRect","Group2D","border","layout","translate","restore","childProps","deg","YAXIS","ThreeDOFController","stagePos","stageRot","states","touchpad","keystates","ArrowLeft","previous","ArrowRight","ArrowUp","ArrowDown","dir","rotateRight","moveForward","moveBackward","applyAxisAngle","_fire","scanGamepads","updateKeys","gamepads","getGamepads","gamepad","startsWith","buttons","pressed","axes","down","deleteObject","isEmpty","removeFromParent","newDoc","generateAddAssetPopup","acts","supportsAssetUpload","icon","fun","showAddImageAssetDialog","showAddServerImageDialog","divider","showAddGLTFAssetDialog","showAddGLBAssetDialog","showAddAudioAssetDialog","showOpenAssetDialog","showAddGeoLocationAssetDialog","editor","currentScene","swapScene","ImmersiveVREditor","standardViewClickHandler","isRunning","parseOptions","disabled","appy_comps_es","sceneWrappers","initScene","render3","stats","controller","$","querySelector","container","innerWidth","innerHeight","WebGLRenderer","appendChild","vrmanager","VRManager","AudioListener","initContent","VR_DETECTED","removeAttribute","innerText","enterVR","updateSceneOp","documentSwapped","controls","selectedNode","AmbientLight","VRStats","editable","Pointer","cameraFollowMouse","mouseSimulatesController","enableLaser","laserLength","stick","controller1","tools","panel2d","button2d","setAll","add3DObject","runButton","color_group","group2d","panel","setColor","defaults","nodeObj","addImageAssetFromExpandedURL","assetId","getAssetsObject","insertChildLast","requestImageCache","addImageAssetFromFile","uploadFile","ans","addGLBAssetFromFile","addAudioAssetFromURL","fileType","lastIndexOf","AddImageAssetDialog","fileInput","files","switchLocal","switchRemote","selectedFile","typedURL","React","createRef","selected","renderSelectedPanel","AddGLTFAssetDialog","fileinput","multiple","webkitdirectory","AddGLBAssetDialog","AddAudioAssetDialog","addAudioAssetFromFile","UnsavedDocumentDialog","onAnyway","DRACOLoader","timeLoaded","verbosity","attributeOptions","TrianglesDrawMode","nativeAttributeMap","setVerbosity","level","setDrawMode","setSkipDequantization","skip","skipDequantization","getAttributeOptions","rawBuffer","attributeUniqueIdMap","getDecoderModule","module","decodeDracoFileInternal","decoder","dracoDecoder","DecoderBuffer","Init","Decoder","geometryType","GetEncodedGeometryType","TRIANGULAR_MESH","POINT_CLOUD","errorMsg","convertDracoGeometryTo3JS","addAttributeToGeometry","dracoGeometry","attributeType","geometryBuffer","ptr","attributeData","TypedBufferAttribute","numComponents","num_components","numValues","num_points","DracoFloat32Array","GetAttributeFloatForAllPoints","DracoInt8Array","GetAttributeInt8ForAllPoints","Int8BufferAttribute","DracoInt16Array","GetAttributeInt16ForAllPoints","Int16BufferAttribute","Int32Array","DracoInt32Array","GetAttributeInt32ForAllPoints","Int32BufferAttribute","DracoUInt8Array","GetAttributeUInt8ForAllPoints","Uint8BufferAttribute","DracoUInt16Array","GetAttributeUInt16ForAllPoints","Uint16BufferAttribute","DracoUInt32Array","GetAttributeUInt32ForAllPoints","Uint32BufferAttribute","GetValue","destroy","decodingStatus","SkipAttributeTransform","start_time","performance","DecodeBufferToMesh","PointCloud","DecodeBufferToPointCloud","ok","error_msg","numFaces","decode_end","num_faces","numPoints","numAttributes","num_attributes","posAttId","GetAttributeId","posAttribute","GetAttribute","attributeId","GetAttributeByUniqueId","attId","stripsArray","GetTriangleStripsFromMesh","numIndices","ia","GetFaceFromMesh","posTransform","AttributeQuantizationTransform","InitFromAttribute","isQuantized","maxRange","numQuantizationBits","quantization_bits","minValues","min_value","decode_time","import_time","isVersionSupported","decoderPath","decoderConfig","decoderModulePromise","setDecoderPath","setDecoderConfig","config","wasmBinary","releaseDecoderModule","DracoDecoderModule","WebAssembly","_loadScript","wasmBinaryFile","_loadArrayBuffer","onModuleLoaded","prevScript","getElementById","parentNode","removeChild","head","getElementsByTagName","script","GLTFAssetView","renderThree","initThreeJS","swapModel","draco","near","far","playAllClips","sceneContainer","screenSpacePanning","GeoAssetView","loadCurrentLocation","getCurrentPosition","coords","onMapClick","latlng","lat","lng","updateLocation","ll","latLng","lon","marker","setLatLng","mymap","panTo","setView","tileLayer","attribution","addTo","customIcon","divIcon","AssetView","renderAsset","alt","playsInline","GLTFAssetView_GLTFAssetView","GeoAssetView_GeoAssetView","cloneObjectDeep","shapeid","newParent","id2","children2","arr2","ch2","insertElement","cloneArrayDeep","createProperty","GraphAccessor","hasObject","insertFirstChild","insertChildAfter","findIndex","removeElement","getParent","match","OpenFileDialog","refreshList","loadDocList","docs","docList","dismiss","removeDoc","href","generateDocUrl","renderDeleteButton","supportsDocDelete","deleteDoc","OpenAssetDialog","loadAssetList","assetList","isVideoType","addVideoAssetFromURL","isGLTFType","addGLBAssetFromURL","removeAssetSource","addAsset","deleteAsset","ScriptEditor","swap","changeText","getSession","getAnnotations","updateBehaviorAssetContents","fetchBehaviorAssetContents","lib_default","theme","onBlur","showGutter","ed","OpenScriptDialog","loadScriptList","scripts","addBehaviorAssetFromURL","onAdd","removeBehaviorAssetSource","addScript","supportsScriptEdit","deleteScript","CUSTOM_BEHAVIOR_SCRIPT","CUSTOM_SCENE_SCRIPT","QRDialog","wurl","PasswordDialog","doPasswordLogin","field","keyDown","GithubAuthDialog","getLoginURL","ErrorCatcher","errorInfo","parseGIF","gif","delayTimes","graphicControl","frames","disposals","transparencies","transparentColors","loopCnt","gifHeader","subarray","blockId","label","imageData","GIFTexture","delays","_ctx","isVideoTexture","frameStartTime","firstDrawCount","playing","clearRect","AssetsManager","assets_url_map","videocache","audiocache","gifcache","lg","sound","isPlaying","Audio","getAudioListener","AudioLoader","setBuffer","setVolume","muted","volume","arrayBuffer","String","fromCharCode","rawImageData","loadCnt","_loop","createGIFTexture","preload","VideoTexture","xhr","SaveDocumentAsDialog","edited","newTitle","saveAs","duplicateDocument","BadAssetsDialog","badAssets","ToasterNotification","notification","ConsoleView","clearLog","messages","placeholder","loc","formatMessage","msgs","inspect","SimpleMessageDialog","VREditor","getApp","VREditor_VREditorApp","ImmersiveVREditor_ImmersiveVREditor","getTitle","consoleLogger","getBehaviorsObject","setCachedBehaviorAsset","cacheAssetsList","addAssetLoadingError","answers","showBadAssetsDialog","getRendererForItem","editIn2D","protocol","pathname","QRDialog_QRDialog","editInVR","viewInVR","make","cutSelection","nodeName","setClipboard","copySelection","pasteSelection","obj1","getClipboard","AddImageAssetDialog_AddImageAssetDialog","AddAudioAssetDialog_AddAudioAssetDialog","AddGLTFAssetDialog_AddGLTFAssetDialog","AddGLBAssetDialog_AddGLBAssetDialog","showOpenDocumentDialog","OpenFileDialog_OpenFileDialog","OpenAssetDialog_OpenAssetDialog","showOpenBehaviorDialog","OpenScriptDialog_OpenScriptDialog","showPasswordDialog","PasswordDialog_PasswordDialog","showGithubDialog","GithubAuthDialog_GithubAuthDialog","addCustomBehaviorAsset","TEMPLATE","randi","fname","getScriptsURL","addSceneScript","addBehaviorToObject","imagecache","behaviorCache","popupManager","rootObj","scene1","behaviors","behaviorProps","getCachedBehaviorPropDefs","pname","propdef","ndef","out","copyPropDef","GROUP","ob","SimpleMessageDialog_SimpleMessageDialog","realobj","hasHints","getHints","nodeType","acceptsImageAsset","acceptsVideoAsset","withNone","EnumTitleRenderer","getFirstSceneObject","ov","cmds","addScene","canHaveBehavior","tgt","dataTransfer","isGLTFFile","sibling","VREditor_ColorEditor","VREditor_GroupPropertyEditor","al","BadAssetsDialog_BadAssetsDialog","VREditorApp","showSaveAsDialog","SaveDocumentAsDialog_SaveDocumentAsDialog","resizeLeft","resizeLeftWindow","endResizeLeftWindow","leftDivider","resizeRight","resizeRightWindow","endResizeRightWindow","rightDivider","resizeBottom","resizeBottomWindow","endResizeBottomWindow","bottomDivider","toggleLeftPane","toggleRightPane","toggleBottomPane","toggleRunning","dirty","UnsavedDocumentDialog_UnsavedDocumentDialog","user","im","InputManager","addKeyBinding","KEYS","S","modifiers","MODIFIERS","COMMAND","SHIFT","C","V","attachKeyEvents","getUsername","gridStyle","gridTemplateColumns","gridTemplateRows","ErrorCatcher_ErrorCatcher","renderLoginButton","VREditor_Resizer","getPopupManager","actions","showAddPopup","showAddAssetPopup","showAddBehaviorPopup","VREditor_RunButton","active","renderCenterPane","bottomText","VREditor_ResizerH","ConsoleView_ConsoleView","ToasterNotification_ToasterNotification","ScriptEditor_ScriptEditor","VRCanvas_VRCanvas","AssetView_AssetView","supportsAuth","supportsPassword","supportsDocList","Resizer","ResizerH","GroupPropertyEditor","syncChanged","sync","getGroupKeys","newvals","_this11","boxes","step","checked","RunButton","clss","ColorEditor","showPopup","_this12","VREditor_ColorPopup","contextType","PopupManagerContext","ColorPopup","_this13","_this14","meshMap","workingMatrix","savedOrigin","savedDirection","reticleParent","reticle","reticleTrackedColor","reticleNotTrackedColor","reticleMaterial","requestNextHit","singleton","XRWorldInfo","engine","_floorPos","updateWorldSensingState","illuminationDetectionState","meshDetectionState","normals","_handleHitResults","handleHitResults","makeRotationX","degToRad","worldInfo","worldInformation","seen","worldMesh","handleUpdateNode","handleNewNode","handleRemoveNode","findFloorNear","squaredDistance","hits","hit","hitMatrix","timeStamp","ts","vertexCountChanged","newMesh","newMeshNode","threeMesh","vertexPositionsChanged","vertexPositions","textureCoordinatesChanged","textureCoordinates","triangleIndicesChanged","triangleIndices","vertexNormalsChanged","vertexNormals","worldMeshGroup","dynamic","verticesBufferAttribute","uvBufferAttribute","normalsBufferAttribute","computeVertexNormals","wireMaterial","targetRadiusSq","targetTop","targetBottom","meshPos","bestPos","bestY","_center","distanceY","_extent","attachUtilFunctions","obj_map","ImmersivePlayer","clickedStart","renderThreeWithCamera","xrWorldInfo","startScene","three_map","current_scene","inter","gobj","refreshWorldInfo","showErrors","title_map","behavior_map","behavior_assets","pendingAssets","loadDocument","initAssets","assetsRoot","validateAssets","buildRoot","setCurrentScene","startupsound","renderSplashImage","renderErrors","initObject","initBehaviors","chnode","documentElement","prom","sceneAnchorNode","removeSceneAnchor","createSceneAnchor","updateAnchoredSceneNode","assetsList","player","_this15","sceneid","updateRayAnchor","stopAnchor","_this16","createDetectionImage","_this17","addGeoAnchoredNode","setVisible","App","ImmersivePlayer_ImmersivePlayer","ReactDOM","Provider","PopupManager","App_App","exports","adds","note","offAdd","__webpack_require__"],"mappings":"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","file":"static/js/main.29c6639d.chunk.js","sourcesContent":["const {SET_PROPERTY, CREATE_PROPERTY, DELETE_PROPERTY,\n    CREATE_OBJECT, DELETE_OBJECT,\n    INSERT_ELEMENT, DELETE_ELEMENT\n} = require(\"syncing_protocol\");\n\nexport class UndoQueue {\n    constructor(graph) {\n        this.graph = graph\n        this.history = []\n        this.current = -1\n    }\n\n    submit(op) {\n        // console.log(\"UNDOREDO: submit\",op)\n        this.history.push(op)\n        this.current = this.history.length - 1\n    }\n\n    canUndo() {\n        return this.current >= 0\n    }\n\n    canRedo() {\n        return this.current < this.history.length - 1\n    }\n\n    undo() {\n        const last = this.history[this.current]\n        this.current--\n        // console.log(\"undoing\",last)\n        // this.history.forEach(op => console.log(short(op)))\n        if (last.type === SET_PROPERTY) {\n            if (!last.prevValue) {\n                console.warn(\"undoing set property without a previous value!\", last)\n                return\n            }\n            const op = {\n                type: SET_PROPERTY,\n                host: this.graph.getHostId(),\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                object: last.object,\n                name: last.name,\n                value: last.prevValue,\n            }\n            this.graph.process(op)\n            return\n        }\n        if (last.type === CREATE_PROPERTY) {\n            const op = {\n                type: DELETE_PROPERTY,\n                host: this.graph.getHostId(),\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                object: last.object,\n                name: last.name,\n            }\n            this.graph.process(op)\n            return\n        }\n        if (last.type === CREATE_OBJECT) {\n            const op = {\n                type: DELETE_OBJECT,\n                host: this.graph.getHostId(),\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                id: last.id,\n            }\n            this.graph.process(op)\n            return\n        }\n        if (last.type === INSERT_ELEMENT) {\n            const op = {\n                type: DELETE_ELEMENT,\n                host: this.graph.getHostId(),\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                array: last.array,\n                entry: last.entryid\n            }\n            this.graph.process(op)\n            return\n        }\n        throw new Error(`undo for type not supported: ${last.type}`)\n    }\n\n    redo() {\n        this.current++\n        const last = this.history[this.current]\n        // console.log(\"redoin\",this.current,last.type,last.name,'=',last.value)\n        if (last.type === SET_PROPERTY) {\n            const op = {\n                type: last.type,\n                host: last.host,\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                object: last.object,\n                name: last.name,\n                value: last.value\n            }\n            this.graph.process(op)\n            return\n        }\n        if (last.type === CREATE_PROPERTY) {\n            const op = {\n                type: last.type,\n                host: last.host,\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                object: last.object,\n                name: last.name,\n                value: last.value\n            }\n            this.graph.process(op)\n            return\n        }\n        if (last.type === CREATE_OBJECT) {\n            const op = {\n                type: last.type,\n                host: last.host,\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                id: last.id,\n            }\n            this.graph.process(op)\n            return\n        }\n        if (last.type === INSERT_ELEMENT) {\n            console.log(\"redoing\", last)\n            const op = {\n                type: last.type,\n                host: last.host,\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                array: last.array,\n                value: last.value,\n                entryid: this.graph.makeGUID(),\n                prev: -1,\n            }\n            this.graph.process(op)\n            return\n        }\n        throw new Error(`redo for type not supported: ${last.type}`)\n    }\n\n    dump() {\n        return this.history.map((op, i) => i + \" \" + op.type + \" \" + op.name + \" => \" + op.value)\n    }\n}\n","const {SET_PROPERTY} = require(\"syncing_protocol\");\n\n\nexport class EventCoalescer {\n    constructor(graph) {\n        this.graph = graph\n        this.listeners = []\n        this.rawlisteners = []\n        this.paused = false\n        this.buffer = []\n        this.first = {}\n        this.last = {}\n    }\n\n    pause() {\n        this.paused = true\n    }\n\n    unpause() {\n        this.paused = false\n        this.buffer = []\n        // console.log(\"need to send out set property updates\",this.last)\n        // console.log('the originals are',this.first)\n        Object.keys(this.last).forEach((key) => {\n            Object.keys(this.last[key]).forEach(name => {\n                const op = this.last[key][name]\n                // console.log(\"sending\",short(op))\n                op.prevValue = this.first[key][name].value\n                this.fire(op)\n                this.graph.process(op)\n            })\n        })\n\n        this.first = {}\n        this.last = {}\n\n        // console.log(this.graph.dumpGraph())\n        // this.graph.getHistory().forEach(h => console.log(h.type,h.name,h.value))\n    }\n\n    onChange = cb => this.listeners.push(cb)\n    onRawChange = cb => this.rawlisteners.push(cb)\n    fire = op => this.listeners.forEach(cb => cb(op))\n    fireRaw = op => this.rawlisteners.forEach(cb => cb(op))\n    getPropertiesForObject = (obj) => this.graph.getPropertiesForObject(obj)\n    getArrayLength = (obj) => this.graph.getArrayLength(obj)\n    getElementAt = (obj, index) => this.graph.getElementAt(obj, index)\n    getHostId = () => this.graph.getHostId()\n\n\n    getPropertyValue(obj, key) {\n        // console.log(\"checking\",this.paused,obj,key)\n        if (this.paused && this.last[obj] && this.last[obj][key]) {\n            // console.log(\"returning the raw property values\",this.last[obj][key])\n            return this.last[obj][key].value\n        } else {\n            return this.graph.getPropertyValue(obj, key)\n        }\n    }\n\n    bufferOp(op) {\n        if (!this.first[op.object]) this.first[op.object] = {}\n        if (!this.first[op.object][op.name]) this.first[op.object][op.name] = op\n        if (!this.last[op.object]) this.last[op.object] = {}\n        this.last[op.object][op.name] = op\n        this.buffer.push(op)\n        this.fireRaw(op)\n    }\n\n    process(op) {\n        if (op.type === SET_PROPERTY && this.paused) {\n            this.bufferOp(op)\n        } else {\n            this.fire(op)\n            this.graph.process(op)\n        }\n    }\n}\n","import {getAssetsURL, getInfoURL, getUserURL, genID} from 'react-visual-editor-framework'\nimport * as ToasterMananager from './ToasterManager'\n\nexport const USER_CHANGE = 'USER_CHANGE'\nexport const CONNECTED = \"CONNECTED\"\nclass AuthModuleSingleton {\n    constructor() {\n        this.listeners = {}\n        this.supported = false\n        this.doclistSupported = false\n        this.docDeleteSupported = false\n        this.assetUploadSupported = false\n        this.scriptEditingSupported = false\n        this.passwordSupported = false\n        this.connected = false\n        this.serverID = genID(\"serverid\")\n    }\n    on(type,cb) {\n        if(!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].push(cb)\n    }\n    fire(type,payload) {\n        if(!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].forEach(cb => cb(payload))\n    }\n\n    init() {\n        if(this.isLoggedIn()) this.doclistSupported = true\n        fetch(getInfoURL()).then(res => res.json())\n            .then(info => {\n                console.info(\"Server Info:\",info)\n                if(info.authentication === true)      this.supported = true\n                if(info.passwordSupported === true)   this.passwordSupported = true\n                if(info.assetUpload === true)         this.assetUploadSupported = true\n                if(info.scriptEditing === true)       this.scriptEditingSupported = true\n                if(info.docDeleteSupported === true)  this.docDeleteSupported = true\n                this.serverID = getInfoURL().replace(/[.:/]/g,\"\")\n\n\n                this.getJSON(getUserURL()).then(res=>{\n                    if(!res.success) {\n                        this.logout()\n                    } else {\n                        this.fire(USER_CHANGE)\n                        this.doclistSupported = true\n                    }\n                    this.connected = true\n                    this.fire(CONNECTED)\n                }).then(()=>{\n                    this.connected = true\n                    this.fire(CONNECTED)\n                })\n            })\n    }\n    isConnected() {\n        return this.connected\n    }\n\n    isLoggedIn() {\n        if(localStorage.getItem('access-token')) return true\n        return false\n    }\n    supportsPassword() {\n        return this.passwordSupported\n    }\n    supportsAuth() {\n        return this.supported\n    }\n    supportsDocList() {\n        return this.doclistSupported\n    }\n    supportsAssetUpload() {\n        return this.assetUploadSupported\n    }\n    supportsScriptEdit() {\n        return this.scriptEditingSupported\n    }\n    supportsDocDelete() {\n        return this.docDeleteSupported\n    }\n\n    login = (res) => {\n        this.win = window.open(res.url,'_blank')\n        window.addEventListener('message',this.authCallback)\n        if(this.win) this.win.focus()\n    }\n    logout = () => {\n        localStorage.clear()\n        this.doclistSupported = false\n        this.fire(USER_CHANGE)\n    }\n    doPasswordLogin (password) {\n        localStorage.setItem('access-token',password)\n        return this.getJSON(getUserURL()).then(res=>{\n            if(res.success === true) {\n                console.log(\"the logged in response is\", res)\n                this.doclistSupported = true\n                ToasterMananager.add(\"login succeeded\")\n                this.fire(USER_CHANGE)\n            } else {\n                ToasterMananager.add(\"login failed\")\n                localStorage.clear()\n                this.doclistSupported = false\n                this.fire(USER_CHANGE)\n            }\n        })\n\n    }\n    authCallback = (msg) => {\n        this.setUserData(msg.data.payload)\n        this.win.close()\n        window.removeEventListener('message',this.authCallback)\n        this.doclistSupported = true\n        this.fire(USER_CHANGE)\n        ToasterMananager.add(\"login succeeded\")\n    }\n    setUserData(data) {\n        localStorage.setItem('access-token',data.accessToken)\n    }\n    getAccessToken() {\n        return localStorage.getItem('access-token')\n    }\n\n    getUsername() {\n        return this.getAccessToken()\n    }\n\n    getServerID() {\n        return this.serverID\n    }\n\n    fetch(url, options) {\n        options.mode = 'cors'\n        options.cache = 'no-cache'\n        if(!options.headers) options.headers = {}\n        options.headers[\"access-key\"] =  AuthModule.getAccessToken()\n        console.log(\"fetching\",url,'with options',options)\n        return fetch(url,options)\n            .then(res => {\n                if(res.status === 404) throw new Error(res.statusText + \" \" + res.url)\n                return res\n            })\n    }\n    getJSON(url) {\n        return this.fetch(url,{\n            method:'GET',\n            headers: {\n                \"Content-Type\": \"application/json\",\n            }\n        }).then(res => res.json())\n    }\n\n    uploadFile(file) {\n        const url = getAssetsURL()+file.name\n        return this.fetch(url,{\n            method:'POST',\n            body:file\n        }).then(res => res.json())\n    }\n\n}\n\nexport const AuthModule = new AuthModuleSingleton()\n","import PubNub from \"pubnub\";\nimport {AuthModule} from '../vr/AuthModule'\nimport prune from \"json-prune\"\n\nfunction short(op) {\n    let str = `${op.type} ${op.uuid} |  `\n    if(op.name) {\n        str += `${op.name} = ${op.value}  prev = ${op.prevValue}`\n    }\n    return str\n}\nconst settings = {\n    publishKey: 'pub-c-1cba58da-c59a-4b8b-b756-09e9b33b1edd',\n    subscribeKey: 'sub-c-39263f3a-f6fb-11e7-847e-5ef6eb1f4733',\n}\n\nexport class PubnubSyncWrapper {\n    constructor(provider, graph) {\n        if(!provider) throw new Error('created PubnubSyncWrapper without a provider')\n        if(!graph) throw new Error('created PubnubSyncWrapper without a graph')\n        this.paused = false\n        this.buffer = []\n        this.provider = provider\n\n        graph.onChange((e)=>this.handleGraphChange(e))\n\n        this.pubnub = new PubNub(settings)\n        this.logger = new PubnubLogger(this.provider.getDocId(),this.pubnub)\n    }\n\n    calculateChannelName() {\n        return \"metadoc-docupdate-\" + this.provider.getDocId() + \"_\"+AuthModule.getServerID()\n    }\n    calculateLoggerChannelName() {\n        return \"metadoc-log-\" + this.provider.getDocId()+\"_\"+AuthModule.getServerID()\n    }\n\n    start() {\n        this.pubnub.addListener({\n            status: (e) => {\n                // console.log(e)\n                if (e.operation === 'PNSubscribeOperation' && e.category === 'PNConnectedCategory') {\n                    this.sendHistoryRequest()\n                }\n            },\n            message: (m)=>this.handleMessage(m),\n        })\n\n        this.pubnub.subscribe({channels: [this.calculateChannelName(),this.calculateLoggerChannelName()]})\n    }\n\n    pause() {\n        this.paused = true\n    }\n\n    unpause() {\n        this.paused = false\n        // console.log(\"we need to send the waiting messages\", this.buffer)\n        this.buffer.forEach(op => this.sendMessage(op))\n        this.buffer = []\n        //now request history from the network for anything we missed\n        // this.sendHistoryRequest()\n    }\n\n    shutdown() {\n        this.pubnub.unsubscribe({channels: [this.calculateChannelName()]})\n        this.pubnub.stop()\n    }\n\n    sendMessage(e) {\n        console.log(\"PN_SEND:\", short(e))\n        this.pubnub.publish({\n            channel: this.calculateChannelName(),\n            message: e\n        }, (status, response) => {\n            // console.log(\"published\",status,response)\n        })\n\n    }\n\n    handleGraphChange (e) {\n        // console.log(\"graph changed\",e)\n        const host = this.provider.getDataGraph().getHostId()\n        if (e.host !== host) return\n        if (this.paused) return this.buffer.push(e)\n        this.sendMessage(e)\n    }\n\n    sendHistoryRequest() {\n        // console.log(\"sending a history request\")\n        this.pubnub.publish({\n            channel: this.calculateChannelName(),\n            message: {\n                type: 'GET_HISTORY',\n                host: this.provider.getDataGraph().getHostId()\n            }\n        })\n    }\n\n    handleGetHistory() {\n        // console.log(\"need to send out the history\")\n        const graph = this.provider.getDataGraph()\n        const hist = graph.getHistory().slice()\n        console.log(hist)\n        const chunkSize = 30\n        let count = 0\n        while (hist.length > 0) {\n            if (count > 100) {\n                console.log(\"breaking out. possible infinite loop\")\n                break\n            }\n            count++\n            const chunk = hist.splice(0, chunkSize)\n            console.log(\"sending\", chunk.length, chunk)\n            this.pubnub.publish({\n                channel: this.calculateChannelName(),\n                message: {\n                    type: 'SEND_HISTORY',\n                    host: graph.getHostId(),\n                    history: chunk\n                }\n            }, (status, response) => {\n                console.log(\"published\", status, response)\n            })\n        }\n\n    }\n\n    handleReceiveHistory(msg) {\n        // console.log(\"got some history\", msg.history.length)\n        msg.history.forEach(op => this.provider.getDataGraph().process(op))\n    }\n\n\n    handleMessage (evt) {\n        if (this.paused) return\n//        console.log(\"channel is\",evt.channel)\n        if(evt.channel === this.calculateLoggerChannelName()) {\n            if(evt.publisher !== this.pubnub.getUUID()) {\n                // console.log(\"REMOTE LOGGER\", evt.message);//.length, evt.message.substring(200))\n            }\n            return\n        }\n        const graph = this.provider.getDataGraph()\n        // console.log('PN_REMOTE',evt)\n        if (evt.message.type === 'GET_HISTORY') {\n            // console.log(\"got a history request\",evt.message.host, graph.getHostId())\n            if (evt.message.host !== graph.getHostId()) {\n                return this.handleGetHistory()\n            }\n            return\n        }\n        if (evt.message.type === 'SEND_HISTORY') {\n            if (evt.message.host !== graph.getHostId()) {\n                return this.handleReceiveHistory(evt.message)\n            }\n            return\n        }\n        const op = evt.message\n        if (!op.host) return console.log(\"received a message without a host\", op)\n        if (!op.timestamp) return console.error(\"received a message without a timestamp\", op)\n        if (op.host && op.host === graph.getHostId()) {\n            // console.log(\"SKIP: my own message came in. ignoring it\")\n            return\n        }\n        console.log(\"REMOTE\", op)\n        graph.process(op)\n    }\n\n    getLogger() {\n        return this.logger\n    }\n}\n\n\nexport class PubnubLogger {\n    constructor(docid, pubnub) {\n        this.count = 0\n        this.docid = docid\n        this.listeners = {}\n        if(!pubnub) {\n            this.pubnub = new PubNub(settings)\n        } else {\n            this.pubnub = pubnub\n        }\n        this.pubnub.addListener({\n            message: (m)=>{\n                if(m.publisher === this.pubnub.getUUID()) return\n                const msg = m.message\n                msg.remote = true\n                this.getListeners(msg.type).forEach(cb => cb(msg))\n            },\n        })\n        this.pubnub.subscribe({channels: [this.calculateLoggerChannelName()]})\n    }\n    addEventListener(type,cb) {\n        this.getListeners(type).push(cb)\n    }\n    calculateLoggerChannelName() {\n        return \"metadoc-log-\" + this.docid+\"_\"+AuthModule.getServerID()\n    }\n\n    log() {\n        this.fire('log',this.makePayload(Array.from(arguments)))\n    }\n    error () {\n        this.fire('error',this.makePayload(Array.from(arguments)))\n    }\n\n    getListeners(type) {\n        if(!this.listeners) this.listeners = {}\n        if(!this.listeners[type]) this.listeners[type] = []\n        return this.listeners[type]\n    }\n\n    fire(type, payload) {\n        payload.type = type\n        this.pubnub.publish({\n            channel: this.calculateLoggerChannelName(),\n            message: JSON.parse(prune(payload))\n        })\n        this.getListeners(type).forEach(cb => cb(payload))\n    }\n    makePayload(arr) {\n        return {\n            data: arr,\n            count: this.count++,\n        }\n    }\n}\n\nexport class ConsoleLogger {\n    constructor() {\n        this.listeners = {}\n        this.count = 0\n    }\n\n    addEventListener(type, cb) {\n        this.getListeners(type).push(cb)\n    }\n\n    getListeners(type) {\n        if (!this.listeners) this.listeners = {}\n        if (!this.listeners[type]) this.listeners[type] = []\n        return this.listeners[type]\n    }\n\n    fire(type, payload) {\n        // console.log(`DUMMY LOGGER ${type} `, payload)\n        payload.type = type\n        this.getListeners(type).forEach(cb => cb(payload))\n    }\n\n    log() {\n        this.fire('log', this.makePayload(Array.from(arguments)))\n    }\n\n    error() {\n        this.fire('error', this.makePayload(Array.from(arguments)))\n    }\n\n    makePayload(arr) {\n        return {\n            data: arr,\n            count: this.count++,\n        }\n    }\n}","export function listToArray(list) {\n    return Array.prototype.slice.call(list)\n}\nexport function createGraphObjectFromObject(graph, json) {\n    return graph.createObject(json)\n}\n\nexport function fetchGraphObject(graph, objid) {\n    const obj = {}\n    graph.getPropertiesForObject(objid).forEach(key => {\n        obj[key] = graph.getPropertyValue(objid, key)\n    })\n    obj.id = objid\n    return obj\n}\n\nexport function propToArray(doc, CH) {\n    const len = doc.getArrayLength(CH)\n    const ch = []\n    for (let i = 0; i < len; i++) {\n        ch.push(doc.getElementAt(CH, i))\n    }\n    return ch\n}\n\nexport function indexOf(graph, array, target) {\n    const arr = propToArray(graph,array)\n    return arr.findIndex(e => e === target)\n}\n\nexport function insertAsFirstChild(graph, parent, child) {\n    graph.setProperty(child.id,'parent',parent.id)\n    const ch = graph.getPropertyValue(parent.id,'children')\n    graph.insertAfter(ch,null,child.id)\n}\n\nexport function insertAsLastChild(graph, parent, child) {\n    graph.setProperty(child.id,'parent',parent.id)\n    const ch = graph.getPropertyValue(parent.id,'children')\n    const len = graph.getArrayLength(ch)\n    const prev = graph.getElementAt(ch,len-1)\n    graph.insertAfter(ch,prev,child.id)\n}\n\nexport function removeFromParent(graph, obj) {\n    const parent = fetchGraphObject(graph, obj.parent)\n    const n = indexOf(graph, parent.children, obj.id)\n    if (n >= 0) {\n        graph.removeElement(parent.children, n)\n    } else {\n        console.error(\"could not find index for child\", obj, 'in children', parent.children)\n    }\n}\n\n\nexport function cloneShape(graph,shape) {\n    const id = shape.id\n    const id2 = graph.createObject()\n    const props = graph.getPropertiesForObject(id)\n    props.forEach(key => {\n        graph.createProperty(id2,key,graph.getPropertyValue(id,key))\n    })\n    const shape2 = fetchGraphObject(graph,id2)\n    return shape2\n}\n","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {Dialog} from 'react-visual-editor-framework'\n\nexport class MissingDocDialog extends Component {\n\n    cancel = () => {\n        DialogManager.hide()\n    }\n\n    okay = () => {\n        DialogManager.hide()\n        this.props.provider.createNewDocument(this.props.docid)\n    }\n\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n                <header>Document \"<b>{this.props.docid}</b>\" not found</header>\n                <section>\n                    Create a new document?\n                </section>\n                <footer>\n                    <button onClick={this.cancel}>cancel</button>\n                    <button onClick={this.okay}>okay</button>\n                </footer>\n        </Dialog>\n    }\n\n}","import {UndoQueue} from './UndoQueue'\nimport {EventCoalescer} from '../metadoc/EventCoalescer'\nimport {\n    SelectionManager,\n    TreeItemProvider,\n    getDocsURL,\n    TREE_ITEM_PROVIDER,\n    setQuery,\n    toQueryString,\n} from 'react-visual-editor-framework'\nimport {PubnubSyncWrapper} from './PubnubSyncWrapper'\nimport {propToArray} from \"./utils\";\nimport * as ToasterMananager from '../vr/ToasterManager'\nimport {DialogManager} from 'appy-comps'\nimport {MissingDocDialog} from './MissingDocDialog'\nimport React from 'react'\nimport {AuthModule} from '../vr/AuthModule'\n\nconst {DocGraph, CommandGenerator, toDocGraphFromObjectGraph, toObjectGraphFromDocGraph} = require(\"syncing_protocol\");\n\n\n\nexport default class SyncGraphProvider extends TreeItemProvider {\n    constructor(options) {\n        super(options)\n        this.options = options || {}\n        this.mode = options.mode || 'edit'\n        this.datalisteners = []\n        this.rawlisteners = []\n        this.expanded = {}\n\n        if(options.doc) {\n            this.loadDoc(options.doc)\n        } else {\n            this.createNewDocument()\n        }\n    }\n    getDocTitle = () => \"untitled\"\n    getDocHistory = () => this.getDataGraph().getHistory()\n    getDocGraph = () => {\n        const root = this.getDataGraph().getObjectByProperty('type','root')\n        return toObjectGraphFromDocGraph(this.getDataGraph(),root)\n    }\n    onRawChange = cb => this.rawlisteners.push(cb)\n    getRawGraph = () => this.coalescer\n    getDataGraph = () => this.syncdoc\n    getSceneRoot = () => this.getDataGraph().getObjectByProperty('type','root')\n    hasChildren = (item) => item && this.getDataGraph().hasPropertyValue(item,'children')\n    getChildren = (item) => {\n        const doc = this.getDataGraph()\n        return propToArray(doc,doc.getPropertyValue(item,'children'))\n    }\n    isExpanded = (item) => {\n        if (typeof this.expanded[item] === 'undefined') this.expanded[item] = true;\n        return this.expanded[item]\n    }\n    toggleItemCollapsed(item) {\n        const current = this.isExpanded(item);\n        this.expanded[item] = !current;\n        this.fire(TREE_ITEM_PROVIDER.EXPANDED_CHANGED,item);\n    }\n\n    setPropertyValue(item, def, value) {\n        const op = this.cmd.setProperty(item,def.key,value)\n        op.prevValue = def.value\n        this.getRawGraph().process(op)\n        this.fire(TREE_ITEM_PROVIDER.PROPERTY_CHANGED,{\n            provider: this,\n            child:item,\n            propKey:def.key,\n            oldValue:def.value,\n            newValue:value\n        })\n    }\n\n    save = (e) => {\n        if(e) e.preventDefault()\n        const payload_obj = {\n            history:this.getDocHistory(),\n            type:this.getDocType(),\n            id:this.getDocId(),\n            graph:this.getDocGraph(),\n            title:this.getDocTitle(),\n        }\n        const payload_string = JSON.stringify(payload_obj)\n        ToasterMananager.add('saving')\n        const opts = {\n            type:this.getDocType(),\n            title:this.getDocTitle(),\n        }\n        const url = getDocsURL()+this.getDocId()+'?'+toQueryString(opts)\n        console.log(`saving ${payload_string.length} chars to ${url}`, payload_obj)\n        return AuthModule.fetch(url,{\n            method:'POST',\n            body:payload_string,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            },\n        })\n            .then(res=>res.json())\n            .then(res => {\n                console.log(\"got back result\",res)\n                setQuery({mode:this.mode,doc:this.getDocId(), doctype:this.getDocType()})\n                ToasterMananager.add(res.message)\n                this.fire(TREE_ITEM_PROVIDER.SAVED,true)\n            }).catch((e)=> console.log(\"error\",e))\n    }\n\n    loadDoc(docid) {\n        return AuthModule.getJSON(getDocsURL()+docid)\n            .then((payload)=>{\n                console.log(\"got the payload\",payload)\n                if(!payload.id) return this.showMissingDocDialog(docid)\n                const doc = this.makeDocFromServerHistory(payload.history)\n                return this.setupDocFlow(doc,docid)\n            })\n            .catch((e)=> {\n                console.error(\"there was an error loading doc\", docid, e)\n                console.log(\"trying to load again without the history\")\n                return AuthModule.getJSON(getDocsURL() + docid)\n                    .then((payload) => {\n                        console.log(\"got the payload\", payload)\n                        const doc = this.makeDocFromServerGraph(payload.graph)\n                        return this.setupDocFlow(doc, docid)\n                    })\n            }).catch((e) => {\n                console.error(\"there was an error loading doc\", docid, e)\n                const doc = new DocGraph()\n                this.makeEmptyRoot(doc)\n                this.setupDocFlow(doc,this.genID('doc'))\n            })\n    }\n\n    createNewDocument(docid) {\n        if(!docid) docid = this.genID(\"doc\")\n        const doc = new DocGraph()\n        this.makeEmptyRoot(doc)\n        this.setupDocFlow(doc,docid)\n    }\n\n    setupDocFlow(doc,docid) {\n        //shut down old network connection\n        if(this.pubnub) this.pubnub.shutdown()\n        this.pubnub = null\n\n        this.syncdoc = doc\n        this.cmd = new CommandGenerator(this.syncdoc)\n        this.root = this.getSceneRoot()\n        this.docid = docid\n        this.undoqueue = new UndoQueue(doc)\n        this.coalescer = new EventCoalescer(this.syncdoc) //sends calls on to sync doc, and fires change event\n        this.coalescer.onChange((op) => this.undoqueue.submit(op))\n\n        this.coalescer.onRawChange(op =>this.rawlisteners.forEach(cb => cb(op)))\n        this.syncdoc.onChange(op => this.rawlisteners.forEach(cb => cb(op)))\n        this.syncdoc.onChange((op)=>{\n            this.fire(TREE_ITEM_PROVIDER.STRUCTURE_CHANGED, { provider:this });\n            this.fire(TREE_ITEM_PROVIDER.PROPERTY_CHANGED, { provider:this });\n        })\n        this.fire(TREE_ITEM_PROVIDER.STRUCTURE_CHANGED, { provider:this });\n        this.fire(TREE_ITEM_PROVIDER.CLEAR_DIRTY,true)\n        SelectionManager.clearSelection()\n        this.pubnub = new PubnubSyncWrapper(this,this.syncdoc)\n        this.pubnub.unpause()\n        this.pubnub.start()\n        return this.docLoaded().then(()=>{\n            this.fire(TREE_ITEM_PROVIDER.DOCUMENT_SWAPPED,{provider:this})\n            setQuery({mode:this.mode,doc:this.getDocId(), doctype:this.getDocType()})\n            this.connected = true\n            this.fire(\"CONNECTED\",this.connected)\n        })\n    }\n\n    reloadDocument() {\n        return AuthModule.getJSON(getDocsURL()+this.docid).then((payload)=>{\n            if(payload.type !== this.getDocType()) throw new Error(\"incorrect doctype for this provider\",payload.type)\n            const doc = this.makeDocFromServerHistory(payload.history)\n            this.setupDocFlow(doc,this.docid)\n        }).catch((e)=>{\n            console.error(\"couldn't reload the doc\",e)\n            const doc = new DocGraph()\n            this.makeEmptyRoot(doc)\n            this.setupDocFlow(doc,this.genID('doc'))\n        })\n\n    }\n\n    duplicateDocument(title) {\n        const newDocId = this.genID(\"doc\")\n        this.save().then(()=> {\n            this.docid = newDocId\n            this.setDocTitle(title)\n            const graph = this.getDocGraph()\n            const new_doc = new DocGraph()\n            toDocGraphFromObjectGraph(graph,new_doc)\n            this.syncdoc = new_doc\n            return this.save()\n        }).then(()=>{\n            ToasterMananager.add('duplicating doc')\n            return this.loadDoc(newDocId)\n        })\n    }\n\n    docLoaded = () => {\n        return Promise.resolve()\n    }\n\n    toggleConnected = () => {\n        this.connected = !this.connected\n        if(this.pubnub) {\n            if(this.connected) {\n                this.pubnub.unpause()\n            } else {\n                this.pubnub.pause()\n            }\n        }\n        this.fire(\"CONNECTED\",this.connected)\n    }\n\n    isConnected = () => this.connected\n\n    pauseQueue = () => this.coalescer.pause()\n    unpauseQueue = () => this.coalescer.unpause()\n\n    performUndo = (e) => {\n        if(e && e.preventDefault) e.preventDefault()\n\n        if(this.undoqueue.canUndo()) {\n            this.undoqueue.undo()\n        } else {\n            console.warn(\"at beginnning of the undo queue\")\n        }\n    }\n    performRedo = (e) => {\n        if(e && e.preventDefault) e.preventDefault()\n        if(this.undoqueue.canRedo()) this.undoqueue.redo()\n    }\n\n    makeDocFromServerHistory(history) {\n        const doc = new DocGraph()\n        history.forEach(op => doc.process(op))\n        return doc\n    }\n\n\n    showMissingDocDialog(docid) {\n        DialogManager.show(<MissingDocDialog docid={docid} provider={this}/>)\n    }\n\n    makeDocFromServerGraph(graph) {\n        console.log(\"Making Doc from Server Graph\",graph)\n        const doc = new DocGraph()\n        toDocGraphFromObjectGraph(graph,doc)\n        return doc\n    }\n}\n","/* eslint-disable */\nconst THREE = require('three');//requireimport * as THREE from 'three'\n\n/**\n * @author arodic / https://github.com/arodic\n */\n\nconst TransformControls = function ( camera, domElement ) {\n\n    THREE.Object3D.call( this );\n\n    domElement = ( domElement !== undefined ) ? domElement : document;\n\n    this.visible = false;\n\n    var _gizmo = new TransformControlsGizmo();\n    this.add( _gizmo );\n\n    var _plane = new TransformControlsPlane();\n    this.add( _plane );\n\n    var scope = this;\n\n    // Define properties with getters/setter\n    // Setting the defined property will automatically trigger change event\n    // Defined properties are passed down to gizmo and plane\n\n    defineProperty( \"camera\", camera );\n    defineProperty( \"object\", undefined );\n    defineProperty( \"enabled\", true );\n    defineProperty( \"axis\", null );\n    defineProperty( \"mode\", \"translate\" );\n    defineProperty( \"translationSnap\", null );\n    defineProperty( \"rotationSnap\", null );\n    defineProperty( \"space\", \"world\" );\n    defineProperty( \"size\", 1 );\n    defineProperty( \"dragging\", false );\n    defineProperty( \"showX\", true );\n    defineProperty( \"showY\", true );\n    defineProperty( \"showZ\", true );\n\n    var changeEvent = { type: \"change\" };\n    var mouseDownEvent = { type: \"mouseDown\" };\n    var mouseUpEvent = { type: \"mouseUp\", mode: scope.mode };\n    var objectChangeEvent = { type: \"objectChange\" };\n\n    // Reusable utility variables\n\n    var ray = new THREE.Raycaster();\n\n    var _tempVector = new THREE.Vector3();\n    var _tempVector2 = new THREE.Vector3();\n    var _tempQuaternion = new THREE.Quaternion();\n    var _unit = {\n        X: new THREE.Vector3( 1, 0, 0 ),\n        Y: new THREE.Vector3( 0, 1, 0 ),\n        Z: new THREE.Vector3( 0, 0, 1 )\n    };\n    var _identityQuaternion = new THREE.Quaternion();\n    var _alignVector = new THREE.Vector3();\n\n    var pointStart = new THREE.Vector3();\n    var pointEnd = new THREE.Vector3();\n    var rotationAxis = new THREE.Vector3();\n    var rotationAngle = 0;\n\n    var cameraPosition = new THREE.Vector3();\n    var cameraQuaternion = new THREE.Quaternion();\n    var cameraScale = new THREE.Vector3();\n\n    var parentPosition = new THREE.Vector3();\n    var parentQuaternion = new THREE.Quaternion();\n    var parentScale = new THREE.Vector3();\n\n    var worldPositionStart = new THREE.Vector3();\n    var worldQuaternionStart = new THREE.Quaternion();\n    var worldScaleStart = new THREE.Vector3();\n\n    var worldPosition = new THREE.Vector3();\n    var worldQuaternion = new THREE.Quaternion();\n    var worldScale = new THREE.Vector3();\n\n    var eye = new THREE.Vector3();\n\n    var _positionStart = new THREE.Vector3();\n    var _quaternionStart = new THREE.Quaternion();\n    var _scaleStart = new THREE.Vector3();\n\n    // TODO: remove properties unused in plane and gizmo\n\n    defineProperty( \"parentQuaternion\", parentQuaternion );\n    defineProperty( \"worldPosition\", worldPosition );\n    defineProperty( \"worldPositionStart\", worldPositionStart );\n    defineProperty( \"worldQuaternion\", worldQuaternion );\n    defineProperty( \"worldQuaternionStart\", worldQuaternionStart );\n    defineProperty( \"cameraPosition\", cameraPosition );\n    defineProperty( \"cameraQuaternion\", cameraQuaternion );\n    defineProperty( \"pointStart\", pointStart );\n    defineProperty( \"pointEnd\", pointEnd );\n    defineProperty( \"rotationAxis\", rotationAxis );\n    defineProperty( \"rotationAngle\", rotationAngle );\n    defineProperty( \"eye\", eye );\n\n\n\n        domElement.addEventListener( \"mousedown\", onPointerDown, false );\n        domElement.addEventListener( \"touchstart\", onPointerDown, false );\n        domElement.addEventListener( \"mousemove\", onPointerHover, false );\n        domElement.addEventListener( \"touchmove\", onPointerHover, false );\n        domElement.addEventListener( \"touchmove\", onPointerMove, false );\n        document.addEventListener( \"mouseup\", onPointerUp, false );\n        domElement.addEventListener( \"touchend\", onPointerUp, false );\n        domElement.addEventListener( \"touchcancel\", onPointerUp, false );\n        domElement.addEventListener( \"touchleave\", onPointerUp, false );\n        domElement.addEventListener( \"contextmenu\", onContext, false );\n\n\n\n    this.dispose = function () {\n\n        domElement.removeEventListener( \"mousedown\", onPointerDown );\n        domElement.removeEventListener( \"touchstart\", onPointerDown );\n        domElement.removeEventListener( \"mousemove\", onPointerHover );\n        domElement.removeEventListener( \"touchmove\", onPointerHover );\n        domElement.removeEventListener( \"touchmove\", onPointerMove );\n        document.removeEventListener( \"mouseup\", onPointerUp );\n        domElement.removeEventListener( \"touchend\", onPointerUp );\n        domElement.removeEventListener( \"touchcancel\", onPointerUp );\n        domElement.removeEventListener( \"touchleave\", onPointerUp );\n        domElement.removeEventListener( \"contextmenu\", onContext );\n\n    };\n\n    // Set current object\n    this.attach = function ( object ) {\n\n        this.object = object;\n        this.visible = true;\n\n    };\n\n    // Detatch from object\n    this.detach = function () {\n\n        this.object = undefined;\n        this.visible = false;\n        this.axis = null;\n\n    };\n\n    // Defined getter, setter and store for a property\n    function defineProperty( propName, defaultValue ) {\n\n        var propValue = defaultValue;\n\n        Object.defineProperty( scope, propName, {\n\n            get: function() {\n\n                return propValue !== undefined ? propValue : defaultValue;\n\n            },\n\n            set: function( value ) {\n\n                if ( propValue !== value ) {\n\n                    propValue = value;\n                    _plane[ propName ] = value;\n                    _gizmo[ propName ] = value;\n\n                    scope.dispatchEvent( { type: propName + \"-changed\", value: value } );\n                    scope.dispatchEvent( changeEvent );\n\n                }\n\n            }\n\n        });\n\n        scope[ propName ] = defaultValue;\n        _plane[ propName ] = defaultValue;\n        _gizmo[ propName ] = defaultValue;\n\n    }\n\n    // updateMatrixWorld  updates key transformation variables\n    this.updateMatrixWorld = function () {\n\n        if ( this.object !== undefined ) {\n\n            this.object.updateMatrixWorld();\n            this.object.parent.matrixWorld.decompose( parentPosition, parentQuaternion, parentScale );\n            this.object.matrixWorld.decompose( worldPosition, worldQuaternion, worldScale );\n\n        }\n\n        this.camera.updateMatrixWorld();\n        this.camera.matrixWorld.decompose( cameraPosition, cameraQuaternion, cameraScale );\n\n        if ( this.camera instanceof THREE.PerspectiveCamera ) {\n\n            eye.copy( cameraPosition ).sub( worldPosition ).normalize();\n\n        } else if ( this.camera instanceof THREE.OrthographicCamera ) {\n\n            eye.copy( cameraPosition ).normalize();\n\n        }\n\n        THREE.Object3D.prototype.updateMatrixWorld.call( this );\n\n    };\n\n    this.pointerHover = function( pointer ) {\n\n        if ( this.object === undefined || this.dragging === true || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;\n\n        ray.setFromCamera( pointer, this.camera );\n\n        var intersect = ray.intersectObjects( _gizmo.picker[ this.mode ].children, true )[ 0 ] || false;\n\n        if ( intersect ) {\n\n            this.axis = intersect.object.name;\n\n        } else {\n\n            this.axis = null;\n\n        }\n\n    };\n\n    this.pointerDown = function( pointer ) {\n\n        if ( this.object === undefined || this.dragging === true || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;\n\n        if ( ( pointer.button === 0 || pointer.button === undefined ) && this.axis !== null ) {\n\n            ray.setFromCamera( pointer, this.camera );\n\n            var planeIntersect = ray.intersectObjects( [ _plane ], true )[ 0 ] || false;\n\n            if ( planeIntersect ) {\n\n                var space = this.space;\n\n                if ( this.mode === 'scale') {\n\n                    space = 'local';\n\n                } else if ( this.axis === 'E' ||  this.axis === 'XYZE' ||  this.axis === 'XYZ' ) {\n\n                    space = 'world';\n\n                }\n\n                if ( space === 'local' && this.mode === 'rotate' ) {\n\n                    var snap = this.rotationSnap;\n\n                    if ( this.axis === 'X' && snap ) this.object.rotation.x = Math.round( this.object.rotation.x / snap ) * snap;\n                    if ( this.axis === 'Y' && snap ) this.object.rotation.y = Math.round( this.object.rotation.y / snap ) * snap;\n                    if ( this.axis === 'Z' && snap ) this.object.rotation.z = Math.round( this.object.rotation.z / snap ) * snap;\n\n                }\n\n                this.object.updateMatrixWorld();\n                this.object.parent.updateMatrixWorld();\n\n                _positionStart.copy( this.object.position );\n                _quaternionStart.copy( this.object.quaternion );\n                _scaleStart.copy( this.object.scale );\n\n                this.object.matrixWorld.decompose( worldPositionStart, worldQuaternionStart, worldScaleStart );\n\n                pointStart.copy( planeIntersect.point ).sub( worldPositionStart );\n\n                if ( space === 'local' ) pointStart.applyQuaternion( worldQuaternionStart.clone().inverse() );\n\n            }\n\n            this.dragging = true;\n            mouseDownEvent.mode = this.mode;\n            this.dispatchEvent( mouseDownEvent );\n\n        }\n\n    };\n\n    this.pointerMove = function( pointer ) {\n\n        var axis = this.axis;\n        var mode = this.mode;\n        var object = this.object;\n        var space = this.space;\n\n        if ( mode === 'scale') {\n\n            space = 'local';\n\n        } else if ( axis === 'E' ||  axis === 'XYZE' ||  axis === 'XYZ' ) {\n\n            space = 'world';\n\n        }\n\n        if ( object === undefined || axis === null || this.dragging === false || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;\n\n        ray.setFromCamera( pointer, this.camera );\n\n        var planeIntersect = ray.intersectObjects( [ _plane ], true )[ 0 ] || false;\n\n        if ( planeIntersect === false ) return;\n\n        pointEnd.copy( planeIntersect.point ).sub( worldPositionStart );\n\n        if ( space === 'local' ) pointEnd.applyQuaternion( worldQuaternionStart.clone().inverse() );\n\n        if ( mode === 'translate' ) {\n\n            if ( axis.search( 'X' ) === -1 ) {\n                pointEnd.x = pointStart.x;\n            }\n            if ( axis.search( 'Y' ) === -1 ) {\n                pointEnd.y = pointStart.y;\n            }\n            if ( axis.search( 'Z' ) === -1 ) {\n                pointEnd.z = pointStart.z;\n            }\n\n            // Apply translate\n\n            if ( space === 'local' ) {\n                object.position.copy( pointEnd ).sub( pointStart ).applyQuaternion( _quaternionStart );\n            } else {\n                object.position.copy( pointEnd ).sub( pointStart );\n            }\n\n            object.position.add( _positionStart );\n\n            // Apply translation snap\n\n            if ( this.translationSnap ) {\n\n                if ( space === 'local' ) {\n\n                    object.position.applyQuaternion(_tempQuaternion.copy( _quaternionStart ).inverse() );\n\n                    if ( axis.search( 'X' ) !== -1 ) {\n                        object.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\n                    }\n\n                    if ( axis.search( 'Y' ) !== -1 ) {\n                        object.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\n                    }\n\n                    if ( axis.search( 'Z' ) !== -1 ) {\n                        object.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\n                    }\n\n                    object.position.applyQuaternion( _quaternionStart );\n\n                }\n\n                if ( space === 'world' ) {\n\n                    if ( object.parent ) {\n                        object.position.add( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\n                    }\n\n                    if ( axis.search( 'X' ) !== -1 ) {\n                        object.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\n                    }\n\n                    if ( axis.search( 'Y' ) !== -1 ) {\n                        object.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\n                    }\n\n                    if ( axis.search( 'Z' ) !== -1 ) {\n                        object.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\n                    }\n\n                    if ( object.parent ) {\n                        object.position.sub( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\n                    }\n\n                }\n\n            }\n\n        } else if ( mode === 'scale' ) {\n\n            if ( axis.search( 'XYZ' ) !== -1 ) {\n\n                var d = pointEnd.length() / pointStart.length();\n\n                if ( pointEnd.dot( pointStart ) < 0 ) d *= -1;\n\n                _tempVector.set( d, d, d );\n\n            } else {\n\n                _tempVector.copy( pointEnd ).divide( pointStart );\n\n                if ( axis.search( 'X' ) === -1 ) {\n                    _tempVector.x = 1;\n                }\n                if ( axis.search( 'Y' ) === -1 ) {\n                    _tempVector.y = 1;\n                }\n                if ( axis.search( 'Z' ) === -1 ) {\n                    _tempVector.z = 1;\n                }\n\n            }\n\n            // Apply scale\n\n            object.scale.copy( _scaleStart ).multiply( _tempVector );\n\n        } else if ( mode === 'rotate' ) {\n\n            var ROTATION_SPEED = 20 / worldPosition.distanceTo( _tempVector.setFromMatrixPosition( this.camera.matrixWorld ) );\n\n            var quaternion = this.space === \"local\" ? worldQuaternion : _identityQuaternion;\n\n            var unit = _unit[ axis ];\n\n            if ( axis === 'E' ) {\n\n                _tempVector.copy( pointEnd ).cross( pointStart );\n                rotationAxis.copy( eye );\n                rotationAngle = pointEnd.angleTo( pointStart ) * ( _tempVector.dot( eye ) < 0 ? 1 : -1 );\n\n            } else if ( axis === 'XYZE' ) {\n\n                _tempVector.copy( pointEnd ).sub( pointStart ).cross( eye ).normalize();\n                rotationAxis.copy( _tempVector );\n                rotationAngle = pointEnd.sub( pointStart ).dot( _tempVector.cross( eye ) ) * ROTATION_SPEED;\n\n            } else if ( axis === 'X' || axis === 'Y' || axis === 'Z' ) {\n\n                _alignVector.copy( unit ).applyQuaternion( quaternion );\n\n                rotationAxis.copy( unit );\n\n                _tempVector = unit.clone();\n                _tempVector2 = pointEnd.clone().sub( pointStart );\n                if ( space === 'local' ) {\n                    _tempVector.applyQuaternion( quaternion );\n                    _tempVector2.applyQuaternion( worldQuaternionStart );\n                }\n                rotationAngle = _tempVector2.dot( _tempVector.cross( eye ).normalize() ) * ROTATION_SPEED;\n\n            }\n\n            // Apply rotation snap\n\n            if ( this.rotationSnap ) rotationAngle = Math.round( rotationAngle / this.rotationSnap ) * this.rotationSnap;\n\n            this.rotationAngle = rotationAngle;\n\n            // Apply rotate\n\n            if ( space === 'local' ) {\n\n                object.quaternion.copy( _quaternionStart );\n                object.quaternion.multiply( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) );\n\n            } else {\n\n                object.quaternion.copy( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) );\n                object.quaternion.multiply( _quaternionStart );\n\n            }\n\n        }\n\n        this.dispatchEvent( changeEvent );\n        this.dispatchEvent( objectChangeEvent );\n\n    };\n\n    this.pointerUp = function( pointer ) {\n\n        if ( pointer.button !== undefined && pointer.button !== 0 ) return;\n\n        if ( this.dragging && ( this.axis !== null ) ) {\n\n            mouseUpEvent.mode = this.mode;\n            this.dispatchEvent( mouseUpEvent );\n\n        }\n\n        this.dragging = false;\n\n        if ( pointer.button === undefined ) this.axis = null;\n\n    };\n\n    // normalize mouse / touch pointer and remap {x,y} to view space.\n\n    function getPointer( event ) {\n\n        var pointer = event.changedTouches ? event.changedTouches[ 0 ] : event;\n\n        var rect = domElement.getBoundingClientRect();\n\n        return {\n            x: ( pointer.clientX - rect.left ) / rect.width * 2 - 1,\n            y: - ( pointer.clientY - rect.top ) / rect.height * 2 + 1,\n            button: event.button\n        };\n\n    }\n\n    // mouse / touch event handlers\n\n    function onContext( event ) {\n\n        event.preventDefault();\n\n    }\n\n    function onPointerHover( event ) {\n\n        if ( !scope.enabled ) return;\n\n        scope.pointerHover( getPointer( event ) );\n\n    }\n\n    function onPointerDown( event ) {\n\n        if ( !scope.enabled ) return;\n\n        event.preventDefault();\n\n        document.addEventListener( \"mousemove\", onPointerMove, false );\n\n        scope.pointerHover( getPointer( event ) );\n        scope.pointerDown( getPointer( event ) );\n\n    }\n\n    function onPointerMove( event ) {\n\n        if ( !scope.enabled ) return;\n\n        event.preventDefault();\n\n        scope.pointerMove( getPointer( event ) );\n\n    }\n\n    function onPointerUp( event ) {\n\n        if ( !scope.enabled ) return;\n\n        event.preventDefault(); // Prevent MouseEvent on mobile\n\n        document.removeEventListener( \"mousemove\", onPointerMove, false );\n\n        scope.pointerUp( getPointer( event ) );\n\n    }\n\n    // TODO: depricate\n\n    this.getMode = function () {\n\n        return scope.mode;\n\n    };\n\n    this.setMode = function ( mode ) {\n\n        scope.mode = mode;\n\n    };\n\n    this.setTranslationSnap = function ( translationSnap ) {\n\n        scope.translationSnap = translationSnap;\n\n    };\n\n    this.setRotationSnap = function ( rotationSnap ) {\n\n        scope.rotationSnap = rotationSnap;\n\n    };\n\n    this.setSize = function ( size ) {\n\n        scope.size = size;\n\n    };\n\n    this.setSpace = function ( space ) {\n\n        scope.space = space;\n\n    };\n\n    this.update = function () {\n\n        console.warn( 'TransformControls: update function has been depricated.' );\n\n    };\n\n};\n\nTransformControls.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\n\n    constructor: TransformControls,\n\n    isTransformControls: true\n\n} );\n\n\nconst TransformControlsGizmo = function () {\n\n\n    THREE.Object3D.call( this );\n\n    this.type = 'TransformControlsGizmo';\n\n    // shared materials\n\n    var gizmoMaterial = new THREE.MeshBasicMaterial({\n        depthTest: false,\n        depthWrite: false,\n        transparent: true,\n        side: THREE.DoubleSide,\n        fog: false\n    });\n\n    var gizmoLineMaterial = new THREE.LineBasicMaterial({\n        depthTest: false,\n        depthWrite: false,\n        transparent: true,\n        linewidth: 1,\n        fog: false\n    });\n\n    // Make unique material for each axis/color\n\n    var matInvisible = gizmoMaterial.clone();\n    matInvisible.opacity = 0.15;\n\n    var matHelper = gizmoMaterial.clone();\n    matHelper.opacity = 0.33;\n\n    var matRed = gizmoMaterial.clone();\n    matRed.color.set( 0xff0000 );\n\n    var matGreen = gizmoMaterial.clone();\n    matGreen.color.set( 0x00ff00 );\n\n    var matBlue = gizmoMaterial.clone();\n    matBlue.color.set( 0x0000ff );\n\n    var matWhiteTransperent = gizmoMaterial.clone();\n    matWhiteTransperent.opacity = 0.25;\n\n    var matYellowTransparent = matWhiteTransperent.clone();\n    matYellowTransparent.color.set( 0xffff00 );\n\n    var matCyanTransparent = matWhiteTransperent.clone();\n    matCyanTransparent.color.set( 0x00ffff );\n\n    var matMagentaTransparent = matWhiteTransperent.clone();\n    matMagentaTransparent.color.set( 0xff00ff );\n\n    var matYellow = gizmoMaterial.clone();\n    matYellow.color.set( 0xffff00 );\n\n    var matLineRed = gizmoLineMaterial.clone();\n    matLineRed.color.set( 0xff0000 );\n\n    var matLineGreen = gizmoLineMaterial.clone();\n    matLineGreen.color.set( 0x00ff00 );\n\n    var matLineBlue = gizmoLineMaterial.clone();\n    matLineBlue.color.set( 0x0000ff );\n\n    var matLineCyan = gizmoLineMaterial.clone();\n    matLineCyan.color.set( 0x00ffff );\n\n    var matLineMagenta = gizmoLineMaterial.clone();\n    matLineMagenta.color.set( 0xff00ff );\n\n    var matLineYellow = gizmoLineMaterial.clone();\n    matLineYellow.color.set( 0xffff00 );\n\n    var matLineGray = gizmoLineMaterial.clone();\n    matLineGray.color.set( 0x787878);\n\n    var matLineYellowTransparent = matLineYellow.clone();\n    matLineYellowTransparent.opacity = 0.25;\n\n    // reusable geometry\n\n    var arrowGeometry = new THREE.CylinderBufferGeometry( 0, 0.05, 0.2, 12, 1, false);\n\n    var scaleHandleGeometry = new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125);\n\n    var lineGeometry = new THREE.BufferGeometry( );\n    lineGeometry.addAttribute('position', new THREE.Float32BufferAttribute( [ 0, 0, 0,\t1, 0, 0 ], 3 ) );\n\n    var CircleGeometry = function( radius, arc ) {\n\n        var geometry = new THREE.BufferGeometry( );\n        var vertices = [];\n\n        for ( var i = 0; i <= 64 * arc; ++i ) {\n\n            vertices.push( 0, Math.cos( i / 32 * Math.PI ) * radius, Math.sin( i / 32 * Math.PI ) * radius );\n\n        }\n\n        geometry.addAttribute('position', new THREE.Float32BufferAttribute( vertices, 3 ) );\n\n        return geometry;\n\n    };\n\n    // Special geometry for transform helper. If scaled with position vector it spans from [0,0,0] to position\n\n    var TranslateHelperGeometry = function( radius, arc ) {\n\n        var geometry = new THREE.BufferGeometry()\n\n        geometry.addAttribute('position', new THREE.Float32BufferAttribute( [ 0, 0, 0, 1, 1, 1 ], 3 ) );\n\n        return geometry;\n\n    };\n\n    // Gizmo definitions - custom hierarchy definitions for setupGizmo() function\n\n    var gizmoTranslate = {\n        X: [\n            [ new THREE.Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, -Math.PI / 2 ], null, 'fwd' ],\n            [ new THREE.Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, Math.PI / 2 ], null, 'bwd' ],\n            [ new THREE.Line( lineGeometry, matLineRed ) ]\n        ],\n        Y: [\n            [ new THREE.Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], null, null, 'fwd' ],\n            [ new THREE.Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], [ Math.PI, 0, 0 ], null, 'bwd' ],\n            [ new THREE.Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ] ]\n        ],\n        Z: [\n            [ new THREE.Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ Math.PI / 2, 0, 0 ], null, 'fwd' ],\n            [ new THREE.Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ -Math.PI / 2, 0, 0 ], null, 'bwd' ],\n            [ new THREE.Line( lineGeometry, matLineBlue ), null, [ 0, -Math.PI / 2, 0 ] ]\n        ],\n        XYZ: [\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.1, 0 ), matWhiteTransperent ), [ 0, 0, 0 ], [ 0, 0, 0 ] ]\n        ],\n        XY: [\n            [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.295, 0.295 ), matYellowTransparent ), [ 0.15, 0.15, 0 ] ],\n            [ new THREE.Line( lineGeometry, matLineYellow ), [ 0.18, 0.3, 0 ], null, [ 0.125, 1, 1 ] ],\n            [ new THREE.Line( lineGeometry, matLineYellow ), [ 0.3, 0.18, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ]\n        ],\n        YZ: [\n            [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.295, 0.295 ), matCyanTransparent ), [ 0, 0.15, 0.15 ], [ 0, Math.PI / 2, 0 ] ],\n            [ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.18, 0.3 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ],\n            [ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.3, 0.18 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]\n        ],\n        XZ: [\n            [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.295, 0.295 ), matMagentaTransparent ), [ 0.15, 0, 0.15 ], [ -Math.PI / 2, 0, 0 ] ],\n            [ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.18, 0, 0.3 ], null, [ 0.125, 1, 1 ] ],\n            [ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.3, 0, 0.18 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]\n        ]\n    };\n\n    var pickerTranslate = {\n        X: [\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0.6, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ]\n        ],\n        Y: [\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0.6, 0 ] ]\n        ],\n        Z: [\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0, 0.6 ], [ Math.PI / 2, 0, 0 ] ]\n        ],\n        XYZ: [\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.2, 0 ), matInvisible ) ]\n        ],\n        XY: [\n            [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0.2, 0.2, 0 ] ]\n        ],\n        YZ: [\n            [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0, 0.2, 0.2 ], [ 0, Math.PI / 2, 0 ] ]\n        ],\n        XZ: [\n            [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0.2, 0, 0.2 ], [ -Math.PI / 2, 0, 0 ] ]\n        ]\n    };\n\n    var helperTranslate = {\n        START: [\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\n        ],\n        END: [\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\n        ],\n        DELTA: [\n            [ new THREE.Line( TranslateHelperGeometry(), matHelper ), null, null, null, 'helper' ]\n        ],\n        X: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ -1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n        ],\n        Y: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, -1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\n        ],\n        Z: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, 0, -1e3 ], [ 0, -Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\n        ]\n    };\n\n    var gizmoRotate = {\n        X: [\n            [ new THREE.Line( CircleGeometry( 1, 0.5 ), matLineRed ) ],\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.04, 0 ), matRed ), [ 0, 0, 0.99 ], null, [ 1, 3, 1 ] ],\n        ],\n        Y: [\n            [ new THREE.Line( CircleGeometry( 1, 0.5 ), matLineGreen ), null, [ 0, 0, -Math.PI / 2 ] ],\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.04, 0 ), matGreen ), [ 0, 0, 0.99 ], null, [ 3, 1, 1 ] ],\n        ],\n        Z: [\n            [ new THREE.Line( CircleGeometry( 1, 0.5 ), matLineBlue ), null, [ 0, Math.PI / 2, 0 ] ],\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.04, 0 ), matBlue ), [ 0.99, 0, 0 ], null, [ 1, 3, 1 ] ],\n        ],\n        E: [\n            [ new THREE.Line( CircleGeometry( 1.25, 1 ), matLineYellowTransparent ), null, [ 0, Math.PI / 2, 0 ] ],\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 1.17, 0, 0 ], [ 0, 0, -Math.PI / 2 ], [ 1, 1, 0.001 ]],\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ -1.17, 0, 0 ], [ 0, 0, Math.PI / 2 ], [ 1, 1, 0.001 ]],\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, -1.17, 0 ], [ Math.PI, 0, 0 ], [ 1, 1, 0.001 ]],\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, 1.17, 0 ], [ 0, 0, 0 ], [ 1, 1, 0.001 ]],\n        ],\n        XYZE: [\n            [ new THREE.Line( CircleGeometry( 1, 1 ), matLineGray ), null, [ 0, Math.PI / 2, 0 ] ]\n        ]\n    };\n\n    var helperRotate = {\n        AXIS: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ -1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n        ]\n    };\n\n    var pickerRotate = {\n        X: [\n            [ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, -Math.PI / 2, -Math.PI / 2 ] ],\n        ],\n        Y: [\n            [ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ Math.PI / 2, 0, 0 ] ],\n        ],\n        Z: [\n            [ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ],\n        ],\n        E: [\n            [ new THREE.Mesh( new THREE.TorusBufferGeometry( 1.25, 0.1, 2, 24 ), matInvisible ) ]\n        ],\n        XYZE: [\n            [ new THREE.Mesh( new THREE.SphereBufferGeometry( 0.7, 10, 8 ), matInvisible ) ]\n        ]\n    };\n\n    var gizmoScale = {\n        X: [\n            [ new THREE.Mesh( scaleHandleGeometry, matRed ), [ 0.8, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ],\n            [ new THREE.Line( lineGeometry, matLineRed ), null, null, [ 0.8, 1, 1 ] ]\n        ],\n        Y: [\n            [ new THREE.Mesh( scaleHandleGeometry, matGreen ), [ 0, 0.8, 0 ] ],\n            [ new THREE.Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ], [ 0.8, 1, 1 ] ]\n        ],\n        Z: [\n            [ new THREE.Mesh( scaleHandleGeometry, matBlue ), [ 0, 0, 0.8 ], [ Math.PI / 2, 0, 0 ] ],\n            [ new THREE.Line( lineGeometry, matLineBlue ), null, [ 0, -Math.PI / 2, 0 ], [ 0.8, 1, 1 ] ]\n        ],\n        XY: [\n            [ new THREE.Mesh( scaleHandleGeometry, matYellowTransparent ), [ 0.85, 0.85, 0 ], null, [ 2, 2, 0.2 ] ],\n            [ new THREE.Line( lineGeometry, matLineYellow ), [ 0.855, 0.98, 0 ], null, [ 0.125, 1, 1 ] ],\n            [ new THREE.Line( lineGeometry, matLineYellow ), [ 0.98, 0.855, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ]\n        ],\n        YZ: [\n            [ new THREE.Mesh( scaleHandleGeometry, matCyanTransparent ), [ 0, 0.85, 0.85 ], null, [ 0.2, 2, 2 ] ],\n            [ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.855, 0.98 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ],\n            [ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.98, 0.855 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]\n        ],\n        XZ: [\n            [ new THREE.Mesh( scaleHandleGeometry, matMagentaTransparent ), [ 0.85, 0, 0.85 ], null, [ 2, 0.2, 2 ] ],\n            [ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.855, 0, 0.98 ], null, [ 0.125, 1, 1 ] ],\n            [ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.98, 0, 0.855 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]\n        ],\n        XYZX: [\n            [ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransperent ), [ 1.1, 0, 0 ] ],\n        ],\n        XYZY: [\n            [ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransperent ), [ 0, 1.1, 0 ] ],\n        ],\n        XYZZ: [\n            [ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransperent ), [ 0, 0, 1.1 ] ],\n        ]\n    };\n\n    var pickerScale = {\n        X: [\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0.5, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ]\n        ],\n        Y: [\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0.5, 0 ] ]\n        ],\n        Z: [\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0, 0.5 ], [ Math.PI / 2, 0, 0 ] ]\n        ],\n        XY: [\n            [ new THREE.Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0.85, 0 ], null, [ 3, 3, 0.2 ] ],\n        ],\n        YZ: [\n            [ new THREE.Mesh( scaleHandleGeometry, matInvisible ), [ 0, 0.85, 0.85 ], null, [ 0.2, 3, 3 ] ],\n        ],\n        XZ: [\n            [ new THREE.Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0, 0.85 ], null, [ 3, 0.2, 3 ] ],\n        ],\n        XYZX: [\n            [ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 1.1, 0, 0 ] ],\n        ],\n        XYZY: [\n            [ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 1.1, 0 ] ],\n        ],\n        XYZZ: [\n            [ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 0, 1.1 ] ],\n        ]\n    };\n\n    var helperScale = {\n        X: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ -1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n        ],\n        Y: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, -1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\n        ],\n        Z: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, 0, -1e3 ], [ 0, -Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\n        ]\n    };\n\n    // Creates an Object3D with gizmos described in custom hierarchy definition.\n\n    var setupGizmo = function( gizmoMap ) {\n\n        var gizmo = new THREE.Object3D();\n\n        for ( var name in gizmoMap ) {\n\n            for ( var i = gizmoMap[ name ].length; i --; ) {\n\n                var object = gizmoMap[ name ][ i ][ 0 ].clone();\n                var position = gizmoMap[ name ][ i ][ 1 ];\n                var rotation = gizmoMap[ name ][ i ][ 2 ];\n                var scale = gizmoMap[ name ][ i ][ 3 ];\n                var tag = gizmoMap[ name ][ i ][ 4 ];\n\n                // name and tag properties are essential for picking and updating logic.\n                object.name = name;\n                object.tag = tag;\n\n                if (position) {\n                    object.position.set(position[ 0 ], position[ 1 ], position[ 2 ]);\n                }\n                if (rotation) {\n                    object.rotation.set(rotation[ 0 ], rotation[ 1 ], rotation[ 2 ]);\n                }\n                if (scale) {\n                    object.scale.set(scale[ 0 ], scale[ 1 ], scale[ 2 ]);\n                }\n\n                object.updateMatrix();\n\n                var tempGeometry = object.geometry.clone();\n                tempGeometry.applyMatrix(object.matrix);\n                object.geometry = tempGeometry;\n\n                object.position.set( 0, 0, 0 );\n                object.rotation.set( 0, 0, 0 );\n                object.scale.set(1, 1, 1);\n\n                gizmo.add(object);\n\n            }\n\n        }\n\n        return gizmo;\n\n    };\n\n    // Reusable utility variables\n\n    var tempVector = new THREE.Vector3( 0, 0, 0 );\n    var tempEuler = new THREE.Euler();\n    var alignVector = new THREE.Vector3( 0, 1, 0 );\n    var zeroVector = new THREE.Vector3( 0, 0, 0 );\n    var lookAtMatrix = new THREE.Matrix4();\n    var tempQuaternion = new THREE.Quaternion();\n    var tempQuaternion2 = new THREE.Quaternion();\n    var identityQuaternion = new THREE.Quaternion();\n\n    var unitX = new THREE.Vector3( 1, 0, 0 );\n    var unitY = new THREE.Vector3( 0, 1, 0 );\n    var unitZ = new THREE.Vector3( 0, 0, 1 );\n\n    // Gizmo creation\n\n    this.gizmo = {};\n    this.picker = {};\n    this.helper = {};\n\n    this.add( this.gizmo[ \"translate\" ] = setupGizmo( gizmoTranslate ) );\n    this.add( this.gizmo[ \"rotate\" ] = setupGizmo( gizmoRotate ) );\n    this.add( this.gizmo[ \"scale\" ] = setupGizmo( gizmoScale ) );\n    this.add( this.picker[ \"translate\" ] = setupGizmo( pickerTranslate ) );\n    this.add( this.picker[ \"rotate\" ] = setupGizmo( pickerRotate ) );\n    this.add( this.picker[ \"scale\" ] = setupGizmo( pickerScale ) );\n    this.add( this.helper[ \"translate\" ] = setupGizmo( helperTranslate ) );\n    this.add( this.helper[ \"rotate\" ] = setupGizmo( helperRotate ) );\n    this.add( this.helper[ \"scale\" ] = setupGizmo( helperScale ) );\n\n    // Pickers should be hidden always\n\n    this.picker[ \"translate\" ].visible = false;\n    this.picker[ \"rotate\" ].visible = false;\n    this.picker[ \"scale\" ].visible = false;\n\n    // updateMatrixWorld will update transformations and appearance of individual handles\n\n    this.updateMatrixWorld = function () {\n\n        var space = this.space;\n\n        if ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation\n\n        var quaternion = space === \"local\" ? this.worldQuaternion : identityQuaternion;\n\n        // Show only gizmos for current transform mode\n\n        this.gizmo[ \"translate\" ].visible = this.mode === \"translate\";\n        this.gizmo[ \"rotate\" ].visible = this.mode === \"rotate\";\n        this.gizmo[ \"scale\" ].visible = this.mode === \"scale\";\n\n        this.helper[ \"translate\" ].visible = this.mode === \"translate\";\n        this.helper[ \"rotate\" ].visible = this.mode === \"rotate\";\n        this.helper[ \"scale\" ].visible = this.mode === \"scale\";\n\n\n        var handles = [];\n        handles = handles.concat( this.picker[ this.mode ].children );\n        handles = handles.concat( this.gizmo[ this.mode ].children );\n        handles = handles.concat( this.helper[ this.mode ].children );\n\n        for ( var i = 0; i < handles.length; i++ ) {\n\n            var handle = handles[i];\n\n            // hide aligned to camera\n\n            handle.visible = true;\n            handle.rotation.set( 0, 0, 0 );\n            handle.position.copy( this.worldPosition );\n\n            var eyeDistance = this.worldPosition.distanceTo( this.cameraPosition);\n            handle.scale.set( 1, 1, 1 ).multiplyScalar( eyeDistance * this.size / 7 );\n\n            // TODO: simplify helpers and consider decoupling from gizmo\n\n            if ( handle.tag === 'helper' ) {\n\n                handle.visible = false;\n\n                if ( handle.name === 'AXIS' ) {\n\n                    handle.position.copy( this.worldPositionStart );\n                    handle.visible = !!this.axis;\n\n                    if ( this.axis === 'X' ) {\n\n                        tempQuaternion.setFromEuler( tempEuler.set( 0, 0, 0 ) );\n                        handle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n                        if ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n                            handle.visible = false;\n                        }\n\n                    }\n\n                    if ( this.axis === 'Y' ) {\n\n                        tempQuaternion.setFromEuler( tempEuler.set( 0, 0, Math.PI / 2 ) );\n                        handle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n                        if ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n                            handle.visible = false;\n                        }\n\n                    }\n\n                    if ( this.axis === 'Z' ) {\n\n                        tempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );\n                        handle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n                        if ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n                            handle.visible = false;\n                        }\n\n                    }\n\n                    if ( this.axis === 'XYZE' ) {\n\n                        tempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );\n                        alignVector.copy( this.rotationAxis );\n                        handle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( zeroVector, alignVector, unitY ) );\n                        handle.quaternion.multiply( tempQuaternion );\n                        handle.visible = this.dragging;\n\n                    }\n\n                    if ( this.axis === 'E' ) {\n\n                        handle.visible = false;\n\n                    }\n\n\n                } else if ( handle.name === 'START' ) {\n\n                    handle.position.copy( this.worldPositionStart );\n                    handle.visible = this.dragging;\n\n                } else if ( handle.name === 'END' ) {\n\n                    handle.position.copy( this.worldPosition );\n                    handle.visible = this.dragging;\n\n                } else if ( handle.name === 'DELTA' ) {\n\n                    handle.position.copy( this.worldPositionStart );\n                    handle.quaternion.copy( this.worldQuaternionStart );\n                    tempVector.set( 1e-10, 1e-10, 1e-10 ).add( this.worldPositionStart ).sub( this.worldPosition ).multiplyScalar( -1 );\n                    tempVector.applyQuaternion( this.worldQuaternionStart.clone().inverse() );\n                    handle.scale.copy( tempVector );\n                    handle.visible = this.dragging;\n\n                } else {\n\n                    handle.quaternion.copy( quaternion );\n\n                    if ( this.dragging ) {\n\n                        handle.position.copy( this.worldPositionStart );\n\n                    } else {\n\n                        handle.position.copy( this.worldPosition );\n\n                    }\n\n                    if ( this.axis ) {\n\n                        handle.visible = this.axis.search( handle.name ) !== -1;\n\n                    }\n\n                }\n\n                // If updating helper, skip rest of the loop\n                continue;\n\n            }\n\n            // Align handles to current local or world rotation\n\n            handle.quaternion.copy( quaternion );\n\n            if ( this.mode === 'translate' || this.mode === 'scale' ) {\n\n                // Hide translate and scale axis facing the camera\n\n                var AXIS_HIDE_TRESHOLD = 0.99;\n                var PLANE_HIDE_TRESHOLD = 0.2;\n                var AXIS_FLIP_TRESHOLD = -0.4;\n\n\n                if ( handle.name === 'X' || handle.name === 'XYZX' ) {\n                    if ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n                    }\n                }\n                if ( handle.name === 'Y' || handle.name === 'XYZY' ) {\n                    if ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n                    }\n                }\n                if ( handle.name === 'Z' || handle.name === 'XYZZ' ) {\n                    if ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n                    }\n                }\n                if ( handle.name === 'XY' ) {\n                    if ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n                    }\n                }\n                if ( handle.name === 'YZ' ) {\n                    if ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n                    }\n                }\n                if ( handle.name === 'XZ' ) {\n                    if ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n                    }\n                }\n\n                // Flip translate and scale axis ocluded behind another axis\n\n                if ( handle.name.search( 'X' ) !== -1 ) {\n                    if ( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n                        if ( handle.tag === 'fwd' ) {\n                            handle.visible = false;\n                        } else {\n                            handle.scale.x *= -1;\n                        }\n                    } else if ( handle.tag === 'bwd' ) {\n                        handle.visible = false;\n                    }\n                }\n\n                if ( handle.name.search( 'Y' ) !== -1 ) {\n                    if ( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n                        if ( handle.tag === 'fwd' ) {\n                            handle.visible = false;\n                        } else {\n                            handle.scale.y *= -1;\n                        }\n                    } else if ( handle.tag === 'bwd' ) {\n                        handle.visible = false;\n                    }\n                }\n\n                if ( handle.name.search( 'Z' ) !== -1 ) {\n                    if ( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n                        if ( handle.tag === 'fwd' ) {\n                            handle.visible = false;\n                        } else {\n                            handle.scale.z *= -1;\n                        }\n                    } else if ( handle.tag === 'bwd' ) {\n                        handle.visible = false;\n                    }\n                }\n\n            } else if ( this.mode === 'rotate' ) {\n\n                // Align handles to current local or world rotation\n\n                tempQuaternion2.copy( quaternion );\n                alignVector.copy( this.eye ).applyQuaternion( tempQuaternion.copy( quaternion ).inverse() );\n\n                if ( handle.name.search( \"E\" ) !== - 1 ) {\n\n                    handle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( this.eye, zeroVector, unitY ) );\n\n                }\n\n                if ( handle.name === 'X' ) {\n\n                    tempQuaternion.setFromAxisAngle( unitX, Math.atan2( -alignVector.y, alignVector.z ) );\n                    tempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n                    handle.quaternion.copy( tempQuaternion );\n\n                }\n\n                if ( handle.name === 'Y' ) {\n\n                    tempQuaternion.setFromAxisAngle( unitY, Math.atan2( alignVector.x, alignVector.z ) );\n                    tempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n                    handle.quaternion.copy( tempQuaternion );\n\n                }\n\n                if ( handle.name === 'Z' ) {\n\n                    tempQuaternion.setFromAxisAngle( unitZ, Math.atan2( alignVector.y, alignVector.x ) );\n                    tempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n                    handle.quaternion.copy( tempQuaternion );\n\n                }\n\n            }\n\n            // Hide disabled axes\n            handle.visible = handle.visible && ( handle.name.indexOf( \"X\" ) === -1 || this.showX );\n            handle.visible = handle.visible && ( handle.name.indexOf( \"Y\" ) === -1 || this.showY );\n            handle.visible = handle.visible && ( handle.name.indexOf( \"Z\" ) === -1 || this.showZ );\n            handle.visible = handle.visible && ( handle.name.indexOf( \"E\" ) === -1 || ( this.showX && this.showY && this.showZ ) );\n\n            // highlight selected axis\n\n            handle.material._opacity = handle.material._opacity || handle.material.opacity;\n            handle.material._color = handle.material._color || handle.material.color.clone();\n\n            handle.material.color.copy( handle.material._color );\n            handle.material.opacity = handle.material._opacity;\n\n            if ( !this.enabled ) {\n\n                handle.material.opacity *= 0.5;\n                handle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n            } else if ( this.axis ) {\n\n                if ( handle.name === this.axis ) {\n\n                    handle.material.opacity = 1.0;\n                    handle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n                } else if ( this.axis.split('').some( function( a ) { return handle.name === a; } ) ) {\n\n                    handle.material.opacity = 1.0;\n                    handle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n                } else {\n\n                    handle.material.opacity *= 0.25;\n                    handle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n                }\n\n            }\n\n        }\n\n        THREE.Object3D.prototype.updateMatrixWorld.call( this );\n\n    };\n\n};\n\nTransformControlsGizmo.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\n\n    constructor: TransformControlsGizmo,\n\n    isTransformControlsGizmo: true\n\n} );\n\n\nconst TransformControlsPlane = function () {\n\n\n    THREE.Mesh.call( this,\n        new THREE.PlaneBufferGeometry( 100000, 100000, 2, 2 ),\n        new THREE.MeshBasicMaterial( { visible: false, wireframe: true, side: THREE.DoubleSide, transparent: true, opacity: 0.1 } )\n    );\n\n    this.type = 'TransformControlsPlane';\n\n    var unitX = new THREE.Vector3( 1, 0, 0 );\n    var unitY = new THREE.Vector3( 0, 1, 0 );\n    var unitZ = new THREE.Vector3( 0, 0, 1 );\n\n    var tempVector = new THREE.Vector3();\n    var dirVector = new THREE.Vector3();\n    var alignVector = new THREE.Vector3();\n    var tempMatrix = new THREE.Matrix4();\n    var identityQuaternion = new THREE.Quaternion();\n\n    this.updateMatrixWorld = function() {\n\n        var space = this.space;\n\n        this.position.copy( this.worldPosition );\n\n        if ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation\n\n        unitX.set( 1, 0, 0 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n        unitY.set( 0, 1, 0 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n        unitZ.set( 0, 0, 1 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n\n        // Align the plane for current transform mode, axis and space.\n\n        alignVector.copy( unitY );\n\n        switch ( this.mode ) {\n            case 'translate':\n            case 'scale':\n                switch ( this.axis ) {\n                    case 'X':\n                        alignVector.copy( this.eye ).cross( unitX );\n                        dirVector.copy( unitX ).cross( alignVector );\n                        break;\n                    case 'Y':\n                        alignVector.copy( this.eye ).cross( unitY );\n                        dirVector.copy( unitY ).cross( alignVector );\n                        break;\n                    case 'Z':\n                        alignVector.copy( this.eye ).cross( unitZ );\n                        dirVector.copy( unitZ ).cross( alignVector );\n                        break;\n                    case 'XY':\n                        dirVector.copy( unitZ );\n                        break;\n                    case 'YZ':\n                        dirVector.copy( unitX );\n                        break;\n                    case 'XZ':\n                        alignVector.copy( unitZ );\n                        dirVector.copy( unitY );\n                        break;\n                    case 'XYZ':\n                    case 'E':\n                        dirVector.set( 0, 0, 0 );\n                        break;\n                    default:\n                        break;\n                }\n                break;\n            case 'rotate':\n            default:\n                // special case for rotate\n                dirVector.set( 0, 0, 0 );\n        }\n\n        if ( dirVector.length() === 0 ) {\n\n            // If in rotate mode, make the plane parallel to camera\n            this.quaternion.copy( this.cameraQuaternion );\n\n        } else {\n\n            tempMatrix.lookAt( tempVector.set( 0, 0, 0 ), dirVector, alignVector );\n\n            this.quaternion.setFromRotationMatrix( tempMatrix );\n\n        }\n\n        THREE.Object3D.prototype.updateMatrixWorld.call( this );\n\n    };\n\n};\n\nTransformControlsPlane.prototype = Object.assign( Object.create( THREE.Mesh.prototype ), {\n\n    constructor: TransformControlsPlane,\n\n    isTransformControlsPlane: true\n\n} );\n\nexport default TransformControls\n","/**\n * @author sunag / http://www.sunag.com.br\n */\nconst THREE = require('three');//requireimport * as THREE from 'three'\n\n\nconst SkeletonUtils = {\n\n\tretarget: function () {\n\n\t\tvar pos = new THREE.Vector3(),\n\t\t\tquat = new THREE.Quaternion(),\n\t\t\tscale = new THREE.Vector3(),\n\t\t\tbindBoneMatrix = new THREE.Matrix4(),\n\t\t\trelativeMatrix = new THREE.Matrix4(),\n\t\t\tglobalMatrix = new THREE.Matrix4();\n\n\t\treturn function ( target, source, options ) {\n\n\t\t\toptions = options || {};\n\t\t\toptions.preserveMatrix = options.preserveMatrix !== undefined ? options.preserveMatrix : true;\n\t\t\toptions.preservePosition = options.preservePosition !== undefined ? options.preservePosition : true;\n\t\t\toptions.preserveHipPosition = options.preserveHipPosition !== undefined ? options.preserveHipPosition : false;\n\t\t\toptions.useTargetMatrix = options.useTargetMatrix !== undefined ? options.useTargetMatrix : false;\n\t\t\toptions.hip = options.hip !== undefined ? options.hip : \"hip\";\n\t\t\toptions.names = options.names || {};\n\n\t\t\tvar sourceBones = source.isObject3D ? source.skeleton.bones : this.getBones( source ),\n\t\t\t\tbones = target.isObject3D ? target.skeleton.bones : this.getBones( target ),\n\t\t\t\tbindBones,\n\t\t\t\tbone, name, boneTo,\n\t\t\t\tbonesPosition, i;\n\n\t\t\t// reset bones\n\n\t\t\tif ( target.isObject3D ) {\n\n\t\t\t\ttarget.skeleton.pose();\n\n\t\t\t} else {\n\n\t\t\t\toptions.useTargetMatrix = true;\n\t\t\t\toptions.preserveMatrix = false;\n\n\t\t\t}\n\n\t\t\tif ( options.preservePosition ) {\n\n\t\t\t\tbonesPosition = [];\n\n\t\t\t\tfor ( i = 0; i < bones.length; i ++ ) {\n\n\t\t\t\t\tbonesPosition.push( bones[ i ].position.clone() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( options.preserveMatrix ) {\n\n\t\t\t\t// reset matrix\n\n\t\t\t\ttarget.updateMatrixWorld();\n\n\t\t\t\ttarget.matrixWorld.identity();\n\n\t\t\t\t// reset children matrix\n\n\t\t\t\tfor ( i = 0; i < target.children.length; ++ i ) {\n\n\t\t\t\t\ttarget.children[ i ].updateMatrixWorld( true );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( options.offsets ) {\n\n\t\t\t\tbindBones = [];\n\n\t\t\t\tfor ( i = 0; i < bones.length; ++ i ) {\n\n\t\t\t\t\tbone = bones[ i ];\n\t\t\t\t\tname = options.names[ bone.name ] || bone.name;\n\n\t\t\t\t\tif ( options.offsets && options.offsets[ name ] ) {\n\n\t\t\t\t\t\tbone.matrix.multiply( options.offsets[ name ] );\n\n\t\t\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\n\n\t\t\t\t\t\tbone.updateMatrixWorld();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbindBones.push( bone.matrixWorld.clone() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfor ( i = 0; i < bones.length; ++ i ) {\n\n\t\t\t\tbone = bones[ i ];\n\t\t\t\tname = options.names[ bone.name ] || bone.name;\n\n\t\t\t\tboneTo = this.getBoneByName( name, sourceBones );\n\n\t\t\t\tglobalMatrix.copy( bone.matrixWorld );\n\n\t\t\t\tif ( boneTo ) {\n\n\t\t\t\t\tboneTo.updateMatrixWorld();\n\n\t\t\t\t\tif ( options.useTargetMatrix ) {\n\n\t\t\t\t\t\trelativeMatrix.copy( boneTo.matrixWorld );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\trelativeMatrix.getInverse( target.matrixWorld );\n\t\t\t\t\t\trelativeMatrix.multiply( boneTo.matrixWorld );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// ignore scale to extract rotation\n\n\t\t\t\t\tscale.setFromMatrixScale( relativeMatrix );\n\t\t\t\t\trelativeMatrix.scale( scale.set( 1 / scale.x, 1 / scale.y, 1 / scale.z ) );\n\n\t\t\t\t\t// apply to global matrix\n\n\t\t\t\t\tglobalMatrix.makeRotationFromQuaternion( quat.setFromRotationMatrix( relativeMatrix ) );\n\n\t\t\t\t\tif ( target.isObject3D ) {\n\n\t\t\t\t\t\tvar boneIndex = bones.indexOf( bone ),\n\t\t\t\t\t\t\twBindMatrix = bindBones ? bindBones[ boneIndex ] : bindBoneMatrix.getInverse( target.skeleton.boneInverses[ boneIndex ] );\n\n\t\t\t\t\t\tglobalMatrix.multiply( wBindMatrix );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tglobalMatrix.copyPosition( relativeMatrix );\n\n\t\t\t\t}\n\n\t\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\t\tbone.matrix.getInverse( bone.parent.matrixWorld );\n\t\t\t\t\tbone.matrix.multiply( globalMatrix );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbone.matrix.copy( globalMatrix );\n\n\t\t\t\t}\n\n\t\t\t\tif ( options.preserveHipPosition && name === options.hip ) {\n\n\t\t\t\t\tbone.matrix.setPosition( pos.set( 0, bone.position.y, 0 ) );\n\n\t\t\t\t}\n\n\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\n\n\t\t\t\tbone.updateMatrixWorld();\n\n\t\t\t}\n\n\t\t\tif ( options.preservePosition ) {\n\n\t\t\t\tfor ( i = 0; i < bones.length; ++ i ) {\n\n\t\t\t\t\tbone = bones[ i ];\n\t\t\t\t\tname = options.names[ bone.name ] || bone.name;\n\n\t\t\t\t\tif ( name !== options.hip ) {\n\n\t\t\t\t\t\tbone.position.copy( bonesPosition[ i ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( options.preserveMatrix ) {\n\n\t\t\t\t// restore matrix\n\n\t\t\t\ttarget.updateMatrixWorld( true );\n\n\t\t\t}\n\n\t\t};\n\n\t}(),\n\n\tretargetClip: function ( target, source, clip, options ) {\n\n\t\toptions = options || {};\n\t\toptions.useFirstFramePosition = options.useFirstFramePosition !== undefined ? options.useFirstFramePosition : false;\n\t\toptions.fps = options.fps !== undefined ? options.fps : 30;\n\t\toptions.names = options.names || [];\n\n\t\tif ( ! source.isObject3D ) {\n\n\t\t\tsource = this.getHelperFromSkeleton( source );\n\n\t\t}\n\n\t\tvar numFrames = Math.round( clip.duration * ( options.fps / 1000 ) * 1000 ),\n\t\t\tdelta = 1 / options.fps,\n\t\t\tconvertedTracks = [],\n\t\t\tmixer = new THREE.AnimationMixer( source ),\n\t\t\tbones = this.getBones( target.skeleton ),\n\t\t\tboneDatas = [],\n\t\t\tpositionOffset,\n\t\t\tbone, boneTo, boneData,\n\t\t\tname, i, j;\n\n\t\tmixer.clipAction( clip ).play();\n\t\tmixer.update( 0 );\n\n\t\tsource.updateMatrixWorld();\n\n\t\tfor ( i = 0; i < numFrames; ++ i ) {\n\n\t\t\tvar time = i * delta;\n\n\t\t\tthis.retarget( target, source, options );\n\n\t\t\tfor ( j = 0; j < bones.length; ++ j ) {\n\n\t\t\t\tname = options.names[ bones[ j ].name ] || bones[ j ].name;\n\n\t\t\t\tboneTo = this.getBoneByName( name, source.skeleton );\n\n\t\t\t\tif ( boneTo ) {\n\n\t\t\t\t\tbone = bones[ j ];\n\t\t\t\t\tboneData = boneDatas[ j ] = boneDatas[ j ] || { bone: bone };\n\n\t\t\t\t\tif ( options.hip === name ) {\n\n\t\t\t\t\t\tif ( ! boneData.pos ) {\n\n\t\t\t\t\t\t\tboneData.pos = {\n\t\t\t\t\t\t\t\ttimes: new Float32Array( numFrames ),\n\t\t\t\t\t\t\t\tvalues: new Float32Array( numFrames * 3 )\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( options.useFirstFramePosition ) {\n\n\t\t\t\t\t\t\tif ( i === 0 ) {\n\n\t\t\t\t\t\t\t\tpositionOffset = bone.position.clone();\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbone.position.sub( positionOffset );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tboneData.pos.times[ i ] = time;\n\n\t\t\t\t\t\tbone.position.toArray( boneData.pos.values, i * 3 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! boneData.quat ) {\n\n\t\t\t\t\t\tboneData.quat = {\n\t\t\t\t\t\t\ttimes: new Float32Array( numFrames ),\n\t\t\t\t\t\t\tvalues: new Float32Array( numFrames * 4 )\n\t\t\t\t\t\t};\n\n\t\t\t\t\t}\n\n\t\t\t\t\tboneData.quat.times[ i ] = time;\n\n\t\t\t\t\tbone.quaternion.toArray( boneData.quat.values, i * 4 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tmixer.update( delta );\n\n\t\t\tsource.updateMatrixWorld();\n\n\t\t}\n\n\t\tfor ( i = 0; i < boneDatas.length; ++ i ) {\n\n\t\t\tboneData = boneDatas[ i ];\n\n\t\t\tif ( boneData ) {\n\n\t\t\t\tif ( boneData.pos ) {\n\n\t\t\t\t\tconvertedTracks.push( new THREE.VectorKeyframeTrack(\n\t\t\t\t\t\t\".bones[\" + boneData.bone.name + \"].position\",\n\t\t\t\t\t\tboneData.pos.times,\n\t\t\t\t\t\tboneData.pos.values\n\t\t\t\t\t) );\n\n\t\t\t\t}\n\n\t\t\t\tconvertedTracks.push( new THREE.QuaternionKeyframeTrack(\n\t\t\t\t\t\".bones[\" + boneData.bone.name + \"].quaternion\",\n\t\t\t\t\tboneData.quat.times,\n\t\t\t\t\tboneData.quat.values\n\t\t\t\t) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tmixer.uncacheAction( clip );\n\n\t\treturn new THREE.AnimationClip( clip.name, - 1, convertedTracks );\n\n\t},\n\n\tgetHelperFromSkeleton: function ( skeleton ) {\n\n\t\tvar source = new THREE.SkeletonHelper( skeleton.bones[ 0 ] );\n\t\tsource.skeleton = skeleton;\n\n\t\treturn source;\n\n\t},\n\n\tgetSkeletonOffsets: function () {\n\n\t\tvar targetParentPos = new THREE.Vector3(),\n\t\t\ttargetPos = new THREE.Vector3(),\n\t\t\tsourceParentPos = new THREE.Vector3(),\n\t\t\tsourcePos = new THREE.Vector3(),\n\t\t\ttargetDir = new THREE.Vector2(),\n\t\t\tsourceDir = new THREE.Vector2();\n\n\t\treturn function ( target, source, options ) {\n\n\t\t\toptions = options || {};\n\t\t\toptions.hip = options.hip !== undefined ? options.hip : \"hip\";\n\t\t\toptions.names = options.names || {};\n\n\t\t\tif ( ! source.isObject3D ) {\n\n\t\t\t\tsource = this.getHelperFromSkeleton( source );\n\n\t\t\t}\n\n\t\t\tvar nameKeys = Object.keys( options.names ),\n\t\t\t\tnameValues = Object.values( options.names ),\n\t\t\t\tsourceBones = source.isObject3D ? source.skeleton.bones : this.getBones( source ),\n\t\t\t\tbones = target.isObject3D ? target.skeleton.bones : this.getBones( target ),\n\t\t\t\toffsets = [],\n\t\t\t\tbone, boneTo,\n\t\t\t\tname, i;\n\n\t\t\ttarget.skeleton.pose();\n\n\t\t\tfor ( i = 0; i < bones.length; ++ i ) {\n\n\t\t\t\tbone = bones[ i ];\n\t\t\t\tname = options.names[ bone.name ] || bone.name;\n\n\t\t\t\tboneTo = this.getBoneByName( name, sourceBones );\n\n\t\t\t\tif ( boneTo && name !== options.hip ) {\n\n\t\t\t\t\tvar boneParent = this.getNearestBone( bone.parent, nameKeys ),\n\t\t\t\t\t\tboneToParent = this.getNearestBone( boneTo.parent, nameValues );\n\n\t\t\t\t\tboneParent.updateMatrixWorld();\n\t\t\t\t\tboneToParent.updateMatrixWorld();\n\n\t\t\t\t\ttargetParentPos.setFromMatrixPosition( boneParent.matrixWorld );\n\t\t\t\t\ttargetPos.setFromMatrixPosition( bone.matrixWorld );\n\n\t\t\t\t\tsourceParentPos.setFromMatrixPosition( boneToParent.matrixWorld );\n\t\t\t\t\tsourcePos.setFromMatrixPosition( boneTo.matrixWorld );\n\n\t\t\t\t\ttargetDir.subVectors(\n\t\t\t\t\t\tnew THREE.Vector2( targetPos.x, targetPos.y ),\n\t\t\t\t\t\tnew THREE.Vector2( targetParentPos.x, targetParentPos.y )\n\t\t\t\t\t).normalize();\n\n\t\t\t\t\tsourceDir.subVectors(\n\t\t\t\t\t\tnew THREE.Vector2( sourcePos.x, sourcePos.y ),\n\t\t\t\t\t\tnew THREE.Vector2( sourceParentPos.x, sourceParentPos.y )\n\t\t\t\t\t).normalize();\n\n\t\t\t\t\tvar laterialAngle = targetDir.angle() - sourceDir.angle();\n\n\t\t\t\t\tvar offset = new THREE.Matrix4().makeRotationFromEuler(\n\t\t\t\t\t\tnew THREE.Euler(\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\tlaterialAngle\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\n\t\t\t\t\tbone.matrix.multiply( offset );\n\n\t\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\n\n\t\t\t\t\tbone.updateMatrixWorld();\n\n\t\t\t\t\toffsets[ name ] = offset;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn offsets;\n\n\t\t};\n\n\t}(),\n\n\trenameBones: function ( skeleton, names ) {\n\n\t\tvar bones = this.getBones( skeleton );\n\n\t\tfor ( var i = 0; i < bones.length; ++ i ) {\n\n\t\t\tvar bone = bones[ i ];\n\n\t\t\tif ( names[ bone.name ] ) {\n\n\t\t\t\tbone.name = names[ bone.name ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tgetBones: function ( skeleton ) {\n\n\t\treturn Array.isArray( skeleton ) ? skeleton : skeleton.bones;\n\n\t},\n\n\tgetBoneByName: function ( name, skeleton ) {\n\n\t\tfor ( var i = 0, bones = this.getBones( skeleton ); i < bones.length; i ++ ) {\n\n\t\t\tif ( name === bones[ i ].name )\n\n\t\t\t\treturn bones[ i ];\n\n\t\t}\n\n\t},\n\n\tgetNearestBone: function ( bone, names ) {\n\n\t\twhile ( bone.isBone ) {\n\n\t\t\tif ( names.indexOf( bone.name ) !== - 1 ) {\n\n\t\t\t\treturn bone;\n\n\t\t\t}\n\n\t\t\tbone = bone.parent;\n\n\t\t}\n\n\t},\n\n\tfindBoneTrackData: function ( name, tracks ) {\n\n\t\tvar regexp = /\\[(.*)\\]\\.(.*)/,\n\t\t\tresult = { name: name };\n\n\t\tfor ( var i = 0; i < tracks.length; ++ i ) {\n\n\t\t\t// 1 is track name\n\t\t\t// 2 is track type\n\t\t\tvar trackData = regexp.exec( tracks[ i ].name );\n\n\t\t\tif ( trackData && name === trackData[ 1 ] ) {\n\n\t\t\t\tresult[ trackData[ 2 ] ] = i;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn result;\n\n\t},\n\n\tgetEqualsBonesNames: function ( skeleton, targetSkeleton ) {\n\n\t\tvar sourceBones = this.getBones( skeleton ),\n\t\t\ttargetBones = this.getBones( targetSkeleton ),\n\t\t\tbones = [];\n\n\t\tsearch : for ( var i = 0; i < sourceBones.length; i ++ ) {\n\n\t\t\tvar boneName = sourceBones[ i ].name;\n\n\t\t\tfor ( var j = 0; j < targetBones.length; j ++ ) {\n\n\t\t\t\tif ( boneName === targetBones[ j ].name ) {\n\n\t\t\t\t\tbones.push( boneName );\n\n\t\t\t\t\tcontinue search;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn bones;\n\n\t},\n\n\tclone: function ( source ) {\n\n\t\tvar sourceLookup = new Map();\n\t\tvar cloneLookup = new Map();\n\n\t\tvar clone = source.clone();\n\n\t\tparallelTraverse( source, clone, function ( sourceNode, clonedNode ) {\n\n\t\t\tsourceLookup.set( clonedNode, sourceNode );\n\t\t\tcloneLookup.set( sourceNode, clonedNode );\n\n\t\t} );\n\n\t\tclone.traverse( function ( node ) {\n\n\t\t\tif ( ! node.isSkinnedMesh ) return;\n\n\t\t\tvar clonedMesh = node;\n\t\t\tvar sourceMesh = sourceLookup.get( node );\n\t\t\tvar sourceBones = sourceMesh.skeleton.bones;\n\n\t\t\tclonedMesh.skeleton = sourceMesh.skeleton.clone();\n\t\t\tclonedMesh.bindMatrix.copy( sourceMesh.bindMatrix );\n\n\t\t\tclonedMesh.skeleton.bones = sourceBones.map( function ( bone ) {\n\n\t\t\t\treturn cloneLookup.get( bone );\n\n\t\t\t} );\n\n\t\t\tclonedMesh.bind( clonedMesh.skeleton, clonedMesh.bindMatrix );\n\n\t\t} );\n\n\t\treturn clone;\n\n\t}\n\n};\n\n\nfunction parallelTraverse ( a, b, callback ) {\n\n\tcallback( a, b );\n\n\tfor ( var i = 0; i < a.children.length; i ++ ) {\n\n\t\tparallelTraverse( a.children[ i ], b.children[ i ], callback );\n\n\t}\n\n}\n\nexport default SkeletonUtils","import {NONE_ASSET} from '../Common'\nimport {DoubleSide, MeshLambertMaterial} from 'three'\n\nexport default class ObjectDef {\n    updateProperty(node, obj, op, provider) {\n        if (op.name === 'tx') node.position.x = parseFloat(op.value)\n        if (op.name === 'ty') node.position.y = parseFloat(op.value)\n        if (op.name === 'tz') node.position.z = parseFloat(op.value)\n        if (op.name === 'rx') node.rotation.x = parseFloat(op.value)\n        if (op.name === 'ry') node.rotation.y = parseFloat(op.value)\n        if (op.name === 'rz') node.rotation.z = parseFloat(op.value)\n        if (op.name === 'sx') node.scale.x = parseFloat(op.value)\n        if (op.name === 'sy') node.scale.y = parseFloat(op.value)\n        if (op.name === 'sz') node.scale.z = parseFloat(op.value)\n        if (op.name === 'visible') node.visible = op.value\n\n        if (op.name === 'color') {\n            let color = op.value\n            if(color.indexOf('#') === 0) color = color.substring(1)\n            node.material.color.set(parseInt(color,16))\n        }\n\n    }\n    reset(node, obj) {\n        node.position.set(obj.tx,obj.ty,obj.tz)\n        node.visible = obj.visible\n    }\n\n    attachAsset(node, obj, provider) {\n        if(obj.asset === NONE_ASSET.id) {\n            node.material = new MeshLambertMaterial({color: obj.color, side:DoubleSide})\n            return\n        }\n        provider.assetsManager.getTexture(obj.asset).then(tex => {\n            provider.getLogger().log(\"loadded asset\",obj.asset)\n            provider.getLogger().log(tex)\n            if(!tex) provider.getLogger().error(\"error loading asset\",obj.asset)\n            const opts = {\n                color: obj.color,\n                side: DoubleSide,\n                map:tex\n            }\n            if(obj.transparent) {\n                opts.transparent = true\n                opts.alphaTest = 0.5\n            }\n            node.material = new MeshLambertMaterial(opts)\n        }).catch(err => {\n            provider.getLogger().error('error somwhere',err.message,err)\n        })\n    }\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport ObjectDef from './ObjectDef'\nimport {NONE_ASSET, OBJ_TYPES, PROP_DEFS} from '../Common'\nimport {BoxGeometry, Mesh, MeshLambertMaterial} from 'three'\n\nlet COUNTER = 0\n\nexport default class CubeDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create cube w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.cube,\n            title:'cube '+COUNTER++,\n            visible:true,\n            width:0.3, height:0.3, depth:0.3,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#00ff00',\n            children:graph.createArray(),\n            asset:NONE_ASSET.id,\n            transparent:false,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new Mesh(\n            new BoxGeometry(obj.width, obj.height, obj.depth),\n            new MeshLambertMaterial({color: obj.color})\n        )\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        this.attachAsset(node, obj, provider)\n        return node\n    }\n\n\n\n    updateProperty(node, obj, op, provider) {\n        if (op.name === 'width' || op.name === 'height' || op.name === 'depth') {\n            node.geometry = new BoxGeometry(obj.width, obj.height, obj.depth)\n            return\n        }\n        if (op.name === PROP_DEFS.asset.key || op.name === PROP_DEFS.transparent.key) return this.attachAsset(node, obj, provider)\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport ObjectDef from './ObjectDef'\nimport {NONE_ASSET, OBJ_TYPES, PROP_DEFS} from '../Common'\nimport {Mesh, MeshLambertMaterial, SphereBufferGeometry} from 'three'\n\nlet COUNTER = 0\n\nexport default class SphereDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create sphere w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.sphere,\n            title:'sphere '+COUNTER++,\n            visible:true,\n            radius: 0.3/2,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#0000ff',\n            children:graph.createArray(),\n            asset:NONE_ASSET.id,\n            transparent:false,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new Mesh(\n            new SphereBufferGeometry(obj.radius),\n            new MeshLambertMaterial({color: obj.color})\n        )\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        this.attachAsset(node, obj, provider)\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        if (op.name === 'radius') node.geometry = new SphereBufferGeometry(op.value)\n        if (op.name === PROP_DEFS.asset.key || op.name === PROP_DEFS.transparent.key) return this.attachAsset(node, obj, provider)\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport * as THREE from \"three\"\nimport {NONE_ASSET, PROP_DEFS} from '../Common'\nimport ObjectDef from './ObjectDef'\n\nexport default class PlaneDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create plane w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:'plane',\n            title:'a plane',\n            visible:true,\n            width: 0.5,\n            height: 0.5,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#ffffff',\n            children:graph.createArray(),\n            asset:NONE_ASSET.id,\n            transparent:false,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new THREE.Mesh(\n            new THREE.PlaneBufferGeometry(obj.width,obj.height),\n            new THREE.MeshLambertMaterial({color: obj.color, side: THREE.DoubleSide})\n        )\n        this.attachAsset(node, obj, provider)\n        node.userData.clickable = true\n        // on(node,POINTER_CLICK,e =>SelectionManager.setSelection(node.userData.graphid))\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        if (op.name === 'width') node.geometry = new THREE.PlaneBufferGeometry(op.value,obj.height)\n        if (op.name === 'height') node.geometry = new THREE.PlaneBufferGeometry(obj.width,op.value)\n        if (op.name === PROP_DEFS.asset.key || op.name === PROP_DEFS.transparent.key) return this.attachAsset(node, obj, provider)\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport * as THREE from \"three\"\nimport {MeshLambertMaterial} from \"three\"\nimport {NONE_ASSET, PROP_DEFS} from '../Common'\nimport SkeletonUtils from '../SkeletonUtils'\nimport ObjectDef from './ObjectDef'\n\nexport default class ModelDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create model w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:'model',\n            title:'a model',\n            visible:true,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#ffffff',\n            children:graph.createArray(),\n            asset:NONE_ASSET.id,\n            transparent:false,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new THREE.Group()\n        node.name = obj.title\n        const clicker =  new THREE.Mesh(\n            new THREE.SphereBufferGeometry(1),\n            new MeshLambertMaterial({color:\"red\", transparent:true, opacity: 0.2})\n        )\n        clicker.material.visible = true\n        clicker.userData.clickable = true\n        node.userData.clicker = clicker\n        node.add(clicker)\n        // on(clicker,POINTER_CLICK,e =>SelectionManager.setSelection(node.userData.graphid))\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        this.attachAsset(node, obj, provider)\n\n        node.enter = (evt,scriptManager) => {\n            node.userData.clicker.visible = false\n            // if (node.userData.mixer) {\n            //     provider.addMixer(obj.id, node.userData.mixer)\n            // }\n            if (node.userData.model) {\n                if (node.userData.currentClip) {\n                    node.userData.action = node.userData.mixer.clipAction( node.userData.currentClip );\n                    node.userData.action.play()\n                }\n            } else {\n                node.userData.shouldPlay = true\n            }\n        }\n        node.exit = (evt,scriptManager) => {\n            const ob2 = provider.accessObject(obj.id)\n            if(ob2.asset === NONE_ASSET.id) {\n                node.userData.clicker.visible = true\n            }\n            // if (node.userData.mixer) {\n            //     provider.removeMixer(obj.id)\n            // }\n        }\n        node.tick = (evt,scriptManager) => {\n            const dt = evt.deltaTime / 1000;\n            node.userData.mixer && node.userData.mixer.update(dt);\n        }\n\n        // node.playAllClips = (evt, scriptManager) => {\n        //     node.userData.clips.forEach((clip) => {\n        //         node.userData.mixer.clipAction(clip).reset().play();\n        //     });\n        // }\n        // need to get this into the render loop somehow\n\n        node.useClip = (name) => {\n            if (node.userData.model) {\n                var clip = THREE.AnimationClip.findByName( node.userData.clips, name );\n                if (clip) {\n                    node.userData.currentClip = clip\n                }\n            } else {\n                node.userData.currentClipName = name\n            }\n        }\n\n        node.play = () => {\n            if (node.userData.currentClip) {\n                node.userData.mixer.stopAllAction();\n                node.userData.action = node.userData.mixer.clipAction( node.userData.currentClip );\n                node.userData.action.play()\n            }\n        }\n\n        node.stop = () => {\n            if (node.userData.mixer) {\n                node.userData.mixer.stopAllAction();            \n            }\n        }\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        if (op.name === PROP_DEFS.asset.key) return this.attachAsset(node, obj, provider)\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n    setClips ( userData ) {\n        if (userData.mixer) {\n          userData.mixer.stopAllAction();\n          userData.mixer.uncacheRoot(userData.mixer.getRoot());\n          userData.mixer = null;\n        }\n    \n        userData.clips.forEach((clip) => {\n          if (clip.validate()) clip.optimize();\n        });\n\n        if (!userData.clips.length) return;\n    \n        userData.currentClip = userData.clips[0]\n        userData.mixer = new THREE.AnimationMixer( userData.model );\n    }\n        \n    attachAsset(node, obj, provider) {\n        if(obj.asset === NONE_ASSET.id) {\n            // node.material = new MeshLambertMaterial({color: obj.color, side:THREE.DoubleSide})\n            console.log(\"REMOVE NODE CHILDREN\")\n            if(node.userData.model) {\n                node.remove(node.userData.model)\n                delete node.userData.model\n            }\n            node.userData.clicker.visible = true\n            return\n        }\n\n        node.userData.shouldPlay = false\n        node.userData.currentClip = null\n        node.userData.model = null\n        node.userData.currentClipName = null\n\n        provider.assetsManager.getGLTF(obj.asset).then(gltf => {\n            //swap the model\n            if(node.userData.model) node.remove(node.userData.model)\n\n            node.userData.model = gltf.scene || gltf.scenes[0]\n\n            // clone it, in case the loader is returning the same cached version?\n            node.userData.model = SkeletonUtils.clone( node.userData.model  );\n\n            node.userData.clips = gltf.animations || [];\n\n            node.add(node.userData.model)\n            node.userData.model.updateMatrixWorld();\n\n            //calculate the size of the model\n            // if(node.userData.model.geometry) {\n                // node.userData.model.geometry.computeBoundingSphere()\n                // node.userData.boundingSphere = node.userData.model.geometry.boundingSphere\n                // const bs = node.userData.boundingSphere\n                const model = node.userData.model\n\n                node.userData.boundingBox = new THREE.Box3().setFromObject(model);\n                node.userData.boundingBoxSize = node.userData.boundingBox.getSize(new THREE.Vector3()).length();\n                node.userData.BoundingBoxCenter = node.userData.boundingBox.getCenter(new THREE.Vector3());     \n                      \n                node.userData.mixer = null\n                this.setClips(node.userData)\n\n                // Really don't want to move it\n                ///\n                // model.position.x += model.position.x - node.userData.BoundingBoxCenter.x\n                // model.position.y += model.position.y - node.userData.BoundingBoxCenter.y\n                // model.position.z += model.position.z - node.userData.BoundingBoxCenter.z\n\n                // model.position.x = -bs.center.x\n                // model.position.y = -bs.center.y\n                // model.position.z = -bs.center.z\n\n                if (node.userData.currentClipName) {\n                    var clip = THREE.AnimationClip.findByName( node.userData.clips, node.userData.currentClipName );\n                    if (clip) {\n                        node.userData.currentClip = clip\n                    }\n                    node.userData.currentClipName = null\n                }\n\n                if (node.userData.shouldPlay && node.userData.currentClip) {\n                    node.userData.action = node.userData.mixer.clipAction( node.userData.currentClip );\n                    node.userData.action.play()\n                    node.userData.shouldPlay = false\n                }\n                node.userData.clicker.geometry = new THREE.SphereBufferGeometry(node.userData.boundingBoxSize / 2)\n            // }\n            //disable the clicker sphere\n            node.userData.clicker.visible = false\n        }).catch(e => {\n            console.log(\"error loading GLTF\")\n        })\n    }\n\n}\n","import {fetchGraphObject} from '../../syncgraph/utils'\nimport {NONE_ASSET, OBJ_TYPES, PROP_DEFS} from '../Common'\nimport * as THREE from 'three'\nimport {MeshLambertMaterial} from 'three'\nimport {DoubleSide} from 'three'\n\nfunction customize(node,mat,obj) {\n    mat.onBeforeCompile = (shader) => {\n        //add uniform\n        shader.uniforms.imageOffsetAngle    = { value: obj.imageOffsetAngle }\n        shader.uniforms.imageCropStartAngle = { value: obj.imageCropStartAngle }\n        shader.uniforms.imageCropEndAngle   = { value: obj.imageCropEndAngle }\n        //prepend to the shader the defs\n        shader.vertexShader = `\n            uniform float imageOffsetAngle;\n            varying float vImageOffsetAngle;\n            uniform float imageCropStartAngle;            \n            varying float vImageCropStartAngle;            \n            uniform float imageCropEndAngle;            \n            varying float vImageCropEndAngle;            \n        ` + shader.vertexShader\n\n        //copy into fragment shader\n        shader.vertexShader = shader.vertexShader.replace('#include <begin_vertex>',`\n            #include <begin_vertex>\n            vImageOffsetAngle = imageOffsetAngle;\n            vImageCropStartAngle = imageCropStartAngle;\n            vImageCropEndAngle = imageCropEndAngle;\n        `)\n\n        //prepend to the fragment shader the defs\n        shader.fragmentShader = `\n                varying float vImageOffsetAngle;\n                varying float vImageCropStartAngle;\n                varying float vImageCropEndAngle;\n            `+shader.fragmentShader\n        //use in the shader\n        shader.fragmentShader = shader.fragmentShader.replace('#include <dithering_fragment>',`\n            if(vUv.x < vImageCropStartAngle) discard;\n            if(vUv.x > vImageCropEndAngle)  discard;\n            // gl_FragColor.r = vUv.x;\n            // vec3 jv = vec3(cos(gl_FragCoord.x/50.0)); \n            // vec3 empty = vec3(0.0,0.0,0.0);//vec3(jv,jv,jv)\n            // gl_FragColor.rgb = mix(empty,diffuseColor.rgb,jv);\n        `)\n        node.userData.matShader = shader\n    }\n}\n\nexport default class BG360Def {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create sphere w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.bg360,\n            title:'background',\n            visible:true,\n            asset:NONE_ASSET.id,\n            transparent:false,\n            parent:scene.id,\n            imageOffsetAngle:0.0, //offset in UV coords, 0 to 1\n            imageCropStartAngle:0.0, //crop left edge of image\n            imageCropEndAngle:1.0, //crop right edge of image\n        }))\n    }\n    makeNode(obj, provider) {\n        const mat = new THREE.MeshLambertMaterial({color: 'white', side: THREE.BackSide})\n        const node = new THREE.Mesh(new THREE.SphereBufferGeometry(20.0, 50,50),mat)\n        this.attachAsset(node, obj, provider)\n        customize(node,mat,obj)\n        node.name = obj.title\n        node.userData.clickable = true\n        node.visible = obj.visible\n        return node\n    }\n    updateProperty(node, obj, op, provider) {\n        if (op.name === PROP_DEFS.asset.key || op.name === PROP_DEFS.transparent.key) return this.attachAsset(node, obj, provider)\n        if(node.userData.matShader) {\n            if (op.name === 'imageOffsetAngle') node.userData.matShader.uniforms.imageOffsetAngle.value = op.value\n            if (op.name === 'imageCropStartAngle') node.userData.matShader.uniforms.imageCropStartAngle.value = op.value\n            if (op.name === 'imageCropEndAngle') node.userData.matShader.uniforms.imageCropEndAngle.value = op.value\n        } else {\n            console.warn(\"BG360: no shader reference?!\")\n        }\n    }\n\n    attachAsset(node, obj, provider) {\n        if(obj.asset === NONE_ASSET.id) {\n            node.material = new MeshLambertMaterial({side:DoubleSide})\n            return\n        }\n        provider.assetsManager.getTexture(obj.asset).then(tex => {\n            provider.getLogger().log(\"loadded asset\",obj.asset)\n            provider.getLogger().log(tex)\n            if(!tex) provider.getLogger().error(\"error loading asset\",obj.asset)\n            const opts = {\n                side: DoubleSide,\n                map:tex\n            }\n            if(obj.transparent) {\n                opts.transparent = true\n                opts.alphaTest = 0.5\n            }\n            node.material = new MeshLambertMaterial(opts)\n        }).catch(err => {\n            provider.getLogger().error('error somwhere',err.message,err)\n        })\n    }\n\n}\n","import ObjectDef from './ObjectDef'\nimport {fetchGraphObject} from '../../syncgraph/utils'\nimport {OBJ_TYPES, PROP_DEFS} from '../Common'\nimport * as THREE from 'three'\nimport WebLayer3D from 'three-web-layer'\n\nexport default class TextDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create sphere w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.text,\n            title:'some text',\n            visible:true,\n            text:'cool <b>formatted</b> <i>text</i>',\n            cssStyle:\n`color:black; \nbackground-color:white;\nwidth: 10em;\nfont-size: 200%;\n`,\n\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n\n            children:graph.createArray(),\n            parent:scene.id\n        }))\n    }\n\n    makeNode(obj) {\n        const div = document.createElement('div')\n        div.innerHTML = obj.text\n        div.id = `div_${obj.id}`\n        div.classList.add('weblayer-div')\n        if(obj.cssStyle) div.setAttribute('style',obj.cssStyle)\n        const divLayer = new WebLayer3D(div,{\n            pixelRatio: window.devicePixelRatio,\n            onLayerCreate(layer) {\n                layer.mesh.material.side = THREE.DoubleSide\n                layer.mesh.userData.graphid = obj.id\n                layer.mesh.userData.clickable = true\n            }\n        })\n\n        divLayer.refresh(true)\n        divLayer.userData.clickable = true\n        const node = new THREE.Object3D()\n\n        node.previewUpdate = function() {\n            divLayer.update()\n        }        \n        node.setText = function (text) {\n            if (text !== node.userData.text) {\n                node.userData.text = text\n                node.userData.div.innerHTML = text\n                //if(obj.cssStyle) node.userData.div.setAttribute('style',obj.cssStyle)\n\n                // shouldn't be explicitly calling refresh\n                //node.userData.divLayer.refresh(true)\n            }\n        }\n\n        node.add(divLayer)\n        node.userData.divLayer = divLayer\n        node.userData.text = obj.text\n        node.userData.div = div\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        this.regenerateText(node,obj)\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        if(    op.name === PROP_DEFS.text.key) this.regenerateText(node,obj)\n        if(    op.name === PROP_DEFS.cssStyle.key) this.regenerateText(node,obj)\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n\n    regenerateText(node, obj) {\n        node.userData.div.innerHTML = obj.text\n        if(obj.cssStyle) node.userData.div.setAttribute('style',obj.cssStyle)\n        node.userData.divLayer.refresh(true)\n    }\n}\n\n\n\n","import {fetchGraphObject} from '../../syncgraph/utils'\nimport {NONE_ASSET, OBJ_TYPES, PROP_DEFS} from '../Common'\nimport * as THREE from 'three'\nimport ObjectDef from './ObjectDef'\n\nexport default class Image2DDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create Image2D with missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.img2d,\n            title:'image',\n            visible:true,\n            width:0.5,\n            ratio:1,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            asset:NONE_ASSET.id,\n            transparent:false,\n            parent:scene.id,\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new THREE.Mesh(\n            new THREE.PlaneBufferGeometry(obj.width, obj.width*obj.ratio),\n            new THREE.MeshLambertMaterial({color: 'white', side: THREE.DoubleSide})\n        )\n        node.name = obj.title\n        node.userData.clickable = true\n        // on(node,POINTER_CLICK,e =>SelectionManager.setSelection(node.userData.graphid))\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        this.attachAsset(node, obj, provider)\n        return node\n    }\n    updateProperty(node, obj, op, provider) {\n        if (op.name === PROP_DEFS.asset.key || op.name === PROP_DEFS.transparent.key) return this.attachAsset(node, obj, provider)\n        if( op.name === PROP_DEFS.width.key || op.name === 'ratio') {\n            node.geometry = new THREE.PlaneBufferGeometry(obj.width, obj.width*(1/obj.ratio))\n            return\n        }\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport {Group} from 'three'\nimport ObjectDef from './ObjectDef'\nimport {OBJ_TYPES} from '../Common'\n\nlet COUNTER = 0\n\nexport default class GroupDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create cube w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.group,\n            title:'group '+COUNTER++,\n            visible:true,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#00ff00',\n            children:graph.createArray(),\n            parent:scene.id\n        }))\n    }\n    makeNode(obj) {\n        const node = new Group()\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n}\n","import {\n    BufferAttribute,\n    BufferGeometry,\n    CanvasTexture,\n    Color,\n    NormalBlending,\n    Object3D,\n    Points,\n    RepeatWrapping,\n    ShaderMaterial,\n    Vector3\n} from 'three'\n\n/*\n* modified from the version from the ThreeJS examples repo\n */\n\nconst GPUParticleShader = {\n\n    vertexShader:\n        `\n                uniform float uTime;\n                uniform float uScale;\n                uniform bool reverseTime;\n                uniform float fadeIn;\n                uniform float fadeOut;\n    \n                attribute vec3 positionStart;\n                attribute float startTime;\n                attribute vec3 velocity;\n                attribute vec3 acceleration;\n                attribute vec3 color;\n                attribute vec3 endColor;\n                attribute float size;\n                attribute float lifeTime;\n    \n                varying vec4 vColor;\n                varying vec4 vEndColor;\n                varying float lifeLeft;\n                varying float alpha;\n    \n                void main() {\n                    vColor = vec4( color, 1.0 );\n                    vEndColor = vec4( endColor, 1.0);\n                    vec3 newPosition;\n                    float timeElapsed = uTime - startTime;\n                    if(reverseTime) timeElapsed = lifeTime - timeElapsed;\n                    if(timeElapsed < fadeIn) {\n                        alpha = timeElapsed/fadeIn;\n                    }\n                    if(timeElapsed >= fadeIn && timeElapsed <= (lifeTime - fadeOut)) {\n                        alpha = 1.0;\n                    }\n                    if(timeElapsed > (lifeTime - fadeOut)) {\n                        alpha = 1.0 - (timeElapsed - (lifeTime-fadeOut))/fadeOut;\n                    }\n                    \n                    lifeLeft = 1.0 - ( timeElapsed / lifeTime );\n                    gl_PointSize = ( uScale * size );// * lifeLeft;\n                    newPosition = positionStart \n                        + (velocity * timeElapsed)\n                        + (acceleration * 0.5 * timeElapsed * timeElapsed)\n                        ;\n                    if (lifeLeft < 0.0) { \n                        lifeLeft = 0.0; \n                        gl_PointSize = 0.;\n                    }\n                    //while active use the new position\n                    if( timeElapsed > 0.0 ) {\n                        gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );\n                    } else {\n                        //if dead use the initial position and set point size to 0\n                        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n                        lifeLeft = 0.0;\n                        gl_PointSize = 0.;\n                    }\n                }\n                `\n    ,\n\n    fragmentShader: `\n                varying vec4 vColor;\n                varying vec4 vEndColor;\n                varying float lifeLeft;\n                varying float alpha;\n                uniform sampler2D tSprite;\n                void main() {\n                    // color based on particle texture and the lifeLeft. \n                    // if lifeLeft is 0 then make invisible\n                    vec4 tex = texture2D( tSprite, gl_PointCoord );\n                    vec4 color = mix(vColor, vEndColor, 1.0-lifeLeft);\n                    gl_FragColor = vec4( color.rgb*tex.rgb, alpha * tex.a);\n                }\n    \n            `\n};\n\nconst UPDATEABLE_ATTRIBUTES = [\n    'positionStart', 'startTime',\n    'velocity', 'acceleration',\n    'color', 'endColor',\n    'size', 'lifeTime']\n\nexport default class GPUParticles extends Object3D {\n    constructor(options) {\n        super()\n        options = options || {};\n\n\n        this.blending = options.blending? options.blending : NormalBlending\n        this.PARTICLE_COUNT = options.maxParticles || 1000000;\n        this.PARTICLE_CURSOR = 0;\n        this.time = 0;\n        this.offset = 0;\n        this.count = 0;\n        this.DPR = window.devicePixelRatio;\n        this.particleUpdate = false;\n        this.onTick = options.onTick\n\n        this.reverseTime = options.reverseTime\n        this.fadeIn = options.fadeIn || 1\n        if(this.fadeIn === 0) this.fadeIn = 0.001\n        this.fadeOut = options.fadeOut || 1\n        if(this.fadeOut === 0) this.fadeOut = 0.001\n\n        // preload a 10_000 random numbers from -0.5 to 0.5\n        this.rand = [];\n        let i;\n        for (i = 1e5; i>0; i--) {\n            this.rand.push( Math.random() - 0.5 );\n        }\n        this.i = i\n\n        //setup the texture\n        this.sprite = options.particleSpriteTex || null;\n        if(!this.sprite) {\n            const can = document.createElement('canvas')\n            can.width = 16\n            can.height = 16\n            const ctx = can.getContext('2d')\n            ctx.fillStyle = 'black'\n            ctx.fillRect(0,0,can.width,can.height)\n            ctx.fillStyle = 'rgba(255,255,255,0.5)'\n            ctx.beginPath()\n            ctx.arc(8,8,8,0,Math.PI*2)\n            ctx.fill()\n            this.sprite = new CanvasTexture(can)\n        }\n        this.sprite.wrapS = this.sprite.wrapT = RepeatWrapping;\n\n        //setup the shader material\n        this.material = new ShaderMaterial( {\n            transparent: true,\n            depthWrite: false,\n            uniforms: {\n                'uTime': {\n                    value: 0.0\n                },\n                'uScale': {\n                    value: 1.0\n                },\n                'tSprite': {\n                    value: this.sprite\n                },\n                reverseTime: {\n                    value: this.reverseTime\n                },\n                fadeIn: {\n                    value: this.fadeIn\n                },\n                fadeOut: {\n                    value: this.fadeOut,\n                }\n            },\n            blending: this.blending,\n            vertexShader: GPUParticleShader.vertexShader,\n            fragmentShader: GPUParticleShader.fragmentShader\n        } );\n\n        // define defaults for all values\n        this.material.defaultAttributeValues.particlePositionsStartTime = [ 0, 0, 0, 0 ];\n        this.material.defaultAttributeValues.particleVelColSizeLife = [ 0, 0, 0, 0 ];\n\n\n        // geometry\n        this.geometry = new BufferGeometry();\n\n        //vec3 attributes\n        this.geometry.addAttribute('position',      new BufferAttribute(new Float32Array(this.PARTICLE_COUNT * 3), 3).setDynamic(true));\n        this.geometry.addAttribute('positionStart', new BufferAttribute(new Float32Array(this.PARTICLE_COUNT * 3), 3).setDynamic(true));\n        this.geometry.addAttribute('velocity',      new BufferAttribute(new Float32Array(this.PARTICLE_COUNT * 3), 3).setDynamic(true));\n        this.geometry.addAttribute('acceleration',  new BufferAttribute(new Float32Array(this.PARTICLE_COUNT * 3), 3).setDynamic(true));\n        this.geometry.addAttribute('color',         new BufferAttribute(new Float32Array(this.PARTICLE_COUNT * 3), 3).setDynamic(true));\n        this.geometry.addAttribute('endColor',      new BufferAttribute(new Float32Array(this.PARTICLE_COUNT * 3), 3).setDynamic(true));\n\n        //scalar attributes\n        this.geometry.addAttribute('startTime',     new BufferAttribute(new Float32Array(this.PARTICLE_COUNT), 1).setDynamic(true));\n        this.geometry.addAttribute('size',          new BufferAttribute(new Float32Array(this.PARTICLE_COUNT), 1).setDynamic(true));\n        this.geometry.addAttribute('lifeTime',      new BufferAttribute(new Float32Array(this.PARTICLE_COUNT), 1).setDynamic(true));\n\n\n        this.particleSystem = new Points(this.geometry, this.material);\n        this.particleSystem.frustumCulled = false;\n        this.add(this.particleSystem);\n    }\n\n    /*\n      This updates the geometry on the shader if at least one particle has been spawned.\n      It uses the offset and the count to determine which part of the data needs to actually\n      be sent to the GPU. This ensures no more data than necessary is sent.\n     */\n    geometryUpdate () {\n        if (this.particleUpdate === true) {\n            this.particleUpdate = false;\n            UPDATEABLE_ATTRIBUTES.forEach(name => {\n                const attr = this.geometry.getAttribute(name)\n                if (this.offset + this.count < this.PARTICLE_COUNT) {\n                    attr.updateRange.offset = this.offset * attr.itemSize\n                    attr.updateRange.count = this.count * attr.itemSize\n                } else {\n                    attr.updateRange.offset = 0\n                    attr.updateRange.count = -1\n                }\n                attr.needsUpdate = true\n            })\n            this.offset = 0;\n            this.count = 0;\n        }\n    }\n\n\n    //use one of the random numbers\n    random () {\n        return ++ this.i >= this.rand.length ? this.rand[ this.i = 1 ] : this.rand[ this.i ];\n    }\n\n    update ( ttime ) {\n        this.time = ttime/1000\n        this.material.uniforms.uTime.value = this.time;\n        if(this.onTick) this.onTick(this,this.time)\n        this.geometryUpdate();\n    }\n\n    dispose () {\n        this.material.dispose();\n        this.sprite.dispose();\n        this.geometry.dispose();\n    }\n\n    updateSprite(sprite) {\n        if(sprite) {\n            const old = this.sprite\n            this.sprite = sprite\n            this.sprite.wrapS = this.sprite.wrapT = RepeatWrapping;\n            this.material.uniforms.tSprite.value = sprite\n            if(old) old.dispose()\n        }\n    }\n\n    /* spawn a particle\n\n    This works by updating values inside of\n    the attribute arrays, then updates the count and the PARTICLE_CURSOR and\n    sets particleUpdate to true.\n\n    This if spawnParticle is called three times in a row before rendering,\n    then count will be 3 and the cursor will have moved by three.\n     */\n    spawnParticle ( options ) {\n        // console.log('spawnparticle')\n        let position = new Vector3()\n        let velocity = new Vector3()\n        let acceleration = new Vector3()\n        let color = new Color()\n        let endColor = new Color()\n\n        const positionStartAttribute = this.geometry.getAttribute('positionStart')\n        const startTimeAttribute = this.geometry.getAttribute('startTime')\n        const velocityAttribute = this.geometry.getAttribute('velocity')\n        const accelerationAttribute = this.geometry.getAttribute('acceleration')\n        const colorAttribute = this.geometry.getAttribute('color')\n        const endcolorAttribute = this.geometry.getAttribute('endColor')\n        const sizeAttribute = this.geometry.getAttribute('size')\n        const lifeTimeAttribute = this.geometry.getAttribute('lifeTime')\n\n        options = options || {};\n\n        // setup reasonable default values for all arguments\n\n        position = options.position !== undefined ? position.copy(options.position) : position.set(0, 0, 0);\n        velocity = options.velocity !== undefined ? velocity.copy(options.velocity) : velocity.set(0, 0, 0);\n        acceleration = options.acceleration !== undefined ? acceleration.copy(options.acceleration) : acceleration.set(0, 0, 0);\n        color = options.color !== undefined ? color.copy(options.color) : color.set(0xffffff);\n        endColor = options.endColor !== undefined ? endColor.copy(options.endColor) : endColor.copy(color)\n\n        const lifetime = options.lifetime !== undefined ? options.lifetime : 5\n        let size = options.size !== undefined ? options.size : 10\n        const sizeRandomness = options.sizeRandomness !== undefined ? options.sizeRandomness : 0\n\n        if (this.DPR !== undefined) size *= this.DPR;\n\n        const i = this.PARTICLE_CURSOR\n\n        // position\n        positionStartAttribute.array[i * 3 + 0] = position.x\n        positionStartAttribute.array[i * 3 + 1] = position.y\n        positionStartAttribute.array[i * 3 + 2] = position.z\n\n        velocityAttribute.array[i * 3 + 0] = velocity.x;\n        velocityAttribute.array[i * 3 + 1] = velocity.y;\n        velocityAttribute.array[i * 3 + 2] = velocity.z;\n\n        accelerationAttribute.array[i * 3 + 0] = acceleration.x;\n        accelerationAttribute.array[i * 3 + 1] = acceleration.y;\n        accelerationAttribute.array[i * 3 + 2] = acceleration.z;\n\n        colorAttribute.array[i * 3 + 0] = color.r;\n        colorAttribute.array[i * 3 + 1] = color.g;\n        colorAttribute.array[i * 3 + 2] = color.b;\n\n        endcolorAttribute.array[i * 3 + 0] = endColor.r;\n        endcolorAttribute.array[i * 3 + 1] = endColor.g;\n        endcolorAttribute.array[i * 3 + 2] = endColor.b;\n\n        //size, lifetime and starttime\n        sizeAttribute.array[i] = size + this.random() * sizeRandomness;\n        lifeTimeAttribute.array[i] = lifetime;\n        startTimeAttribute.array[i] = this.time + this.random() * 2e-2;\n\n        // offset\n        if (this.offset === 0) this.offset = this.PARTICLE_CURSOR;\n        // counter and cursor\n        this.count++;\n        this.PARTICLE_CURSOR++;\n        //wrap the cursor around\n        if (this.PARTICLE_CURSOR >= this.PARTICLE_COUNT) this.PARTICLE_CURSOR = 0;\n        this.particleUpdate = true;\n    };\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport {AdditiveBlending, Color, TextureLoader, Vector3} from 'three'\nimport ObjectDef from './ObjectDef'\nimport {NONE_ASSET, OBJ_TYPES, PROP_DEFS} from '../Common'\nimport GPUParticles from './GPUParticles'\n\nexport const rand = (min,max) => Math.random()*(max-min) + min\n\nlet COUNTER = 0\n\nexport default class ParticlesDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create cube w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.particles,\n            title:'particles '+COUNTER++,\n            visible:true,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            children:graph.createArray(),\n            pointSize:10.0,\n            lifetime:3.0,\n            startColor:'#ff0000',\n            endColor:'#0000ff',\n            parent:scene.id,\n            texture:NONE_ASSET.id,\n        }))\n    }\n    makeNode(obj, provider) {\n        const options = {\n            velocity: new Vector3(0,1,0),\n            position: new Vector3(0,0,0),\n            size:obj.pointSize,\n            lifetime:obj.lifetime,\n            color: new Color(1.0,0.0,1.0),\n            endColor: new Color(0,1,1),\n        }\n\n        const node = new GPUParticles({\n            maxParticles: 10000,\n            position: new Vector3(0,0,0),\n            positionRandomness: 0.0,\n            baseVelocity: new Vector3(0.0, 0.0, -1),\n            velocity: new Vector3(0.0, 0.0, 0.0),\n            velocityRandomness: 1.0,\n            acceleration: new Vector3(0,0.0,0),\n            baseColor: new Color(1.0,1.0,0.5),\n            color: new Color(1.0,0,0),\n            colorRandomness: 0.5,\n            lifetime: 3,\n            size: 10,\n            sizeRandomness: 1.0,\n            blending: AdditiveBlending,\n            onTick: (system, time) => {\n                options.velocity.set(rand(-1,1),1,rand(-1,1))\n                system.spawnParticle(options);\n            }\n        })\n        node.tick = function(evt) {\n            node.update(evt.time)\n        }\n        this.attachTexture(node,obj,provider)\n        node.userData.options = options\n        node.name = obj.title\n        node.userData.clickable = false\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        if(op.name === PROP_DEFS.pointSize.key) return node.userData.options.size = obj.pointSize\n        if(op.name === PROP_DEFS.lifetime.key) return node.userData.options.lifetime = obj.lifetime\n        if(op.name === PROP_DEFS.startColor.key) return node.userData.options.color.set(obj.startColor)\n        if(op.name === PROP_DEFS.endColor.key) return node.userData.options.endColor.set(obj.endColor)\n        if(op.name === PROP_DEFS.texture.key) return this.attachTexture(node,obj,provider)\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n    attachTexture(node, obj, provider) {\n        if(obj.asset === NONE_ASSET.id) {\n            node.updateSprite(null)\n            return\n        }\n        const texture = provider.accessObject(obj.texture)\n        if(!texture.exists()) return\n        const url = provider.assetsManager.getAssetURL(texture)\n        provider.getLogger().log(\"ParticlesDef: loading the asset url\",url)\n        const tex = new TextureLoader().load(url)\n        node.updateSprite(tex)\n    }\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport ObjectDef from './ObjectDef'\nimport {OBJ_TYPES} from '../Common'\nimport * as THREE from 'three'\n\n//////////////////////////////////////////////////////////////////////\n// portal object itself\n//////////////////////////////////////////////////////////////////////\n\n//\n// Attach a copy shader to the Reflector which makes the texture present as a material to threejs\n// (this is done prior to allowing users to use the reflector itself)\n//\nlet THREEReflectorShader = {\n  uniforms: {\n    'color': {type: 'c',value: null},\n    'tDiffuse': {type: 't',value: null},\n    'textureMatrix': {type: 'm4',value: null}\n  },\n  vertexShader: [\n    'uniform mat4 textureMatrix;',\n    'varying vec4 vUv;',\n    'void main() {',\n    '   vUv = textureMatrix * vec4( position, 1.0 );',\n    '   gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',\n    '}'\n  ].join( '\\n' ),\n  fragmentShader: [\n    'uniform vec3 color;',\n    'uniform sampler2D tDiffuse;',\n    'varying vec4 vUv;',\n    'float blendOverlay( float base, float blend ) {',\n    '   return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );',\n    '}',\n    'vec3 blendOverlay( vec3 base, vec3 blend ) {',\n    '   return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );',\n    '}',\n    'void main() {',\n    '   vec4 base = texture2DProj( tDiffuse, vUv );',\n    '   gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );',\n    '}'\n  ].join( '\\n' )\n}\n\n//\n// Build a constructor that can be invoked later by user\n//\n\nclass THREEReflector extends THREE.Mesh {\n\n  constructor(options) {\n\n//  \tsuper()\n  \n    var childrenMode = options.childrenMode || 0\n    var color = ( options.color !== undefined ) ? new THREE.Color( options.color ) : new THREE.Color( 0xFFFFFF );\n    var clear = ( options.clear !== undefined ) ? new THREE.Color( options.clear ) : new THREE.Color( 0xFF0000 );\n    var textureWidth = options.textureWidth || 512;\n    var textureHeight = options.textureHeight || 512;\n    var clipBias = options.clipBias || 0;\n    var shader = THREEReflectorShader;\n    var recursion = options.recursion !== undefined ? options.recursion : 1;\n\n    // Build a few static variables to avoid thrashing memory at runtime\n    var reflectorPlane = new THREE.Plane();\n    var normal = new THREE.Vector3();\n    var reflectorWorldPosition = new THREE.Vector3();\n    var cameraWorldPosition = new THREE.Vector3();\n    var scratchMatrix = new THREE.Matrix4();\n    var lookAtPosition = new THREE.Vector3( 0, 0, - 1 );\n    var clipPlane = new THREE.Vector4();\n    var viewport = new THREE.Vector4();\n    var view = new THREE.Vector3();\n    var target = new THREE.Vector3();\n    var q = new THREE.Vector4();\n    var size = new THREE.Vector2();\n    var textureMatrix = new THREE.Matrix4();\n    var virtualCamera = new THREE.PerspectiveCamera();\n\n    // Build a texture to render into\n    var parameters = {\n      minFilter: THREE.LinearFilter,\n      magFilter: THREE.LinearFilter,\n      format: THREE.RGBFormat,\n      stencilBuffer: false\n    }\n    var renderTarget = new THREE.WebGLRenderTarget(\n      textureWidth,\n      textureHeight,\n      parameters\n    )\n    if ( ! THREE.Math.isPowerOfTwo( textureWidth ) || ! THREE.Math.isPowerOfTwo( textureHeight ) ) {\n      renderTarget.texture.generateMipmaps = false;\n    }\n\n    // After the target texture is rendered it needs to pretend it is a material so threejs can paint it\n    var material = new THREE.ShaderMaterial( {\n      side: THREE.DoubleSide,\n      uniforms: THREE.UniformsUtils.clone( shader.uniforms ),\n      fragmentShader: shader.fragmentShader,\n      vertexShader: shader.vertexShader\n    } );\n    material.uniforms[ \"tDiffuse\" ].value = renderTarget.texture;\n    material.uniforms[ \"color\" ].value = color;\n    material.uniforms[ \"textureMatrix\" ].value = textureMatrix;\n\n    let geometry = new THREE.PlaneBufferGeometry(options.width, options.height)\n\n    // make a mesh\n    super(geometry,material) //let mesh = new THREE.Mesh(geometry,material)\n\n    // Have a private scene\n    let privateScene = new THREE.Scene()\n    let privateLight1 = new THREE.PointLight(0xffffff, 1, 1000); privateLight1.intensity = 2\n    let privateLight2 = new THREE.DirectionalLight()\n    privateScene.add(privateLight1)\n    privateScene.add(privateLight2) \n\n    // Rebuild the texture of the portal every frame\n    let group = this\n    let scope = this\n\n    scope.renderer = scope.camera = 0\n\n    scope.onBeforeRender = function(renderer,parent,camera) {\n    \tscope.renderer = renderer\n    \tscope.camera = camera\n    }\n\n    scope.repaint = function() {\n\n    \tlet renderer = scope.renderer\n    \tlet camera = scope.camera\n    \tif(!renderer || !camera) return\n\n        // number of bounces - may be less useful for portals than mirrors?\n        if ( 'recursion' in camera.userData ) {\n          if ( camera.userData.recursion === recursion ) return;\n          camera.userData.recursion ++;\n        }\n\n        // find positions and vector between\n        reflectorWorldPosition.setFromMatrixPosition( scope.matrixWorld )\n        cameraWorldPosition.setFromMatrixPosition( camera.matrixWorld )\n        view.subVectors( reflectorWorldPosition, cameraWorldPosition )\n\n        // get a normal for the direction of the portal based on where we are\n        scratchMatrix.extractRotation( scope.matrixWorld )\n        let portalDirection = view.dot(normal)<0 ? 1 : -1\n        normal.set( 0, 0, portalDirection )\n        normal.applyMatrix4( scratchMatrix )\n\n        // get a clone of the current camera as a scratch space\n        // TODO slightly wasteful of CPU\n        virtualCamera = camera.clone()\n\n        // transform the camera to be relative to the portals pose in the exterior world\n        let portalInverse = scratchMatrix.getInverse(scope.matrixWorld)\n        virtualCamera.applyMatrix(portalInverse)\n\n        // clear this for some reason?\n        virtualCamera.userData.recursion = 0;\n      \n        // Update the texture matrix\n        textureMatrix.set(\n          0.5, 0.0, 0.0, 0.5,\n          0.0, 0.5, 0.0, 0.5,\n          0.0, 0.0, 0.5, 0.5,\n          0.0, 0.0, 0.0, 1.0\n        );\n        textureMatrix.multiply( virtualCamera.projectionMatrix )\n        textureMatrix.multiply( virtualCamera.matrixWorldInverse )\n        textureMatrix.multiply( scope.matrixWorld )\n\n        //////////////////////////////////////////////////\n        // Now update projection matrix with new clip plane, implementing code from: http://www.terathon.com/code/oblique.html\n        // Paper explaining this technique: http://www.terathon.com/lengyel/Lengyel-Oblique.pdf\n        //////////////////////////////////////////////////\n\n        if(true) {\n            reflectorPlane.setFromNormalAndCoplanarPoint( normal, reflectorWorldPosition );\n            reflectorPlane.applyMatrix4( virtualCamera.matrixWorldInverse );\n\n            clipPlane.set( reflectorPlane.normal.x, reflectorPlane.normal.y, reflectorPlane.normal.z, reflectorPlane.constant );\n\n            var projectionMatrix = virtualCamera.projectionMatrix;\n\n            q.x = ( Math.sign( clipPlane.x ) + projectionMatrix.elements[ 8 ] ) / projectionMatrix.elements[ 0 ];\n            q.y = ( Math.sign( clipPlane.y ) + projectionMatrix.elements[ 9 ] ) / projectionMatrix.elements[ 5 ];\n            q.z = -1.0;\n            q.w = ( 1.0 + projectionMatrix.elements[ 10 ] ) / projectionMatrix.elements[ 14 ];\n\n            // Calculate the scaled plane vector\n            clipPlane.multiplyScalar( 2.0 / clipPlane.dot( q ) );\n\n            // Replacing the third row of the projection matrix\n            projectionMatrix.elements[ 2 ] = clipPlane.x;\n            projectionMatrix.elements[ 6 ] = clipPlane.y;\n            projectionMatrix.elements[ 10 ] = clipPlane.z + 1.0 - clipBias;\n            projectionMatrix.elements[ 14 ] = clipPlane.w;\n        }\n\n        // move other children to a private scene for painting to portal texture\n        group.children.slice().forEach(child=>{\n        \tgroup.remove(child)\n        \tprivateScene.add(child)\n        \tchild.visible = true\n        })\n\n        // Render to the texture\n        {\n            // Save renderer state\n            let currentRenderTarget = renderer.getRenderTarget();\n            let currentVrEnabled = renderer.vr.enabled;\n            let currentShadowAutoUpdate = renderer.shadowMap.autoUpdate;\n            let currentClearColor = renderer.getClearColor()\n            let currentClearAlpha = renderer.getClearAlpha()\n\n            // Render to buffer\n            renderer.vr.enabled = false; // Avoid camera modification and recursion\n            renderer.shadowMap.autoUpdate = false; // Avoid re-computing shadows\n            renderer.setRenderTarget( renderTarget )\n            renderer.setClearColor(clear)\n            renderer.setClearAlpha(0)\n            renderer.clear()\n            renderer.render( privateScene, virtualCamera )\n\n            // Restore renderer settings\n            renderer.setClearColor(currentClearColor,currentClearAlpha)\n            renderer.setClearAlpha(currentClearAlpha)\n            renderer.vr.enabled = currentVrEnabled\n            renderer.shadowMap.autoUpdate = currentShadowAutoUpdate\n            renderer.setRenderTarget( currentRenderTarget )\n        }\n\n        // move children back into this group and make them invisible\n        privateScene.children.slice().forEach(child=>{\n        \tprivateScene.remove(child)\n        \tgroup.add(child)\n        \tchild.visible = false\n        })\n\n        // restore viewport\n        var bounds = camera.bounds;\n        if ( bounds !== undefined ) {\n          renderer.getSize( size );\n          var pixelRatio = renderer.getPixelRatio();\n          viewport.x = bounds.x * size.width * pixelRatio;\n          viewport.y = bounds.y * size.height * pixelRatio;\n          viewport.z = bounds.z * size.width * pixelRatio;\n          viewport.w = bounds.w * size.height * pixelRatio;\n          renderer.state.viewport( viewport );\n        }\n\n    }\n\n  }\n\n}\n\n/////////////////////////////////////////////////\n// app logic to manage it\n/////////////////////////////////////////////////\n\nlet COUNTER = 0\n\nexport default class PortalDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create portal w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.portal,\n            title:'portal '+COUNTER++,\n            visible:true,\n            width:1, height:2, depth:0.1,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            clipBias: 0.001,\n            recursion: 1,\n            textureWidth: 512,\n            textureHeight: 512,\n            color:'#00ffff',\n            clear:'#ff0000',\n            children:graph.createArray(),\n            transparent:false,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n    \tlet node = new THREEReflector({\n          width: obj.width || 1,\n          height: obj.height || 1,\n          clipBias: 0.001,\n          textureWidth: 512,\n          textureHeight: 512,\n          color: obj.color || \"purple\",\n          clear: obj.clear || \"red\",\n          recursion: 1,\n        })\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        node.tick = function(evt) {\n            node.repaint()\n        }\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n    \t// TODO TBD\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport {Group, Mesh, MeshLambertMaterial, SphereBufferGeometry} from 'three'\nimport ObjectDef from './ObjectDef'\nimport {OBJ_TYPES, REC_TYPES} from '../Common'\n\nlet COUNTER = 0\n\nexport default class LocalAnchorDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't localanchor w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.localanchor,\n            title:'localanchor '+COUNTER++,\n            visible:true,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#00ff00',\n            children:graph.createArray(),\n            recType:REC_TYPES.SCENE_START,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new Group()\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = true\n\n        const clicker =  new Mesh(\n            new SphereBufferGeometry(1),\n            new MeshLambertMaterial({color:\"green\", transparent:true, opacity: 0.2})\n        )\n        clicker.material.visible = true\n        clicker.userData.clickable = true\n        node.userData.clicker = clicker\n        node.add(clicker)\n\n        node.enter = (evt, scriptManager) => {\n            clicker.visible = false\n            node.visible = true\n            node.userData.info = {\n                recType: obj.recType,\n                object: obj,\n                node: node,\n                callback: (info) => {\n                    node.visible = true\n                }\n            }\n            scriptManager.sgp.startLocalAnchor(node.userData.info)\n        }\n        node.exit = (evt, scriptManager) => {\n            clicker.visible = true\n            scriptManager.sgp.stopLocalAnchor(node.userData.info)\n        }\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport {Group, Mesh, MeshLambertMaterial, SphereBufferGeometry, PlaneBufferGeometry, TextureLoader, DoubleSide} from 'three'\nimport ObjectDef from './ObjectDef'\nimport {OBJ_TYPES, REC_TYPES, PROP_DEFS, toRad} from '../Common'\n\nlet COUNTER = 0\n\nexport default class ImageAnchorDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't imageanchor w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.imageanchor,\n            title:'image anchor '+COUNTER++,\n            visible:true,\n            reactivate: false,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#00ff00',\n            children:graph.createArray(),\n            targetImage:null,\n            imageRealworldWidth:1,\n            recType:REC_TYPES.SCENE_START,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new Group()\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n\n        const clicker =  new Mesh(\n            new SphereBufferGeometry(1),\n            new MeshLambertMaterial({color:\"red\", transparent:true, opacity: 0.2})\n        )\n        clicker.material.visible = true\n        clicker.userData.clickable = true\n        node.userData.clicker = clicker\n        node.add(clicker)\n\n        const preview = new Mesh(\n            new PlaneBufferGeometry(1,1),\n            new MeshLambertMaterial({color:'white',transparent:true, opacity: 0.5, side: DoubleSide})\n        )\n        preview.rotation.x = toRad(90)\n        node.add(preview)\n        node.userData.preview = preview\n        this.updateImagePreview(node,obj,provider)\n\n        node.enter = (evt, scriptManager) => {\n            clicker.visible = false\n            node.visible = false\n            preview.visible = false\n            node.userData.info = {\n                image: scriptManager.sgp.getGraphObjectById(obj.targetImage),\n                imageRealworldWidth: obj.imageRealworldWidth,\n                reactivate: obj.reactivate,\n                recType: obj.recType,\n                object: obj,\n                node: node,\n                callback: (info) => {\n                    scriptManager.fireEventAtTarget(obj, 'recognized', info)\n                    node.visible = true\n                }\n            }\n            scriptManager.sgp.startImageRecognizer(node.userData.info)\n        }\n        node.exit = (evt, scriptManager) => {\n            clicker.visible = true\n            preview.visible = true\n            scriptManager.sgp.stopImageRecognizer(node.userData.info)\n        }\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        if(op.name === PROP_DEFS.targetImage.key) {\n            return this.updateImagePreview(node,obj,provider)\n        }\n        if(op.name === PROP_DEFS.imageRealworldWidth.key) {\n            return this.updateImagePreview(node,obj,provider)\n        }\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n    updateImagePreview(node,obj,provider) {\n        const targetImage = provider.accessObject(obj.targetImage)\n        if(targetImage.exists()) {\n            const url = provider.assetsManager.getAssetURL(targetImage)\n            provider.getLogger().log(\"ImageAnchor loading the asset url\",url)\n            const tex = new TextureLoader().load(url)\n            node.userData.preview.material = new MeshLambertMaterial({color:'white',transparent:true, opacity:0.5, side:DoubleSide, map:tex})\n            let height = (targetImage.height / targetImage.width)\n            let width = 1\n            node.userData.preview.geometry = new PlaneBufferGeometry(width,height)\n            //console.log(obj)\n            let scale = obj.imageRealworldWidth\n            node.userData.preview.scale.set(scale,scale,scale)\n        }\n        if(provider.accessObject(obj.targetImage).exists()) {\n            node.userData.preview.visible = true\n            node.userData.clicker.visible = false\n        } else {\n            node.userData.preview.visible = false\n            node.userData.clicker.visible = true\n        }\n    }\n\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport {Group, Mesh, MeshLambertMaterial, SphereBufferGeometry} from 'three'\nimport ObjectDef from './ObjectDef'\nimport {OBJ_TYPES, REC_TYPES} from '../Common'\nlet COUNTER = 0\n\nexport default class GeoAnchorDef extends ObjectDef {\n    make(graph, scene) {\n        if (!scene.id) throw new Error(\"can't create geo anchor w/ missing parent\")\n        return fetchGraphObject(graph, graph.createObject({\n            type: OBJ_TYPES.geoanchor,\n            title: 'geo anchor ' + COUNTER++,\n            visible: true,\n            tx: 0, ty: 0, tz: 0,\n            rx: 0, ry: 0, rz: 0,\n            sx: 1, sy: 1, sz: 1,\n            color: '#00ff00',\n            children: graph.createArray(),\n            targetGeoLocation: null,\n            recType: REC_TYPES.SCENE_START,\n            parent: scene.id\n        }))\n    }\n    makeNode(obj) {\n        const node = new Group()\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n\n        const clicker =  new Mesh(\n            new SphereBufferGeometry(1),\n            new MeshLambertMaterial({color:\"red\", transparent:true, opacity: 0.2})\n        )\n        clicker.material.visible = true\n        clicker.userData.clickable = true\n        node.userData.clicker = clicker\n        node.add(clicker)\n        node.enter = (evt, scriptManager) => {\n            clicker.visible = false\n            node.visible = false\n            node.userData.info = {\n                location:scriptManager.sgp.getGraphObjectById(obj.targetGeoLocation),\n                recType:obj.recType,\n                object:obj,\n                node:node,\n                callback:(info) => {\n                    scriptManager.fireEventAtTarget(obj, 'localized', info)\n                    node.visible = true\n                }\n            }\n            scriptManager.sgp.startGeoTracker(node.userData.info)\n        }\n        node.exit = (evt, scriptManager) => {\n            clicker.visible = true\n            scriptManager.sgp.stopGeoTracker(node.userData.info)\n        }\n        return node\n    }\n}","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport {Group, Mesh, MeshLambertMaterial, SphereBufferGeometry} from 'three'\nimport ObjectDef from './ObjectDef'\nimport {OBJ_TYPES} from '../Common'\n\nlet COUNTER = 0\n\nexport class HudAnchorDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't add hudanchor w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.hudanchor,\n            title:'hud anchor '+COUNTER++,\n            visible:true,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            children:graph.createArray(),\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new Group()\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n\n        const clicker =  new Mesh(\n            new SphereBufferGeometry(1),\n            new MeshLambertMaterial({color:\"red\", transparent:true, opacity: 0.2})\n        )\n        clicker.material.visible = true\n        clicker.userData.clickable = true\n        node.userData.clicker = clicker\n        node.add(clicker)\n\n        node.enter = (evt,scriptManager) => {\n            node.parent.remove(node)\n            node.position.z = 0\n            clicker.visible = false\n            scriptManager.sgp.getCamera().add(node)\n        }\n        node.exit = (evt,scriptManager) => {\n            scriptManager.sgp.getCamera().remove(node)\n            clicker.visible = true\n            const scene = scriptManager.sgp.getThreeObject(obj.parent)\n            scene.add(node)\n            node.position.set(obj.tx, obj.ty, obj.tz)\n            node.rotation.set(obj.rx,obj.ry,obj.rz)\n            node.scale.set(obj.sx,obj.sy,obj.sz)\n        }\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        return super.updateProperty(node,obj,op,provider)\n    }\n}\n","import ObjectDef from './ObjectDef'\nimport {NONE_ASSET, OBJ_TYPES} from '../Common'\nimport {fetchGraphObject} from '../../syncgraph/utils'\nimport * as THREE from 'three'\nimport {MeshLambertMaterial} from 'three'\n\nlet COUNTER = 0\n\n\nexport default class CloneDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create cube w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.clone,\n            title:'clone '+COUNTER++,\n            visible:true,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            children:graph.createArray(),\n            cloneTarget:NONE_ASSET.id,\n            parent:scene.id\n        }))\n    }\n\n    makeNode(obj,provider) {\n        const node = new THREE.Group()\n        node.name = obj.title\n        const clicker = new THREE.Mesh(\n            new THREE.SphereBufferGeometry(1),\n            new MeshLambertMaterial({color: \"red\", transparent: true, opacity: 0.2})\n        )\n        clicker.material.visible = true\n        clicker.userData.clickable = true\n        node.userData.clicker = clicker\n        node.add(node.userData.clicker)\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx, obj.ry, obj.rz)\n        node.scale.set(obj.sx, obj.sy, obj.sz)\n        node.visible = obj.visible\n        node.enter = (evt, scriptManager) => {\n            clicker.visible = false\n            const cloneTarget = scriptManager.sgp.getGraphObjectById(obj.cloneTarget)\n            const cloneNode = scriptManager.sgp.getThreeObject(cloneTarget)\n            const theClone = cloneNode.clone()\n            node.add(theClone)\n            node.userData.theClone = theClone\n            node.userData.cloneTarget = cloneTarget\n\n            if(node.userData.theClone.enter) node.userData.theClone.enter(evt,scriptManager)\n            node.userData.cloneTarget.find(child => scriptManager.fireSceneLifecycleEventAtChild('enter',evt,child,obj.id))\n        }\n        node.tick  = (evt,scriptManager) => {\n            if(node.userData.theClone.tick) node.userData.theClone.tick(evt,scriptManager)\n            node.userData.cloneTarget.find(child => scriptManager.fireSceneLifecycleEventAtChild('tick',evt,child,obj.id))\n        }\n        node.exit = (evt,scriptManager) => {\n            if(node.userData.theClone.exit) node.userData.theClone.exit(evt,scriptManager)\n            node.userData.cloneTarget.find(child => scriptManager.fireSceneLifecycleEventAtChild('exit',evt,child,obj.id))\n\n            clicker.visible = true\n            node.remove(node.userData.theClone)\n            node.userData.theClone = null\n        }\n        return node\n    }\n\n}\n","import {PROP_TYPES} from 'react-visual-editor-framework'\nimport CubeDef from './defs/CubeDef'\nimport SphereDef from './defs/SphereDef'\nimport PlaneDef from './defs/PlaneDef'\nimport ModelDef from './defs/ModelDef'\nimport BG360Def from './defs/BG360Def'\nimport TextDef from './defs/TextDef'\nimport Image2DDef from './defs/Image2DDef'\nimport GroupDef from './defs/GroupDef'\nimport ParticlesDef from './defs/ParticlesDef'\nimport PortalDef from './defs/PortalDef'\nimport LocalAnchorDef from './defs/LocalAnchorDef'\nimport ImageAnchorDef from './defs/ImageAnchorDef'\nimport GeoAnchorDef from './defs/GeoAnchorDef'\nimport {HudAnchorDef} from './defs/HudAnchorDef'\nimport CloneDef from './defs/CloneDef'\n\nexport const NONE_ASSET = {\n    id:-30,\n    title:'NONE'\n}\n\nconst stdhints = {\n    incrementValue:0.1,\n}\nexport const PROP_DEFS = {\n    title: {\n        key:'title',\n        name:'Title',\n        type:PROP_TYPES.STRING\n    },\n    description: {\n        key:'description',\n        name:'Description',\n        type:PROP_TYPES.STRING\n    },\n    width: {\n        key:'width',\n        name:'Width',\n        type:PROP_TYPES.NUMBER,\n        hints: stdhints\n    },\n    height: {\n        key:'height',\n        name:'Height',\n        type:PROP_TYPES.NUMBER,\n        hints: stdhints\n    },\n    depth: {\n        key:'depth',\n        name:'Depth',\n        type:PROP_TYPES.NUMBER,\n        hints: stdhints\n    },\n    radius: {\n        key:'radius',\n        name:'Radius',\n        type:PROP_TYPES.NUMBER,\n        hints: stdhints\n    },\n    tx: {\n        key:'tx',\n        name:'TX',\n        type:PROP_TYPES.NUMBER,\n        hints: stdhints\n    },\n    ty: {\n        key:'ty',\n        name:'TY',\n        type:PROP_TYPES.NUMBER,\n        hints: stdhints\n    },\n    tz: {\n        key:'tz',\n        name:'TZ',\n        type:PROP_TYPES.NUMBER,\n        hints: stdhints\n    },\n    rx: {\n        key:'rx',\n        name:'RX',\n        type:PROP_TYPES.NUMBER,\n        hints: stdhints\n    },\n    ry: {\n        key:'ry',\n        name:'RY',\n        type:PROP_TYPES.NUMBER,\n        hints: stdhints\n    },\n    rz: {\n        key:'rz',\n        name:'RZ',\n        type:PROP_TYPES.NUMBER,\n        hints: stdhints\n    },\n    sx: {\n        key:'sx',\n        name:'SX',\n        type:PROP_TYPES.NUMBER,\n        hints: stdhints\n    },\n    sy: {\n        key:'sy',\n        name:'SY',\n        type:PROP_TYPES.NUMBER,\n        hints: stdhints\n    },\n    sz: {\n        key:'sz',\n        name:'SZ',\n        type:PROP_TYPES.NUMBER,\n        hints: stdhints\n    },\n    color: {\n        key:'color',\n        name:'Color',\n        type:PROP_TYPES.COLOR,\n        custom:true,\n    },\n    defaultFloor: {\n        key:'defaultFloor',\n        name:'Default Floor',\n        type:PROP_TYPES.BOOLEAN\n    },\n    src: {\n        key:'src',\n        name:'src',\n        type:PROP_TYPES.STRING,\n        locked:true,\n    },\n    asset: {\n        key:'asset',\n        name:'asset',\n        type:PROP_TYPES.ENUM,\n    },\n    subtype: {\n        key:'subtype',\n        name:'kind',\n        type:PROP_TYPES.STRING,\n        locked:true,\n    },\n    format: {\n        key:'format',\n        name:'format',\n        type:PROP_TYPES.STRING,\n        locked:true,\n    },\n    imageOffsetAngle: {\n        key:'imageOffsetAngle',\n        name:'Image Offset Angle',\n        type:PROP_TYPES.NUMBER,\n        hints: {\n            incrementValue:0.05,\n        }\n    },\n    imageCropStartAngle: {\n        key:'imageCropStartAngle',\n        name:'Image Crop Start Angle',\n        type:PROP_TYPES.NUMBER,\n        hints: {\n            incrementValue:0.05,\n        }\n    },\n    imageCropEndAngle: {\n        key:'imageCropEndAngle',\n        name:'Image Crop End Angle',\n        type:PROP_TYPES.NUMBER,\n        hints: {\n            incrementValue:0.05,\n        }\n    },\n    transparent: {\n        key:'transparent',\n        name:\"Transparent\",\n        type:PROP_TYPES.BOOLEAN\n    },\n    imageRealworldWidth: {\n        key:'imageRealworldWidth',\n        name:'Image width in meters',\n        type: PROP_TYPES.NUMBER,\n        hints: {\n            incrementValue:0.01\n        }\n    },\n    recType: {\n        key:'recType',\n        name:'Recognition Type',\n        type: PROP_TYPES.ENUM,\n    },\n\n    targetImage: {\n        key:'targetImage',\n        name:'Image to Recognize',\n        type: PROP_TYPES.ENUM,\n    },\n\n    targetGeoLocation: {\n        key:'targetGeoLocation',\n        name:'Target Location',\n        type: PROP_TYPES.ENUM,\n    },\n\n    splashImage: {\n        key:'splashImage',\n        name:'Splash Image',\n        type: PROP_TYPES.ENUM,\n    },\n\n    text: {\n        key:'text',\n        name:'Text',\n        type:PROP_TYPES.STRING,\n        hints: {\n            multiline:true\n        }\n    },\n    fontSize: {\n        key:'fontSize',\n        name:'Font Size',\n        type:PROP_TYPES.NUMBER,\n    },\n    padding: {\n        key:'padding',\n        name:'Padding',\n        type:PROP_TYPES.NUMBER,\n    },\n    borderWidth: {\n        key:'borderWidth',\n        name:'Border width',\n        type:PROP_TYPES.NUMBER,\n    },\n    borderRadius: {\n        key:'borderRadius',\n        name:'Corner Size',\n        type:PROP_TYPES.NUMBER,\n    },\n    horizontalAlign: {\n        key:'horizontalAlign',\n        name:'H Align',\n        type:PROP_TYPES.ENUM,\n        locked:false,\n    },\n    textColor: {\n        key:'textColor',\n        name:'Text Color',\n        type:PROP_TYPES.COLOR,\n        custom:true,\n    },\n    backgroundColor: {\n        key:'backgroundColor',\n        name:'BG Color',\n        type:PROP_TYPES.COLOR,\n        custom:true,\n    },\n    borderColor: {\n        key:'borderColor',\n        name:'Border Color',\n        type:PROP_TYPES.COLOR,\n        custom:true,\n    },\n    startColor: {\n        key:'startColor',\n        name:'Start',\n        type:PROP_TYPES.COLOR,\n        custom:true,\n    },\n    endColor: {\n        key:'endColor',\n        name:'End',\n        type:PROP_TYPES.COLOR,\n        custom:true,\n    },\n    drawBackground: {\n        key:'drawBackground',\n        name:'BG?',\n        type:PROP_TYPES.BOOLEAN,\n    },\n    scriptBody: {\n        key:'scriptBody',\n        name:'code',\n        type:PROP_TYPES.STRING,\n        hints: {\n            multiline:true\n        }\n    },\n    defaultScene: {\n        key:'defaultScene',\n        name:'Start Scene',\n        type:PROP_TYPES.ENUM,\n    },\n    visible: {\n        key:'visible',\n        name:'Visible',\n        type:PROP_TYPES.BOOLEAN\n    },\n\n    reactivate: {\n        key: 'reactivate',\n        name: \"Reactivate Image Search\",\n        type: PROP_TYPES.BOOLEAN\n    },\n\n    pointSize: {\n        key:'pointSize',\n        name:'Point Size',\n        type:PROP_TYPES.NUMBER,\n    },\n    lifetime: {\n        key:'lifetime',\n        name:'Lifetime',\n        type:PROP_TYPES.NUMBER,\n        hints: stdhints,\n    },\n    texture: {\n        key:'texture',\n        name:'texture',\n        type:PROP_TYPES.ENUM,\n    },\n    cssStyle: {\n        key:'cssStyle',\n        name:'Style',\n        type:PROP_TYPES.STRING,\n        hints: {\n            multiline:true\n        }\n    },\n    latitude: {\n        key:'latitude',\n        name:\"Latitude\",\n        type:PROP_TYPES.NUMBER, //value in degrees\n    },\n    longitude: {\n        key:'longitude',\n        name:\"Longitude\",\n        type:PROP_TYPES.NUMBER, //value in degrees\n    },\n    altitude: {\n        key:'altitude',\n        name:\"altitude\",\n        type:PROP_TYPES.NUMBER, //value in meters\n    },\n    useAltitude: {\n        key:'useAltitude',\n        name:\"use altitude?\",\n        type:PROP_TYPES.BOOLEAN,\n    },\n    autoRecenter: {\n        key:'autoRecenter',\n        name:\"Recenter on Load\",\n        type:PROP_TYPES.BOOLEAN\n    },\n\n    cloneTarget: {\n        key:'cloneTarget',\n        name:'clone target',\n        type: PROP_TYPES.ENUM,\n    },\n}\n\nexport const SIMPLE_COLORS = [\"#ffffff\",\"#ff0000\",\"#ffff00\",\"#00ff00\",\"#00ffff\",\"#0000ff\",\"#ff00ff\",\"#000000\"]\n\nexport const OBJ_TYPES = {\n    cube:'cube',\n    sphere:'sphere',\n    plane:'plane',\n    model:'model',\n    bg360:'bg360',\n    text:'text',\n    img2d:'img2d',\n    group:'group',\n    particles:'particles',\n    portal:'portal',\n    localanchor:'localanchor',\n    imageanchor:'imageanchor',\n    geoanchor:'geoanchor',\n    hudanchor:'hudanchor',\n    clone:'clone',\n}\n\nexport const TOTAL_OBJ_TYPES = {\n    SCENE:'scene',\n    ASSET:'asset',\n    BEHAVIOR:'behavior',\n    BEHAVIOR_SCRIPT:'behavior_script',\n    ASSETS_LIST: 'assets',\n    BEHAVIORS_LIST: 'behaviors',\n    ROOT: 'root'\n}\nexport const HORIZONTAL_ALIGNMENT = {\n    LEFT:'LEFT',\n    CENTER:'CENTER',\n    RIGHT:'RIGHT',\n}\n\n\nexport function is3DObjectType(type) {\n    if(type === OBJ_TYPES.cube) return true\n    if(type === OBJ_TYPES.sphere) return true\n    if(type === OBJ_TYPES.plane) return true\n    if(type === OBJ_TYPES.model) return true\n    if(type === OBJ_TYPES.text) return true\n    if(type === OBJ_TYPES.bg360) return true\n    if(type === OBJ_TYPES.img2d) return true\n    if(type === OBJ_TYPES.group) return true\n    if(type === OBJ_TYPES.particles) return true\n    if(type === OBJ_TYPES.portal) return true\n    if(type === OBJ_TYPES.localanchor) return true\n    if(type === OBJ_TYPES.imageanchor) return true\n    if(type === OBJ_TYPES.geoanchor) return true\n    if(type === OBJ_TYPES.hudanchor) return true\n    if(type === OBJ_TYPES.clone) return true\n    return false\n}\n\nexport function canHaveShape(type) {\n    if(type === OBJ_TYPES.group) return true\n    if(type === OBJ_TYPES.portal) return true\n    if(type === OBJ_TYPES.localanchor) return true\n    if(type === OBJ_TYPES.imageanchor) return true\n    if(type === OBJ_TYPES.geoanchor) return true\n    if(type === OBJ_TYPES.hudanchor) return true\n    if(type === TOTAL_OBJ_TYPES.SCENE) return true\n    return false\n}\n\nexport function canHaveBehavior(type) {\n    if(is3DObjectType(type)) return true\n    if(type === TOTAL_OBJ_TYPES.SCENE) return true\n    return false\n}\n\nexport function canHaveScene(type) {\n    if(type === TOTAL_OBJ_TYPES.ROOT) return true\n    return false\n}\n\nexport function canBeDeleted(type) {\n    if(type === TOTAL_OBJ_TYPES.ROOT) return false\n    if(type === TOTAL_OBJ_TYPES.ASSETS_LIST) return false\n    if(type === TOTAL_OBJ_TYPES.BEHAVIORS_LIST) return false\n    return true\n}\n\nexport function get3DObjectDef(type) {\n    if(type === OBJ_TYPES.cube) return new CubeDef()\n    if(type === OBJ_TYPES.sphere) return new SphereDef()\n    if(type === OBJ_TYPES.plane) return new PlaneDef()\n    if(type === OBJ_TYPES.model) return new ModelDef()\n    if(type === OBJ_TYPES.bg360) return new BG360Def()\n    if(type === OBJ_TYPES.text) return new TextDef()\n    if(type === OBJ_TYPES.img2d) return new Image2DDef()\n    if(type === OBJ_TYPES.group) return new GroupDef()\n    if(type === OBJ_TYPES.particles) return new ParticlesDef()\n    if(type === OBJ_TYPES.portal) return new PortalDef()\n    if(type === OBJ_TYPES.localanchor) return new LocalAnchorDef()\n    if(type === OBJ_TYPES.imageanchor) return new ImageAnchorDef()\n    if(type === OBJ_TYPES.geoanchor) return new GeoAnchorDef()\n    if(type === OBJ_TYPES.hudanchor) return new HudAnchorDef()\n    if(type === OBJ_TYPES.clone) return new CloneDef()\n    throw new Error(`unknown 3d object type ${type}`)\n}\n\nexport const toRad = (degrees) => degrees*Math.PI/180\n\nexport const MIME_TYPES = {\n    PNG:'image/png',\n    JPEG:'image/jpeg',\n    GIF:'image/gif',\n    MP3: 'audio/mpeg',\n    AAC: 'audio/aac',\n    WAV:'audio/wav',\n    JAVASCRIPT: 'text/javascript',\n    GLB: 'model/gltf-binary',\n    MP4:'video/mp4',\n    MOV:'video/quicktime',\n}\nexport const ASSET_TYPES = {\n    BEHAVIOR:'behavior',\n    IMAGE:'image',\n    GLTF: 'gltf',\n    AUDIO:'audio',\n    VIDEO:'video',\n    GEOLOCATION: 'geolocation'\n}\nexport function isImageType(type) {\n    if (!type) return false\n    if (type.toLowerCase() === MIME_TYPES.PNG) return true\n    if (type.toLowerCase() === MIME_TYPES.JPEG) return true\n    if (type.toLowerCase() === MIME_TYPES.GIF) return true\n    return false;\n}\nexport function isAudioType(type) {\n    if(!type) return false\n    if(type.toLowerCase() === MIME_TYPES.MP3) return true\n    if(type.toLowerCase() === MIME_TYPES.AAC) return true\n    if(type.toLowerCase() === MIME_TYPES.WAV) return true\n    return false\n}\n\nexport function isVideoType(type) {\n    if(!type) return false\n    if(type.toLowerCase() === MIME_TYPES.MP4) return true\n    if(type.toLowerCase() === MIME_TYPES.MOV) return true\n    return false\n}\nexport function isGLTFType(type) {\n    if(!type) return false\n    if(type.toLowerCase() === MIME_TYPES.GLB) return true\n    return false\n}\n\n\nexport function isGLTFFile(file) {\n    if (!file) return false\n    console.log(\"looking at the file\", file, 'type', file.type, 'type')\n    if (!file.type || file.type === '' || file.type.length === 0) {\n        console.log(\"no mimetype. check extension\")\n        if (file.name.toLowerCase().indexOf(\".gltf\") > 0) return true\n        if (file.name.toLowerCase().indexOf(\".glb\") > 0) return true\n    }\n    if (file.type.toLowerCase() === 'image/gltf') return true\n    return false;\n}\n\nexport const ITEM_ICONS = {\n    plane: 'fa fa-plane',\n    cube: 'fa fa-square',\n    sphere: 'fa fa-circle',\n    model: 'fa fa-cube',\n    asset: 'fa fa-file',\n    assets: 'fa fa-archive',\n    behavior:'fab fa-superpowers',\n    behavior_script:'fab fa-superpowers',\n    scene: 'fa fa-globe',\n    bg360:'fa fa-image',\n    img2d:'fa fa-image',\n    image:'fa fa-file-image',\n    text:'fa fa-font',\n    audio:'fa fa-file-audio',\n    video:'fas fa-file-video',\n    group:'fa fa-object-group',\n    particles:'fa fa-certificate',\n    portal:'fa fa-object-group',\n    gltf:'fa fa-cube',\n    localanchor:'fa fa-anchor',\n    imageanchor:'fa fa-anchor',\n    geoanchor:'fa fa-globe',\n    geolocation:'fas fa-globe-americas',\n    hudanchor: 'fa fa-eye',\n\n    cut:'fa fa-cut',\n    copy:'fa fa-copy',\n    paste:'fa fa-paste',\n    delete:'fa fa-close'\n}\n\n\nexport function parseBehaviorScript(contents) {\n    // eslint-disable-next-line\n    return Function(`\"use strict\";\n    const toRadians = (deg) => Math.PI/180*deg; \n    return(${contents})`)();\n}\n\nexport const REC_TYPES = {\n    SCENE_START:'SCENE_START'\n}\n","import {createGraphObjectFromObject, fetchGraphObject} from \"../../syncgraph/utils\";\nimport {\n    Group,\n    Mesh,\n    MeshLambertMaterial,\n    PlaneBufferGeometry\n} from 'three'\nimport {OBJ_TYPES, PROP_DEFS} from '../Common'\n\nfunction isAnchorType(type) {\n    if(type === OBJ_TYPES.geoanchor) return true\n    if(type === OBJ_TYPES.localanchor) return true\n    if(type === OBJ_TYPES.imageanchor) return true\n    if(type === OBJ_TYPES.hudanchor) return true\n    return false\n}\n\nfunction generateUniqueTitle(prefix,count, root) {\n    const title = prefix + ' ' + count\n    const dup = root.getChildren().find(sc =>  sc.title === title)\n    if(dup) {\n        return generateUniqueTitle(prefix,count+1,root)\n    } else {\n        return title\n    }\n}\n\nexport default class SceneDef {\n    make(graph, root) {\n        if(!root.id) throw new Error(\"can't create scene w/ missing parent\")\n        let title = generateUniqueTitle('Scene ',0,root)\n        return fetchGraphObject(graph,createGraphObjectFromObject(graph,{\n            type:'scene',\n            title:title,\n            autoRecenter:true,\n            defaultFloor: false,\n            parent:root.id,\n            children:graph.createArray()\n        }))\n    }\n    makeNode(obj,provider) {\n        const scene = new Group()\n        scene.name = obj.title\n        this.setDefaultFloor(scene,obj.defaultFloor)\n        scene.start = () => {\n            scene.userData.sceneAnchor = new Group()\n            scene.userData.sceneAnchor.name = \"SceneAnchor\"\n            scene.children.slice().forEach(chNode => {\n                const chObj = provider.accessObject(chNode.userData.graphid)\n                if(!chObj.exists()) return\n                if(isAnchorType(chObj.type)) return\n                if(chObj.type === OBJ_TYPES.geoanchor) return\n                if(chObj.type === OBJ_TYPES.localanchor) return\n                if(chObj.type === OBJ_TYPES.imageanchor) return\n                if(chObj.type === OBJ_TYPES.hudanchor) return\n                scene.userData.sceneAnchor.add(chNode)\n            })\n            scene.add(scene.userData.sceneAnchor)\n        }\n        scene.stop = () => {\n            const toMove = scene.userData.sceneAnchor.children.slice()\n            toMove.forEach(chNode => scene.add(chNode))\n            scene.remove(scene.userData.sceneAnchor)\n        }\n        return scene\n    }\n\n    updateProperty(node, obj, op, provider) {\n        console.log(\"update property\",node.name,op.name,op.value)\n        if(op.name === PROP_DEFS.defaultFloor.key) {\n            console.log('setting the floor too',op.value)\n            this.setDefaultFloor(node,op.value)\n        }\n    }\n\n    setDefaultFloor(scene,val) {\n        if (val === true) {\n            const floor = new Mesh(\n                new PlaneBufferGeometry(100, 100, 10, 10),\n                new MeshLambertMaterial({color: 'blue'})\n            )\n            floor.name = 'defaultFloor'\n            floor.rotation.x = -90 * Math.PI / 180\n            scene.parts = {}\n            scene.parts.floor = floor\n            scene.add(floor)\n        } else {\n            if (scene.parts && scene.parts.floor) {\n                scene.remove(scene.parts.floor)\n                delete scene.parts.floor\n            }\n        }\n    }\n\n    getFloorPart(node) {\n        if(!node) return null\n        if(!node.parts) return null\n        return node.parts.floor\n    }\n\n}\n","/* eslint-disable */\nconst THREE = require('three');//requireimport * as THREE from 'three'\n\n/**\n * @author Rich Tibbett / https://github.com/richtr\n * @author mrdoob / http://mrdoob.com/\n * @author Tony Parisi / http://www.tonyparisi.com/\n * @author Takahiro / https://github.com/takahirox\n * @author Don McCurdy / https://www.donmccurdy.com\n */\n\nconst GLTFLoader = ( function () {\n\n\tfunction GLTFLoader( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\t\tthis.dracoLoader = null;\n\n\t}\n\n\tGLTFLoader.prototype = {\n\n\t\tconstructor: GLTFLoader,\n\n\t\tcrossOrigin: 'anonymous',\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar scope = this;\n\n\t\t\tvar resourcePath;\n\n\t\t\tif ( this.resourcePath !== undefined ) {\n\n\t\t\t\tresourcePath = this.resourcePath;\n\n\t\t\t} else if ( this.path !== undefined ) {\n\n\t\t\t\tresourcePath = this.path;\n\n\t\t\t} else {\n\n\t\t\t\tresourcePath = THREE.LoaderUtils.extractUrlBase( url );\n\n\t\t\t}\n\n\t\t\t// Tells the LoadingManager to track an extra item, which resolves after\n\t\t\t// the model is fully loaded. This means the count of items loaded will\n\t\t\t// be incorrect, but ensures manager.onLoad() does not fire early.\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\tvar _onError = function ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t};\n\n\t\t\tvar loader = new THREE.FileLoader( scope.manager );\n\n\t\t\tloader.setPath( this.path );\n\t\t\tloader.setResponseType( 'arraybuffer' );\n\n\t\t\tloader.load( url, function ( data ) {\n\n\t\t\t\ttry {\n\n\t\t\t\t\tscope.parse( data, resourcePath, function ( gltf ) {\n\n\t\t\t\t\t\tonLoad( gltf );\n\n\t\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t\t}, _onError );\n\n\t\t\t\t} catch ( e ) {\n\n\t\t\t\t\t_onError( e );\n\n\t\t\t\t}\n\n\t\t\t}, onProgress, _onError );\n\n\t\t},\n\n\t\tsetCrossOrigin: function ( value ) {\n\n\t\t\tthis.crossOrigin = value;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetPath: function ( value ) {\n\n\t\t\tthis.path = value;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetResourcePath: function ( value ) {\n\n\t\t\tthis.resourcePath = value;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetDRACOLoader: function ( dracoLoader ) {\n\n\t\t\tthis.dracoLoader = dracoLoader;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tparse: function ( data, path, onLoad, onError ) {\n\n\t\t\tvar content;\n\t\t\tvar extensions = {};\n\n\t\t\tif ( typeof data === 'string' ) {\n\n\t\t\t\tcontent = data;\n\n\t\t\t} else {\n\n\t\t\t\tvar magic = THREE.LoaderUtils.decodeText( new Uint8Array( data, 0, 4 ) );\n\n\t\t\t\tif ( magic === BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\textensions[ EXTENSIONS.KHR_BINARY_GLTF ] = new GLTFBinaryExtension( data );\n\n\t\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\t\tif ( onError ) onError( error );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tcontent = extensions[ EXTENSIONS.KHR_BINARY_GLTF ].content;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tcontent = THREE.LoaderUtils.decodeText( new Uint8Array( data ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar json = JSON.parse( content );\n\n\t\t\tif ( json.asset === undefined || json.asset.version[ 0 ] < 2 ) {\n\n\t\t\t\tif ( onError ) onError( new Error( 'THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead.' ) );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( json.extensionsUsed ) {\n\n\t\t\t\tfor ( var i = 0; i < json.extensionsUsed.length; ++ i ) {\n\n\t\t\t\t\tvar extensionName = json.extensionsUsed[ i ];\n\t\t\t\t\tvar extensionsRequired = json.extensionsRequired || [];\n\n\t\t\t\t\tswitch ( extensionName ) {\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_LIGHTS_PUNCTUAL:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFLightsExtension( json );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_UNLIT:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsUnlitExtension( json );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsPbrSpecularGlossinessExtension( json );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFDracoMeshCompressionExtension( json, this.dracoLoader );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.MSFT_TEXTURE_DDS:\n\t\t\t\t\t\t\textensions[ EXTENSIONS.MSFT_TEXTURE_DDS ] = new GLTFTextureDDSExtension();\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n\t\t\t\t\t\t\textensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] = new GLTFTextureTransformExtension( json );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tif ( extensionsRequired.indexOf( extensionName ) >= 0 ) {\n\n\t\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".' );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar parser = new GLTFParser( json, extensions, {\n\n\t\t\t\tpath: path || this.resourcePath || '',\n\t\t\t\tcrossOrigin: this.crossOrigin,\n\t\t\t\tmanager: this.manager\n\n\t\t\t} );\n\n\t\t\tparser.parse( onLoad, onError );\n\n\t\t}\n\n\t};\n\n\t/* GLTFREGISTRY */\n\n\tfunction GLTFRegistry() {\n\n\t\tvar objects = {};\n\n\t\treturn\t{\n\n\t\t\tget: function ( key ) {\n\n\t\t\t\treturn objects[ key ];\n\n\t\t\t},\n\n\t\t\tadd: function ( key, object ) {\n\n\t\t\t\tobjects[ key ] = object;\n\n\t\t\t},\n\n\t\t\tremove: function ( key ) {\n\n\t\t\t\tdelete objects[ key ];\n\n\t\t\t},\n\n\t\t\tremoveAll: function () {\n\n\t\t\t\tobjects = {};\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t/*********************************/\n\t/********** EXTENSIONS ***********/\n\t/*********************************/\n\n\tvar EXTENSIONS = {\n\t\tKHR_BINARY_GLTF: 'KHR_binary_glTF',\n\t\tKHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n\t\tKHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n\t\tKHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: 'KHR_materials_pbrSpecularGlossiness',\n\t\tKHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n\t\tKHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n\t\tMSFT_TEXTURE_DDS: 'MSFT_texture_dds'\n\t};\n\n\t/**\n\t * DDS Texture Extension\n\t *\n\t * Specification:\n\t * https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/MSFT_texture_dds\n\t *\n\t */\n\tfunction GLTFTextureDDSExtension() {\n\n\t\tif ( ! THREE.DDSLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.MSFT_TEXTURE_DDS;\n\t\tthis.ddsLoader = new THREE.DDSLoader();\n\n\t}\n\n\t/**\n\t * Lights Extension\n\t *\n\t * Specification: PENDING\n\t */\n\tfunction GLTFLightsExtension( json ) {\n\n\t\tthis.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\n\n\t\tvar extension = ( json.extensions && json.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ] ) || {};\n\t\tthis.lightDefs = extension.lights || [];\n\n\t}\n\n\tGLTFLightsExtension.prototype.loadLight = function ( lightIndex ) {\n\n\t\tvar lightDef = this.lightDefs[ lightIndex ];\n\t\tvar lightNode;\n\n\t\tvar color = new THREE.Color( 0xffffff );\n\t\tif ( lightDef.color !== undefined ) color.fromArray( lightDef.color );\n\n\t\tvar range = lightDef.range !== undefined ? lightDef.range : 0;\n\n\t\tswitch ( lightDef.type ) {\n\n\t\t\tcase 'directional':\n\t\t\t\tlightNode = new THREE.DirectionalLight( color );\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tcase 'point':\n\t\t\t\tlightNode = new THREE.PointLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\tbreak;\n\n\t\t\tcase 'spot':\n\t\t\t\tlightNode = new THREE.SpotLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\t// Handle spotlight properties.\n\t\t\t\tlightDef.spot = lightDef.spot || {};\n\t\t\t\tlightDef.spot.innerConeAngle = lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\n\t\t\t\tlightDef.spot.outerConeAngle = lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\n\t\t\t\tlightNode.angle = lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Unexpected light type, \"' + lightDef.type + '\".' );\n\n\t\t}\n\n\t\t// Some lights (e.g. spot) default to a position other than the origin. Reset the position\n\t\t// here, because node-level parsing will only override position if explicitly specified.\n\t\tlightNode.position.set( 0, 0, 0 );\n\n\t\tlightNode.decay = 2;\n\n\t\tif ( lightDef.intensity !== undefined ) lightNode.intensity = lightDef.intensity;\n\n\t\tlightNode.name = lightDef.name || ( 'light_' + lightIndex );\n\n\t\treturn Promise.resolve( lightNode );\n\n\t};\n\n\t/**\n\t * Unlit Materials Extension (pending)\n\t *\n\t * PR: https://github.com/KhronosGroup/glTF/pull/1163\n\t */\n\tfunction GLTFMaterialsUnlitExtension() {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\n\n\t}\n\n\tGLTFMaterialsUnlitExtension.prototype.getMaterialType = function () {\n\n\t\treturn THREE.MeshBasicMaterial;\n\n\t};\n\n\tGLTFMaterialsUnlitExtension.prototype.extendParams = function ( materialParams, materialDef, parser ) {\n\n\t\tvar pending = [];\n\n\t\tmaterialParams.color = new THREE.Color( 1.0, 1.0, 1.0 );\n\t\tmaterialParams.opacity = 1.0;\n\n\t\tvar metallicRoughness = materialDef.pbrMetallicRoughness;\n\n\t\tif ( metallicRoughness ) {\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tvar array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t};\n\n\t/* BINARY EXTENSION */\n\n\tvar BINARY_EXTENSION_BUFFER_NAME = 'binary_glTF';\n\tvar BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\n\tvar BINARY_EXTENSION_HEADER_LENGTH = 12;\n\tvar BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4E4F534A, BIN: 0x004E4942 };\n\n\tfunction GLTFBinaryExtension( data ) {\n\n\t\tthis.name = EXTENSIONS.KHR_BINARY_GLTF;\n\t\tthis.content = null;\n\t\tthis.body = null;\n\n\t\tvar headerView = new DataView( data, 0, BINARY_EXTENSION_HEADER_LENGTH );\n\n\t\tthis.header = {\n\t\t\tmagic: THREE.LoaderUtils.decodeText( new Uint8Array( data.slice( 0, 4 ) ) ),\n\t\t\tversion: headerView.getUint32( 4, true ),\n\t\t\tlength: headerView.getUint32( 8, true )\n\t\t};\n\n\t\tif ( this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported glTF-Binary header.' );\n\n\t\t} else if ( this.header.version < 2.0 ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.' );\n\n\t\t}\n\n\t\tvar chunkView = new DataView( data, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tvar chunkIndex = 0;\n\n\t\twhile ( chunkIndex < chunkView.byteLength ) {\n\n\t\t\tvar chunkLength = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tvar chunkType = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tif ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON ) {\n\n\t\t\t\tvar contentArray = new Uint8Array( data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength );\n\t\t\t\tthis.content = THREE.LoaderUtils.decodeText( contentArray );\n\n\t\t\t} else if ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN ) {\n\n\t\t\t\tvar byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n\t\t\t\tthis.body = data.slice( byteOffset, byteOffset + chunkLength );\n\n\t\t\t}\n\n\t\t\t// Clients must ignore chunks with unknown types.\n\n\t\t\tchunkIndex += chunkLength;\n\n\t\t}\n\n\t\tif ( this.content === null ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: JSON content not found.' );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * DRACO Mesh Compression Extension\n\t *\n\t * Specification: https://github.com/KhronosGroup/glTF/pull/874\n\t */\n\tfunction GLTFDracoMeshCompressionExtension( json, dracoLoader ) {\n\n\t\tif ( ! dracoLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: No DRACOLoader instance provided.' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\n\t\tthis.json = json;\n\t\tthis.dracoLoader = dracoLoader;\n\n\t}\n\n\tGLTFDracoMeshCompressionExtension.prototype.decodePrimitive = function ( primitive, parser ) {\n\n\t\tvar json = this.json;\n\t\tvar dracoLoader = this.dracoLoader;\n\t\tvar bufferViewIndex = primitive.extensions[ this.name ].bufferView;\n\t\tvar gltfAttributeMap = primitive.extensions[ this.name ].attributes;\n\t\tvar threeAttributeMap = {};\n\t\tvar attributeNormalizedMap = {};\n\t\tvar attributeTypeMap = {};\n\n\t\tfor ( var attributeName in gltfAttributeMap ) {\n\n\t\t\tvar threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tthreeAttributeMap[ threeAttributeName ] = gltfAttributeMap[ attributeName ];\n\n\t\t}\n\n\t\tfor ( attributeName in primitive.attributes ) {\n\n\t\t\tvar threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tif ( gltfAttributeMap[ attributeName ] !== undefined ) {\n\n\t\t\t\tvar accessorDef = json.accessors[ primitive.attributes[ attributeName ] ];\n\t\t\t\tvar componentType = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t\tattributeTypeMap[ threeAttributeName ] = componentType;\n\t\t\t\tattributeNormalizedMap[ threeAttributeName ] = accessorDef.normalized === true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.getDependency( 'bufferView', bufferViewIndex ).then( function ( bufferView ) {\n\n\t\t\treturn new Promise( function ( resolve ) {\n\n\t\t\t\tdracoLoader.decodeDracoFile( bufferView, function ( geometry ) {\n\n\t\t\t\t\tfor ( var attributeName in geometry.attributes ) {\n\n\t\t\t\t\t\tvar attribute = geometry.attributes[ attributeName ];\n\t\t\t\t\t\tvar normalized = attributeNormalizedMap[ attributeName ];\n\n\t\t\t\t\t\tif ( normalized !== undefined ) attribute.normalized = normalized;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve( geometry );\n\n\t\t\t\t}, threeAttributeMap, attributeTypeMap );\n\n\t\t\t} );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Texture Transform Extension\n\t *\n\t * Specification:\n\t */\n\tfunction GLTFTextureTransformExtension() {\n\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\n\n\t}\n\n\tGLTFTextureTransformExtension.prototype.extendTexture = function ( texture, transform ) {\n\n\t\ttexture = texture.clone();\n\n\t\tif ( transform.offset !== undefined ) {\n\n\t\t\ttexture.offset.fromArray( transform.offset );\n\n\t\t}\n\n\t\tif ( transform.rotation !== undefined ) {\n\n\t\t\ttexture.rotation = transform.rotation;\n\n\t\t}\n\n\t\tif ( transform.scale !== undefined ) {\n\n\t\t\ttexture.repeat.fromArray( transform.scale );\n\n\t\t}\n\n\t\tif ( transform.texCoord !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Custom UV sets in \"' + this.name + '\" extension not yet supported.' );\n\n\t\t}\n\n\t\ttexture.needsUpdate = true;\n\n\t\treturn texture;\n\n\t};\n\n\t/**\n\t * Specular-Glossiness Extension\n\t *\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_pbrSpecularGlossiness\n\t */\n\tfunction GLTFMaterialsPbrSpecularGlossinessExtension() {\n\n\t\treturn {\n\n\t\t\tname: EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,\n\n\t\t\tspecularGlossinessParams: [\n\t\t\t\t'color',\n\t\t\t\t'map',\n\t\t\t\t'lightMap',\n\t\t\t\t'lightMapIntensity',\n\t\t\t\t'aoMap',\n\t\t\t\t'aoMapIntensity',\n\t\t\t\t'emissive',\n\t\t\t\t'emissiveIntensity',\n\t\t\t\t'emissiveMap',\n\t\t\t\t'bumpMap',\n\t\t\t\t'bumpScale',\n\t\t\t\t'normalMap',\n\t\t\t\t'displacementMap',\n\t\t\t\t'displacementScale',\n\t\t\t\t'displacementBias',\n\t\t\t\t'specularMap',\n\t\t\t\t'specular',\n\t\t\t\t'glossinessMap',\n\t\t\t\t'glossiness',\n\t\t\t\t'alphaMap',\n\t\t\t\t'envMap',\n\t\t\t\t'envMapIntensity',\n\t\t\t\t'refractionRatio',\n\t\t\t],\n\n\t\t\tgetMaterialType: function () {\n\n\t\t\t\treturn THREE.ShaderMaterial;\n\n\t\t\t},\n\n\t\t\textendParams: function ( materialParams, materialDef, parser ) {\n\n\t\t\t\tvar pbrSpecularGlossiness = materialDef.extensions[ this.name ];\n\n\t\t\t\tvar shader = THREE.ShaderLib[ 'standard' ];\n\n\t\t\t\tvar uniforms = THREE.UniformsUtils.clone( shader.uniforms );\n\n\t\t\t\tvar specularMapParsFragmentChunk = [\n\t\t\t\t\t'#ifdef USE_SPECULARMAP',\n\t\t\t\t\t'\tuniform sampler2D specularMap;',\n\t\t\t\t\t'#endif'\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar glossinessMapParsFragmentChunk = [\n\t\t\t\t\t'#ifdef USE_GLOSSINESSMAP',\n\t\t\t\t\t'\tuniform sampler2D glossinessMap;',\n\t\t\t\t\t'#endif'\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar specularMapFragmentChunk = [\n\t\t\t\t\t'vec3 specularFactor = specular;',\n\t\t\t\t\t'#ifdef USE_SPECULARMAP',\n\t\t\t\t\t'\tvec4 texelSpecular = texture2D( specularMap, vUv );',\n\t\t\t\t\t'\ttexelSpecular = sRGBToLinear( texelSpecular );',\n\t\t\t\t\t'\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture',\n\t\t\t\t\t'\tspecularFactor *= texelSpecular.rgb;',\n\t\t\t\t\t'#endif'\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar glossinessMapFragmentChunk = [\n\t\t\t\t\t'float glossinessFactor = glossiness;',\n\t\t\t\t\t'#ifdef USE_GLOSSINESSMAP',\n\t\t\t\t\t'\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );',\n\t\t\t\t\t'\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture',\n\t\t\t\t\t'\tglossinessFactor *= texelGlossiness.a;',\n\t\t\t\t\t'#endif'\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar lightPhysicalFragmentChunk = [\n\t\t\t\t\t'PhysicalMaterial material;',\n\t\t\t\t\t'material.diffuseColor = diffuseColor.rgb;',\n\t\t\t\t\t'material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );',\n\t\t\t\t\t'material.specularColor = specularFactor.rgb;',\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar fragmentShader = shader.fragmentShader\n\t\t\t\t\t.replace( 'uniform float roughness;', 'uniform vec3 specular;' )\n\t\t\t\t\t.replace( 'uniform float metalness;', 'uniform float glossiness;' )\n\t\t\t\t\t.replace( '#include <roughnessmap_pars_fragment>', specularMapParsFragmentChunk )\n\t\t\t\t\t.replace( '#include <metalnessmap_pars_fragment>', glossinessMapParsFragmentChunk )\n\t\t\t\t\t.replace( '#include <roughnessmap_fragment>', specularMapFragmentChunk )\n\t\t\t\t\t.replace( '#include <metalnessmap_fragment>', glossinessMapFragmentChunk )\n\t\t\t\t\t.replace( '#include <lights_physical_fragment>', lightPhysicalFragmentChunk );\n\n\t\t\t\tdelete uniforms.roughness;\n\t\t\t\tdelete uniforms.metalness;\n\t\t\t\tdelete uniforms.roughnessMap;\n\t\t\t\tdelete uniforms.metalnessMap;\n\n\t\t\t\tuniforms.specular = { value: new THREE.Color().setHex( 0x111111 ) };\n\t\t\t\tuniforms.glossiness = { value: 0.5 };\n\t\t\t\tuniforms.specularMap = { value: null };\n\t\t\t\tuniforms.glossinessMap = { value: null };\n\n\t\t\t\tmaterialParams.vertexShader = shader.vertexShader;\n\t\t\t\tmaterialParams.fragmentShader = fragmentShader;\n\t\t\t\tmaterialParams.uniforms = uniforms;\n\t\t\t\tmaterialParams.defines = { 'STANDARD': '' };\n\n\t\t\t\tmaterialParams.color = new THREE.Color( 1.0, 1.0, 1.0 );\n\t\t\t\tmaterialParams.opacity = 1.0;\n\n\t\t\t\tvar pending = [];\n\n\t\t\t\tif ( Array.isArray( pbrSpecularGlossiness.diffuseFactor ) ) {\n\n\t\t\t\t\tvar array = pbrSpecularGlossiness.diffuseFactor;\n\n\t\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t\t}\n\n\t\t\t\tif ( pbrSpecularGlossiness.diffuseTexture !== undefined ) {\n\n\t\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', pbrSpecularGlossiness.diffuseTexture ) );\n\n\t\t\t\t}\n\n\t\t\t\tmaterialParams.emissive = new THREE.Color( 0.0, 0.0, 0.0 );\n\t\t\t\tmaterialParams.glossiness = pbrSpecularGlossiness.glossinessFactor !== undefined ? pbrSpecularGlossiness.glossinessFactor : 1.0;\n\t\t\t\tmaterialParams.specular = new THREE.Color( 1.0, 1.0, 1.0 );\n\n\t\t\t\tif ( Array.isArray( pbrSpecularGlossiness.specularFactor ) ) {\n\n\t\t\t\t\tmaterialParams.specular.fromArray( pbrSpecularGlossiness.specularFactor );\n\n\t\t\t\t}\n\n\t\t\t\tif ( pbrSpecularGlossiness.specularGlossinessTexture !== undefined ) {\n\n\t\t\t\t\tvar specGlossMapDef = pbrSpecularGlossiness.specularGlossinessTexture;\n\t\t\t\t\tpending.push( parser.assignTexture( materialParams, 'glossinessMap', specGlossMapDef ) );\n\t\t\t\t\tpending.push( parser.assignTexture( materialParams, 'specularMap', specGlossMapDef ) );\n\n\t\t\t\t}\n\n\t\t\t\treturn Promise.all( pending );\n\n\t\t\t},\n\n\t\t\tcreateMaterial: function ( params ) {\n\n\t\t\t\t// setup material properties based on MeshStandardMaterial for Specular-Glossiness\n\n\t\t\t\tvar material = new THREE.ShaderMaterial( {\n\t\t\t\t\tdefines: params.defines,\n\t\t\t\t\tvertexShader: params.vertexShader,\n\t\t\t\t\tfragmentShader: params.fragmentShader,\n\t\t\t\t\tuniforms: params.uniforms,\n\t\t\t\t\tfog: true,\n\t\t\t\t\tlights: true,\n\t\t\t\t\topacity: params.opacity,\n\t\t\t\t\ttransparent: params.transparent\n\t\t\t\t} );\n\n\t\t\t\tmaterial.isGLTFSpecularGlossinessMaterial = true;\n\n\t\t\t\tmaterial.color = params.color;\n\n\t\t\t\tmaterial.map = params.map === undefined ? null : params.map;\n\n\t\t\t\tmaterial.lightMap = null;\n\t\t\t\tmaterial.lightMapIntensity = 1.0;\n\n\t\t\t\tmaterial.aoMap = params.aoMap === undefined ? null : params.aoMap;\n\t\t\t\tmaterial.aoMapIntensity = 1.0;\n\n\t\t\t\tmaterial.emissive = params.emissive;\n\t\t\t\tmaterial.emissiveIntensity = 1.0;\n\t\t\t\tmaterial.emissiveMap = params.emissiveMap === undefined ? null : params.emissiveMap;\n\n\t\t\t\tmaterial.bumpMap = params.bumpMap === undefined ? null : params.bumpMap;\n\t\t\t\tmaterial.bumpScale = 1;\n\n\t\t\t\tmaterial.normalMap = params.normalMap === undefined ? null : params.normalMap;\n\n\t\t\t\tif ( params.normalScale ) material.normalScale = params.normalScale;\n\n\t\t\t\tmaterial.displacementMap = null;\n\t\t\t\tmaterial.displacementScale = 1;\n\t\t\t\tmaterial.displacementBias = 0;\n\n\t\t\t\tmaterial.specularMap = params.specularMap === undefined ? null : params.specularMap;\n\t\t\t\tmaterial.specular = params.specular;\n\n\t\t\t\tmaterial.glossinessMap = params.glossinessMap === undefined ? null : params.glossinessMap;\n\t\t\t\tmaterial.glossiness = params.glossiness;\n\n\t\t\t\tmaterial.alphaMap = null;\n\n\t\t\t\tmaterial.envMap = params.envMap === undefined ? null : params.envMap;\n\t\t\t\tmaterial.envMapIntensity = 1.0;\n\n\t\t\t\tmaterial.refractionRatio = 0.98;\n\n\t\t\t\tmaterial.extensions.derivatives = true;\n\n\t\t\t\treturn material;\n\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Clones a GLTFSpecularGlossinessMaterial instance. The ShaderMaterial.copy() method can\n\t\t\t * copy only properties it knows about or inherits, and misses many properties that would\n\t\t\t * normally be defined by MeshStandardMaterial.\n\t\t\t *\n\t\t\t * This method allows GLTFSpecularGlossinessMaterials to be cloned in the process of\n\t\t\t * loading a glTF model, but cloning later (e.g. by the user) would require these changes\n\t\t\t * AND also updating `.onBeforeRender` on the parent mesh.\n\t\t\t *\n\t\t\t * @param  {THREE.ShaderMaterial} source\n\t\t\t * @return {THREE.ShaderMaterial}\n\t\t\t */\n\t\t\tcloneMaterial: function ( source ) {\n\n\t\t\t\tvar target = source.clone();\n\n\t\t\t\ttarget.isGLTFSpecularGlossinessMaterial = true;\n\n\t\t\t\tvar params = this.specularGlossinessParams;\n\n\t\t\t\tfor ( var i = 0, il = params.length; i < il; i ++ ) {\n\n\t\t\t\t\ttarget[ params[ i ] ] = source[ params[ i ] ];\n\n\t\t\t\t}\n\n\t\t\t\treturn target;\n\n\t\t\t},\n\n\t\t\t// Here's based on refreshUniformsCommon() and refreshUniformsStandard() in WebGLRenderer.\n\t\t\trefreshUniforms: function ( renderer, scene, camera, geometry, material, group ) {\n\n\t\t\t\tif ( material.isGLTFSpecularGlossinessMaterial !== true ) {\n\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tvar uniforms = material.uniforms;\n\t\t\t\tvar defines = material.defines;\n\n\t\t\t\tuniforms.opacity.value = material.opacity;\n\n\t\t\t\tuniforms.diffuse.value.copy( material.color );\n\t\t\t\tuniforms.emissive.value.copy( material.emissive ).multiplyScalar( material.emissiveIntensity );\n\n\t\t\t\tuniforms.map.value = material.map;\n\t\t\t\tuniforms.specularMap.value = material.specularMap;\n\t\t\t\tuniforms.alphaMap.value = material.alphaMap;\n\n\t\t\t\tuniforms.lightMap.value = material.lightMap;\n\t\t\t\tuniforms.lightMapIntensity.value = material.lightMapIntensity;\n\n\t\t\t\tuniforms.aoMap.value = material.aoMap;\n\t\t\t\tuniforms.aoMapIntensity.value = material.aoMapIntensity;\n\n\t\t\t\t// uv repeat and offset setting priorities\n\t\t\t\t// 1. color map\n\t\t\t\t// 2. specular map\n\t\t\t\t// 3. normal map\n\t\t\t\t// 4. bump map\n\t\t\t\t// 5. alpha map\n\t\t\t\t// 6. emissive map\n\n\t\t\t\tvar uvScaleMap;\n\n\t\t\t\tif ( material.map ) {\n\n\t\t\t\t\tuvScaleMap = material.map;\n\n\t\t\t\t} else if ( material.specularMap ) {\n\n\t\t\t\t\tuvScaleMap = material.specularMap;\n\n\t\t\t\t} else if ( material.displacementMap ) {\n\n\t\t\t\t\tuvScaleMap = material.displacementMap;\n\n\t\t\t\t} else if ( material.normalMap ) {\n\n\t\t\t\t\tuvScaleMap = material.normalMap;\n\n\t\t\t\t} else if ( material.bumpMap ) {\n\n\t\t\t\t\tuvScaleMap = material.bumpMap;\n\n\t\t\t\t} else if ( material.glossinessMap ) {\n\n\t\t\t\t\tuvScaleMap = material.glossinessMap;\n\n\t\t\t\t} else if ( material.alphaMap ) {\n\n\t\t\t\t\tuvScaleMap = material.alphaMap;\n\n\t\t\t\t} else if ( material.emissiveMap ) {\n\n\t\t\t\t\tuvScaleMap = material.emissiveMap;\n\n\t\t\t\t}\n\n\t\t\t\tif ( uvScaleMap !== undefined ) {\n\n\t\t\t\t\t// backwards compatibility\n\t\t\t\t\tif ( uvScaleMap.isWebGLRenderTarget ) {\n\n\t\t\t\t\t\tuvScaleMap = uvScaleMap.texture;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( uvScaleMap.matrixAutoUpdate === true ) {\n\n\t\t\t\t\t\tuvScaleMap.updateMatrix();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tuniforms.uvTransform.value.copy( uvScaleMap.matrix );\n\n\t\t\t\t}\n\n\t\t\t\tif ( material.envMap ) {\n\n\t\t\t\t\tuniforms.envMap.value = material.envMap;\n\t\t\t\t\tuniforms.envMapIntensity.value = material.envMapIntensity;\n\n\t\t\t\t\t// don't flip CubeTexture envMaps, flip everything else:\n\t\t\t\t\t//  WebGLRenderTargetCube will be flipped for backwards compatibility\n\t\t\t\t\t//  WebGLRenderTargetCube.texture will be flipped because it's a Texture and NOT a CubeTexture\n\t\t\t\t\t// this check must be handled differently, or removed entirely, if WebGLRenderTargetCube uses a CubeTexture in the future\n\t\t\t\t\tuniforms.flipEnvMap.value = material.envMap.isCubeTexture ? - 1 : 1;\n\n\t\t\t\t\tuniforms.reflectivity.value = material.reflectivity;\n\t\t\t\t\tuniforms.refractionRatio.value = material.refractionRatio;\n\n\t\t\t\t\tuniforms.maxMipLevel.value = renderer.properties.get( material.envMap ).__maxMipLevel;\n\n\t\t\t\t}\n\n\t\t\t\tuniforms.specular.value.copy( material.specular );\n\t\t\t\tuniforms.glossiness.value = material.glossiness;\n\n\t\t\t\tuniforms.glossinessMap.value = material.glossinessMap;\n\n\t\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\n\t\t\t\tuniforms.bumpMap.value = material.bumpMap;\n\t\t\t\tuniforms.normalMap.value = material.normalMap;\n\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t\t\tif ( uniforms.glossinessMap.value !== null && defines.USE_GLOSSINESSMAP === undefined ) {\n\n\t\t\t\t\tdefines.USE_GLOSSINESSMAP = '';\n\t\t\t\t\t// set USE_ROUGHNESSMAP to enable vUv\n\t\t\t\t\tdefines.USE_ROUGHNESSMAP = '';\n\n\t\t\t\t}\n\n\t\t\t\tif ( uniforms.glossinessMap.value === null && defines.USE_GLOSSINESSMAP !== undefined ) {\n\n\t\t\t\t\tdelete defines.USE_GLOSSINESSMAP;\n\t\t\t\t\tdelete defines.USE_ROUGHNESSMAP;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t/*********************************/\n\t/********** INTERPOLATION ********/\n\t/*********************************/\n\n\t// Spline Interpolation\n\t// Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\n\tfunction GLTFCubicSplineInterpolant( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tTHREE.Interpolant.call( this, parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tGLTFCubicSplineInterpolant.prototype = Object.create( THREE.Interpolant.prototype );\n\tGLTFCubicSplineInterpolant.prototype.constructor = GLTFCubicSplineInterpolant;\n\n\tGLTFCubicSplineInterpolant.prototype.copySampleValue_ = function ( index ) {\n\n\t\t// Copies a sample value to the result buffer. See description of glTF\n\t\t// CUBICSPLINE values layout in interpolate_() function below.\n\n\t\tvar result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tvalueSize = this.valueSize,\n\t\t\toffset = index * valueSize * 3 + valueSize;\n\n\t\tfor ( var i = 0; i !== valueSize; i ++ ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t};\n\n\tGLTFCubicSplineInterpolant.prototype.beforeStart_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\n\tGLTFCubicSplineInterpolant.prototype.afterEnd_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\n\tGLTFCubicSplineInterpolant.prototype.interpolate_ = function ( i1, t0, t, t1 ) {\n\n\t\tvar result = this.resultBuffer;\n\t\tvar values = this.sampleValues;\n\t\tvar stride = this.valueSize;\n\n\t\tvar stride2 = stride * 2;\n\t\tvar stride3 = stride * 3;\n\n\t\tvar td = t1 - t0;\n\n\t\tvar p = ( t - t0 ) / td;\n\t\tvar pp = p * p;\n\t\tvar ppp = pp * p;\n\n\t\tvar offset1 = i1 * stride3;\n\t\tvar offset0 = offset1 - stride3;\n\n\t\tvar s2 = - 2 * ppp + 3 * pp;\n\t\tvar s3 = ppp - pp;\n\t\tvar s0 = 1 - s2;\n\t\tvar s1 = s3 - pp + p;\n\n\t\t// Layout of keyframe output values for CUBICSPLINE animations:\n\t\t//   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n\t\tfor ( var i = 0; i !== stride; i ++ ) {\n\n\t\t\tvar p0 = values[ offset0 + i + stride ]; // splineVertex_k\n\t\t\tvar m0 = values[ offset0 + i + stride2 ] * td; // outTangent_k * (t_k+1 - t_k)\n\t\t\tvar p1 = values[ offset1 + i + stride ]; // splineVertex_k+1\n\t\t\tvar m1 = values[ offset1 + i ] * td; // inTangent_k+1 * (t_k+1 - t_k)\n\n\t\t\tresult[ i ] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\n\n\t\t}\n\n\t\treturn result;\n\n\t};\n\n\t/*********************************/\n\t/********** INTERNALS ************/\n\t/*********************************/\n\n\t/* CONSTANTS */\n\n\tvar WEBGL_CONSTANTS = {\n\t\tFLOAT: 5126,\n\t\t//FLOAT_MAT2: 35674,\n\t\tFLOAT_MAT3: 35675,\n\t\tFLOAT_MAT4: 35676,\n\t\tFLOAT_VEC2: 35664,\n\t\tFLOAT_VEC3: 35665,\n\t\tFLOAT_VEC4: 35666,\n\t\tLINEAR: 9729,\n\t\tREPEAT: 10497,\n\t\tSAMPLER_2D: 35678,\n\t\tPOINTS: 0,\n\t\tLINES: 1,\n\t\tLINE_LOOP: 2,\n\t\tLINE_STRIP: 3,\n\t\tTRIANGLES: 4,\n\t\tTRIANGLE_STRIP: 5,\n\t\tTRIANGLE_FAN: 6,\n\t\tUNSIGNED_BYTE: 5121,\n\t\tUNSIGNED_SHORT: 5123\n\t};\n\n\tvar WEBGL_TYPE = {\n\t\t5126: Number,\n\t\t//35674: THREE.Matrix2,\n\t\t35675: THREE.Matrix3,\n\t\t35676: THREE.Matrix4,\n\t\t35664: THREE.Vector2,\n\t\t35665: THREE.Vector3,\n\t\t35666: THREE.Vector4,\n\t\t35678: THREE.Texture\n\t};\n\n\tvar WEBGL_COMPONENT_TYPES = {\n\t\t5120: Int8Array,\n\t\t5121: Uint8Array,\n\t\t5122: Int16Array,\n\t\t5123: Uint16Array,\n\t\t5125: Uint32Array,\n\t\t5126: Float32Array\n\t};\n\n\tvar WEBGL_FILTERS = {\n\t\t9728: THREE.NearestFilter,\n\t\t9729: THREE.LinearFilter,\n\t\t9984: THREE.NearestMipMapNearestFilter,\n\t\t9985: THREE.LinearMipMapNearestFilter,\n\t\t9986: THREE.NearestMipMapLinearFilter,\n\t\t9987: THREE.LinearMipMapLinearFilter\n\t};\n\n\tvar WEBGL_WRAPPINGS = {\n\t\t33071: THREE.ClampToEdgeWrapping,\n\t\t33648: THREE.MirroredRepeatWrapping,\n\t\t10497: THREE.RepeatWrapping\n\t};\n\n\tvar WEBGL_SIDES = {\n\t\t1028: THREE.BackSide, // Culling front\n\t\t1029: THREE.FrontSide // Culling back\n\t\t//1032: THREE.NoSide   // Culling front and back, what to do?\n\t};\n\n\tvar WEBGL_DEPTH_FUNCS = {\n\t\t512: THREE.NeverDepth,\n\t\t513: THREE.LessDepth,\n\t\t514: THREE.EqualDepth,\n\t\t515: THREE.LessEqualDepth,\n\t\t516: THREE.GreaterEqualDepth,\n\t\t517: THREE.NotEqualDepth,\n\t\t518: THREE.GreaterEqualDepth,\n\t\t519: THREE.AlwaysDepth\n\t};\n\n\tvar WEBGL_BLEND_EQUATIONS = {\n\t\t32774: THREE.AddEquation,\n\t\t32778: THREE.SubtractEquation,\n\t\t32779: THREE.ReverseSubtractEquation\n\t};\n\n\tvar WEBGL_BLEND_FUNCS = {\n\t\t0: THREE.ZeroFactor,\n\t\t1: THREE.OneFactor,\n\t\t768: THREE.SrcColorFactor,\n\t\t769: THREE.OneMinusSrcColorFactor,\n\t\t770: THREE.SrcAlphaFactor,\n\t\t771: THREE.OneMinusSrcAlphaFactor,\n\t\t772: THREE.DstAlphaFactor,\n\t\t773: THREE.OneMinusDstAlphaFactor,\n\t\t774: THREE.DstColorFactor,\n\t\t775: THREE.OneMinusDstColorFactor,\n\t\t776: THREE.SrcAlphaSaturateFactor\n\t\t// The followings are not supported by Three.js yet\n\t\t//32769: CONSTANT_COLOR,\n\t\t//32770: ONE_MINUS_CONSTANT_COLOR,\n\t\t//32771: CONSTANT_ALPHA,\n\t\t//32772: ONE_MINUS_CONSTANT_COLOR\n\t};\n\n\tvar WEBGL_TYPE_SIZES = {\n\t\t'SCALAR': 1,\n\t\t'VEC2': 2,\n\t\t'VEC3': 3,\n\t\t'VEC4': 4,\n\t\t'MAT2': 4,\n\t\t'MAT3': 9,\n\t\t'MAT4': 16\n\t};\n\n\tvar ATTRIBUTES = {\n\t\tPOSITION: 'position',\n\t\tNORMAL: 'normal',\n\t\tTANGENT: 'tangent',\n\t\tTEXCOORD_0: 'uv',\n\t\tTEXCOORD_1: 'uv2',\n\t\tCOLOR_0: 'color',\n\t\tWEIGHTS_0: 'skinWeight',\n\t\tJOINTS_0: 'skinIndex',\n\t};\n\n\tvar PATH_PROPERTIES = {\n\t\tscale: 'scale',\n\t\ttranslation: 'position',\n\t\trotation: 'quaternion',\n\t\tweights: 'morphTargetInfluences'\n\t};\n\n\tvar INTERPOLATION = {\n\t\tCUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n\t\t                        // keyframe track will be initialized with a default interpolation type, then modified.\n\t\tLINEAR: THREE.InterpolateLinear,\n\t\tSTEP: THREE.InterpolateDiscrete\n\t};\n\n\tvar STATES_ENABLES = {\n\t\t2884: 'CULL_FACE',\n\t\t2929: 'DEPTH_TEST',\n\t\t3042: 'BLEND',\n\t\t3089: 'SCISSOR_TEST',\n\t\t32823: 'POLYGON_OFFSET_FILL',\n\t\t32926: 'SAMPLE_ALPHA_TO_COVERAGE'\n\t};\n\n\tvar ALPHA_MODES = {\n\t\tOPAQUE: 'OPAQUE',\n\t\tMASK: 'MASK',\n\t\tBLEND: 'BLEND'\n\t};\n\n\tvar MIME_TYPE_FORMATS = {\n\t\t'image/png': THREE.RGBAFormat,\n\t\t'image/jpeg': THREE.RGBFormat\n\t};\n\n\t/* UTILITY FUNCTIONS */\n\n\tfunction resolveURL( url, path ) {\n\n\t\t// Invalid URL\n\t\tif ( typeof url !== 'string' || url === '' ) return '';\n\n\t\t// Absolute URL http://,https://,//\n\t\tif ( /^(https?:)?\\/\\//i.test( url ) ) return url;\n\n\t\t// Data URI\n\t\tif ( /^data:.*,.*$/i.test( url ) ) return url;\n\n\t\t// Blob URL\n\t\tif ( /^blob:.*$/i.test( url ) ) return url;\n\n\t\t// Relative URL\n\t\treturn path + url;\n\n\t}\n\n\tvar defaultMaterial;\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n\t */\n\tfunction createDefaultMaterial() {\n\n\t\tdefaultMaterial = defaultMaterial || new THREE.MeshStandardMaterial( {\n\t\t\tcolor: 0xFFFFFF,\n\t\t\temissive: 0x000000,\n\t\t\tmetalness: 1,\n\t\t\troughness: 1,\n\t\t\ttransparent: false,\n\t\t\tdepthTest: true,\n\t\t\tside: THREE.FrontSide\n\t\t} );\n\n\t\treturn defaultMaterial;\n\n\t}\n\n\tfunction addUnknownExtensionsToUserData( knownExtensions, object, objectDef ) {\n\n\t\t// Add unknown glTF extensions to an object's userData.\n\n\t\tfor ( var name in objectDef.extensions ) {\n\n\t\t\tif ( knownExtensions[ name ] === undefined ) {\n\n\t\t\t\tobject.userData.gltfExtensions = object.userData.gltfExtensions || {};\n\t\t\t\tobject.userData.gltfExtensions[ name ] = objectDef.extensions[ name ];\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * @param {THREE.Object3D|THREE.Material|THREE.BufferGeometry} object\n\t * @param {GLTF.definition} gltfDef\n\t */\n\tfunction assignExtrasToUserData( object, gltfDef ) {\n\n\t\tif ( gltfDef.extras !== undefined ) {\n\n\t\t\tif ( typeof gltfDef.extras === 'object' ) {\n\n\t\t\t\tobject.userData = gltfDef.extras;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n\t *\n\t * @param {THREE.BufferGeometry} geometry\n\t * @param {Array<GLTF.Target>} targets\n\t * @param {GLTFParser} parser\n\t * @return {Promise<THREE.BufferGeometry>}\n\t */\n\tfunction addMorphTargets( geometry, targets, parser ) {\n\n\t\tvar hasMorphPosition = false;\n\t\tvar hasMorphNormal = false;\n\n\t\tfor ( var i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tvar target = targets[ i ];\n\n\t\t\tif ( target.POSITION !== undefined ) hasMorphPosition = true;\n\t\t\tif ( target.NORMAL !== undefined ) hasMorphNormal = true;\n\n\t\t\tif ( hasMorphPosition && hasMorphNormal ) break;\n\n\t\t}\n\n\t\tif ( ! hasMorphPosition && ! hasMorphNormal ) return Promise.resolve( geometry );\n\n\t\tvar pendingPositionAccessors = [];\n\t\tvar pendingNormalAccessors = [];\n\n\t\tfor ( var i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tvar target = targets[ i ];\n\n\t\t\tif ( hasMorphPosition ) {\n\n\t\t\t\tvar pendingAccessor = target.POSITION !== undefined\n\t\t\t\t\t? parser.getDependency( 'accessor', target.POSITION )\n\t\t\t\t\t: geometry.attributes.position;\n\n\t\t\t\tpendingPositionAccessors.push( pendingAccessor );\n\n\t\t\t}\n\n\t\t\tif ( hasMorphNormal ) {\n\n\t\t\t\tvar pendingAccessor = target.NORMAL !== undefined\n\t\t\t\t\t? parser.getDependency( 'accessor', target.NORMAL )\n\t\t\t\t\t: geometry.attributes.normal;\n\n\t\t\t\tpendingNormalAccessors.push( pendingAccessor );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( [\n\t\t\tPromise.all( pendingPositionAccessors ),\n\t\t\tPromise.all( pendingNormalAccessors )\n\t\t] ).then( function ( accessors ) {\n\n\t\t\tvar morphPositions = accessors[ 0 ];\n\t\t\tvar morphNormals = accessors[ 1 ];\n\n\t\t\t// Clone morph target accessors before modifying them.\n\n\t\t\tfor ( var i = 0, il = morphPositions.length; i < il; i ++ ) {\n\n\t\t\t\tif ( geometry.attributes.position === morphPositions[ i ] ) continue;\n\n\t\t\t\tmorphPositions[ i ] = cloneBufferAttribute( morphPositions[ i ] );\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0, il = morphNormals.length; i < il; i ++ ) {\n\n\t\t\t\tif ( geometry.attributes.normal === morphNormals[ i ] ) continue;\n\n\t\t\t\tmorphNormals[ i ] = cloneBufferAttribute( morphNormals[ i ] );\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\t\tvar target = targets[ i ];\n\t\t\t\tvar attributeName = 'morphTarget' + i;\n\n\t\t\t\tif ( hasMorphPosition ) {\n\n\t\t\t\t\t// Three.js morph position is absolute value. The formula is\n\t\t\t\t\t//   basePosition\n\t\t\t\t\t//     + weight0 * ( morphPosition0 - basePosition )\n\t\t\t\t\t//     + weight1 * ( morphPosition1 - basePosition )\n\t\t\t\t\t//     ...\n\t\t\t\t\t// while the glTF one is relative\n\t\t\t\t\t//   basePosition\n\t\t\t\t\t//     + weight0 * glTFmorphPosition0\n\t\t\t\t\t//     + weight1 * glTFmorphPosition1\n\t\t\t\t\t//     ...\n\t\t\t\t\t// then we need to convert from relative to absolute here.\n\n\t\t\t\t\tif ( target.POSITION !== undefined ) {\n\n\t\t\t\t\t\tvar positionAttribute = morphPositions[ i ];\n\t\t\t\t\t\tpositionAttribute.name = attributeName;\n\n\t\t\t\t\t\tvar position = geometry.attributes.position;\n\n\t\t\t\t\t\tfor ( var j = 0, jl = positionAttribute.count; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tpositionAttribute.setXYZ(\n\t\t\t\t\t\t\t\tj,\n\t\t\t\t\t\t\t\tpositionAttribute.getX( j ) + position.getX( j ),\n\t\t\t\t\t\t\t\tpositionAttribute.getY( j ) + position.getY( j ),\n\t\t\t\t\t\t\t\tpositionAttribute.getZ( j ) + position.getZ( j )\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( hasMorphNormal ) {\n\n\t\t\t\t\t// see target.POSITION's comment\n\n\t\t\t\t\tif ( target.NORMAL !== undefined ) {\n\n\t\t\t\t\t\tvar normalAttribute = morphNormals[ i ];\n\t\t\t\t\t\tnormalAttribute.name = attributeName;\n\n\t\t\t\t\t\tvar normal = geometry.attributes.normal;\n\n\t\t\t\t\t\tfor ( var j = 0, jl = normalAttribute.count; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tnormalAttribute.setXYZ(\n\t\t\t\t\t\t\t\tj,\n\t\t\t\t\t\t\t\tnormalAttribute.getX( j ) + normal.getX( j ),\n\t\t\t\t\t\t\t\tnormalAttribute.getY( j ) + normal.getY( j ),\n\t\t\t\t\t\t\t\tnormalAttribute.getZ( j ) + normal.getZ( j )\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( hasMorphPosition ) geometry.morphAttributes.position = morphPositions;\n\t\t\tif ( hasMorphNormal ) geometry.morphAttributes.normal = morphNormals;\n\n\t\t\treturn geometry;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * @param {THREE.Mesh} mesh\n\t * @param {GLTF.Mesh} meshDef\n\t */\n\tfunction updateMorphTargets( mesh, meshDef ) {\n\n\t\tmesh.updateMorphTargets();\n\n\t\tif ( meshDef.weights !== undefined ) {\n\n\t\t\tfor ( var i = 0, il = meshDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\tmesh.morphTargetInfluences[ i ] = meshDef.weights[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// .extras has user-defined data, so check that .extras.targetNames is an array.\n\t\tif ( meshDef.extras && Array.isArray( meshDef.extras.targetNames ) ) {\n\n\t\t\tvar targetNames = meshDef.extras.targetNames;\n\n\t\t\tif ( mesh.morphTargetInfluences.length === targetNames.length ) {\n\n\t\t\t\tmesh.morphTargetDictionary = {};\n\n\t\t\t\tfor ( var i = 0, il = targetNames.length; i < il; i ++ ) {\n\n\t\t\t\t\tmesh.morphTargetDictionary[ targetNames[ i ] ] = i;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\tfunction isObjectEqual( a, b ) {\n\n\t\tif ( Object.keys( a ).length !== Object.keys( b ).length ) return false;\n\n\t\tfor ( var key in a ) {\n\n\t\t\tif ( a[ key ] !== b[ key ] ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tfunction createPrimitiveKey( primitiveDef ) {\n\n\t\tvar dracoExtension = primitiveDef.extensions && primitiveDef.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ];\n\t\tvar geometryKey;\n\n\t\tif ( dracoExtension ) {\n\n\t\t\tgeometryKey = 'draco:' + dracoExtension.bufferView\n\t\t\t\t+ ':' + dracoExtension.indices\n\t\t\t\t+ ':' + createAttributesKey( dracoExtension.attributes );\n\n\t\t} else {\n\n\t\t\tgeometryKey = primitiveDef.indices + ':' + createAttributesKey( primitiveDef.attributes ) + ':' + primitiveDef.mode;\n\n\t\t}\n\n\t\treturn geometryKey;\n\n\t}\n\n\tfunction createAttributesKey( attributes ) {\n\n\t\tvar attributesKey = '';\n\n\t\tvar keys = Object.keys( attributes ).sort();\n\n\t\tfor ( var i = 0, il = keys.length; i < il; i ++ ) {\n\n\t\t\tattributesKey += keys[ i ] + ':' + attributes[ keys[ i ] ] + ';';\n\n\t\t}\n\n\t\treturn attributesKey;\n\n\t}\n\n\tfunction cloneBufferAttribute( attribute ) {\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tvar count = attribute.count;\n\t\t\tvar itemSize = attribute.itemSize;\n\t\t\tvar array = attribute.array.slice( 0, count * itemSize );\n\n\t\t\tfor ( var i = 0, j = 0; i < count; ++ i ) {\n\n\t\t\t\tarray[ j ++ ] = attribute.getX( i );\n\t\t\t\tif ( itemSize >= 2 ) array[ j ++ ] = attribute.getY( i );\n\t\t\t\tif ( itemSize >= 3 ) array[ j ++ ] = attribute.getZ( i );\n\t\t\t\tif ( itemSize >= 4 ) array[ j ++ ] = attribute.getW( i );\n\n\t\t\t}\n\n\t\t\treturn new THREE.BufferAttribute( array, itemSize, attribute.normalized );\n\n\t\t}\n\n\t\treturn attribute.clone();\n\n\t}\n\n\t/* GLTF PARSER */\n\n\tfunction GLTFParser( json, extensions, options ) {\n\n\t\tthis.json = json || {};\n\t\tthis.extensions = extensions || {};\n\t\tthis.options = options || {};\n\n\t\t// loader object cache\n\t\tthis.cache = new GLTFRegistry();\n\n\t\t// BufferGeometry caching\n\t\tthis.primitiveCache = {};\n\n\t\tthis.textureLoader = new THREE.TextureLoader( this.options.manager );\n\t\tthis.textureLoader.setCrossOrigin( this.options.crossOrigin );\n\n\t\tthis.fileLoader = new THREE.FileLoader( this.options.manager );\n\t\tthis.fileLoader.setResponseType( 'arraybuffer' );\n\n\t}\n\n\tGLTFParser.prototype.parse = function ( onLoad, onError ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\t\tvar extensions = this.extensions;\n\n\t\t// Clear the loader cache\n\t\tthis.cache.removeAll();\n\n\t\t// Mark the special nodes/meshes in json for efficient parse\n\t\tthis.markDefs();\n\n\t\tPromise.all( [\n\n\t\t\tthis.getDependencies( 'scene' ),\n\t\t\tthis.getDependencies( 'animation' ),\n\t\t\tthis.getDependencies( 'camera' ),\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tvar result = {\n\t\t\t\tscene: dependencies[ 0 ][ json.scene || 0 ],\n\t\t\t\tscenes: dependencies[ 0 ],\n\t\t\t\tanimations: dependencies[ 1 ],\n\t\t\t\tcameras: dependencies[ 2 ],\n\t\t\t\tasset: json.asset,\n\t\t\t\tparser: parser,\n\t\t\t\tuserData: {}\n\t\t\t};\n\n\t\t\taddUnknownExtensionsToUserData( extensions, result, json );\n\n\t\t\tonLoad( result );\n\n\t\t} ).catch( onError );\n\n\t};\n\n\t/**\n\t * Marks the special nodes/meshes in json for efficient parse.\n\t */\n\tGLTFParser.prototype.markDefs = function () {\n\n\t\tvar nodeDefs = this.json.nodes || [];\n\t\tvar skinDefs = this.json.skins || [];\n\t\tvar meshDefs = this.json.meshes || [];\n\n\t\tvar meshReferences = {};\n\t\tvar meshUses = {};\n\n\t\t// Nothing in the node definition indicates whether it is a Bone or an\n\t\t// Object3D. Use the skins' joint references to mark bones.\n\t\tfor ( var skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex ++ ) {\n\n\t\t\tvar joints = skinDefs[ skinIndex ].joints;\n\n\t\t\tfor ( var i = 0, il = joints.length; i < il; i ++ ) {\n\n\t\t\t\tnodeDefs[ joints[ i ] ].isBone = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Meshes can (and should) be reused by multiple nodes in a glTF asset. To\n\t\t// avoid having more than one THREE.Mesh with the same name, count\n\t\t// references and rename instances below.\n\t\t//\n\t\t// Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n\t\tfor ( var nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tvar nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\tif ( meshReferences[ nodeDef.mesh ] === undefined ) {\n\n\t\t\t\t\tmeshReferences[ nodeDef.mesh ] = meshUses[ nodeDef.mesh ] = 0;\n\n\t\t\t\t}\n\n\t\t\t\tmeshReferences[ nodeDef.mesh ] ++;\n\n\t\t\t\t// Nothing in the mesh definition indicates whether it is\n\t\t\t\t// a SkinnedMesh or Mesh. Use the node's mesh reference\n\t\t\t\t// to mark SkinnedMesh if node has skin.\n\t\t\t\tif ( nodeDef.skin !== undefined ) {\n\n\t\t\t\t\tmeshDefs[ nodeDef.mesh ].isSkinnedMesh = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.json.meshReferences = meshReferences;\n\t\tthis.json.meshUses = meshUses;\n\n\t};\n\n\t/**\n\t * Requests the specified dependency asynchronously, with caching.\n\t * @param {string} type\n\t * @param {number} index\n\t * @return {Promise<THREE.Object3D|THREE.Material|THREE.Texture|THREE.AnimationClip|ArrayBuffer|Object>}\n\t */\n\tGLTFParser.prototype.getDependency = function ( type, index ) {\n\n\t\tvar cacheKey = type + ':' + index;\n\t\tvar dependency = this.cache.get( cacheKey );\n\n\t\tif ( ! dependency ) {\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'scene':\n\t\t\t\t\tdependency = this.loadScene( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'node':\n\t\t\t\t\tdependency = this.loadNode( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'mesh':\n\t\t\t\t\tdependency = this.loadMesh( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'accessor':\n\t\t\t\t\tdependency = this.loadAccessor( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bufferView':\n\t\t\t\t\tdependency = this.loadBufferView( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'buffer':\n\t\t\t\t\tdependency = this.loadBuffer( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'material':\n\t\t\t\t\tdependency = this.loadMaterial( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'texture':\n\t\t\t\t\tdependency = this.loadTexture( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'skin':\n\t\t\t\t\tdependency = this.loadSkin( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'animation':\n\t\t\t\t\tdependency = this.loadAnimation( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'camera':\n\t\t\t\t\tdependency = this.loadCamera( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'light':\n\t\t\t\t\tdependency = this.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ].loadLight( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error( 'Unknown type: ' + type );\n\n\t\t\t}\n\n\t\t\tthis.cache.add( cacheKey, dependency );\n\n\t\t}\n\n\t\treturn dependency;\n\n\t};\n\n\t/**\n\t * Requests all dependencies of the specified type asynchronously, with caching.\n\t * @param {string} type\n\t * @return {Promise<Array<Object>>}\n\t */\n\tGLTFParser.prototype.getDependencies = function ( type ) {\n\n\t\tvar dependencies = this.cache.get( type );\n\n\t\tif ( ! dependencies ) {\n\n\t\t\tvar parser = this;\n\t\t\tvar defs = this.json[ type + ( type === 'mesh' ? 'es' : 's' ) ] || [];\n\n\t\t\tdependencies = Promise.all( defs.map( function ( def, index ) {\n\n\t\t\t\treturn parser.getDependency( type, index );\n\n\t\t\t} ) );\n\n\t\t\tthis.cache.add( type, dependencies );\n\n\t\t}\n\n\t\treturn dependencies;\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tGLTFParser.prototype.loadBuffer = function ( bufferIndex ) {\n\n\t\tvar bufferDef = this.json.buffers[ bufferIndex ];\n\t\tvar loader = this.fileLoader;\n\n\t\tif ( bufferDef.type && bufferDef.type !== 'arraybuffer' ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.' );\n\n\t\t}\n\n\t\t// If present, GLB container is required to be the first buffer.\n\t\tif ( bufferDef.uri === undefined && bufferIndex === 0 ) {\n\n\t\t\treturn Promise.resolve( this.extensions[ EXTENSIONS.KHR_BINARY_GLTF ].body );\n\n\t\t}\n\n\t\tvar options = this.options;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tloader.load( resolveURL( bufferDef.uri, options.path ), resolve, undefined, function () {\n\n\t\t\t\treject( new Error( 'THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".' ) );\n\n\t\t\t} );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferViewIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tGLTFParser.prototype.loadBufferView = function ( bufferViewIndex ) {\n\n\t\tvar bufferViewDef = this.json.bufferViews[ bufferViewIndex ];\n\n\t\treturn this.getDependency( 'buffer', bufferViewDef.buffer ).then( function ( buffer ) {\n\n\t\t\tvar byteLength = bufferViewDef.byteLength || 0;\n\t\t\tvar byteOffset = bufferViewDef.byteOffset || 0;\n\t\t\treturn buffer.slice( byteOffset, byteOffset + byteLength );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n\t * @param {number} accessorIndex\n\t * @return {Promise<THREE.BufferAttribute|THREE.InterleavedBufferAttribute>}\n\t */\n\tGLTFParser.prototype.loadAccessor = function ( accessorIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\n\t\tvar accessorDef = this.json.accessors[ accessorIndex ];\n\n\t\tif ( accessorDef.bufferView === undefined && accessorDef.sparse === undefined ) {\n\n\t\t\t// Ignore empty accessors, which may be used to declare runtime\n\t\t\t// information about attributes coming from another source (e.g. Draco\n\t\t\t// compression extension).\n\t\t\treturn Promise.resolve( null );\n\n\t\t}\n\n\t\tvar pendingBufferViews = [];\n\n\t\tif ( accessorDef.bufferView !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.bufferView ) );\n\n\t\t} else {\n\n\t\t\tpendingBufferViews.push( null );\n\n\t\t}\n\n\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.indices.bufferView ) );\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.values.bufferView ) );\n\n\t\t}\n\n\t\treturn Promise.all( pendingBufferViews ).then( function ( bufferViews ) {\n\n\t\t\tvar bufferView = bufferViews[ 0 ];\n\n\t\t\tvar itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tvar TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t// For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n\t\t\tvar elementBytes = TypedArray.BYTES_PER_ELEMENT;\n\t\t\tvar itemBytes = elementBytes * itemSize;\n\t\t\tvar byteOffset = accessorDef.byteOffset || 0;\n\t\t\tvar byteStride = accessorDef.bufferView !== undefined ? json.bufferViews[ accessorDef.bufferView ].byteStride : undefined;\n\t\t\tvar normalized = accessorDef.normalized === true;\n\t\t\tvar array, bufferAttribute;\n\n\t\t\t// The buffer is not interleaved if the stride is the item size in bytes.\n\t\t\tif ( byteStride && byteStride !== itemBytes ) {\n\n\t\t\t\tvar ibCacheKey = 'InterleavedBuffer:' + accessorDef.bufferView + ':' + accessorDef.componentType;\n\t\t\t\tvar ib = parser.cache.get( ibCacheKey );\n\n\t\t\t\tif ( ! ib ) {\n\n\t\t\t\t\t// Use the full buffer if it's interleaved.\n\t\t\t\t\tarray = new TypedArray( bufferView );\n\n\t\t\t\t\t// Integer parameters to IB/IBA are in array elements, not bytes.\n\t\t\t\t\tib = new THREE.InterleavedBuffer( array, byteStride / elementBytes );\n\n\t\t\t\t\tparser.cache.add( ibCacheKey, ib );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new THREE.InterleavedBufferAttribute( ib, itemSize, byteOffset / elementBytes, normalized );\n\n\t\t\t} else {\n\n\t\t\t\tif ( bufferView === null ) {\n\n\t\t\t\t\tarray = new TypedArray( accessorDef.count * itemSize );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, byteOffset, accessorDef.count * itemSize );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new THREE.BufferAttribute( array, itemSize, normalized );\n\n\t\t\t}\n\n\t\t\t// https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n\t\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\t\tvar itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\n\t\t\t\tvar TypedArrayIndices = WEBGL_COMPONENT_TYPES[ accessorDef.sparse.indices.componentType ];\n\n\t\t\t\tvar byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\n\t\t\t\tvar byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\n\n\t\t\t\tvar sparseIndices = new TypedArrayIndices( bufferViews[ 1 ], byteOffsetIndices, accessorDef.sparse.count * itemSizeIndices );\n\t\t\t\tvar sparseValues = new TypedArray( bufferViews[ 2 ], byteOffsetValues, accessorDef.sparse.count * itemSize );\n\n\t\t\t\tif ( bufferView !== null ) {\n\n\t\t\t\t\t// Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n\t\t\t\t\tbufferAttribute.setArray( bufferAttribute.array.slice() );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var i = 0, il = sparseIndices.length; i < il; i ++ ) {\n\n\t\t\t\t\tvar index = sparseIndices[ i ];\n\n\t\t\t\t\tbufferAttribute.setX( index, sparseValues[ i * itemSize ] );\n\t\t\t\t\tif ( itemSize >= 2 ) bufferAttribute.setY( index, sparseValues[ i * itemSize + 1 ] );\n\t\t\t\t\tif ( itemSize >= 3 ) bufferAttribute.setZ( index, sparseValues[ i * itemSize + 2 ] );\n\t\t\t\t\tif ( itemSize >= 4 ) bufferAttribute.setW( index, sparseValues[ i * itemSize + 3 ] );\n\t\t\t\t\tif ( itemSize >= 5 ) throw new Error( 'THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn bufferAttribute;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n\t * @param {number} textureIndex\n\t * @return {Promise<THREE.Texture>}\n\t */\n\tGLTFParser.prototype.loadTexture = function ( textureIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\t\tvar options = this.options;\n\t\tvar textureLoader = this.textureLoader;\n\n\t\tvar URL = window.URL || window.webkitURL;\n\n\t\tvar textureDef = json.textures[ textureIndex ];\n\n\t\tvar textureExtensions = textureDef.extensions || {};\n\n\t\tvar source;\n\n\t\tif ( textureExtensions[ EXTENSIONS.MSFT_TEXTURE_DDS ] ) {\n\n\t\t\tsource = json.images[ textureExtensions[ EXTENSIONS.MSFT_TEXTURE_DDS ].source ];\n\n\t\t} else {\n\n\t\t\tsource = json.images[ textureDef.source ];\n\n\t\t}\n\n\t\tvar sourceURI = source.uri;\n\t\tvar isObjectURL = false;\n\n\t\tif ( source.bufferView !== undefined ) {\n\n\t\t\t// Load binary image data from bufferView, if provided.\n\n\t\t\tsourceURI = parser.getDependency( 'bufferView', source.bufferView ).then( function ( bufferView ) {\n\n\t\t\t\tisObjectURL = true;\n\t\t\t\tvar blob = new Blob( [ bufferView ], { type: source.mimeType } );\n\t\t\t\tsourceURI = URL.createObjectURL( blob );\n\t\t\t\treturn sourceURI;\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn Promise.resolve( sourceURI ).then( function ( sourceURI ) {\n\n\t\t\t// Load Texture resource.\n\n\t\t\tvar loader = THREE.Loader.Handlers.get( sourceURI );\n\n\t\t\tif ( ! loader ) {\n\n\t\t\t\tloader = textureExtensions[ EXTENSIONS.MSFT_TEXTURE_DDS ]\n\t\t\t\t\t? parser.extensions[ EXTENSIONS.MSFT_TEXTURE_DDS ].ddsLoader\n\t\t\t\t\t: textureLoader;\n\n\t\t\t}\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tloader.load( resolveURL( sourceURI, options.path ), resolve, undefined, reject );\n\n\t\t\t} );\n\n\t\t} ).then( function ( texture ) {\n\n\t\t\t// Clean up resources and configure Texture.\n\n\t\t\tif ( isObjectURL === true ) {\n\n\t\t\t\tURL.revokeObjectURL( sourceURI );\n\n\t\t\t}\n\n\t\t\ttexture.flipY = false;\n\n\t\t\tif ( textureDef.name !== undefined ) texture.name = textureDef.name;\n\n\t\t\t// Ignore unknown mime types, like DDS files.\n\t\t\tif ( source.mimeType in MIME_TYPE_FORMATS ) {\n\n\t\t\t\ttexture.format = MIME_TYPE_FORMATS[ source.mimeType ];\n\n\t\t\t}\n\n\t\t\tvar samplers = json.samplers || {};\n\t\t\tvar sampler = samplers[ textureDef.sampler ] || {};\n\n\t\t\ttexture.magFilter = WEBGL_FILTERS[ sampler.magFilter ] || THREE.LinearFilter;\n\t\t\ttexture.minFilter = WEBGL_FILTERS[ sampler.minFilter ] || THREE.LinearMipMapLinearFilter;\n\t\t\ttexture.wrapS = WEBGL_WRAPPINGS[ sampler.wrapS ] || THREE.RepeatWrapping;\n\t\t\ttexture.wrapT = WEBGL_WRAPPINGS[ sampler.wrapT ] || THREE.RepeatWrapping;\n\n\t\t\treturn texture;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Asynchronously assigns a texture to the given material parameters.\n\t * @param {Object} materialParams\n\t * @param {string} mapName\n\t * @param {Object} mapDef\n\t * @return {Promise}\n\t */\n\tGLTFParser.prototype.assignTexture = function ( materialParams, mapName, mapDef ) {\n\n\t\tvar parser = this;\n\n\t\treturn this.getDependency( 'texture', mapDef.index ).then( function ( texture ) {\n\n\t\t\tif ( ! texture.isCompressedTexture ) {\n\n\t\t\t\tswitch ( mapName ) {\n\n\t\t\t\t\tcase 'aoMap':\n\t\t\t\t\tcase 'emissiveMap':\n\t\t\t\t\tcase 'metalnessMap':\n\t\t\t\t\tcase 'normalMap':\n\t\t\t\t\tcase 'roughnessMap':\n\t\t\t\t\t\ttexture.format = THREE.RGBFormat;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] ) {\n\n\t\t\t\tvar transform = mapDef.extensions !== undefined ? mapDef.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] : undefined;\n\n\t\t\t\tif ( transform ) {\n\n\t\t\t\t\ttexture = parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ].extendTexture( texture, transform );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tmaterialParams[ mapName ] = texture;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Assigns final material to a Mesh, Line, or Points instance. The instance\n\t * already has a material (generated from the glTF material options alone)\n\t * but reuse of the same glTF material may require multiple threejs materials\n\t * to accomodate different primitive types, defines, etc. New materials will\n\t * be created if necessary, and reused from a cache.\n\t * @param  {THREE.Object3D} mesh Mesh, Line, or Points instance.\n\t */\n\tGLTFParser.prototype.assignFinalMaterial = function ( mesh ) {\n\n\t\tvar geometry = mesh.geometry;\n\t\tvar material = mesh.material;\n\t\tvar extensions = this.extensions;\n\n\t\tvar useVertexTangents = geometry.attributes.tangent !== undefined;\n\t\tvar useVertexColors = geometry.attributes.color !== undefined;\n\t\tvar useFlatShading = geometry.attributes.normal === undefined;\n\t\tvar useSkinning = mesh.isSkinnedMesh === true;\n\t\tvar useMorphTargets = Object.keys( geometry.morphAttributes ).length > 0;\n\t\tvar useMorphNormals = useMorphTargets && geometry.morphAttributes.normal !== undefined;\n\n\t\tif ( mesh.isPoints ) {\n\n\t\t\tvar cacheKey = 'PointsMaterial:' + material.uuid;\n\n\t\t\tvar pointsMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! pointsMaterial ) {\n\n\t\t\t\tpointsMaterial = new THREE.PointsMaterial();\n\t\t\t\tTHREE.Material.prototype.copy.call( pointsMaterial, material );\n\t\t\t\tpointsMaterial.color.copy( material.color );\n\t\t\t\tpointsMaterial.map = material.map;\n\t\t\t\tpointsMaterial.lights = false; // PointsMaterial doesn't support lights yet\n\n\t\t\t\tthis.cache.add( cacheKey, pointsMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = pointsMaterial;\n\n\t\t} else if ( mesh.isLine ) {\n\n\t\t\tvar cacheKey = 'LineBasicMaterial:' + material.uuid;\n\n\t\t\tvar lineMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! lineMaterial ) {\n\n\t\t\t\tlineMaterial = new THREE.LineBasicMaterial();\n\t\t\t\tTHREE.Material.prototype.copy.call( lineMaterial, material );\n\t\t\t\tlineMaterial.color.copy( material.color );\n\t\t\t\tlineMaterial.lights = false; // LineBasicMaterial doesn't support lights yet\n\n\t\t\t\tthis.cache.add( cacheKey, lineMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = lineMaterial;\n\n\t\t}\n\n\t\t// Clone the material if it will be modified\n\t\tif ( useVertexTangents || useVertexColors || useFlatShading || useSkinning || useMorphTargets ) {\n\n\t\t\tvar cacheKey = 'ClonedMaterial:' + material.uuid + ':';\n\n\t\t\tif ( material.isGLTFSpecularGlossinessMaterial ) cacheKey += 'specular-glossiness:';\n\t\t\tif ( useSkinning ) cacheKey += 'skinning:';\n\t\t\tif ( useVertexTangents ) cacheKey += 'vertex-tangents:';\n\t\t\tif ( useVertexColors ) cacheKey += 'vertex-colors:';\n\t\t\tif ( useFlatShading ) cacheKey += 'flat-shading:';\n\t\t\tif ( useMorphTargets ) cacheKey += 'morph-targets:';\n\t\t\tif ( useMorphNormals ) cacheKey += 'morph-normals:';\n\n\t\t\tvar cachedMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! cachedMaterial ) {\n\n\t\t\t\tcachedMaterial = material.isGLTFSpecularGlossinessMaterial\n\t\t\t\t\t? extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].cloneMaterial( material )\n\t\t\t\t\t: material.clone();\n\n\t\t\t\tif ( useSkinning ) cachedMaterial.skinning = true;\n\t\t\t\tif ( useVertexTangents ) cachedMaterial.vertexTangents = true;\n\t\t\t\tif ( useVertexColors ) cachedMaterial.vertexColors = THREE.VertexColors;\n\t\t\t\tif ( useFlatShading ) cachedMaterial.flatShading = true;\n\t\t\t\tif ( useMorphTargets ) cachedMaterial.morphTargets = true;\n\t\t\t\tif ( useMorphNormals ) cachedMaterial.morphNormals = true;\n\n\t\t\t\tthis.cache.add( cacheKey, cachedMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = cachedMaterial;\n\n\t\t}\n\n\t\t// workarounds for mesh and geometry\n\n\t\tif ( material.aoMap && geometry.attributes.uv2 === undefined && geometry.attributes.uv !== undefined ) {\n\n\t\t\tconsole.log( 'THREE.GLTFLoader: Duplicating UVs to support aoMap.' );\n\t\t\tgeometry.addAttribute( 'uv2', new THREE.BufferAttribute( geometry.attributes.uv.array, 2 ) );\n\n\t\t}\n\n\t\tif ( material.isGLTFSpecularGlossinessMaterial ) {\n\n\t\t\t// for GLTFSpecularGlossinessMaterial(ShaderMaterial) uniforms runtime update\n\t\t\tmesh.onBeforeRender = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].refreshUniforms;\n\n\t\t}\n\n\t\tmesh.material = material;\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n\t * @param {number} materialIndex\n\t * @return {Promise<THREE.Material>}\n\t */\n\tGLTFParser.prototype.loadMaterial = function ( materialIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\t\tvar extensions = this.extensions;\n\t\tvar materialDef = json.materials[ materialIndex ];\n\n\t\tvar materialType;\n\t\tvar materialParams = {};\n\t\tvar materialExtensions = materialDef.extensions || {};\n\n\t\tvar pending = [];\n\n\t\tif ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ] ) {\n\n\t\t\tvar sgExtension = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ];\n\t\t\tmaterialType = sgExtension.getMaterialType();\n\t\t\tpending.push( sgExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else if ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ] ) {\n\n\t\t\tvar kmuExtension = extensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ];\n\t\t\tmaterialType = kmuExtension.getMaterialType();\n\t\t\tpending.push( kmuExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else {\n\n\t\t\t// Specification:\n\t\t\t// https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n\t\t\tmaterialType = THREE.MeshStandardMaterial;\n\n\t\t\tvar metallicRoughness = materialDef.pbrMetallicRoughness || {};\n\n\t\t\tmaterialParams.color = new THREE.Color( 1.0, 1.0, 1.0 );\n\t\t\tmaterialParams.opacity = 1.0;\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tvar array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\n\n\t\t\t}\n\n\t\t\tmaterialParams.metalness = metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n\t\t\tmaterialParams.roughness = metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n\t\t\tif ( metallicRoughness.metallicRoughnessTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'metalnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'roughnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.doubleSided === true ) {\n\n\t\t\tmaterialParams.side = THREE.DoubleSide;\n\n\t\t}\n\n\t\tvar alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\n\n\t\tif ( alphaMode === ALPHA_MODES.BLEND ) {\n\n\t\t\tmaterialParams.transparent = true;\n\n\t\t} else {\n\n\t\t\tmaterialParams.transparent = false;\n\n\t\t\tif ( alphaMode === ALPHA_MODES.MASK ) {\n\n\t\t\t\tmaterialParams.alphaTest = materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.normalTexture !== undefined && materialType !== THREE.MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'normalMap', materialDef.normalTexture ) );\n\n\t\t\tmaterialParams.normalScale = new THREE.Vector2( 1, 1 );\n\n\t\t\tif ( materialDef.normalTexture.scale !== undefined ) {\n\n\t\t\t\tmaterialParams.normalScale.set( materialDef.normalTexture.scale, materialDef.normalTexture.scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.occlusionTexture !== undefined && materialType !== THREE.MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'aoMap', materialDef.occlusionTexture ) );\n\n\t\t\tif ( materialDef.occlusionTexture.strength !== undefined ) {\n\n\t\t\t\tmaterialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.emissiveFactor !== undefined && materialType !== THREE.MeshBasicMaterial ) {\n\n\t\t\tmaterialParams.emissive = new THREE.Color().fromArray( materialDef.emissiveFactor );\n\n\t\t}\n\n\t\tif ( materialDef.emissiveTexture !== undefined && materialType !== THREE.MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'emissiveMap', materialDef.emissiveTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\tvar material;\n\n\t\t\tif ( materialType === THREE.ShaderMaterial ) {\n\n\t\t\t\tmaterial = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].createMaterial( materialParams );\n\n\t\t\t} else {\n\n\t\t\t\tmaterial = new materialType( materialParams );\n\n\t\t\t}\n\n\t\t\tif ( materialDef.name !== undefined ) material.name = materialDef.name;\n\n\t\t\t// baseColorTexture, emissiveTexture, and specularGlossinessTexture use sRGB encoding.\n\t\t\tif ( material.map ) material.map.encoding = THREE.sRGBEncoding;\n\t\t\tif ( material.emissiveMap ) material.emissiveMap.encoding = THREE.sRGBEncoding;\n\t\t\tif ( material.specularMap ) material.specularMap.encoding = THREE.sRGBEncoding;\n\n\t\t\tassignExtrasToUserData( material, materialDef );\n\n\t\t\tif ( materialDef.extensions ) addUnknownExtensionsToUserData( extensions, material, materialDef );\n\n\t\t\treturn material;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * @param {THREE.BufferGeometry} geometry\n\t * @param {GLTF.Primitive} primitiveDef\n\t * @param {GLTFParser} parser\n\t * @return {Promise<THREE.BufferGeometry>}\n\t */\n\tfunction addPrimitiveAttributes( geometry, primitiveDef, parser ) {\n\n\t\tvar attributes = primitiveDef.attributes;\n\n\t\tvar pending = [];\n\n\t\tfunction assignAttributeAccessor( accessorIndex, attributeName ) {\n\n\t\t\treturn parser.getDependency( 'accessor', accessorIndex )\n\t\t\t\t.then( function ( accessor ) {\n\n\t\t\t\t\tgeometry.addAttribute( attributeName, accessor );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tfor ( var gltfAttributeName in attributes ) {\n\n\t\t\tvar threeAttributeName = ATTRIBUTES[ gltfAttributeName ] || gltfAttributeName.toLowerCase();\n\n\t\t\t// Skip attributes already provided by e.g. Draco extension.\n\t\t\tif ( threeAttributeName in geometry.attributes ) continue;\n\n\t\t\tpending.push( assignAttributeAccessor( attributes[ gltfAttributeName ], threeAttributeName ) );\n\n\t\t}\n\n\t\tif ( primitiveDef.indices !== undefined && ! geometry.index ) {\n\n\t\t\tvar accessor = parser.getDependency( 'accessor', primitiveDef.indices ).then( function ( accessor ) {\n\n\t\t\t\tgeometry.setIndex( accessor );\n\n\t\t\t} );\n\n\t\t\tpending.push( accessor );\n\n\t\t}\n\n\t\tassignExtrasToUserData( geometry, primitiveDef );\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\treturn primitiveDef.targets !== undefined\n\t\t\t\t? addMorphTargets( geometry, primitiveDef.targets, parser )\n\t\t\t\t: geometry;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n\t *\n\t * Creates BufferGeometries from primitives.\n\t *\n\t * @param {Array<GLTF.Primitive>} primitives\n\t * @return {Promise<Array<THREE.BufferGeometry>>}\n\t */\n\tGLTFParser.prototype.loadGeometries = function ( primitives ) {\n\n\t\tvar parser = this;\n\t\tvar extensions = this.extensions;\n\t\tvar cache = this.primitiveCache;\n\n\t\tfunction createDracoPrimitive( primitive ) {\n\n\t\t\treturn extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ]\n\t\t\t\t.decodePrimitive( primitive, parser )\n\t\t\t\t.then( function ( geometry ) {\n\n\t\t\t\t\treturn addPrimitiveAttributes( geometry, primitive, parser );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tvar pending = [];\n\n\t\tfor ( var i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tvar primitive = primitives[ i ];\n\t\t\tvar cacheKey = createPrimitiveKey( primitive );\n\n\t\t\t// See if we've already created this geometry\n\t\t\tvar cached = cache[ cacheKey ];\n\n\t\t\tif ( cached ) {\n\n\t\t\t\t// Use the cached geometry if it exists\n\t\t\t\tpending.push( cached.promise );\n\n\t\t\t} else {\n\n\t\t\t\tvar geometryPromise;\n\n\t\t\t\tif ( primitive.extensions && primitive.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] ) {\n\n\t\t\t\t\t// Use DRACO geometry if available\n\t\t\t\t\tgeometryPromise = createDracoPrimitive( primitive );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Otherwise create a new geometry\n\t\t\t\t\tgeometryPromise = addPrimitiveAttributes( new THREE.BufferGeometry(), primitive, parser );\n\n\t\t\t\t}\n\n\t\t\t\t// Cache this geometry\n\t\t\t\tcache[ cacheKey ] = { primitive: primitive, promise: geometryPromise };\n\n\t\t\t\tpending.push( geometryPromise );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n\t * @param {number} meshIndex\n\t * @return {Promise<THREE.Group|THREE.Mesh|THREE.SkinnedMesh>}\n\t */\n\tGLTFParser.prototype.loadMesh = function ( meshIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\t\tvar extensions = this.extensions;\n\n\t\tvar meshDef = json.meshes[ meshIndex ];\n\t\tvar primitives = meshDef.primitives;\n\n\t\tvar pending = [];\n\n\t\tfor ( var i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tvar material = primitives[ i ].material === undefined\n\t\t\t\t? createDefaultMaterial()\n\t\t\t\t: this.getDependency( 'material', primitives[ i ].material );\n\n\t\t\tpending.push( material );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function ( originalMaterials ) {\n\n\t\t\treturn parser.loadGeometries( primitives ).then( function ( geometries ) {\n\n\t\t\t\tvar meshes = [];\n\n\t\t\t\tfor ( var i = 0, il = geometries.length; i < il; i ++ ) {\n\n\t\t\t\t\tvar geometry = geometries[ i ];\n\t\t\t\t\tvar primitive = primitives[ i ];\n\n\t\t\t\t\t// 1. create Mesh\n\n\t\t\t\t\tvar mesh;\n\n\t\t\t\t\tvar material = originalMaterials[ i ];\n\n\t\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n\t\t\t\t\t\tprimitive.mode === undefined ) {\n\n\t\t\t\t\t\t// .isSkinnedMesh isn't in glTF spec. See .markDefs()\n\t\t\t\t\t\tmesh = meshDef.isSkinnedMesh === true\n\t\t\t\t\t\t\t? new THREE.SkinnedMesh( geometry, material )\n\t\t\t\t\t\t\t: new THREE.Mesh( geometry, material );\n\n\t\t\t\t\t\tif ( mesh.isSkinnedMesh === true ) mesh.normalizeSkinWeights(); // #15319\n\n\t\t\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ) {\n\n\t\t\t\t\t\t\tmesh.drawMode = THREE.TriangleStripDrawMode;\n\n\t\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ) {\n\n\t\t\t\t\t\t\tmesh.drawMode = THREE.TriangleFanDrawMode;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINES ) {\n\n\t\t\t\t\t\tmesh = new THREE.LineSegments( geometry, material );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_STRIP ) {\n\n\t\t\t\t\t\tmesh = new THREE.Line( geometry, material );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_LOOP ) {\n\n\t\t\t\t\t\tmesh = new THREE.LineLoop( geometry, material );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.POINTS ) {\n\n\t\t\t\t\t\tmesh = new THREE.Points( geometry, material );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( Object.keys( mesh.geometry.morphAttributes ).length > 0 ) {\n\n\t\t\t\t\t\tupdateMorphTargets( mesh, meshDef );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmesh.name = meshDef.name || ( 'mesh_' + meshIndex );\n\n\t\t\t\t\tif ( geometries.length > 1 ) mesh.name += '_' + i;\n\n\t\t\t\t\tassignExtrasToUserData( mesh, meshDef );\n\n\t\t\t\t\tparser.assignFinalMaterial( mesh );\n\n\t\t\t\t\tmeshes.push( mesh );\n\n\t\t\t\t}\n\n\t\t\t\tif ( meshes.length === 1 ) {\n\n\t\t\t\t\treturn meshes[ 0 ];\n\n\t\t\t\t}\n\n\t\t\t\tvar group = new THREE.Group();\n\n\t\t\t\tfor ( var i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\t\tgroup.add( meshes[ i ] );\n\n\t\t\t\t}\n\n\t\t\t\treturn group;\n\n\t\t\t} );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n\t * @param {number} cameraIndex\n\t * @return {Promise<THREE.Camera>}\n\t */\n\tGLTFParser.prototype.loadCamera = function ( cameraIndex ) {\n\n\t\tvar camera;\n\t\tvar cameraDef = this.json.cameras[ cameraIndex ];\n\t\tvar params = cameraDef[ cameraDef.type ];\n\n\t\tif ( ! params ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing camera parameters.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( cameraDef.type === 'perspective' ) {\n\n\t\t\tcamera = new THREE.PerspectiveCamera( THREE.Math.radToDeg( params.yfov ), params.aspectRatio || 1, params.znear || 1, params.zfar || 2e6 );\n\n\t\t} else if ( cameraDef.type === 'orthographic' ) {\n\n\t\t\tcamera = new THREE.OrthographicCamera( params.xmag / - 2, params.xmag / 2, params.ymag / 2, params.ymag / - 2, params.znear, params.zfar );\n\n\t\t}\n\n\t\tif ( cameraDef.name !== undefined ) camera.name = cameraDef.name;\n\n\t\tassignExtrasToUserData( camera, cameraDef );\n\n\t\treturn Promise.resolve( camera );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n\t * @param {number} skinIndex\n\t * @return {Promise<Object>}\n\t */\n\tGLTFParser.prototype.loadSkin = function ( skinIndex ) {\n\n\t\tvar skinDef = this.json.skins[ skinIndex ];\n\n\t\tvar skinEntry = { joints: skinDef.joints };\n\n\t\tif ( skinDef.inverseBindMatrices === undefined ) {\n\n\t\t\treturn Promise.resolve( skinEntry );\n\n\t\t}\n\n\t\treturn this.getDependency( 'accessor', skinDef.inverseBindMatrices ).then( function ( accessor ) {\n\n\t\t\tskinEntry.inverseBindMatrices = accessor;\n\n\t\t\treturn skinEntry;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n\t * @param {number} animationIndex\n\t * @return {Promise<THREE.AnimationClip>}\n\t */\n\tGLTFParser.prototype.loadAnimation = function ( animationIndex ) {\n\n\t\tvar json = this.json;\n\n\t\tvar animationDef = json.animations[ animationIndex ];\n\n\t\tvar pendingNodes = [];\n\t\tvar pendingInputAccessors = [];\n\t\tvar pendingOutputAccessors = [];\n\t\tvar pendingSamplers = [];\n\t\tvar pendingTargets = [];\n\n\t\tfor ( var i = 0, il = animationDef.channels.length; i < il; i ++ ) {\n\n\t\t\tvar channel = animationDef.channels[ i ];\n\t\t\tvar sampler = animationDef.samplers[ channel.sampler ];\n\t\t\tvar target = channel.target;\n\t\t\tvar name = target.node !== undefined ? target.node : target.id; // NOTE: target.id is deprecated.\n\t\t\tvar input = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.input ] : sampler.input;\n\t\t\tvar output = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.output ] : sampler.output;\n\n\t\t\tpendingNodes.push( this.getDependency( 'node', name ) );\n\t\t\tpendingInputAccessors.push( this.getDependency( 'accessor', input ) );\n\t\t\tpendingOutputAccessors.push( this.getDependency( 'accessor', output ) );\n\t\t\tpendingSamplers.push( sampler );\n\t\t\tpendingTargets.push( target );\n\n\t\t}\n\n\t\treturn Promise.all( [\n\n\t\t\tPromise.all( pendingNodes ),\n\t\t\tPromise.all( pendingInputAccessors ),\n\t\t\tPromise.all( pendingOutputAccessors ),\n\t\t\tPromise.all( pendingSamplers ),\n\t\t\tPromise.all( pendingTargets )\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tvar nodes = dependencies[ 0 ];\n\t\t\tvar inputAccessors = dependencies[ 1 ];\n\t\t\tvar outputAccessors = dependencies[ 2 ];\n\t\t\tvar samplers = dependencies[ 3 ];\n\t\t\tvar targets = dependencies[ 4 ];\n\n\t\t\tvar tracks = [];\n\n\t\t\tfor ( var i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tvar node = nodes[ i ];\n\t\t\t\tvar inputAccessor = inputAccessors[ i ];\n\t\t\t\tvar outputAccessor = outputAccessors[ i ];\n\t\t\t\tvar sampler = samplers[ i ];\n\t\t\t\tvar target = targets[ i ];\n\n\t\t\t\tif ( node === undefined ) continue;\n\n\t\t\t\tnode.updateMatrix();\n\t\t\t\tnode.matrixAutoUpdate = true;\n\n\t\t\t\tvar TypedKeyframeTrack;\n\n\t\t\t\tswitch ( PATH_PROPERTIES[ target.path ] ) {\n\n\t\t\t\t\tcase PATH_PROPERTIES.weights:\n\n\t\t\t\t\t\tTypedKeyframeTrack = THREE.NumberKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase PATH_PROPERTIES.rotation:\n\n\t\t\t\t\t\tTypedKeyframeTrack = THREE.QuaternionKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase PATH_PROPERTIES.position:\n\t\t\t\t\tcase PATH_PROPERTIES.scale:\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tTypedKeyframeTrack = THREE.VectorKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tvar targetName = node.name ? node.name : node.uuid;\n\n\t\t\t\tvar interpolation = sampler.interpolation !== undefined ? INTERPOLATION[ sampler.interpolation ] : THREE.InterpolateLinear;\n\n\t\t\t\tvar targetNames = [];\n\n\t\t\t\tif ( PATH_PROPERTIES[ target.path ] === PATH_PROPERTIES.weights ) {\n\n\t\t\t\t\t// Node may be a THREE.Group (glTF mesh with several primitives) or a THREE.Mesh.\n\t\t\t\t\tnode.traverse( function ( object ) {\n\n\t\t\t\t\t\tif ( object.isMesh === true && object.morphTargetInfluences ) {\n\n\t\t\t\t\t\t\ttargetNames.push( object.name ? object.name : object.uuid );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttargetNames.push( targetName );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var j = 0, jl = targetNames.length; j < jl; j ++ ) {\n\n\t\t\t\t\tvar track = new TypedKeyframeTrack(\n\t\t\t\t\t\ttargetNames[ j ] + '.' + PATH_PROPERTIES[ target.path ],\n\t\t\t\t\t\tinputAccessor.array,\n\t\t\t\t\t\toutputAccessor.array,\n\t\t\t\t\t\tinterpolation\n\t\t\t\t\t);\n\n\t\t\t\t\t// Override interpolation with custom factory method.\n\t\t\t\t\tif ( sampler.interpolation === 'CUBICSPLINE' ) {\n\n\t\t\t\t\t\ttrack.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline( result ) {\n\n\t\t\t\t\t\t\t// A CUBICSPLINE keyframe in glTF has three output values for each input value,\n\t\t\t\t\t\t\t// representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n\t\t\t\t\t\t\t// must be divided by three to get the interpolant's sampleSize argument.\n\n\t\t\t\t\t\t\treturn new GLTFCubicSplineInterpolant( this.times, this.values, this.getValueSize() / 3, result );\n\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\n\t\t\t\t\t\ttrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttracks.push( track );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar name = animationDef.name !== undefined ? animationDef.name : 'animation_' + animationIndex;\n\n\t\t\treturn new THREE.AnimationClip( name, undefined, tracks );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n\t * @param {number} nodeIndex\n\t * @return {Promise<THREE.Object3D>}\n\t */\n\tGLTFParser.prototype.loadNode = function ( nodeIndex ) {\n\n\t\tvar json = this.json;\n\t\tvar extensions = this.extensions;\n\t\tvar parser = this;\n\n\t\tvar meshReferences = json.meshReferences;\n\t\tvar meshUses = json.meshUses;\n\n\t\tvar nodeDef = json.nodes[ nodeIndex ];\n\n\t\treturn ( function () {\n\n\t\t\t// .isBone isn't in glTF spec. See .markDefs\n\t\t\tif ( nodeDef.isBone === true ) {\n\n\t\t\t\treturn Promise.resolve( new THREE.Bone() );\n\n\t\t\t} else if ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\treturn parser.getDependency( 'mesh', nodeDef.mesh ).then( function ( mesh ) {\n\n\t\t\t\t\tvar node;\n\n\t\t\t\t\tif ( meshReferences[ nodeDef.mesh ] > 1 ) {\n\n\t\t\t\t\t\tvar instanceNum = meshUses[ nodeDef.mesh ] ++;\n\n\t\t\t\t\t\tnode = mesh.clone();\n\t\t\t\t\t\tnode.name += '_instance_' + instanceNum;\n\n\t\t\t\t\t\t// onBeforeRender copy for Specular-Glossiness\n\t\t\t\t\t\tnode.onBeforeRender = mesh.onBeforeRender;\n\n\t\t\t\t\t\tfor ( var i = 0, il = node.children.length; i < il; i ++ ) {\n\n\t\t\t\t\t\t\tnode.children[ i ].name += '_instance_' + instanceNum;\n\t\t\t\t\t\t\tnode.children[ i ].onBeforeRender = mesh.children[ i ].onBeforeRender;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tnode = mesh;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// if weights are provided on the node, override weights on the mesh.\n\t\t\t\t\tif ( nodeDef.weights !== undefined ) {\n\n\t\t\t\t\t\tnode.traverse( function ( o ) {\n\n\t\t\t\t\t\t\tif ( ! o.isMesh ) return;\n\n\t\t\t\t\t\t\tfor ( var i = 0, il = nodeDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\t\t\t\t\to.morphTargetInfluences[ i ] = nodeDef.weights[ i ];\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn node;\n\n\t\t\t\t} );\n\n\t\t\t} else if ( nodeDef.camera !== undefined ) {\n\n\t\t\t\treturn parser.getDependency( 'camera', nodeDef.camera );\n\n\t\t\t} else if ( nodeDef.extensions\n\t\t\t\t&& nodeDef.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ]\n\t\t\t\t&& nodeDef.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ].light !== undefined ) {\n\n\t\t\t\treturn parser.getDependency( 'light', nodeDef.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ].light );\n\n\t\t\t} else {\n\n\t\t\t\treturn Promise.resolve( new THREE.Object3D() );\n\n\t\t\t}\n\n\t\t}() ).then( function ( node ) {\n\n\t\t\tif ( nodeDef.name !== undefined ) {\n\n\t\t\t\tnode.name = THREE.PropertyBinding.sanitizeNodeName( nodeDef.name );\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( node, nodeDef );\n\n\t\t\tif ( nodeDef.extensions ) addUnknownExtensionsToUserData( extensions, node, nodeDef );\n\n\t\t\tif ( nodeDef.matrix !== undefined ) {\n\n\t\t\t\tvar matrix = new THREE.Matrix4();\n\t\t\t\tmatrix.fromArray( nodeDef.matrix );\n\t\t\t\tnode.applyMatrix( matrix );\n\n\t\t\t} else {\n\n\t\t\t\tif ( nodeDef.translation !== undefined ) {\n\n\t\t\t\t\tnode.position.fromArray( nodeDef.translation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.rotation !== undefined ) {\n\n\t\t\t\t\tnode.quaternion.fromArray( nodeDef.rotation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.scale !== undefined ) {\n\n\t\t\t\t\tnode.scale.fromArray( nodeDef.scale );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n\t * @param {number} sceneIndex\n\t * @return {Promise<THREE.Scene>}\n\t */\n\tGLTFParser.prototype.loadScene = function () {\n\n\t\t// scene node hierachy builder\n\n\t\tfunction buildNodeHierachy( nodeId, parentObject, json, parser ) {\n\n\t\t\tvar nodeDef = json.nodes[ nodeId ];\n\n\t\t\treturn parser.getDependency( 'node', nodeId ).then( function ( node ) {\n\n\t\t\t\tif ( nodeDef.skin === undefined ) return node;\n\n\t\t\t\t// build skeleton here as well\n\n\t\t\t\tvar skinEntry;\n\n\t\t\t\treturn parser.getDependency( 'skin', nodeDef.skin ).then( function ( skin ) {\n\n\t\t\t\t\tskinEntry = skin;\n\n\t\t\t\t\tvar pendingJoints = [];\n\n\t\t\t\t\tfor ( var i = 0, il = skinEntry.joints.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tpendingJoints.push( parser.getDependency( 'node', skinEntry.joints[ i ] ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Promise.all( pendingJoints );\n\n\t\t\t\t} ).then( function ( jointNodes ) {\n\n\t\t\t\t\tvar meshes = node.isGroup === true ? node.children : [ node ];\n\n\t\t\t\t\tfor ( var i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tvar mesh = meshes[ i ];\n\n\t\t\t\t\t\tvar bones = [];\n\t\t\t\t\t\tvar boneInverses = [];\n\n\t\t\t\t\t\tfor ( var j = 0, jl = jointNodes.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tvar jointNode = jointNodes[ j ];\n\n\t\t\t\t\t\t\tif ( jointNode ) {\n\n\t\t\t\t\t\t\t\tbones.push( jointNode );\n\n\t\t\t\t\t\t\t\tvar mat = new THREE.Matrix4();\n\n\t\t\t\t\t\t\t\tif ( skinEntry.inverseBindMatrices !== undefined ) {\n\n\t\t\t\t\t\t\t\t\tmat.fromArray( skinEntry.inverseBindMatrices.array, j * 16 );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tboneInverses.push( mat );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Joint \"%s\" could not be found.', skinEntry.joints[ j ] );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmesh.bind( new THREE.Skeleton( bones, boneInverses ), mesh.matrixWorld );\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn node;\n\n\t\t\t\t} );\n\n\t\t\t} ).then( function ( node ) {\n\n\t\t\t\t// build node hierachy\n\n\t\t\t\tparentObject.add( node );\n\n\t\t\t\tvar pending = [];\n\n\t\t\t\tif ( nodeDef.children ) {\n\n\t\t\t\t\tvar children = nodeDef.children;\n\n\t\t\t\t\tfor ( var i = 0, il = children.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tvar child = children[ i ];\n\t\t\t\t\t\tpending.push( buildNodeHierachy( child, node, json, parser ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn Promise.all( pending );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn function loadScene( sceneIndex ) {\n\n\t\t\tvar json = this.json;\n\t\t\tvar extensions = this.extensions;\n\t\t\tvar sceneDef = this.json.scenes[ sceneIndex ];\n\t\t\tvar parser = this;\n\n\t\t\tvar scene = new THREE.Scene();\n\t\t\tif ( sceneDef.name !== undefined ) scene.name = sceneDef.name;\n\n\t\t\tassignExtrasToUserData( scene, sceneDef );\n\n\t\t\tif ( sceneDef.extensions ) addUnknownExtensionsToUserData( extensions, scene, sceneDef );\n\n\t\t\tvar nodeIds = sceneDef.nodes || [];\n\n\t\t\tvar pending = [];\n\n\t\t\tfor ( var i = 0, il = nodeIds.length; i < il; i ++ ) {\n\n\t\t\t\tpending.push( buildNodeHierachy( nodeIds[ i ], scene, json, parser ) );\n\n\t\t\t}\n\n\t\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\t\treturn scene;\n\n\t\t\t} );\n\n\t\t};\n\n\t}();\n\n\treturn GLTFLoader;\n\n} )();\n\n\nexport default GLTFLoader","import {OBJ_TYPES, TOTAL_OBJ_TYPES} from './Common'\nimport * as THREE from \"three\"\nimport WebLayer3D from 'three-web-layer'\nimport GPUParticles from './defs/GPUParticles'\nimport GLTFLoader from './GLTFLoader'\n\nexport class SceneGraphProvider {\n    //return the current scene. provider is in charge of tracking which scene is considered 'current'\n    //including the default scene when the project loads\n    getCurrentScene() { throw new Error(\"getCurrentScene not implemented\")}\n    getSceneObjects(scene) { throw new Error(\"getSceneObjects not implemented\")}\n    getBehaviorsForObject(obj) { throw new Error(\"getBehaviorsForObject(obj) not implemented\")}\n    //return threejs object for the id of the graph object\n    getThreeObject(id) { throw new Error(\"getThreeObject(id) not implemented\")}\n    getParsedBehaviorAsset(beh) { throw new Error(\"getParsedBehaviorAsset(behavior) not implemented\")}\n    getAllBehaviors() { throw new Error(\"getAllBehaviors() not implemented\")}\n    getAllScenes() { throw new Error(\"getAllScenes not implemented\")}\n\n    //navigate to the specified scene. id is a graph object id\n    navigateScene(id) { throw new Error(\"navigateScene(id) not implemented\")}\n\n    //media stuff\n    playMediaAsset(id) { throw new Error(\"playMediaAsset(id) not implemented\")}\n    stopMediaAsset(id) { throw new Error(\"stopMediaAsset(id) not implemented\")}\n    isMediaAssetPlaying(id) { throw new Error(\"isMediaAssetPlaying(id) not implemented\")}\n    setMediaVolume(id,vol) { throw new Error(\"setMediaVolume(asset,vol) not implemented\")}\n\n    getGraphObjectByName(name) { throw new Error(\"getGraphObjectByName(name) not implemented\")}\n    getGraphObjectById(id) { throw new Error(\"getGraphObjectById(id) not implemented\")}\n    getCamera() { throw new Error(\"getCamera() not implemented\")}\n    getTweenManager() { throw new Error(\"getTweenManager() not implemented\")}\n    getFloorNear(info) { throw new Error(\"getFloorNear not implemented\")}\n    startLocalAnchor(info) { throw new Error(\"startLocalAnchor not implemented\")}\n    stopLocalAnchor(info) { throw new Error(\"stopLocalAnchor not implemented\")}\n    startImageRecognizer(info) { throw new Error(\"startImageRecognizer not implemented\")}\n    stopImageRecognizer(info) { throw new Error(\"stopImageRecognizer not implemented\")}\n    startGeoTracker(info) { throw new Error(\"startGeoTracker not implemented\")}\n    stopGeoTracker(info) { throw new Error(\"stopGeoTracker not implemented\")}\n    startWorldInfo(info) { throw new Error(\"startWorldInformation not implemented\")}\n    stopWorldInfo(info) { throw new Error(\"stopWorldInformation not implemented\")}\n\n}\n\nclass SystemFacade {\n\n    constructor(manager, sgp, behavior) {\n        this.manager = manager\n        this.sgp = sgp\n        this.logger = this.manager.logger\n        this.tween = sgp.getTweenManager()\n        this.camera = sgp.getCamera()\n        this.globalStorage = this.manager.storage\n        this.behavior = behavior\n    }\n\n    get globals () {\n        return {\n            THREE:THREE,\n            GLTFLoader: GLTFLoader,\n            GPUParticles: GPUParticles,\n            WebLayer3D: WebLayer3D\n        }\n    }\n\n    get properties () {\n        return this.behavior.props()\n    }\n    getThreeObjectByTitle(title) {\n        const obj = this.sgp.getGraphObjectByName(title)\n        if(!obj) throw new Error(`three object '${title}' not found`)\n        return this.sgp.getThreeObject(obj)\n    }\n    getObjectByTitle(title) {\n        const obj = this.sgp.getGraphObjectByName(title)\n        if(!obj || !obj.exists()) throw new Error(`object '${title}' not found`)\n        return obj\n    }\n    getAssetByTitle(title) {\n        const obj = this.sgp.getGraphObjectByName(title)\n        if(!obj || !obj.exists()) throw new Error(`asset '${title}' not found`)\n        let trusted = this._event && this._event.data && this._event.data.event && this._event.data.event.isTrusted\n        return new AssetFacade(this.manager,obj, trusted)\n    }\n    getAssetById(id) {\n        const obj = this.getObjectById(id)\n        if(!obj || !obj.exists()) throw new Error(`asset '${id}' not found`)\n        let trusted = this._event && this._event.data && this._event.data.event && this._event.data.event.isTrusted\n        return new AssetFacade(this.manager,obj,trusted)\n    }\n    getObjectById(id) {\n        const obj = this.sgp.getGraphObjectById(id)\n        if(!obj || !obj.exists()) throw new Error(`object '${id}' not found`)\n        return obj\n    }\n    getThreeObjectById(id) {\n        return this.sgp.getThreeObject(id)\n    }\n\n    getCurrentScene() {\n        const obj = this.sgp.getCurrentScene()\n        if(!obj || !obj.exists()) throw new Error(`current scene not found`)\n        return obj\n    }\n    navigateScene(id) {\n        this.manager.fireSceneLifecycleEvent('exit',this.getCurrentScene())\n        this.sgp.navigateScene(id)\n        this.manager.fireSceneLifecycleEvent('enter',this.getCurrentScene())\n    }\n    fireEvent(type,payload,target=null) {\n        // this.manager.fireEventFromTarget(target,type,payload)\n        if (target == null) {\n            target = this.sgp.getGraphObjectById(this.behavior.parent)\n        }\n        this.manager.fireEventAtTarget(target,type,payload)\n    }\n    sendMessage(name,payload,target=null) {\n        if (target == null) {\n            target = this.sgp.getGraphObjectById(this.behavior.parent)\n        }\n        this.manager.fireMessageAtTarget(target,name,payload)\n    }\n    captureEvent() {\n        this.manager.captureEvent()\n    }\n}\n\nexport default class ScriptManager {\n    constructor(sceneGraphProvider, logger) {\n        this.sgp = sceneGraphProvider\n        this.logger = logger\n        this.running = false\n        this.storage = {}\n        this.logger = logger\n        this.logger.log(\"ScriptManager created\")\n        this.system_cache = {}\n\n        this.bubbling = true;\n\n        if (!window.THREE) window.THREE = THREE\n        if (!window.GLTFLoader) window.GLTFLoader = GLTFLoader\n        if (!window.GPUParticles) window.GPUParticles = GPUParticles\n        if (!window.WebLayer3D) window.WebLayer3D = WebLayer3D\n    }\n\n\n    fireLifecycleEvent(type) {\n        this.logger.log(`doing ${type} event`)\n        const evt = {\n            type:type\n        }\n        this.sgp.getAllScenes().forEach(scene => {\n            scene.find(child => {\n                if(child.type === TOTAL_OBJ_TYPES.BEHAVIOR) {\n                    evt.target = this.sgp.getThreeObject(child.parent)\n                    evt.graphTarget = this.sgp.getGraphObjectById(child.parent)\n                    const asset = this.sgp.getParsedBehaviorAsset(child)\n                    const system = this.getSystemFacadeFromCache(child)\n                    system.code = asset\n                    if (asset[type]) asset[type].call(system,evt)\n                } else {\n                    evt.target = this.sgp.getThreeObject(child)\n                    evt.graphTarget = child\n                    if(evt.target && evt.target[type]) evt.target[type](evt, this)\n                }\n                return true\n            })\n        })\n    }\n\n    fireSceneLifecycleEvent(type, scene, time) {\n        if(type!=='tick') this.logger.log(`doing ${type} event`)\n\n        const evt = {\n            type: type,\n            time: time ? time - this.startTime : -1,\n            deltaTime: time ? time - this.lastTime : 0,\n            session: this.session\n        }\n        if (time) {\n            this.lastTime = time\n        }\n        scene.find(child => {\n            const parentId = child.parent\n            this.fireSceneLifecycleEventAtChild(type,evt,child,parentId)\n            return true\n        })\n    }\n\n    fireSceneLifecycleEventAtChild(type,evt,child, parentId) {\n        // if(type!=='tick') this.logger.log(`calling ${type} on ${child.type} ${child.id}`)\n        if(child.type === TOTAL_OBJ_TYPES.BEHAVIOR) {\n            evt.target = this.sgp.getThreeObject(parentId)\n            evt.graphTarget = this.sgp.getGraphObjectById(parentId)\n            //evt.props = child.props()\n            const asset = this.sgp.getParsedBehaviorAsset(child)\n            const system = this.getSystemFacadeFromCache(child)\n            system.code = asset\n            if (asset[type]) asset[type].call(system,evt)\n            // if(asset[type]) asset[type](evt)\n        } else {\n            evt.target = this.sgp.getThreeObject(child)\n            evt.graphTarget = child\n            if(evt.target && evt.target[type]) evt.target[type](evt, this)\n            if(child.type === OBJ_TYPES.clone) {\n                if (type !== 'tick') console.log(`also doing ${type} event on a clone`)\n            }\n        }\n    }\n\n    tick(time, session) {\n        if(!this.running) return\n        if(this.startTime ===0) {\n            this.startTime = time\n            this.lastTime = time\n        }\n        try {\n            this.session = session\n            this.fireSceneLifecycleEvent('tick',this.sgp.getCurrentScene(),time)\n        } catch (err) {\n            this.logger.error(\"error in script\",err.message)\n            this.logger.log(err)\n            this.stopRunning()\n        }\n    }\n\n\n    startRunning() {\n        this.running = true\n        this.startTime = 0\n        this.lastTime = 0\n        this.storage = {}\n        this.logger.log(\"ScriptManager starting\")\n        try {\n            this.fireLifecycleEvent('start')\n        } catch(err) {\n            this.logger.error(\"error in script\",err.message)\n            this.logger.error(err)\n            this.stopRunning()\n        }\n    }\n\n    startFirstScene() {\n        try {\n            this.fireSceneLifecycleEvent('enter',this.sgp.getCurrentScene())\n        } catch(err) {\n            this.logger.error(\"error in script\",err.message)\n            this.logger.error(err)\n            this.stopRunning()\n        }\n    }\n    \n\n    stopRunning() {\n        try {\n            this.fireSceneLifecycleEvent('exit',this.sgp.getCurrentScene())\n            this.fireLifecycleEvent('stop')\n            this.running = false\n            this.storage = {}\n            this.destroyListeners()\n        } catch(err) {\n            this.running = false\n            this.logger.error(\"error stopping scripts\",err.message)\n            this.logger.error(err)\n        }\n        this.logger.log(\"script manager stopping\")\n    }\n    isRunning() {\n        return this.running\n    }\n\n    fireMessageAtTarget(target, name, payload) {\n        if(!this.running) return\n        try { \n            const evt = {\n                type: 'message',\n                name: name,\n                data: payload,\n                time: this.lastTime,\n                target: this.sgp.getThreeObject(target),\n                graphTarget: target,\n            }\n            const behaviors = this.sgp.getBehaviorsForObject(target)\n            behaviors.forEach(b => {\n                const system = this.getSystemFacadeFromCache(b)\n                const asset = this.sgp.getParsedBehaviorAsset(b)\n                system._event = evt   // want to be able to look for this later\n                system.code = asset\n                if (asset.message) asset.message.call(system,evt)\n                system._event = null\n            })\n        } catch (error) {\n            this.logger.error(\"error in '\" + name + \"' message\",error.message)\n            this.logger.error(error)\n            this.stopRunning()\n        }\n    }\n\n    performClickAction(target, e) {\n        this.fireEventAtTarget(target, \"click\", {event: e})\n    }\n\n    captureEvent() {\n        this.bubbling = false\n    }\n\n    fireEventAtTarget(target, type, payload) {\n        if(!this.running) return\n        try { \n            this.bubbling = true\n\n            const evt = {\n                type: type,\n                data: payload,\n                time: this.lastTime,\n                target: this.sgp.getThreeObject(target),\n                graphTarget: target,\n            }\n\n            let scene = this.sgp.getCurrentScene()\n            while (this.bubbling && target.id !== scene.id && target.type !== TOTAL_OBJ_TYPES.SCENE) {\n                //console.log(\"getting behaviors for the object\",target)\n                const behaviors = this.sgp.getBehaviorsForObject(target)\n                //this.logger.log(\"firing \" + type + \" at target \" + target.id + \", \" + behaviors.length + \" behaviors\")\n\n                behaviors.forEach(b => {\n                    const system = this.getSystemFacadeFromCache(b)\n                    const asset = this.sgp.getParsedBehaviorAsset(b)\n                    system._event = evt\n                    if (asset[type]) {\n                        system.code = asset\n                        // this.logger.log(\"found message on behavior\")\n                        asset[type].call(system,evt)\n                    } else {\n                        // this.logger.log(\"didn't find message on behavior\")\n                    }\n                    system._event = null\n                })\n                target = this.sgp.getGraphObjectById(target.parent)\n            }\n        } catch (error) {\n            this.logger.error(\"error in '\" + type + \"' event\",error.message)\n            this.logger.error(error)\n            this.stopRunning()\n        }\n    }\n\n    destroyListeners() {\n        this.listeners = {}\n    }\n\n    on(target,type,cb) {\n        if(!this.listeners) this.listeners = {}\n        if(!this.listeners[target.id]) this.listeners[target.id] = {}\n        if(!this.listeners[target.id][type]) this.listeners[target.id][type] = []\n        this.listeners[target.id][type].push(cb)\n    }\n\n    getSystemFacadeFromCache(behavior) {\n        if(!this.system_cache[behavior.id]) {\n            this.system_cache[behavior.id] = new SystemFacade(this, this.sgp, behavior)\n        }\n        return this.system_cache[behavior.id]\n    }\n}\n\n\nclass AssetFacade {\n    constructor(manager,obj, trusted) {\n        this.manager = manager\n        this.obj = obj\n        this.trusted = trusted\n    }\n    play() {\n        this.manager.sgp.playMediaAsset(this.obj, this.trusted)\n    }\n    isPlaying() {\n        return this.manager.sgp.isMediaAssetPlaying(this.obj)\n    }\n    stop() {\n        this.manager.sgp.stopMediaAsset(this.obj)\n    }\n    setVolume(vol) {\n        this.manager.sgp.setMediaVolume(this.obj, vol)\n    }\n    getType() {\n        return this.obj.subtype\n    }\n}\n","import * as THREE from 'three'\n\nclass Tween {\n    constructor() {\n        this.running = false\n    }\n    update(time) {\n        throw new Error(\"update not implemented\")\n    }\n    start() {\n        this.running = true\n    }\n    isAlive() {\n        return this.running\n    }\n    kill() {\n        this.running = false\n    }\n}\n\nclass WaitTween extends Tween {\n    constructor(dur) {\n        super()\n        this.type = 'wait'\n        this.duration = dur\n    }\n    update(time) {\n        time = time/1000\n        if(!this.startTime) this.startTime = time\n        const diff = time - this.startTime\n        let t = diff/this.duration\n        if(t >= 1) {\n            this.running = false\n        }\n    }\n}\n\nclass ActionTween extends Tween {\n    constructor(fn) {\n        super()\n        this.type = 'action'\n        this.fn = fn\n    }\n    start() {\n        const res = this.fn()\n        this.running = false\n        return res\n    }\n}\n\nclass ForeverTween extends Tween {\n    constructor(fn) {\n        super()\n        this.type = 'forever'\n        this.fn = fn\n    }\n    start() {\n        this.running = true\n        this.startTime = Date.now()/1000\n    }\n    update(time) {\n        const diff = time/1000 - this.startTime\n        this.fn(diff)\n    }\n}\n\nexport const PROP_TYPES = {\n    SINGLE:'single',\n    COMPOUND:'compound',\n}\nexport const LERP_TYPES = {\n    LINEAR:'linear',\n    ELASTIC:'elastic'\n}\n\nfunction easeOutElastic(t) {\n    var p = 0.3;\n    return Math.pow(2,-10*t) * Math.sin((t-p/4)*(2*Math.PI)/p) + 1;\n}\nfunction easeLinear(from,to,t) {\n    return (to - from) * t + from\n}\nclass PropTween extends Tween {\n    constructor(opts) {\n        super()\n        this.type = 'prop'\n        this.target = opts.target\n        this.duration = opts.duration\n        if(typeof this.duration === 'undefined') throw new Error(\"duration is missing\")\n        this.property = opts.property\n        if(typeof this.property === 'undefined') throw new Error(\"property is missing\")\n        this.propertyType = opts.propertyType || PROP_TYPES.SINGLE\n        this.from = opts.from\n        this.to = opts.to\n        this.lerp_type = opts.lerpType || LERP_TYPES.LINEAR\n\n        this.loop = opts.loop\n        if(typeof this.loop === 'undefined') this.loop = 1\n        this.loopCount = 0\n        this.reversed = false\n        this.autoReverse = opts.autoReverse\n        if(typeof this.autoReverse === 'undefined') this.autoReverse = false\n    }\n    update(time) {\n        time = time/1000\n        if(!this.startTime) this.startTime = time\n        const diff = time - this.startTime\n\n        let t = diff/this.duration\n        if(t > 1.0) {\n            t = 1.0\n        }\n        this.setPropertyValue(this.from,this.to,t)\n        if(t === 1.0) {\n            this.loopCount++\n            if(this.autoReverse) {\n                this.reversed = !this.reversed\n            }\n            if(this.loop !== -1) {\n                if(this.loopCount >= this.loop) {\n                    this.running = false\n                    return\n                }\n            }\n            this.startTime = time\n        }\n    }\n\n    setPropertyValue(from,to,t,target,name) {\n        if(this.propertyType === PROP_TYPES.SINGLE) {\n            this.target[this.property] = this.lerp(this.from, this.to, this.reversed ? (1 - t) : t)\n        }\n        if(this.propertyType === PROP_TYPES.COMPOUND) {\n            Object.keys(this.from).forEach(name => {\n                this.target[this.property][name] = this.lerp(this.from[name], this.to[name], this.reversed ? (1 - t) : t)\n            })\n        }\n    }\n\n    lerp(from,to,t) {\n        if(this.lerp_type === LERP_TYPES.LINEAR)  return easeLinear(from,to,t)\n        if(this.lerp_type === LERP_TYPES.ELASTIC) return easeLinear(from,to,easeOutElastic(t))\n        console.log(\"invalid LERP_TYPE\")\n        return from\n    }\n}\n\nclass ClipTween extends Tween {\n    constructor(opts) {\n        super()\n        this.type = 'clip'\n        this.target = opts.target\n        this.name = opts.name\n        this.loop = opts.loop\n        this.autoReverse = opts.autoReverse\n        if(typeof this.autoReverse === 'undefined') this.autoReverse = false\n        if(typeof this.loop === 'undefined') this.loop = 1\n        if(typeof this.name === 'undefined') throw new Error(\"name is missing\")\n        this.speed = opts.speed\n        if(typeof this.speed === 'undefined') this.speed = 1\n    }\n    start() {\n        this.running = true\n        this.mixer = new THREE.AnimationMixer(this.target.scene)\n        this.action = this.mixer.clipAction(THREE.AnimationClip.findByName(this.target.animations,this.name))\n        if(this.loop === 1) {\n            this.action.setLoop(THREE.LoopOnce, 1)\n        }\n        if(this.loop === -1) {\n            this.action.setLoop(this.autoReverse?THREE.LoopPingPong:THREE.LoopRepeat, Infinity)\n        }\n        if(this.loop > 1) {\n            this.action.setLoop(THREE.LoopRepeat, this.loop)\n        }\n        this.action.play()\n        this.action.setEffectiveTimeScale(this.speed)\n        this.startTime = Date.now()/1000\n        this.prevTime = this.startTime\n    }\n    update(time) {\n        const diff = time/1000 - this.prevTime\n        this.mixer.update(diff)\n        this.prevTime = time/1000\n    }\n    kill() {\n        this.action.stop()\n        this.running = false\n    }\n}\n\nclass ParallelTween extends Tween {\n    constructor() {\n        super()\n        this.subs = []\n    }\n    and(obj) {\n        if(obj instanceof Tween) {\n            this.subs.push(obj)\n        } else {\n            this.subs.push(new ActionTween(obj))\n        }\n        return this\n    }\n    start() {\n        // console.log(\"starting parallel\")\n        this.running = true\n        this.subs.forEach(s=>s.start())\n        // console.log('started')\n        // console.log(this.subs)\n        return this\n    }\n    update(time) {\n        this.subs.forEach(s => {\n            if(s.isAlive()) s.update(time)\n        })\n    }\n    isAlive() {\n        const first = this.subs.find(s => s.isAlive() === true)\n        // console.log(\"first alive is\",first)\n        return first !== undefined\n    }\n}\n\nclass SequentialTween extends Tween {\n    constructor() {\n        super()\n        this.subs = []\n        this.n = -1\n    }\n    then(obj) {\n        if(obj instanceof Tween) {\n            this.subs.push(obj)\n        } else {\n            this.subs.push(new ActionTween(obj))\n        }\n        return this\n    }\n    wait(dur) {\n        this.subs.push(new WaitTween(dur))\n        return this\n    }\n    start() {\n        this.running = true\n        this._startNext()\n        return this\n    }\n    _startNext() {\n        this.n = this.n + 1\n\n        //if at the end of everything\n        if(this.n > this.subs.length-1) {\n            this.running = false\n            this.n = -1\n            return null\n        }\n\n\n        const cur = this.subs[this.n]\n        const res = cur.start()\n        if(!cur.isAlive()) {\n            if(res) {\n                console.log(\"the next swapped itself\", res)\n                //swap in the result\n                this.subs[this.n] = res\n                //backup\n                this.n = this.n -1\n                //recurse\n                return this._startNext()\n            } else {\n                // console.log(\"the next didn't swap. just move on\")\n                return this._startNext()\n            }\n        }\n        return cur\n    }\n    update(time) {\n        // console.log('updating')\n        const cur = this.subs[this.n]\n        cur.update(time)\n        // console.log(\"updated cur\",cur, cur.isAlive())\n        if(!cur.isAlive()) this._startNext()\n\n    }\n    isAlive() {\n        const first = this.subs.find(s => s.isAlive() === true)\n        // console.log(\"first alive is\",first)\n        // console.log(this.subs)\n        return first !== undefined\n    }\n}\n\nexport class TweenManager {\n    constructor() {\n        this.subs = []\n    }\n    parallel() {\n        const t = new ParallelTween()\n        this.subs.push(t)\n        return t\n    }\n    sequence() {\n        const t =  new SequentialTween()\n        this.subs.push(t)\n        return t\n    }\n    action(fn) {\n        const t = new ActionTween(fn)\n        this.subs.push(t)\n        return t\n    }\n    prop(opts) {\n        const t = new PropTween(opts)\n        this.subs.push(t)\n        return t\n    }\n    isAlive() {\n        return this.subs.find((s => s.isAlive() === true))\n    }\n    update(time) {\n        const now = Date.now()\n        this.subs.forEach(s => {\n            if(s.isAlive()) s.update(now)\n        })\n    }\n    forever(fn) {\n        const t = new ForeverTween(fn)\n        this.subs.push(t)\n        return t\n    }\n    clip(opts) {\n        const t = new ClipTween(opts)\n        this.subs.push(t)\n        return t\n    }\n    wait(dur) {\n        const t = new WaitTween(dur)\n        this.subs.push(t)\n        return t\n    }\n}\n\n/*\n\nconst obj = { x: -1, y: -1, z: 0, w: 0}\n\nconst para = t2.parallel()\n    .and(t2.prop({ target:obj, property:'x', from:10, to:0, duration: 1}))\n    .and(()=>console.log(\"inside the parallel action\"))\n    .start()\n\nconst seq = t2.sequence()\n    .then(()=>console.log(\"first is an action\"))\n    .then(t2.prop({ target:obj, property:'y', from:10, to:0, duration: 1}))\n    .then(()=> console.log(\"inside the sequential action\"))\n    .then(t2.prop({target:obj, property:'y', from:0, to:10, duration:1 }))\n    .then(()=>{\n        console.log(\"done with part 1. calculating part 2\")\n        return t2.prop({target:obj, property:'x', from: 0, to:-8, duration:1})\n    })\n    .then(() => {\n        console.log(\"now we're going to insert a new parallel tween\")\n        return t2.parallel()\n            .and(t2.prop({target:obj, property:'z', from:-1,to:1, duration:1}))\n            .and(t2.prop({target:obj, property:'w', from:-1,to:1, duration:1}))\n    })\n    .start()\n\nfunction update() {\n    console.log(\"tick\")\n    t2.update()\n    console.log(obj)\n    if(t2.isAlive()) {\n        setTimeout(update,250)\n    } else {\n        console.log(\"done with everything. check it out!\")\n        console.log(obj.z === 1)\n    }\n}\nupdate()\n*/\n","import * as ToasterManager from './ToasterManager'\nimport {mat4, vec3} from \"gl-matrix/dist/gl-matrix.js\"\n\nlet Cesium = window.Cesium\nlet XRGeospatialAnchor = window.XRGeospatialAnchor\n\n\nexport class XRSupport {\n    constructor() {\n        this.imageDetectorMap = {}\n        this.geoAnchorMap = {}\n        this._workingMatrix = mat4.create()\n        this._identity = mat4.create()\n        this._vec = vec3.create()\n        this.lastFrameTime = 0        \n        this.heightAboveFloor = 1.1; // for now\n    }\n    static supportsARKit() {\n        if (navigator.xr && navigator.xr._mozillaXRViewer) {\n            console.log(\"*** Found mozilla xr viewer\")\n            return true\n        }\n        console.log(\"*** Did not find WebXR\")\n        return false\n    }\n\n    getContext(canvas = 0) {\n        this.device = 0\n        this.session = 0\n        this.xrCanvas = 0\n        this.xrContext = 0\n        this.canvas = canvas\n        this.context = 0\n        this.xrCanvas = document.createElement('canvas')\n        this.xrContext = this.xrCanvas.getContext('xrpresent')\n        this._anchoredNodes = new Map() // { XRAnchorOffset, Three.js Object3D }\n        this.projectionMatrix = 0\n\n        let that = this\n        let prom = new Promise((resolve, reject) => {\n            // document.body.insertBefore(this.xrCanvas, document.body.firstChild) <- not needed?\n            navigator.xr.requestDevice().then((xrDevice) => {\n                that.device = xrDevice\n                that.device.requestSession({\n                    outputContext: that.xrContext,\n                    alignEUS: true,\n                    geolocation: true,\n                    worldSensing: true\n                }).then((xrSession) => {\n                    that.session = xrSession\n\n                    // we want to always use the estimated elevation\n                    XRGeospatialAnchor.useEstimatedElevation(true, this.heightAboveFloor)\n                    this.updateGeoElevationLoop()\n\n                    // enable smooth tracking of image targets\n                    that.session.nonStandard_setNumberOfTrackedImages(4)\n\n                    if (!that.canvas) that.canvas = document.createElement('canvas')\n                    if (!that.context) that.context = that.canvas.getContext('webgl', {compatibleXRDevice: that.device})\n                    that.session.baseLayer = new window.XRWebGLLayer(that.session, that.context)\n                    resolve(that.context)\n                }).catch(err => {\n                    console.error('Session setup error', err)\n                    reject()\n                })\n            }).catch(err => {\n                console.error('Error', err)\n                reject()\n            })\n        })\n        return prom\n    }\n\n    async updateGeoElevationLoop () {\n        let sleep = function (time) {\n            return new Promise((resolve) => setTimeout(resolve, time));\n        }\n    \n        //let deviceCarto = await XRGeospatialAnchor.getDeviceCartographic()\n        //let txt = textBox.myText + \"<p>device altitude \" + deviceCarto.height.toPrecision(6) + \"</p>\" \n        //let defElev = await XRGeospatialAnchor.getDefaultElevation(deviceCarto)\n        //txt = txt + textBox.myText + \"<p>estimated altitude \" + defElev.toPrecision(6) + \"</p>\"\n        //textBox.innerHTML = txt \n\n        await XRGeospatialAnchor.useEstimatedElevation(true, this.heightAboveFloor)\n\n        await sleep(100)\n        setTimeout(() => this.updateGeoElevationLoop(), 1)\n    }\n\n    setAnimationLoop(userAnimationCallback) {\n\n        if (!userAnimationCallback) {\n            console.error(\"Supply a callback\")\n            return\n        }\n\n        // head-model is the coordinate system that tracks the position of the display\n        this.session.requestFrameOfReference('head-model').then(frameOfReference => {\n            this.headFrameOfReference = frameOfReference\n        }).catch(err => {\n            console.error('Error finding head frame of reference', err)\n        })\n\n        // get eye level which is somehow different from head level?\n        this.session.requestFrameOfReference('eye-level').then(frameOfReference => {\n            this.eyeLevelFrameOfReference = frameOfReference\n        }).catch(err => {\n            console.error('Error finding eye frame of reference', err)\n        })\n\n        // setup callback\n        this.userAnimationCallback = userAnimationCallback\n        this.__handleAnimationFrame = this._handleAnimationFrame.bind(this)\n        this.session.requestAnimationFrame(this.__handleAnimationFrame)\n    }\n\n    _handleAnimationFrame(time = 0, frame = 0) {\n        this.lastFrameTime = time\n        if (!this.session || this.session.ended) return\n\n        this.session.requestAnimationFrame(this.__handleAnimationFrame)\n\n        if (!this.headFrameOfReference || !this.eyeLevelFrameOfReference) return\n\n        let pose = frame.getDevicePose(this.eyeLevelFrameOfReference)\n        if (!pose) {\n            console.log('No pose')\n            return\n        }\n\n        for (let view of frame.views) {\n            // let higher level update itself\n            this.userAnimationCallback(\n                this.session.baseLayer.getViewport(view),\n                view.projectionMatrix,\n                pose.getViewMatrix(view),\n                time,frame,\n            )\n            this.projectionMatrix = view.projectionMatrix\n            break\n        }\n    }\n\n    getTime() { return this.lastFrameTime }\n\n    addAnchoredNode(anchor, node, logger) {\n        if (!anchor || !anchor.uid) {\n            console.error(\"not a valid anchor\", anchor)\n            logger.error(\"not a valid anchor\",anchor)\n            return\n        }\n        this._anchoredNodes.set(anchor.uid, {\n            anchor: anchor,\n            node: node\n        })\n        node.anchor = anchor\n        node.matrixAutoUpdate = false\n        node.matrix.fromArray(anchor.modelMatrix)\n        node.updateMatrixWorld(true)\n        //this._scene.add(node) -> presumably this is already done\n\n        anchor._handleAnchorUpdateCallback = this._handleAnchorUpdate.bind(this, logger)\n        anchor._handleAnchorDeleteCallback = this._handleAnchorDelete.bind(this, logger)\n\n        anchor.addEventListener(\"update\", anchor._handleAnchorUpdateCallback)\n        anchor.addEventListener(\"removed\", anchor._handleAnchorDeleteCallback)\n        logger.log(\"done adding anchored node\")\n        return node\n    }\n\n    async createSceneAnchor(sceneNode, logger) {\n        logger.log(\"Creating Scene Anchor\")\n\n        if (!this.session) {\n            logger.log(\"no session\")\n            return\n        }\n        let eyeLevel = await this.session.requestFrameOfReference('eye-level')\n        let headLevel = await this.session.requestFrameOfReference('head-model')\n\n        // get the pose of the camera in the world\n        headLevel.getTransformTo(eyeLevel, this._workingMatrix)\n\n        // get just the position\n        mat4.getTranslation(this._vec, this._workingMatrix) \n\n        // set the matrix to just the position, which means the orientation is EUS\n        mat4.fromTranslation(this._workingMatrix, this._vec)\n\n        // create that anchor\n        let newAnchor = await this.session.addAnchor(this._workingMatrix, eyeLevel)\n\n        this.addAnchoredNode(newAnchor, sceneNode, logger)\n        return newAnchor\n    }\n\n    updateAnchoredSceneNode(sceneAnchor, sceneNode, logger) {\n        logger.log(\"Replacing the scene node on the existing scene anchor\")\n        this._removeAnchorFromNode(sceneAnchor)\n        this.addAnchoredNode(sceneAnchor, sceneNode, logger)\n    }\n\n    removeSceneAnchor(sceneAnchor, logger) {\n        logger.log(\"Removing Scene Anchor\")\n        this.session.removeAnchor(sceneAnchor)\n        this._removeAnchorFromNode(sceneAnchor)\n    }\n\n    updateRayAnchor(info,logger) {\n\n        if(!this.projectionMatrix) {\n            logger.error(\"No projection matrix\")\n            return\n        }\n        if(!this.canvas || !this.canvas.width || !this.canvas.height) {\n            logger.error(\"No canvas or canvas size\")\n            return\n        }\n\n        // normalize screen coords\n        let x = this.screenx || 0\n        let y = this.screeny || 0\n        let normalizedX = x / this.canvas.width * 2 - 1;\n        let normalizedY = y / this.canvas.height * 2;\n\n        // get a ray\n        var rayorigin = vec3.create();\n        mat4.invert(this._workingMatrix, this.projectionMatrix );\n        var raydir = vec3.fromValues(normalizedX, normalizedY, 0.5);\n        vec3.transformMat4(raydir,raydir,this._workingMatrix);\n        vec3.normalize(raydir, raydir);\n\n        this.session.requestFrameOfReference('head-model').then((headLevel)=>{\n            this.session.requestFrameOfReference('eye-level').then((eyeLevel)=>{\n\n                // get collidants\n                this.session.requestHitTest(rayorigin, raydir, headLevel ).then((xrhitresults)=>{\n\n                    if (xrhitresults.length < 1) {\n                        logger.error(\"No hit returned from hit test\")\n                        return\n                    }\n\n                    this.session.addAnchor(xrhitresults[0], headLevel ).then((newAnchor)=> {\n\n                        // remove previous if any\n                        this._removeAnchorForNode(info.node)\n                 \n                        // add new\n                        this.addAnchoredNode(newAnchor,info.node,logger)\n\n                        logger.log(\"made anchor in local coords: \" + info.node.position.x + \" \" + info.node.position.y + \" \" + info.node.position.z )\n                    })\n                })\n            })\n        })\n    }\n\n    updatePointAnchor(info,logger) {\n\n        let point = info.point\n\n        this.session.requestFrameOfReference('head-model').then((headLevel)=>{\n            this.session.requestFrameOfReference('eye-level').then((eyeLevel)=>{\n                headLevel.getTransformTo(eyeLevel, this._workingMatrix)\n                mat4.fromTranslation(this._workingMatrix,point)\n\nlogger.log(this._workingMatrix)\n\n                this.session.addAnchor(this._workingMatrix,eyeLevel).then((newAnchor)=>{\n                    // remove previous if any\n                    this._removeAnchorForNode(info.node)\n             \n                    // add new\n                    this.addAnchoredNode(newAnchor,info.node,logger)\n\n                    // done\n                    logger.log(\"updated anchor in local coords: \" + info.node.position.x + \" \" + info.node.position.y + \" \" + info.node.position.z )\n                    logger.log(point)\n                })\n            })\n        })\n    }\n\n    stopAnchor(info, logger) {\n        console.log(\"Stopping anchor of various flavors\")\n        if(!this._anchoredNodes) return\n        if (!info.node) {\n            logger.error(\"missing threejs node\")\n            return\n        }\n        this._removeAnchorFromNode(info.node)\n    }\n\n    sleeper(time) {\n        return new Promise((resolve) => setTimeout(resolve, time))\n    }\n\n    _fetchImage(info,logger) {\n        return new Promise((res,rej) => {\n            const img = new Image()\n            img.crossOrigin = \"Anonymous\"\n            img.src = info.image.src\n            logger.log(\"Loading image\",img.src)\n            img.onload = () => {\n                res(img)\n            }\n        })\n    }\n\n    createDetectionImage(info, logger) {\n        logger.log(\"creating/find an image recognizer\")\n        return new Promise((res,rej) => {            \n            if (!info.image || !info.node) {\n                logger.log(\"createDetectionImage: missing image or threejs node\")\n                rej(\"createDetectionImage: missing image or threejs node\")\n                return\n            }\n\n            if (!this.session) {\n                logger.log(\"no session\")\n                rej(\"no session\")\n                return\n            }\n\n            let imageRealworldWidth = info.imageRealworldWidth || 1\n\n            if (this.imageDetectorMap[info.image.src]) {\n                let det = this.imageDetectorMap[info.image.src]\n                if (imageRealworldWidth !== det.realWorldWidth) {\n                    logger.log(\"can't create the same image with different real world width\")\n                    rej(\"can't create the same image with different real world width\")\n                    return\n                }\n                logger.log(\"createDetectionImage: already created, returning it\")\n                res(det.name)\n                return\n            }\n\n            this._fetchImage(info,logger).then(image => {\n                logger.log(\"got the image\",(image))\n    \n                //info contains\n                // * callback: to call when the image is found\n                // * image: info about the image to recognize. src is at image.src\n                // * imageRealworldWidth: width of the image in meters\n                // * object: the anchor object\n                // * node: the ThreeJS group which represents the anchor. It should be updated as the scene changes\n                // * recType: current set to SCENE_START, meaning we should recognize as soon as the scene starts up\n    \n        \n                // random name from https://gist.github.com/6174/6062387\n                let name = [...Array(10)].map(i => (~~(Math.random() * 36)).toString(36)).join('')\n        \n                // Get ImageData\n                let canvas = document.createElement('canvas')\n                let context = canvas.getContext('2d')\n                canvas.width = image.width\n                canvas.height = image.height\n        \n                context.drawImage(image, 0, 0)\n                let idata\n                try {\n                    idata = context.getImageData(0, 0, image.width, image.height)\n                } catch (e) {\n                    logger.log(\"error drawing image\",e)\n                    logger.log(\"name\",e.name)\n                    logger.log(\"name\",e.message)\n                    logger.log(\"local url is \" + document.documentURI)\n                    logger.log(\"image url from \" + image.src)\n                    ToasterManager.add(\"error drawing image\", e.toString())\n                    rej( new Error(\"foo\"))\n                }\n                logger.log(`calling createDetectionImage with image width and height ${image.width} ${image.height}`)\n        \n                // Attach image observer handler\n                this.session.nonStandard_createDetectionImage(name, idata.data, image.width, image.height, imageRealworldWidth).then(() => {\n                    this.imageDetectorMap[info.image.src] = {\n                        name: name,\n                        realWorldWidth: imageRealworldWidth,\n                        anchor: null\n                    }\n                    res(name)\n                }).catch(error => {\n                    logger.error(`error creating detection image: ${error}`)\n                    rej(error)\n                })\n            }).catch(error => {\n                logger.error(`error creating detection image: ${error}`)\n                rej(error)\n            })\n        })\n    }\n\n    startImageRecognizer(info, name, logger) {\n        logger.log(\"starting Image Recognizer\")\n\n        if (!info.image || !info.node) {\n            logger.log(\"missing image or threejs node\")\n            return\n        }\n\n        if (!this.session) {\n            logger.log(\"no session\")\n            return\n        }\n\n        //info contains\n        // * callback: to call when the image is found\n        // * image: info about the image to recognize. src is at image.src\n        // * imageRealworldWidth: width of the image in meters\n        // * object: the anchor object\n        // * node: the ThreeJS group which represents the anchor. It should be updated as the scene changes\n        // * recType: current set to SCENE_START, meaning we should recognize as soon as the scene starts up\n\n        let callback = info.callback\n\n        let node = info.node\n        //let recType = 0 // unused. currently set to SCENE_START -> meaning we should recognize as soon as the scene starts up\n\n        if (!this.imageDetectorMap[info.image.src]) {\n            logger.error(\"not detection object for image\", info.image.src)\n            return\n        }\n\n        let det = this.imageDetectorMap[info.image.src]\n\n        // there is already an anchor tracking this image, either from this\n        // scene or another\n        if (det.anchor) {\n            if (info.reactivate) {\n                logger.log(\"Found existing anchor: reactivate\")\n                // we want to reactivate.  So destroy the anchor, remove it from\n                // the node it was tracking, and continue below to reactivate\n                this.session.removeAnchor(det.anchor)\n                logger.log(\"remove from previous node\")\n                this._removeAnchorFromNode(det.anchor)\n                det.anchor = null\n            } else {\n                logger.log(\"Found existing anchor: use it\")\n                // we want to reuse, likely from some previous scene.\n                // So, remove the relationship to whatever node is in the \n                // anchor map, and reset it to this node.   \n                logger.log(\"remove from previous node\")\n                this._removeAnchorFromNode(det.anchor)\n                logger.log(\"add our node\")\n                this.addAnchoredNode(det.anchor, node, logger)\n                if (callback) {\n                    callback(info)\n                }\n                return\n            }\n        } \n\n        node.anchorName = null\n        logger.log(\"activate detection image\")\n        this.session.nonStandard_activateDetectionImage(det.name).then(anchor => {\n            logger.log(\"found detection image\")\n            // this gets invoked after the image is seen for the first time\n            node.anchorName = name\n            node.anchorStyle = \"image\"\n            this.addAnchoredNode(anchor, node, logger)\n            if (callback) {\n                callback(info)\n            }\n        }).catch(error => {\n            logger.error(`error activating detection image: ${error}`)\n        })\n    }\n\n    stopImageRecognizer(info, logger) {\n        console.log(\"Stopping image recognizer\")\n        if(!this._anchoredNodes) return\n\n        if (!this.imageDetectorMap[info.image.src]) {\n            logger.error(\"no detection object for image\", info.image.src)\n            return\n        }\n\n        let det = this.imageDetectorMap[info.image.src]\n\n        if (det.anchor) {\n            console.log(\"already found the image, removing it\")\n            this._removeAnchorFromNode(det.anchor)\n            det.anchor = null\n        }\n\n        console.log(\"deactivating the image\")\n        this.session.nonStandard_deactivateDetectionImage(det.name).then(() => {\n        }).catch(error => {\n            logger.error(`error deactivating detection image: ${error}`)\n        })\n    }\n\n\n    createGeoAnchor(info, logger) {        \n        logger.log(\"creating or reusing a geospatial anchor\")\n        return new Promise((res,rej) => {            \n            if (!info.node) {\n                logger.log(\"Missing threejs node\")\n                rej(\"Missing threejs node\")\n                return\n            }\n\n            if (!info.location || !info.location.id) {\n                logger.log(\"User must attach a geo location first\")\n                rej(\"Missing geo location\")\n                return\n            }\n\n            if (!this.session) {\n                logger.log(\"no session\")\n                rej(\"no session\")\n                return\n            }\n\n            if (this.geoAnchorMap[info.location.id]) {\n                //let det = this.geoAnchorMap[info.location.id]\n                logger.log(\"found geoanchor: already created, returning it\")\n                res()\n                return\n            }\n\n            /*\n            info contains\n            location:  a geo location asset, has properties for latitude, longitude, altitude, useAltitude\n            recType: the recognition type. for now always SCENE_START\n            object: the anchor object. It reresents the anchor in the 3D scene. has tx,ty,tz, rotation, etc.\n            node: the actual ThreeJS object that mirrors the propertites of the `object` above\n            callback: a function to be called once the geo anchor is recognized. By default this callback will fire a 'recognized' event and make the anchor visible in the scene\n            */\n\n            let location = info.location\n            //let object = info.object // object that represents anchor variables that users can edit in general-editor\n            //let node = info.node\n            //let recType = 0 // unused. currently set to SCENE_START -> meaning we should recognize as soon as the scene starts up\n\n            // As a slight hack, look for any non zero value in latitude or longitude as a hint to not use your current location\n\n            // these values are 0 by default, we need to change at least one of them by a bit!\n            if (location.latitude !== 0 || location.longitude !== 0) {\n                // use supplied altitude?\n\n                let lla = new Cesium.Cartographic(location.longitude * Math.PI / 180, location.latitude * Math.PI / 180, location.altitude)\n\n                if (location.useAltitude) {\n                    logger.log(\"XRGeoAnchor: Placing an object at specified lla and specified altitude\")\n                    logger.log(lla)\n                    XRGeospatialAnchor.createGeoAnchor(lla).then(anchor => {\n                        this.geoAnchorMap[info.location.id] = {\n                            anchor: anchor\n                        }\n                        res()\n                        return;\n                    }).catch(error => {\n                        logger.error(`error creating geospatial anchor: ${error}`)\n                        rej(error)\n                    })\n                } else {\n                    XRGeospatialAnchor.getDefaultElevation(lla).then(altitude => {\n                        lla.height = altitude\n                        logger.log(\"XRGeoAnchor: Placing an object at specified lla and estimated altitude\")\n                        logger.log(lla)\n                        XRGeospatialAnchor.createGeoAnchor(lla).then(anchor => {\n                            this.geoAnchorMap[info.location.id] = {\n                                anchor: anchor\n                            }\n                            res()\n                            return;\n                        }).catch(error => {\n                            logger.error(`error creating geospatial anchor: ${error}`)\n                            rej(error)\n                        })\n                    }).catch(error => {\n                        logger.error(`error getting default elevation: ${error}`)\n                        rej(error)\n                    })\n                }\n            }\n\n            // else find current position and altitude\n            else {\n                XRGeospatialAnchor.getDeviceCartographic().then(cartographic => {\n                    // probably don't need to explicitly do this, but to be safe ...\n                    XRGeospatialAnchor.getDefaultElevation().then(altitude => {\n                        let lla = new Cesium.Cartographic(cartographic.longitude, cartographic.latitude, altitude)\n                        logger.log(\"XRGeoAnchor: Placing an object at your lla\")\n                        logger.log(lla)\n                        XRGeospatialAnchor.createGeoAnchor(lla).then(anchor => {\n                            this.geoAnchorMap[info.location.id] = {\n                                anchor: anchor\n                            }\n                            res()\n                            return;\n                        }).catch(error => {\n                            logger.error(`error creating geospatial anchor: ${error}`)\n                            rej(error)\n                        })\n                    }).catch(error => {\n                        logger.error(`error getting default elevation: ${error}`)\n                        rej(error)\n                    })\n                }).catch(error => {\n                    logger.error(`error getting device cartographic location: ${error}`)\n                    rej(error)\n                })\n            }\n        })\n    }\n\n\n    addGeoAnchoredNode(info, logger) {\n        logger.log(\"adding a geotracked node\")\n\n        if (!info.node) {\n            logger.log(\"Missing threejs node\")\n            return\n        }\n\n        if (!this.session) {\n            logger.log(\"no session\")\n            return\n        }\n\n        if (!this.geoAnchorMap[info.location.id]) {\n            logger.error(\"not geolocation anchor for object\", info.location.id)\n            return\n        }\n\n        let det = this.geoAnchorMap[info.location.id]\n\n        /*\n        info contains\n         location:  a geo location asset, has properties for latitude, longitude, altitude, useAltitude\n         recType: the recognition type. for now always SCENE_START\n         object: the anchor object. It reresents the anchor in the 3D scene. has tx,ty,tz, rotation, etc.\n         node: the actual ThreeJS object that mirrors the propertites of the `object` above\n         callback: a function to be called once the geo anchor is recognized. By default this callback will fire a 'recognized' event and make the anchor visible in the scene\n         */\n\n        let callback = info.callback\n        let node = info.node\n        //let recType = 0 // unused. currently set to SCENE_START -> meaning we should recognize as soon as the scene starts up\n\n\n        this._removeAnchorFromNode(det.anchor)\n        logger.log(\"add our node\")\n        this.addAnchoredNode(det.anchor, node, logger)\n        if (callback) {\n            callback(info)\n        }\n    }\n\n    /// BLAIR:  Need a way to destroy geo Anchors!\n    stopGeoTracker(info, logger) {\n        // info.node may be destroyed before we get here\n        if (info && info.node) {\n            this._removeAnchorForNode(info.node)\n        }\n    }\n\n    _handleAnchorDelete(logger, details) {\n        logger.log(\"delete anchor\")\n        let anchor = details.source\n        this._removeAnchorFromNode(anchor)\n    }\n\n    _removeAnchorForNode(node) {\n        this._anchoredNodes.forEach( (value) => {\n            if(value.node === node) {\n                this._removeAnchorFromNode(node.anchor)\n            }\n        })\n    }\n\n    _removeAnchorFromNode(anchor) {\n        const anchoredNode = this._anchoredNodes.get(anchor.uid)\n        if (anchoredNode) {\n            const node = anchoredNode.node\n            node.anchor = null\n\n            anchor.removeEventListener(\"update\", anchor._handleAnchorUpdateCallback)\n            anchor.removeEventListener(\"removed\", anchor._handleAnchorDeleteCallback)\n            anchor._handleAnchorUpdateCallback = null\n            anchor._handleAnchorDeleteCallback = null\n\n            this._anchoredNodes.delete(anchor.uid)\n        }\n    }\n\n    _handleAnchorUpdate(logger, details) {\n        const anchor = details.source\n        const anchoredNode = this._anchoredNodes.get(anchor.uid)\n        if (anchoredNode) {\n            const node = anchoredNode.node\n            node.matrixAutoUpdate = false\n            node.matrix.fromArray(anchor.modelMatrix)\n            node.updateMatrixWorld(true)\n        }\n    }\n}","const THREE = require('three');//requireimport * as THREE from 'three'\n\n/**\n * @author qiao / https://github.com/qiao\n * @author mrdoob / http://mrdoob.com\n * @author alteredq / http://alteredqualia.com/\n * @author WestLangley / http://github.com/WestLangley\n * @author erich666 / http://erichaines.com\n */\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one finger move\n//    Zoom - middle mouse, or mousewheel / touch: two finger spread or squish\n//    Pan - right mouse, or arrow keys / touch: three finger swipe\n\nconst OrbitControls = function ( object, domElement ) {\n\n    this.object = object;\n\n    this.domElement = ( domElement !== undefined ) ? domElement : document;\n\n    // Set to false to disable this control\n    this.enabled = true;\n\n    // \"target\" sets the location of focus, where the object orbits around\n    this.target = new THREE.Vector3();\n\n    // How far you can dolly in and out ( PerspectiveCamera only )\n    this.minDistance = 0;\n    this.maxDistance = Infinity;\n\n    // How far you can zoom in and out ( OrthographicCamera only )\n    this.minZoom = 0;\n    this.maxZoom = Infinity;\n\n    // How far you can orbit vertically, upper and lower limits.\n    // Range is 0 to Math.PI radians.\n    this.minPolarAngle = 0; // radians\n    this.maxPolarAngle = Math.PI; // radians\n\n    // How far you can orbit horizontally, upper and lower limits.\n    // If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\n    this.minAzimuthAngle = - Infinity; // radians\n    this.maxAzimuthAngle = Infinity; // radians\n\n    // Set to true to enable damping (inertia)\n    // If damping is enabled, you must call controls.update() in your animation loop\n    this.enableDamping = false;\n    this.dampingFactor = 0.25;\n\n    // This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n    // Set to false to disable zooming\n    this.enableZoom = true;\n    this.zoomSpeed = 1.0;\n\n    // Set to false to disable rotating\n    this.enableRotate = true;\n    this.rotateSpeed = 1.0;\n\n    // Set to false to disable panning\n    this.enablePan = true;\n    this.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n    // Set to true to automatically rotate around the target\n    // If auto-rotate is enabled, you must call controls.update() in your animation loop\n    this.autoRotate = false;\n    this.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n    // Set to false to disable use of the keys\n    this.enableKeys = true;\n\n    // The four arrow keys\n    this.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n    // Mouse buttons\n    this.mouseButtons = { ORBIT: THREE.MOUSE.LEFT, ZOOM: THREE.MOUSE.MIDDLE, PAN: THREE.MOUSE.RIGHT };\n\n    // for reset\n    this.target0 = this.target.clone();\n    this.position0 = this.object.position.clone();\n    this.zoom0 = this.object.zoom;\n\n    //\n    // public methods\n    //\n\n    this.getPolarAngle = function () {\n\n        return spherical.phi;\n\n    };\n\n    this.getAzimuthalAngle = function () {\n\n        return spherical.theta;\n\n    };\n\n    this.saveState = function () {\n\n        scope.target0.copy( scope.target );\n        scope.position0.copy( scope.object.position );\n        scope.zoom0 = scope.object.zoom;\n\n    };\n\n    this.reset = function () {\n\n        scope.target.copy( scope.target0 );\n        scope.object.position.copy( scope.position0 );\n        scope.object.zoom = scope.zoom0;\n\n        scope.object.updateProjectionMatrix();\n        scope.dispatchEvent( changeEvent );\n\n        scope.update();\n\n        state = STATE.NONE;\n\n    };\n\n    // this method is exposed, but perhaps it would be better if we can make it private...\n    this.update = function () {\n\n        var offset = new THREE.Vector3();\n\n        // so camera.up is the orbit axis\n        var quat = new THREE.Quaternion().setFromUnitVectors( object.up, new THREE.Vector3( 0, 1, 0 ) );\n        var quatInverse = quat.clone().inverse();\n\n        var lastPosition = new THREE.Vector3();\n        var lastQuaternion = new THREE.Quaternion();\n\n        return function update() {\n\n            var position = scope.object.position;\n\n            offset.copy( position ).sub( scope.target );\n\n            // rotate offset to \"y-axis-is-up\" space\n            offset.applyQuaternion( quat );\n\n            // angle from z-axis around y-axis\n            spherical.setFromVector3( offset );\n\n            if ( scope.autoRotate && state === STATE.NONE ) {\n\n                rotateLeft( getAutoRotationAngle() );\n\n            }\n\n            spherical.theta += sphericalDelta.theta;\n            spherical.phi += sphericalDelta.phi;\n\n            // restrict theta to be between desired limits\n            spherical.theta = Math.max( scope.minAzimuthAngle, Math.min( scope.maxAzimuthAngle, spherical.theta ) );\n\n            // restrict phi to be between desired limits\n            spherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\n\n            spherical.makeSafe();\n\n\n            spherical.radius *= scale;\n\n            // restrict radius to be between desired limits\n            spherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\n\n            // move target to panned location\n            scope.target.add( panOffset );\n\n            offset.setFromSpherical( spherical );\n\n            // rotate offset back to \"camera-up-vector-is-up\" space\n            offset.applyQuaternion( quatInverse );\n\n            position.copy( scope.target ).add( offset );\n\n            scope.object.lookAt( scope.target );\n\n            if ( scope.enableDamping === true ) {\n\n                sphericalDelta.theta *= ( 1 - scope.dampingFactor );\n                sphericalDelta.phi *= ( 1 - scope.dampingFactor );\n\n            } else {\n\n                sphericalDelta.set( 0, 0, 0 );\n\n            }\n\n            scale = 1;\n            panOffset.set( 0, 0, 0 );\n\n            // update condition is:\n            // min(camera displacement, camera rotation in radians)^2 > EPS\n            // using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n            if ( zoomChanged ||\n                lastPosition.distanceToSquared( scope.object.position ) > EPS ||\n                8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\n\n                scope.dispatchEvent( changeEvent );\n                lastPosition.copy( scope.object.position );\n                lastQuaternion.copy( scope.object.quaternion );\n                zoomChanged = false;\n\n                return true;\n\n            }\n\n            return false;\n\n        };\n\n    }();\n\n    this.dispose = function () {\n\n        scope.domElement.removeEventListener( 'contextmenu', onContextMenu, false );\n        scope.domElement.removeEventListener( 'mousedown', onMouseDown, false );\n        scope.domElement.removeEventListener( 'wheel', onMouseWheel, false );\n\n        scope.domElement.removeEventListener( 'touchstart', onTouchStart, false );\n        scope.domElement.removeEventListener( 'touchend', onTouchEnd, false );\n        scope.domElement.removeEventListener( 'touchmove', onTouchMove, false );\n\n        document.removeEventListener( 'mousemove', onMouseMove, false );\n        document.removeEventListener( 'mouseup', onMouseUp, false );\n\n        window.removeEventListener( 'keydown', onKeyDown, false );\n\n        //scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\n    };\n\n    //\n    // internals\n    //\n\n    var scope = this;\n\n    var changeEvent = { type: 'change' };\n    var startEvent = { type: 'start' };\n    var endEvent = { type: 'end' };\n\n    var STATE = { NONE: - 1, ROTATE: 0, DOLLY: 1, PAN: 2, TOUCH_ROTATE: 3, TOUCH_DOLLY: 4, TOUCH_PAN: 5 };\n\n    var state = STATE.NONE;\n\n    var EPS = 0.000001;\n\n    // current position in spherical coordinates\n    var spherical = new THREE.Spherical();\n    var sphericalDelta = new THREE.Spherical();\n\n    var scale = 1;\n    var panOffset = new THREE.Vector3();\n    var zoomChanged = false;\n\n    var rotateStart = new THREE.Vector2();\n    var rotateEnd = new THREE.Vector2();\n    var rotateDelta = new THREE.Vector2();\n\n    var panStart = new THREE.Vector2();\n    var panEnd = new THREE.Vector2();\n    var panDelta = new THREE.Vector2();\n\n    var dollyStart = new THREE.Vector2();\n    var dollyEnd = new THREE.Vector2();\n    var dollyDelta = new THREE.Vector2();\n\n    function getAutoRotationAngle() {\n\n        return 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n    }\n\n    function getZoomScale() {\n\n        return Math.pow( 0.95, scope.zoomSpeed );\n\n    }\n\n    function rotateLeft( angle ) {\n\n        sphericalDelta.theta -= angle;\n\n    }\n\n    function rotateUp( angle ) {\n\n        sphericalDelta.phi -= angle;\n\n    }\n\n    var panLeft = function () {\n\n        var v = new THREE.Vector3();\n\n        return function panLeft( distance, objectMatrix ) {\n\n            v.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n            v.multiplyScalar( - distance );\n\n            panOffset.add( v );\n\n        };\n\n    }();\n\n    var panUp = function () {\n\n        var v = new THREE.Vector3();\n\n        return function panUp( distance, objectMatrix ) {\n\n            v.setFromMatrixColumn( objectMatrix, 1 ); // get Y column of objectMatrix\n            v.multiplyScalar( distance );\n\n            panOffset.add( v );\n\n        };\n\n    }();\n\n    // deltaX and deltaY are in pixels; right and down are positive\n    var pan = function () {\n\n        var offset = new THREE.Vector3();\n\n        return function pan( deltaX, deltaY ) {\n\n            var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n            if ( scope.object.isPerspectiveCamera ) {\n\n                // perspective\n                var position = scope.object.position;\n                offset.copy( position ).sub( scope.target );\n                var targetDistance = offset.length();\n\n                // half of the fov is center to top of screen\n                targetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n                // we actually don't use screenWidth, since perspective camera is fixed to screen height\n                panLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\n                panUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\n\n            } else if ( scope.object.isOrthographicCamera ) {\n\n                // orthographic\n                panLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\n                panUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\n\n            } else {\n\n                // camera neither orthographic nor perspective\n                console.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n                scope.enablePan = false;\n\n            }\n\n        };\n\n    }();\n\n    function dollyIn( dollyScale ) {\n\n        if ( scope.object.isPerspectiveCamera ) {\n\n            scale /= dollyScale;\n\n        } else if ( scope.object.isOrthographicCamera ) {\n\n            scope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\n            scope.object.updateProjectionMatrix();\n            zoomChanged = true;\n\n        } else {\n\n            console.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n            scope.enableZoom = false;\n\n        }\n\n    }\n\n    function dollyOut( dollyScale ) {\n\n        if ( scope.object.isPerspectiveCamera ) {\n\n            scale *= dollyScale;\n\n        } else if ( scope.object.isOrthographicCamera ) {\n\n            scope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\n            scope.object.updateProjectionMatrix();\n            zoomChanged = true;\n\n        } else {\n\n            console.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n            scope.enableZoom = false;\n\n        }\n\n    }\n\n    //\n    // event callbacks - update the object state\n    //\n\n    function handleMouseDownRotate( event ) {\n\n        //console.log( 'handleMouseDownRotate' );\n\n        rotateStart.set( event.clientX, event.clientY );\n\n    }\n\n    function handleMouseDownDolly( event ) {\n\n        //console.log( 'handleMouseDownDolly' );\n\n        dollyStart.set( event.clientX, event.clientY );\n\n    }\n\n    function handleMouseDownPan( event ) {\n\n        //console.log( 'handleMouseDownPan' );\n\n        panStart.set( event.clientX, event.clientY );\n\n    }\n\n    function handleMouseMoveRotate( event ) {\n\n        //console.log( 'handleMouseMoveRotate' );\n\n        rotateEnd.set( event.clientX, event.clientY );\n        rotateDelta.subVectors( rotateEnd, rotateStart );\n\n        var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n        // rotating across whole screen goes 360 degrees around\n        rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\n\n        // rotating up and down along whole screen attempts to go 360, but limited to 180\n        rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\n\n        rotateStart.copy( rotateEnd );\n\n        scope.update();\n\n    }\n\n    function handleMouseMoveDolly( event ) {\n\n        //console.log( 'handleMouseMoveDolly' );\n\n        dollyEnd.set( event.clientX, event.clientY );\n\n        dollyDelta.subVectors( dollyEnd, dollyStart );\n\n        if ( dollyDelta.y > 0 ) {\n\n            dollyIn( getZoomScale() );\n\n        } else if ( dollyDelta.y < 0 ) {\n\n            dollyOut( getZoomScale() );\n\n        }\n\n        dollyStart.copy( dollyEnd );\n\n        scope.update();\n\n    }\n\n    function handleMouseMovePan( event ) {\n\n        //console.log( 'handleMouseMovePan' );\n\n        panEnd.set( event.clientX, event.clientY );\n\n        panDelta.subVectors( panEnd, panStart );\n\n        pan( panDelta.x, panDelta.y );\n\n        panStart.copy( panEnd );\n\n        scope.update();\n\n    }\n\n    function handleMouseUp( event ) {\n\n        // console.log( 'handleMouseUp' );\n\n    }\n\n    function handleMouseWheel( event ) {\n\n        // console.log( 'handleMouseWheel' );\n\n        if ( event.deltaY < 0 ) {\n\n            dollyOut( getZoomScale() );\n\n        } else if ( event.deltaY > 0 ) {\n\n            dollyIn( getZoomScale() );\n\n        }\n\n        scope.update();\n\n    }\n\n    function handleKeyDown( event ) {\n\n        //console.log( 'handleKeyDown' );\n\n        switch ( event.keyCode ) {\n\n            case scope.keys.UP:\n                pan( 0, scope.keyPanSpeed );\n                scope.update();\n                break;\n\n            case scope.keys.BOTTOM:\n                pan( 0, - scope.keyPanSpeed );\n                scope.update();\n                break;\n\n            case scope.keys.LEFT:\n                pan( scope.keyPanSpeed, 0 );\n                scope.update();\n                break;\n\n            case scope.keys.RIGHT:\n                pan( - scope.keyPanSpeed, 0 );\n                scope.update();\n                break;\n\n            default:\n                break;\n        }\n\n    }\n\n    function handleTouchStartRotate( event ) {\n\n        //console.log( 'handleTouchStartRotate' );\n\n        rotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n    }\n\n    function handleTouchStartDolly( event ) {\n\n        //console.log( 'handleTouchStartDolly' );\n\n        var dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n        var dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n        var distance = Math.sqrt( dx * dx + dy * dy );\n\n        dollyStart.set( 0, distance );\n\n    }\n\n    function handleTouchStartPan( event ) {\n\n        //console.log( 'handleTouchStartPan' );\n\n        panStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n    }\n\n    function handleTouchMoveRotate( event ) {\n\n        //console.log( 'handleTouchMoveRotate' );\n\n        rotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n        rotateDelta.subVectors( rotateEnd, rotateStart );\n\n        var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n        // rotating across whole screen goes 360 degrees around\n        rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\n\n        // rotating up and down along whole screen attempts to go 360, but limited to 180\n        rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\n\n        rotateStart.copy( rotateEnd );\n\n        scope.update();\n\n    }\n\n    function handleTouchMoveDolly( event ) {\n\n        //console.log( 'handleTouchMoveDolly' );\n\n        var dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n        var dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n        var distance = Math.sqrt( dx * dx + dy * dy );\n\n        dollyEnd.set( 0, distance );\n\n        dollyDelta.subVectors( dollyEnd, dollyStart );\n\n        if ( dollyDelta.y > 0 ) {\n\n            dollyOut( getZoomScale() );\n\n        } else if ( dollyDelta.y < 0 ) {\n\n            dollyIn( getZoomScale() );\n\n        }\n\n        dollyStart.copy( dollyEnd );\n\n        scope.update();\n\n    }\n\n    function handleTouchMovePan( event ) {\n\n        //console.log( 'handleTouchMovePan' );\n\n        panEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n        panDelta.subVectors( panEnd, panStart );\n\n        pan( panDelta.x, panDelta.y );\n\n        panStart.copy( panEnd );\n\n        scope.update();\n\n    }\n\n    function handleTouchEnd( event ) {\n\n        //console.log( 'handleTouchEnd' );\n\n    }\n\n    //\n    // event handlers - FSM: listen for events and reset state\n    //\n\n    function onMouseDown( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        event.preventDefault();\n\n        switch ( event.button ) {\n\n            case scope.mouseButtons.ORBIT:\n\n                if ( scope.enableRotate === false ) return;\n\n                handleMouseDownRotate( event );\n\n                state = STATE.ROTATE;\n\n                break;\n\n            case scope.mouseButtons.ZOOM:\n\n                if ( scope.enableZoom === false ) return;\n\n                handleMouseDownDolly( event );\n\n                state = STATE.DOLLY;\n\n                break;\n\n            case scope.mouseButtons.PAN:\n\n                if ( scope.enablePan === false ) return;\n\n                handleMouseDownPan( event );\n\n                state = STATE.PAN;\n\n                break;\n            default:\n                break;\n\n        }\n\n        if ( state !== STATE.NONE ) {\n\n            document.addEventListener( 'mousemove', onMouseMove, false );\n            document.addEventListener( 'mouseup', onMouseUp, false );\n\n            scope.dispatchEvent( startEvent );\n\n        }\n\n    }\n\n    function onMouseMove( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        event.preventDefault();\n\n        switch ( state ) {\n\n            case STATE.ROTATE:\n\n                if ( scope.enableRotate === false ) return;\n\n                handleMouseMoveRotate( event );\n\n                break;\n\n            case STATE.DOLLY:\n\n                if ( scope.enableZoom === false ) return;\n\n                handleMouseMoveDolly( event );\n\n                break;\n\n            case STATE.PAN:\n\n                if ( scope.enablePan === false ) return;\n\n                handleMouseMovePan( event );\n\n                break;\n            default:\n                break;\n\n        }\n\n    }\n\n    function onMouseUp( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        handleMouseUp( event );\n\n        document.removeEventListener( 'mousemove', onMouseMove, false );\n        document.removeEventListener( 'mouseup', onMouseUp, false );\n\n        scope.dispatchEvent( endEvent );\n\n        state = STATE.NONE;\n\n    }\n\n    function onMouseWheel( event ) {\n\n        if ( scope.enabled === false || scope.enableZoom === false || ( state !== STATE.NONE && state !== STATE.ROTATE ) ) return;\n\n        event.preventDefault();\n        event.stopPropagation();\n\n        handleMouseWheel( event );\n\n        scope.dispatchEvent( startEvent ); // not sure why these are here...\n        scope.dispatchEvent( endEvent );\n\n    }\n\n    function onKeyDown( event ) {\n\n        if ( scope.enabled === false || scope.enableKeys === false || scope.enablePan === false ) return;\n\n        handleKeyDown( event );\n\n    }\n\n    function onTouchStart( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        switch ( event.touches.length ) {\n\n            case 1:\t// one-fingered touch: rotate\n\n                if ( scope.enableRotate === false ) return;\n\n                handleTouchStartRotate( event );\n\n                state = STATE.TOUCH_ROTATE;\n\n                break;\n\n            case 2:\t// two-fingered touch: dolly\n\n                if ( scope.enableZoom === false ) return;\n\n                handleTouchStartDolly( event );\n\n                state = STATE.TOUCH_DOLLY;\n\n                break;\n\n            case 3: // three-fingered touch: pan\n\n                if ( scope.enablePan === false ) return;\n\n                handleTouchStartPan( event );\n\n                state = STATE.TOUCH_PAN;\n\n                break;\n\n            default:\n\n                state = STATE.NONE;\n\n        }\n\n        if ( state !== STATE.NONE ) {\n\n            scope.dispatchEvent( startEvent );\n\n        }\n\n    }\n\n    function onTouchMove( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        event.preventDefault();\n        event.stopPropagation();\n\n        switch ( event.touches.length ) {\n\n            case 1: // one-fingered touch: rotate\n\n                if ( scope.enableRotate === false ) return;\n                if ( state !== STATE.TOUCH_ROTATE ) return; // is this needed?...\n\n                handleTouchMoveRotate( event );\n\n                break;\n\n            case 2: // two-fingered touch: dolly\n\n                if ( scope.enableZoom === false ) return;\n                if ( state !== STATE.TOUCH_DOLLY ) return; // is this needed?...\n\n                handleTouchMoveDolly( event );\n\n                break;\n\n            case 3: // three-fingered touch: pan\n\n                if ( scope.enablePan === false ) return;\n                if ( state !== STATE.TOUCH_PAN ) return; // is this needed?...\n\n                handleTouchMovePan( event );\n\n                break;\n\n            default:\n\n                state = STATE.NONE;\n\n        }\n\n    }\n\n    function onTouchEnd( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        handleTouchEnd( event );\n\n        scope.dispatchEvent( endEvent );\n\n        state = STATE.NONE;\n\n    }\n\n    function onContextMenu( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        event.preventDefault();\n\n    }\n\n    //\n\n    scope.domElement.addEventListener( 'contextmenu', onContextMenu, false );\n\n    scope.domElement.addEventListener( 'mousedown', onMouseDown, false );\n    scope.domElement.addEventListener( 'wheel', onMouseWheel, false );\n\n    scope.domElement.addEventListener( 'touchstart', onTouchStart, false );\n    scope.domElement.addEventListener( 'touchend', onTouchEnd, false );\n    scope.domElement.addEventListener( 'touchmove', onTouchMove, false );\n\n    // window.addEventListener( 'keydown', onKeyDown, false );\n\n    // force an update at start\n\n    this.update();\n\n};\n\nOrbitControls.prototype = Object.create( THREE.EventDispatcher.prototype );\nOrbitControls.prototype.constructor = THREE.OrbitControls;\n\nObject.defineProperties( OrbitControls.prototype, {\n\n    center: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .center has been renamed to .target' );\n            return this.target;\n\n        }\n\n    },\n\n    // backward compatibility\n\n    noZoom: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.' );\n            return ! this.enableZoom;\n\n        },\n\n        set: function ( value ) {\n\n            console.warn( 'THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.' );\n            this.enableZoom = ! value;\n\n        }\n\n    },\n\n    noRotate: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.' );\n            return ! this.enableRotate;\n\n        },\n\n        set: function ( value ) {\n\n            console.warn( 'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.' );\n            this.enableRotate = ! value;\n\n        }\n\n    },\n\n    noPan: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.' );\n            return ! this.enablePan;\n\n        },\n\n        set: function ( value ) {\n\n            console.warn( 'THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.' );\n            this.enablePan = ! value;\n\n        }\n\n    },\n\n    noKeys: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.' );\n            return ! this.enableKeys;\n\n        },\n\n        set: function ( value ) {\n\n            console.warn( 'THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.' );\n            this.enableKeys = ! value;\n\n        }\n\n    },\n\n    staticMoving: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.' );\n            return ! this.enableDamping;\n\n        },\n\n        set: function ( value ) {\n\n            console.warn( 'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.' );\n            this.enableDamping = ! value;\n\n        }\n\n    },\n\n    dynamicDampingFactor: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );\n            return this.dampingFactor;\n\n        },\n\n        set: function ( value ) {\n\n            console.warn( 'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );\n            this.dampingFactor = value;\n\n        }\n\n    }\n\n} );\n\n\nexport default OrbitControls","import React, {Component} from 'react'\nimport * as THREE from 'three'\nimport {SelectionManager, SELECTION_MANAGER, TREE_ITEM_PROVIDER} from 'react-visual-editor-framework'\nimport TransformControls from './TransformControls.js'\nimport SceneDef from \"./defs/SceneDef\"\nimport {get3DObjectDef, is3DObjectType, OBJ_TYPES, TOTAL_OBJ_TYPES} from './Common'\nimport ScriptManager, {SceneGraphProvider} from './ScriptManager'\nimport {TweenManager} from './tween'\nimport {XRSupport} from './XRSupport'\nimport OrbitControls from './OrbitControls'\n\nconst {SET_PROPERTY, INSERT_ELEMENT, DELETE_ELEMENT} = require(\"syncing_protocol\");\n\n\n// ================  SGP implementation =====================\nclass Adapter extends SceneGraphProvider {\n    constructor(canvas) {\n        super()\n        this.canvas = canvas\n    }\n    logger() {\n        return this.canvas.props.provider.getLogger()\n    }\n\n    getCurrentScene() {\n        const scene = this.canvas.props.provider.getSelectedSceneObject()\n        if(!scene || !scene.exists()) {\n            this.logger.error(\"the current scene is null\")\n            return null\n        }\n        return scene\n    }\n    getSceneObjects(scene) {\n        return scene.getChildren().filter(ch => is3DObjectType(ch.type))\n    }\n    getBehaviorsForObject(scene) {\n        return scene.getChildren().filter(ch => ch.type === TOTAL_OBJ_TYPES.BEHAVIOR)\n    }\n    getThreeObject(obj) {\n        if(obj.id) return this.canvas.findNode(obj.id)\n        return this.canvas.findNode(obj)\n    }\n    getParsedBehaviorAsset(beh) {\n        const prov = this.canvas.props.provider\n        const asset = prov.accessObject(beh.behavior)\n        return prov.getCachedBehaviorAsset(asset.id)\n    }\n\n    getAllBehaviors() {\n        return this.canvas.props.provider.accessObject(this.canvas.props.provider.getSceneRoot())\n            .find((obj)=> obj.type === TOTAL_OBJ_TYPES.BEHAVIOR)\n    }\n    getAllScenes() {\n        return this.canvas.props.provider.accessObject(this.canvas.props.provider.getSceneRoot())\n            .find((obj)=>obj.type === TOTAL_OBJ_TYPES.SCENE)\n    }\n\n    navigateScene(id) {\n        const obj = this.canvas.props.provider.accessObject(id)\n        if(obj.exists()) {\n            SelectionManager.setSelection(id)\n        } else {\n            const logger = this.canvas.props.provider.getLogger()\n            logger.error(\"cannot navigate to a scene that doesn't exist\",id)\n        }\n    }\n\n\n    playMediaAsset(asset, trusted=false) {\n        this.canvas.props.provider.assetsManager.playMediaAsset(asset, trusted)\n    }\n\n    stopMediaAsset(asset) {\n        this.canvas.props.provider.assetsManager.stopMediaAsset(asset)\n    }\n    setMediaVolume(asset,vol) {\n        this.canvas.props.provider.assetsManager.setMediaVolume(asset,vol)\n    }\n    isMediaAssetPlaying(asset) {\n        return this.canvas.props.provider.assetsManager.isMediaAssetPlaying(asset)\n    }\n    getGraphObjectByName(title) {\n        const list = this.canvas.props.provider.accessObject(this.canvas.props.provider.getSceneRoot()).find((o)=>o.title === title)\n        if(!list || list.length<1) return null\n        return list[0]\n    }\n\n    getGraphObjectById(id) {\n        return this.canvas.props.provider.accessObject(id)\n    }\n\n\n    getCamera() {\n        return this.canvas.camera\n    }\n    \n    getTweenManager() {\n        return this.canvas.tweenManager\n    }\n    getFloorNear(info) {\n        return this.canvas.getFloorNear(info)\n    }\n    startLocalAnchor(info) {\n        return this.canvas.startLocalAnchor(info)\n    }\n    stopLocalAnchor(info) {\n        return this.canvas.stopLocalAnchor(info)\n    }\n    startImageRecognizer(info) {\n        return this.canvas.startImageRecognizer(info)\n    }\n    stopImageRecognizer(info) {\n        return this.canvas.stopImageRecognizer(info)\n    }\n    startGeoTracker(info) {\n        return this.canvas.startGeoTracker(info)\n    }\n    stopGeoTracker(info) {\n        return this.canvas.stopGeoTracker(info)\n    }\n}\n\n\nconst MOVE_SPEED = 0.1\nexport class VRCanvas extends Component {\n    moveCameraForward = () => {\n        this.camera.position.z += -MOVE_SPEED\n    }\n    moveCameraBackward = () => {\n        this.camera.position.z += MOVE_SPEED\n    }\n    handleKeyPress = (e) => {\n        if(e.key === 'ArrowUp') {\n            this.camera.position.z -= MOVE_SPEED\n        }\n        if(e.key === 'ArrowDown') {\n            this.camera.position.z += MOVE_SPEED\n        }\n        if(e.key === 'a') {\n            this.camera.position.x -= MOVE_SPEED\n        }\n        if(e.key === 'd') {\n            this.camera.position.x += MOVE_SPEED\n        }\n        if(e.key === 'ArrowLeft') {\n            this.camera.rotation.y += 0.1\n        }\n        if(e.key === 'ArrowRight') {\n            this.camera.rotation.y -= 0.1\n        }\n    }\n    recenterOnSelection = () => {\n        const sel = SelectionManager.getSelection()\n        if(!sel) return\n        const obj = this.props.provider.accessObject(sel)\n        if(is3DObjectType(obj.type)) {\n            const node = this.findNode(sel)\n            if(!node) return\n            this.orbitControls.target0.copy(node.position)\n            const cam = node.position.clone().sub(new THREE.Vector3(0,0,-2))\n            this.orbitControls.position0.copy(cam)\n            this.orbitControls.reset()\n        }\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) {\n            this.orbitControls.saveState()\n            this.orbitControls.target0.set(0,0,0)\n            this.orbitControls.position0.set(1,6,6)\n            this.orbitControls.reset()\n        }\n    }\n\n    constructor(props) {\n        super(props)\n        this.obj_node_map = {}\n        this.previewUpdateNodes = []\n        this.scenes = []\n        this.state = {\n            scene: -1,\n            running:props.running\n        }\n        this.current_scene_wrapper = null\n        this.scriptManager = new ScriptManager(new Adapter(this),this.props.provider.getLogger())\n    }\n\n    pauseQueue = (e) => {\n        this.props.provider.pauseQueue()\n    }\n    unpauseQueue = (e) => {\n        this.props.provider.unpauseQueue()\n    }\n    transformChanged = (e) => {\n        const sel = SelectionManager.getSelection()\n        if(sel) {\n            const obj = this.props.provider.accessObject(sel)\n            if(!is3DObjectType(obj.type)) return\n            if(obj.type === OBJ_TYPES.bg360) return\n            const node = this.findNode(sel)\n            if(!node) return\n            const prov = this.props.provider\n            prov.quick_setPropertyValue(sel,'tx',node.position.x)\n            prov.quick_setPropertyValue(sel,'ty',node.position.y)\n            prov.quick_setPropertyValue(sel,'tz',node.position.z)\n        }\n    }\n    transformDraggingChanged = (e) => {\n        this.orbitControls.enabled = ! e.value\n    }\n\n    docSwapped = (e) => {\n        //nuke all the old stuff\n        this.scenes.forEach(sc => this.scene.remove(sc))\n        this.scenes = []\n        this.obj_node_map = {}\n        this.setState({scene: -1})\n        //make new stuff\n        const graph = this.props.provider.getDocGraph()\n        this.rebuildNode(graph,\"\")\n\n        const sceneObj = this.props.provider.getSelectedSceneObject()\n        if(!sceneObj.exists()) return this.props.provider.getLogger().error(\"no selected scene found\")\n        const sceneNode = this.findNode(sceneObj.id)\n        this.setCurrentSceneWrapper(sceneNode, false)\n    }\n    rebuildNode(obj, inset) {\n        // console.log(inset,\"rebuilding\",obj.type)\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) {\n            const node = new SceneDef().makeNode(obj,this.props.provider)\n            this.insertNodeMapping(obj.id,node)\n            this.addSceneWrapper(node)\n        }\n        if(is3DObjectType(obj.type)) {\n            const node = get3DObjectDef(obj.type).makeNode(obj,this.props.provider)\n            this.insertNodeMapping(obj.id,node)\n            const parent = this.findNode(obj.parent)\n            parent.add(node)\n        }\n        if(obj.children) {\n            obj.children.forEach(ch => {\n                this.rebuildNode(ch,inset+\"   \")\n            })\n        }\n    }\n    selectionChanged = () => {\n        this.transformControls.detach()\n        const sel = SelectionManager.getSelection()\n        if(!sel) return\n        const obj = this.props.provider.accessObject(sel)\n\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) return this.setCurrentSceneWrapper(this.findNode(sel),true)\n\n        if(is3DObjectType(obj.type)) {\n            const sc = this.props.provider.findSceneObjectParent(obj)\n            this.setCurrentSceneWrapper(this.findNode(sc.id),true)\n            const node = this.findNode(sel)\n            if (!node) return\n            this.transformControls.attach(node)\n            return\n        }\n        console.log(\"selected something not an object or scene\")\n    }\n\n    checkAspectRatio() {\n        if(!this.canvas) return\n        const w = this.wrapper.clientWidth\n        const h = this.wrapper.clientHeight\n        const aspect = w/h\n        if(Math.abs(this.camera.aspect - aspect) > 0.001 ) {\n            this.camera.aspect = aspect\n            this.camera.updateProjectionMatrix()\n            this.renderer.setSize(w-4,h-4)\n        }\n    }\n\n    componentDidMount() {\n        const canvas = this.canvas\n        const logger = this.props.provider.getLogger()\n        logger.log(\"mounting VRCanvas\")\n        if(XRSupport.supportsARKit()) {\n            this.xr = new XRSupport()\n            this.xr.getContext(canvas).then((context) => {\n                this.setupRenderer(canvas,context)\n                this.xr.setAnimationLoop( this.animationLoopWithCamera.bind(this) )\n            }).catch(err => {\n                console.error('Error', err)\n            })\n        } else {\n            this.setupRenderer(canvas,0)\n            this.renderer.setAnimationLoop( this.animationLoop.bind(this) )\n        }\n    }\n\n    componentWillUnmount() {\n        this.saveOrbitControlsState()\n        this.transformControls.removeEventListener('change',this.transformChanged)\n        this.transformControls.removeEventListener('mouseDown',this.pauseQueue)\n        this.transformControls.removeEventListener('mouseUp',this.unpauseQueue)\n        this.props.provider.off(TREE_ITEM_PROVIDER.DOCUMENT_SWAPPED,this.docSwapped)\n        SelectionManager.off(SELECTION_MANAGER.CHANGED,this.selectionChanged)\n    }\n\n    setupRenderer(canvas,context) {\n        this.scene = new THREE.Scene();\n        this.camera = new THREE.PerspectiveCamera(50, canvas.width / canvas.height, 0.1, 1000);\n        this.renderer = new THREE.WebGLRenderer({antialias: false, canvas: canvas, context:context});\n        this.renderer.setPixelRatio( window.devicePixelRatio );\n        this.renderer.gammaOutput = true\n        this.audioListener = new THREE.AudioListener()\n        this.props.provider.setAudioListener(this.audioListener)\n        this.camera.add(this.audioListener)\n        //only set a background if there is no XR active\n        if(!this.xr) this.scene.background = new THREE.Color(0x000000);\n        // this.camera.matrixAutoUpdate = false\n        this.scene.add(this.camera)\n        this.camera.position.set(1,6,6)\n\n        this.transformControls = new TransformControls(this.camera, this.renderer.domElement)\n        this.transformControls.addEventListener('change',this.transformChanged)\n        this.transformControls.addEventListener('dragging-changed', this.transformDraggingChanged)\n        this.transformControls.addEventListener('mouseDown',this.pauseQueue)\n        this.transformControls.addEventListener('mouseUp',this.unpauseQueue)\n        this.scene.add(this.transformControls)\n\n        this.orbitControls = new OrbitControls(this.camera,this.renderer.domElement)\n        this.orbitControls.update()\n        // this.orbitControls.autoRotate = true\n        this.raycaster = new THREE.Raycaster();\n\n        const light = new THREE.DirectionalLight(0xffffff, 1.0);\n        light.position.set(1, 1, 1).normalize();\n        this.scene.add(light);\n\n        this.scene.add(new THREE.AmbientLight(0xffffff,0.4))\n        \n        this.tweenManager = new TweenManager()\n\n        this.props.provider.onRawChange(op => this.updateScene(op))\n        this.props.provider.on(TREE_ITEM_PROVIDER.DOCUMENT_SWAPPED, this.docSwapped)\n        SelectionManager.on(SELECTION_MANAGER.CHANGED, this.selectionChanged)\n\n        this.docSwapped()\n    }\n\n    animationLoop(time, frame) {\n        this.checkAspectRatio()\n        let session = null\n        if(this.xr) session = this.xr.session\n        if(this.state.running) this.scriptManager.tick(time, session)\n        if(this.tweenManager) this.tweenManager.update(time)\n        if(this.orbitControls) this.orbitControls.update()\n        this.previewUpdateNodes.forEach(n => n.previewUpdate())\n        this.renderer.render(this.scene, this.camera)\n    }\n\n    animationLoopWithCamera(bounds,projectionMatrix,viewMatrix, time,frame) {\n        if(!this.scene || !this.camera) return\n        this.camera.matrix.fromArray(viewMatrix)\n        this.camera.matrixWorldNeedsUpdate = true\n        this.camera.updateMatrixWorld()\n        this.camera.projectionMatrix.fromArray(projectionMatrix)\n        this.animationLoop(time,frame)\n    }\n\n    insertNodeMapping(id, node) {\n        if (typeof id !== 'string') throw new Error(\"cannot map an object to an object. invalid call in insertNodeMapping\")\n        this.obj_node_map[id] = node\n        node.userData.graphid = id\n        if(node.previewUpdate) this.previewUpdateNodes.push(node)\n    }\n    removeNodeMapping(id,node) {\n        delete this.obj_node_map[id]\n        delete node.userData.graphid\n        this.previewUpdateNodes = this.previewUpdateNodes.filter(n => n !== node)\n    }\n\n\n    findNode(id) {\n        if (!this.obj_node_map[id]) console.warn(\"could not find node for id\", id)\n        return this.obj_node_map[id]\n    }\n\n    updateScene(op) {\n        const prov = this.props.provider\n        if (op.type === INSERT_ELEMENT) {\n            const objid = op.value\n            const obj = prov.accessObject(op.value)\n            if(obj.type === TOTAL_OBJ_TYPES.SCENE) return this.populateNode(objid)\n            if (is3DObjectType(obj.type)) return this.populateNode(objid)\n            if(obj.type === TOTAL_OBJ_TYPES.ASSET) return\n            if(obj.type === TOTAL_OBJ_TYPES.ASSETS_LIST) return\n            if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) return\n            if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR) return\n            if(obj.type === TOTAL_OBJ_TYPES.BEHAVIORS_LIST) return\n            console.warn(\"unknown object type\", obj)\n            return\n        }\n        if (op.type === SET_PROPERTY) {\n            //skip setting parents. done through insert_element\n            if(op.name === 'parent') return\n            const node = this.findNode(op.object)\n            if (node) {\n                const obj = prov.accessObject(op.object)\n                if(obj.type === 'scene') {\n                    new SceneDef().updateProperty(node,obj,op,this.props.provider)\n                    return\n                }\n                if(is3DObjectType(obj.type)) return get3DObjectDef(obj.type).updateProperty(node,obj,op, this.props.provider)\n            } else {\n                console.log(\"could not find the node for object id:\", op)\n            }\n            return\n        }\n        if (op.type === DELETE_ELEMENT) {\n            this.transformControls.detach()\n            const node = this.findNode(op.value)\n            if(node) {\n                this.removeNodeMapping(op.value,node)\n                const obj = prov.accessObject(op.value)\n                if(is3DObjectType(obj.type)) node.parent.remove(node)\n            }\n            return\n        }\n        // console.log('skipping', op.type)\n    }\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\n        if('running' in nextProps) {\n            if(nextProps.running !== this.props.running) {\n                this.setState({running:nextProps.running})\n                if(nextProps.running === false) {\n                    this.scriptManager.stopRunning()\n                    this.stopAllMedia()\n                    this.resetSceneGraph()\n                    this.stopRecognizers()\n                } else {\n                    //start the script manager\n                    this.startRecognizers()\n                    this.scriptManager.startRunning()\n                    this.scriptManager.startFirstScene();\n                }\n                return false\n            }\n        }\n        return false\n    }\n\n    render() {\n        return <div style={{\n            borderWidth:0,\n            boxSizing:'border-box',\n            height:'100%',\n            display:'flex',\n            flexDirection:'column'\n        }}>\n            <button onClick={this.recenterOnSelection}>recenter on selection</button>\n            <div style={{\n                boxSizing:'border-box',\n                borderWidth:0,\n                margin:0,\n                padding:0,\n                flex:1.0,\n                overflow:'auto',\n            }}\n                 ref={c => this.wrapper = c}\n            >\n                <canvas ref={c => this.canvas = c}\n                        style={{\n                            boxSizing:'border-box',\n                            margin:0,\n                            padding:0,\n                            width:'100px',\n                            height:'100px',\n                            borderWidth:0,\n                        }}\n                        onClick={this.clickedCanvas}\n                        className=\"editable-canvas\"\n                        onKeyDown={this.handleKeyPress}\n                        tabIndex={0}\n                />\n            </div>\n        </div>\n    }\n\n    populateNode(nodeid) {\n        const obj = this.props.provider.accessObject(nodeid)\n        if (is3DObjectType(obj.type)) {\n            const obj3d = get3DObjectDef(obj.type).makeNode(obj,this.props.provider)\n            this.insertNodeMapping(nodeid, obj3d)\n            const parent = this.findNode(obj.parent)\n            if(!parent) {\n                //this must be a nested pasted child. we can fix the parent links later\n                return null\n            }\n            parent.add(obj3d)\n            this.rebuildParentLink(obj)\n            return obj3d\n        }\n        if (obj.type === TOTAL_OBJ_TYPES.SCENE) {\n            const scene = new SceneDef().makeNode(obj,this.props.provider)\n            this.insertNodeMapping(nodeid, scene)\n            this.addSceneWrapper(scene)\n            this.setCurrentSceneWrapper(scene,true)\n            return scene\n        }\n\n        console.warn(\"cannot populate node for type\", obj.type)\n    }\n\n    rebuildParentLink(obj) {\n        obj.getChildren().forEach((ch)=>{\n            const ch3 = this.findNode(ch.id)\n            if(!ch3.parent) this.findNode(obj.id).add(ch3)\n            this.rebuildParentLink(ch)\n        })\n    }\n\n    addSceneWrapper(scene) {\n        this.scenes.push(scene)\n        this.scene.add(scene)\n    }\n\n    saveOrbitControlsState() {\n        const scene = this.scenes.find(sc => sc.visible)\n        this.orbitControls.saveState()\n        const id = scene.userData.graphid\n        this.props.provider.orbit_state[id] = {\n            target: this.orbitControls.target0.clone(),\n            position:this.orbitControls.position0.clone(),\n        }\n    }\n    restoreOrbitControlsState(scene) {\n        const id = scene.userData.graphid\n        if(this.props.provider.orbit_state[id]) {\n            const state = this.props.provider.orbit_state[id]\n            this.orbitControls.target0.copy(state.target)\n            this.orbitControls.position0.copy(state.position)\n            this.orbitControls.reset()\n        }\n    }\n    setCurrentSceneWrapper(scene, saveState) {\n        if(!scene) return this.props.provider.getLogger().error(\"invalid scene. cannot setCurrentSceneWrapper\")\n        const cur = this.getCurrentSceneWrapper()\n        const changed = (scene !== cur)\n        if(changed && saveState) this.saveOrbitControlsState()\n        this.current_scene_wrapper = scene\n        this.scenes.forEach(sc => {\n            if(sc === scene) {\n                sc.visible = true\n            } else {\n                sc.visible = false\n            }\n        })\n        if(changed) this.restoreOrbitControlsState(scene)\n    }\n\n    dumpScenes() {\n        this.scenes.forEach(sc => {\n            console.log(\"scene\")\n            this.dump(sc,'')\n        })\n    }\n    dump(sc,inset) {\n        console.log(inset+\"\",sc.type,sc.id,  'vis', sc.visible)\n        if(sc.type === 'Mesh') console.log(inset+'  ',sc.geometry.type)\n        // console.log(sc)\n        if(sc.children) {\n            sc.children.forEach((ch) => this.dump(ch, inset + '  '))\n        }\n    }\n\n    getCurrentSceneWrapper() {\n        return this.current_scene_wrapper\n    }\n\n    clickedCanvas = (e) => {\n        this.canvas.focus()\n        const rect = this.canvas.getBoundingClientRect();\n        const pointer = {\n            x: ( e.clientX - rect.left ) / rect.width * 2 - 1,\n            y: - ( e.clientY - rect.top ) / rect.height * 2 + 1,\n        }\n\n        function findKnownParent(node) {\n            if(!node) return null\n            if(node.userData.graphid) return node\n            return findKnownParent(node.parent)\n        }\n\n        this.raycaster.setFromCamera(pointer, this.camera);\n        const intersect = this.raycaster.intersectObjects(this.getCurrentSceneWrapper().children, true)\n        if(intersect && intersect.length >= 1) {\n            let obj = findKnownParent(intersect[0].object)\n            if(this.state.running) {\n                this.scriptManager.performClickAction(this.props.provider.accessObject(obj.userData.graphid), e)\n            } else {\n                SelectionManager.setSelection(obj.userData.graphid)\n            }\n        } else {\n            SelectionManager.clearSelection()\n        }\n    }\n\n\n    resetSceneGraph() {\n        Object.keys(this.obj_node_map).forEach(id => {\n            const graphObj = this.props.provider.accessObject(id)\n            const threeObj = this.obj_node_map[id]\n            if(graphObj.type === 'scene') {\n                // new SceneDef().updateProperty(node,obj,op,this.props.provider)\n                return\n            }\n            if(is3DObjectType(graphObj.type)) {\n                const def = get3DObjectDef(graphObj.type)\n                if(def.reset) {\n                    def.reset(threeObj,graphObj,this.props.provider.getDataGraph())\n                }\n            }\n        })\n    }\n\n    stopAllMedia() {\n        this.props.provider.assetsManager.stopAllMedia()\n    }\n\n    startRecognizers() {\n        //called when script running is started\n    }\n\n    stopRecognizers() {\n        //called when script running is started\n    }\n\n    getFloorNear(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO get floor near\")\n    }\n\n    startLocalAnchor(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO start local anchor\")\n    }\n\n    stopLocalAnchor(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO stop local anchor\")\n    }\n\n    startImageRecognizer(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO start image recognizer\")\n    }\n\n    stopImageRecognizer(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO stop image recognizer\")\n    }\n\n    startGeoTracker(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO start geo recognizer\")\n    }\n\n    stopGeoTracker(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO stop geo recognizer\")\n    }\n\n    startWorldInfo(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO start world info\")\n    }\n\n    stopWorldInfo(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO stop world info\")\n    }\n\n}\n","import * as THREE from 'three'\nimport {POINTER_ENTER, POINTER_EXIT, POINTER_MOVE, POINTER_PRESS, POINTER_RELEASE} from 'webxr-boilerplate'\n\n\n\nconst on = (elem,type,cb) => elem.addEventListener(type,cb)\nconst off = (elem,type,cb) => elem.removeEventListener(type,cb)\nconst toRad = (degrees) => degrees*Math.PI/180\n\nexport default class TranslationArrow extends THREE.Group {\n    constructor(axis, control) {\n        super()\n        this.axis = axis\n        this.control = control\n        this.makePlane()\n        this.makeArrow()\n        this.makeInputGrabber()\n    }\n\n    makePlane() {\n        this.plane = new THREE.Mesh(\n            new THREE.PlaneBufferGeometry(100, 100, 100, 100),\n            new THREE.MeshBasicMaterial({visible: true, wireframe: true, side: THREE.DoubleSide})\n        )\n        if (this.axis === 'Z') this.plane.rotation.y = toRad(90)\n        this.plane.userData.draggable = true\n        this.plane.visible = false\n        this.add(this.plane)\n    }\n\n    makeArrow() {\n        this.arrow = new THREE.Mesh(\n            new THREE.CylinderBufferGeometry(0.02, 0.02, 4),\n            new THREE.MeshLambertMaterial({color: 'yellow'})\n        )\n        if (this.axis === 'X') this.arrow.rotation.z = toRad(90)\n        if (this.axis === 'Y') this.arrow.rotation.z = toRad(180)\n        if (this.axis === 'Z') this.arrow.rotation.x = toRad(90)\n        this.add(this.arrow)\n    }\n\n    makeInputGrabber() {\n        this.input = new THREE.Mesh(\n            new THREE.CylinderBufferGeometry(0.1, 0.1, 4),\n            new THREE.MeshLambertMaterial({color: 'green', visible: false})\n        )\n        if (this.axis === 'X') this.input.rotation.z = toRad(90)\n        if (this.axis === 'Y') this.input.rotation.z = toRad(180)\n        if (this.axis === 'Z') this.input.rotation.x = toRad(90)\n        this.input.userData.clickable = true\n        this.add(this.input)\n    }\n\n    attach() {\n        on(this.input, POINTER_ENTER, this.startHover)\n        on(this.input, POINTER_EXIT, this.endHover)\n        on(this.input, POINTER_PRESS, this.beginDrag)\n    }\n\n    detach() {\n        off(this.input, POINTER_ENTER, this.startHover)\n        off(this.input, POINTER_EXIT, this.endHover)\n        off(this.input, POINTER_PRESS, this.beginDrag)\n    }\n\n    startHover = () => this.arrow.material.color.set(0xffffff)\n    endHover = () => this.arrow.material.color.set(0xffff00)\n\n    beginDrag = (e) => {\n        this.startPoint = this.parent.position.clone()\n        this.startPoint.copy(e.intersection.point)\n        this.parent.target.parent.worldToLocal(this.startPoint)\n        this.oldFilter = this.parent.pointer.intersectionFilter\n        this.parent.pointer.intersectionFilter = (obj) => obj.userData.draggable\n        this.startPosition = this.parent.target.position.clone()\n        this.plane.visible = true\n        on(this.plane, POINTER_MOVE, this.updateDrag)\n        on(this.plane, POINTER_RELEASE, this.endDrag)\n    }\n    updateDrag = (e) => {\n        this.endPoint = e.intersection.point.clone()\n        this.parent.target.parent.worldToLocal(this.endPoint)\n        //neutralize y and z\n        if (this.axis === 'X') {\n            this.endPoint.y = this.startPoint.y\n            this.endPoint.z = this.startPoint.z\n        }\n        if (this.axis === 'Y') {\n            this.endPoint.x = this.startPoint.x\n            this.endPoint.z = this.startPoint.z\n        }\n        if (this.axis === 'Z') {\n            this.endPoint.x = this.startPoint.x\n            this.endPoint.y = this.startPoint.y\n        }\n        const diff = this.endPoint.clone().sub(this.startPoint)\n        const finalPoint = this.startPosition.clone().add(diff)\n        this.parent.target.position.copy(finalPoint)\n        this.parent.position.copy(finalPoint)\n    }\n    endDrag = (e) => {\n        off(this.plane, POINTER_MOVE, this.updateDrag)\n        off(this.plane, POINTER_RELEASE, this.endDrag)\n        this.parent.pointer.intersectionFilter = this.oldFilter\n        this.plane.visible = false\n        this.parent.dispatchEvent({\n            type: 'change',\n            start: this.startPosition.clone(),\n            end: this.parent.position.clone()\n        })\n    }\n}\n","import * as THREE from 'three'\nimport TranslationArrow from './TranslationArrow'\n\nexport class TranslateControl extends THREE.Group {\n    constructor() {\n        super()\n        this.handles = []\n        this.handles.push(new TranslationArrow('X', this))\n        this.handles.push(new TranslationArrow('Y', this))\n        this.handles.push(new TranslationArrow('Z', this))\n        this.handles.forEach(h => this.add(h))\n        this.visible = false\n    }\n\n    attach(target, pointer) {\n        this.target = target\n        this.pointer = pointer\n        this.position.copy(target.position)\n        this.visible = true\n        this.handles.forEach(h => h.attach())\n    }\n\n    detach() {\n        this.target = null\n        this.pointer = null\n        this.visible = false\n        this.handles.forEach(h => h.attach())\n    }\n}\n","import * as THREE from 'three'\n\nimport {POINTER_RELEASE, POINTER_CLICK, POINTER_ENTER, POINTER_EXIT, POINTER_PRESS, POINTER_MOVE} from 'webxr-boilerplate'\n\n// const $ = (sel) => document.querySelector(sel)\nconst on = (elem, type, cb) => elem.addEventListener(type,cb)\n// const toRad = (deg) => deg * Math.PI/180\n\nexport default class Panel2D extends THREE.Object3D {\n    constructor(scene,camera) {\n        super()\n\n        if(!scene) throw new Error(\"cannot pass empty scene to Panel2D()\")\n        if(!camera) throw new Error(\"cannot pass empty camera to Panel2D()\")\n        this.type = 'panel2d'\n        this.listeners = {}\n        this.scene = scene\n        this.camera = camera\n        this.canvas = document.createElement('canvas')\n        this.canvas.width = 256\n        this.canvas.height = 512\n        this.canvasTexture = new THREE.CanvasTexture(this.canvas)\n        this.redrawHandler = (e) => this.redraw()\n\n        const c = this.canvas.getContext('2d')\n        c.fillStyle = 'red'\n        c.fillRect(0,0,this.canvas.width,this.canvas.height)\n\n        this.mesh = new THREE.Mesh(\n            new THREE.PlaneGeometry(1,2),\n            new THREE.MeshBasicMaterial({color:'white',map:this.canvasTexture})\n        )\n        this.mesh.userData.clickable = true\n        this.comps = []\n\n        this.add(this.mesh)\n\n        let inside = null\n        on(this.mesh,POINTER_MOVE,(e)=>{\n            const uv = e.intersection.uv\n            const fpt = new THREE.Vector2(uv.x*256, 512-uv.y*512)\n            if(inside && !inside.contains(fpt)) {\n                inside.fire(POINTER_EXIT)\n                inside = null\n            }\n            const comp = this.findAt(fpt)\n            // for(let i=0; i<this.comps.length; i++) {\n            //     const comp = this.comps[i]\n            //     if(comp.contains(fpt)) {\n            if(inside !== comp){\n                if(inside) inside.fire(POINTER_EXIT)\n                inside = null\n            }\n            if(comp) comp.fire(POINTER_ENTER)\n            inside = comp\n            // }\n            // }\n        })\n        on(this.mesh,POINTER_CLICK,(e)=>{\n            const uv = e.intersection.uv\n            const fpt = new THREE.Vector2(uv.x*256, 512-uv.y*512)\n            const comp = this.findAt(fpt)\n            if(comp) comp.fire(POINTER_CLICK)\n            // for(let i=0; i<this.comps.length; i++) {\n            //     const comp = this.comps[i]\n            //     if(comp.contains(fpt)) {\n            //         comp.fire(POINTER_CLICK)\n            //     }\n            // }\n        })\n\n        this.header = new THREE.Mesh(\n            new THREE.BoxGeometry(1.0,0.1,0.1),\n            new THREE.MeshBasicMaterial({color:'goldenrod'})\n        )\n        this.header.userData.clickable = true\n        this.header.position.set(0,1.1,0)\n        this.add(this.header)\n\n        on(this.header,POINTER_ENTER, e => this.header.material.color.set('yellow'))\n        on(this.header,POINTER_EXIT,  e => this.header.material.color.set('goldenrod'))\n        on(this.header,POINTER_PRESS, e => this.startDrag())\n    }\n\n    fire(type,payload) {\n        if(!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].forEach(cb => cb(payload))\n    }\n\n    findAt(pt) {\n        for(let i=0; i<this.comps.length; i++) {\n            const comp = this.comps[i]\n            const res = comp.findAt({x:pt.x-comp.x,y:pt.y-comp.y})\n            if(res) return res\n        }\n        return null\n    }\n\n    add(comp) {\n        if(comp instanceof THREE.Object3D) {\n            super.add(comp)\n        } else {\n            this.comps.push(comp)\n            on(comp, 'changed', this.redrawHandler)\n        }\n    }\n\n    redraw() {\n        const ctx = this.canvas.getContext('2d')\n        ctx.fillStyle = 'white'\n        ctx.fillRect(0,0,this.canvas.width,this.canvas.height)\n        this.comps.forEach(comp => comp.draw(ctx))\n        this.canvasTexture.needsUpdate = true\n    }\n\n    startDrag() {\n        this.header.userData.clickable = false\n        this.mesh.userData.clickable = false\n\n        this.dragSphere = new THREE.Mesh(\n            new THREE.SphereGeometry(4,32,32),\n            new THREE.MeshLambertMaterial({\n                color:'green',\n                wireframe:true,\n                side: THREE.BackSide\n            })\n        )\n        this.dragSphere.userData.clickable = true\n        this.scene.add(this.dragSphere)\n\n        on(this.dragSphere,POINTER_MOVE,(e)=> this.moveDrag(e))\n        on(this.dragSphere,POINTER_RELEASE,(e)=> this.endDrag(e))\n\n    }\n    endDrag() {\n        this.scene.remove(this.dragSphere)\n        this.dragSphere.userData.clickable = false\n        this.header.userData.clickable = true\n        this.mesh.userData.clickable = true\n    }\n\n\n    moveDrag(e) {\n        this.position.copy(e.point)\n        this.position.add(new THREE.Vector3(0,-1,0))\n        this.lookAt(this.camera.position)\n    }\n}\n","export default class Component2D {\n    constructor() {\n        this.listeners = {}\n    }\n    set(key,value) {\n        this[key] = value\n        this.fire('changed',{type:'changed',target:this})\n        return this\n    }\n    get(key) {\n        return this[key]\n    }\n    addEventListener(type,cb) {\n        if(!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].push(cb)\n        return this\n    }\n    on(type,cb) {\n        this.addEventListener(type,cb)\n        return this\n    }\n    setAll(props) {\n        Object.keys(props).forEach(key => this.set(key, props[key]))\n        return this\n    }\n    fire(type,payload) {\n        if(!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].forEach(cb => cb(payload))\n    }\n\n}","import {POINTER_ENTER, POINTER_EXIT} from 'webxr-boilerplate'\nimport Component2D from \"./component2d\";\n\n\nexport default class Button2D extends Component2D {\n    constructor() {\n        super()\n        this.type = 'button'\n        this.text = 'foo'\n        this.x = 0\n        this.y = 0\n        this.fsize = 20\n        this.w = this.text.length * this.fsize\n        this.h = 20\n        this.normalBg = 'white'\n        this.hoverBg = 'red'\n        this.bg = this.normalBg\n        this.on(POINTER_ENTER, () => {\n            this.bg = this.hoverBg\n            this.fire('changed', {type: 'changed', target: this})\n        })\n        this.on(POINTER_EXIT, () => {\n            this.bg = this.normalBg\n            this.fire('changed', {type: 'changed', target: this})\n        })\n    }\n\n    draw(ctx) {\n        ctx.font = `${this.fsize}px sans-serif`\n        const metrics = ctx.measureText(this.text)\n        this.w = 5 + metrics.width + 5\n        this.h = 0 + this.fsize + 4\n        ctx.fillStyle = this.bg\n        ctx.fillRect(this.x, this.y, this.w, this.h)\n        ctx.fillStyle = 'black'\n        ctx.fillText(this.text, this.x + 3, this.y + this.fsize - 2)\n        ctx.strokeStyle = 'black'\n        ctx.strokeRect(this.x, this.y, this.w, this.h)\n    }\n\n    contains(pt) {\n        if (pt.x < this.x) return false\n        if (pt.x > this.x + this.w) return false\n        if (pt.y < this.y) return false\n        if (pt.y > this.y + this.h) return false\n        return true\n    }\n\n    findAt(pt) {\n        if (pt.x < 0) return null\n        if (pt.x > 0 + this.w) return null\n        if (pt.y < 0) return null\n        if (pt.y > 0 + this.h) return null\n        return this\n    }\n\n    set(key, value) {\n        super.set(key, value)\n        if (key === 'normalBg') this.bg = this.normalBg\n    }\n}\n","import Component2D from \"./component2d\";\n\nexport default class Group2D extends Component2D {\n    constructor() {\n        super()\n        this.type = 'group'\n        this.x = 0\n        this.y = 0\n        this.w = 100\n        this.h = 100\n        this.bg = 'gray'\n        this.visible = true\n        this.comps = []\n        this.padding = 5\n        this.border = 1\n\n        this.layout = (comp) => {\n            console.log(\"not laying out anything\")\n        }\n    }\n    draw(ctx) {\n        if(!this.visible) return\n        this.layout(this)\n        ctx.fillStyle = this.bg\n        ctx.fillRect(this.x,this.y,this.w,this.h)\n        if(this.border > 0) {\n            ctx.strokeStyle = 'black'\n            ctx.strokeRect(this.x, this.y, this.w, this.h)\n        }\n        ctx.save()\n        ctx.translate(this.x+this.padding,this.y+this.padding)\n        this.comps.forEach(comp => comp.draw(ctx))\n        ctx.restore()\n    }\n\n    contains(pt) {\n        if(pt.x < this.x) return false\n        if(pt.x > this.x + this.w) return false\n        if(pt.y < this.y) return false\n        if(pt.y > this.y + this.h) return false\n        return true\n    }\n    findAt(pt) {\n        if(!this.visible) return null\n        for(let i=0; i<this.comps.length; i++) {\n            const comp = this.comps[i]\n            const res = comp.findAt({x:pt.x-comp.x-5,y:pt.y-comp.y-5})\n            if(res) return res\n        }\n        return null\n    }\n\n    childSet(key,value) {\n        this.childProps[key] = value\n        this.comps.forEach(ch=>ch.set(key,value))\n        return this\n    }\n\n    add(comp) {\n        this.comps.push(comp)\n        this.fire('changed',{type:'changed',target:this})\n        return this\n    }\n}\n","import * as THREE from 'three'\n\nconst toRad = (deg) => Math.PI/180*deg\nconst YAXIS = new THREE.Vector3(0,1,0)\n\n\nexport default class ThreeDOFController {\n\n\n    constructor(stagePos, stageRot) {\n        this.stagePos = stagePos\n        this.stageRot = stageRot\n        this.states = { touchpad: false}\n        this.listeners = {}\n        this.keystates = {\n            ArrowLeft:{current:false, previous:false},\n            ArrowRight:{current:false, previous:false},\n            ArrowUp:{current:false, previous:false},\n            ArrowDown:{current:false, previous:false}\n        }\n        this.dir = new THREE.Vector3(0,0,1)\n\n\n        document.addEventListener('keydown',(e)=>{\n            if(this.keystates[e.key]) {\n                this.keystates[e.key].current = true\n            }\n        })\n        document.addEventListener('keyup',(e)=>{\n            if(this.keystates[e.key]) {\n                this.keystates[e.key].current = false\n            }\n        })\n\n    }\n\n    addEventListener(type, cb) {\n        if (!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].push(cb)\n    }\n\n    _fire(type,payload) {\n        if (!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].forEach(cb => cb(payload))\n    }\n\n\n\n\n    updateKeys() {\n        if(this.keystates.ArrowLeft.current === false && this.keystates.ArrowLeft.previous === true) {\n            this.rotateLeft()\n        }\n        if(this.keystates.ArrowRight.current === false && this.keystates.ArrowRight.previous === true) {\n            this.rotateRight()\n        }\n        if(this.keystates.ArrowUp.current === false && this.keystates.ArrowUp.previous === true) {\n            this.moveForward()\n        }\n        if(this.keystates.ArrowDown.current === false && this.keystates.ArrowDown.previous === true) {\n            this.moveBackward()\n        }\n\n        Object.keys(this.keystates).forEach(key => {\n            this.keystates[key].previous = this.keystates[key].current\n        })\n    }\n\n    rotateLeft() {\n        this.dir.applyAxisAngle(YAXIS,toRad(30))\n        this.stageRot.rotation.y -= toRad(30)\n    }\n\n    rotateRight() {\n        this.dir.applyAxisAngle(YAXIS,-toRad(30))\n        this.stageRot.rotation.y += toRad(30)\n    }\n\n    moveForward() {\n        this.stagePos.position.add(this.dir)\n        this._fire('move',this.stagePos.position)\n    }\n\n    moveBackward() {\n        this.stagePos.position.sub(this.dir)\n        this._fire('move',this.stagePos.position)\n    }\n\n    update() {\n        this.scanGamepads()\n        this.updateKeys()\n    }\n\n    scanGamepads() {\n        // console.log(\"gamepads\",navigator.getGamepads())\n        const gamepads = navigator.getGamepads()\n        for(let i=0; i<gamepads.length; i++) {\n            const gamepad = gamepads[i]\n            if ( gamepad && ( gamepad.id === 'Daydream Controller' ||\n                gamepad.id === 'Gear VR Controller' || gamepad.id === 'Oculus Go Controller' ||\n                gamepad.id === 'OpenVR Gamepad' || gamepad.id.startsWith( 'Oculus Touch' ) ||\n                gamepad.id.startsWith( 'Spatial Controller' ) ) ) {\n                //we should have at least two buttons\n                if(gamepad.buttons.length < 2) return\n\n                const touchpad = gamepad.buttons[0]\n                if(touchpad.pressed && gamepad.axes && gamepad.axes.length === 2) {\n                    const left = gamepad.axes[0] < -0.5\n                    const right = gamepad.axes[0] > 0.5\n                    const down = gamepad.axes[1] < -0.5\n                    const up = (gamepad.axes[1] > 0.5)\n\n\n                    if (down && this.states.touchpad === false && touchpad.pressed === true) {\n                        this.moveForward()\n                    }\n                    if (up && this.states.touchpad === false && touchpad.pressed === true) {\n                        this.moveBackward()\n                    }\n                    if (left && this.states.touchpad === false && touchpad.pressed === true) {\n                        this.rotateLeft()\n                    }\n                    if (right && this.states.touchpad === false && touchpad.pressed === true) {\n                        this.rotateRight()\n                    }\n                }\n\n                const trigger = gamepad.buttons[1]\n                if(trigger.pressed) console.log(\"trigger\")\n                if(this.states.touchpad === false && touchpad.pressed === true) {\n                    console.log(\"pressed\")\n                }\n                if(this.states.touchpad === true && touchpad.pressed === false) {\n                    console.log(\"released\")\n                }\n                this.states.touchpad = touchpad.pressed\n            }\n\n        }\n    }\n\n}\n","import SceneDef from './defs/SceneDef'\nimport {ITEM_ICONS, OBJ_TYPES, TOTAL_OBJ_TYPES} from './Common'\nimport {MenuPopup, SelectionManager, toQueryString} from 'react-visual-editor-framework'\nimport React from 'react'\nimport {AuthModule} from './AuthModule'\n\nexport function addScene(provider) {\n    const root = provider.accessObject(provider.getSceneRoot())\n    const scenes = root.getChildren().filter(ch => ch.type === TOTAL_OBJ_TYPES.SCENE)\n    let prev = null\n    if(scenes.length >= 1) prev = scenes[scenes.length-1]\n    const scene = new SceneDef().make(provider.getDataGraph(),root)\n    if(prev) {\n        root.insertChildAfter(scene,prev)\n    } else {\n        root.insertFirstChild(scene)\n    }\n    SelectionManager.setSelection(scene.id)\n}\n\n\nexport function deleteObject(provider) {\n    if(SelectionManager.isEmpty()) return\n    provider.accessObject(SelectionManager.getSelection()).removeFromParent()\n    SelectionManager.clearSelection()\n}\n\nexport function newDoc(provider) {\n    const opts = Object.assign({},provider.options,\n        {mode:'edit', doc:provider.genID('doc')})\n    delete opts.AuthModule\n    document.location =  `./?${toQueryString(opts)}`\n}\n\n\nexport function showAddPopup (e, provider) {\n    let item = provider.getSelectedSceneObject()\n    const acts = Object.keys(OBJ_TYPES).map(type => {\n        return {\n            title: type,\n            icon: ITEM_ICONS[type],\n            fun: () => provider.add3DObject(type,item)\n        }\n    })\n    provider.getPopupManager().show(<MenuPopup actions={acts}/>, e.target)\n}\n\nexport function showAddAssetPopup(e, provider) {\n    const acts = generateAddAssetPopup(provider)\n    provider.getPopupManager().show(<MenuPopup actions={acts}/>, e.target)\n}\n\nexport function generateAddAssetPopup(provider) {\n    let acts = []\n    // console.log(\"Auth mod\",AuthModule.supportsAssetUpload())\n    if(AuthModule.supportsAssetUpload()) {\n        acts = acts.concat([\n            {\n                title: 'image',\n                enabled: AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.image,\n                fun: () => provider.showAddImageAssetDialog()\n            },\n            {\n                title: 'server image',\n                enabled: AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.image,\n                fun: () => provider.showAddServerImageDialog()\n            },\n            {divider: true},\n            {\n                title: 'GLTF model',\n                enabled: AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.model,\n                fun: () => provider.showAddGLTFAssetDialog()\n            },\n            {\n                title: 'GLB model',\n                enabled: AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.model,\n                fun: () => provider.showAddGLBAssetDialog()\n            },\n            {divider: true},\n            {\n                title: 'audio file',\n                enabled: AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.audio,\n                fun: () => provider.showAddAudioAssetDialog()\n            },\n            {\n                title: 'existing asset on server',\n                enabled: AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.assets,\n                fun: () => provider.showOpenAssetDialog()\n            }])\n    } else {\n        acts.push({\n            title: 'add asset from glitch',\n            icon: ITEM_ICONS.assets,\n            fun: () => provider.showOpenAssetDialog()\n        })\n    }\n\n    acts.push({\n        title:'geo location',\n        icon: ITEM_ICONS.geoanchor,\n        fun: () => provider.showAddGeoLocationAssetDialog()\n    })\n\n    return acts\n}\n\nexport function showAddBehaviorPopup (e, provider) {\n    const acts = [\n        {\n            title:'Add Behavior from Server',\n            enabled: AuthModule.isLoggedIn(),\n            icon: ITEM_ICONS.behavior_script,\n            fun: () => provider.showOpenBehaviorDialog()\n        },\n    ]\n    if(AuthModule.supportsScriptEdit()) {\n        acts.push({\n            title: 'custom behavior',\n            enabled: AuthModule.isLoggedIn(),\n            icon: ITEM_ICONS.behavior_script,\n            fun: () => provider.addCustomBehaviorAsset()\n        })\n    }\n    provider.getPopupManager().show(<MenuPopup actions={acts}/>, e.target)\n}\n","import React, {Component} from 'react'\nimport {\n    AmbientLight,\n    AudioListener,\n    Color,\n    CylinderBufferGeometry,\n    DirectionalLight,\n    Group,\n    Mesh,\n    MeshLambertMaterial,\n    PerspectiveCamera,\n    Scene,\n    WebGLRenderer\n} from 'three'\n\n\nimport {Pointer, POINTER_CLICK, VR_DETECTED, VRManager, VRStats} from \"webxr-boilerplate\"\n\nimport {SelectionManager, SELECTION_MANAGER, TREE_ITEM_PROVIDER, on,parseOptions} from 'react-visual-editor-framework'\nimport {TranslateControl} from './TranslateControl'\nimport panel2d from \"./panel2d/panel2d\"\nimport button2d from \"./panel2d/button2d\"\nimport group2d from \"./panel2d/group2d\"\nimport SceneDef from \"./defs/SceneDef\"\nimport {TweenManager} from \"./tween\"\nimport {get3DObjectDef, is3DObjectType, OBJ_TYPES, SIMPLE_COLORS, toRad, TOTAL_OBJ_TYPES} from './Common'\n//use the oculus go controller\nimport ThreeDOFController from \"./3dof.js\"\nimport ScriptManager, {SceneGraphProvider} from './ScriptManager'\nimport {deleteObject} from './Actions'\nimport {DialogContainer} from 'appy-comps'\nimport {PubnubLogger} from '../syncgraph/PubnubSyncWrapper'\n\nconst {SET_PROPERTY, CREATE_OBJECT, INSERT_ELEMENT, DELETE_ELEMENT} = require(\"syncing_protocol\");\n\nclass Adapter extends SceneGraphProvider {\n    constructor(editor, provider) {\n        super()\n        this.editor = editor\n        this.provider = provider\n    }\n    getCurrentScene ()  {\n        return this.provider.accessObject(this.editor.currentScene)\n    }\n    getSceneObjects (scene)  {\n        return scene.getChildren().filter(ch => is3DObjectType(ch.type))\n    }\n    getBehaviorsForObject (obj)  {\n        return obj.getChildren().filter(ch => ch.type === TOTAL_OBJ_TYPES.BEHAVIOR)\n    }\n    getThreeObject(id) {\n        return this.editor.findNode(id)\n    }\n    getParsedBehaviorAsset (beh) {\n        const asset = this.provider.accessObject(beh.behavior)\n        return this.provider.getCachedBehaviorAsset(asset.id)\n    }\n    getAllBehaviors ()  {\n        return this.provider.accessObject(this.provider.getSceneRoot())\n            .find((obj)=> obj.type === TOTAL_OBJ_TYPES.BEHAVIOR)\n    }\n\n    getAllScenes() {\n        return this.provider.accessObject(this.provider.getSceneRoot())\n            .find((obj)=>obj.type === TOTAL_OBJ_TYPES.SCENE)\n    }\n\n    navigateScene(id) {\n        const obj = this.provider.accessObject(id)\n        if(obj.exists()) {\n            return this.editor.swapScene(id)\n        } else {\n            const logger = this.provider.getLogger()\n            logger.error(\"cannot navigate to scene that does not exist\",id)\n        }\n    }\n    playMediaAsset(asset, trusted) {\n        this.provider.assetsManager.playMediaAsset(asset, trusted)\n    }\n\n    stopMediaAsset(asset) {\n        this.provider.assetsManager.stopMediaAsset(asset)\n    }\n\n    getGraphObjectByName(title) {\n        const list = this.provider.accessObject(this.provider.getSceneRoot()).find((o)=>o.title === title)\n        if(!list || list.length<1) return null\n        return list[0]\n    }\n    getGraphObjectById(id) {\n        return this.provider.accessObject(id)\n    }\n\n    getCamera() {\n        return this.editor.camera\n    }\n    \n\n    getTweenManager() {\n        return this.editor.tweenManager\n    }\n\n    getFloorNear(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO get floor near\")\n    }\n\n    startLocalAnchor(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO start local anchor\")\n    }\n\n    stopLocalAnchor(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO stop local anchor\")\n    }\n\n    startImageRecognizer(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO start image recognizer\")\n    }\n\n    stopImageRecognizer(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO stop image recognizer\")\n    }\n\n    startGeoTracker(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO start geo recognizer\")\n    }\n\n    stopGeoTracker(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO stop geo recognizer\")\n    }\n\n    startWorldInformation(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO start world information\")\n        return 0\n    }\n\n    stopWorldInformation(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO stop world information\")\n        return 0\n    }\n\n}\n\nexport default class ImmersiveVREditor extends Component {\n    constructor(props) {\n        super(props)\n        this.obj_node_map = {}\n        this.previewUpdateNodes = []\n        const opts = parseOptions({})\n        if(!opts.doc) throw new Error(\"doc not specified\")\n        this.logger = new PubnubLogger(opts.doc)\n        this.scriptManager = new ScriptManager(new Adapter(this, this.props.provider), this.logger)\n    }\n\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\n        return false\n    }\n\n\n    render() {\n        return <div>\n            <div id=\"overlay\">\n                <div id=\"inner\">\n                    <h1>Application Name</h1>\n                    <div id=\"loading-indicator\">\n                        <label>loading...</label><br></br>\n                        <progress max=\"100\" value=\"0\" id=\"progress\"></progress>\n                    </div>\n                    <button id=\"enter-button\" disabled>VR not supported, play anyway</button>\n                </div>\n            </div>\n            <div ref={c => this.wrapper = c}></div>\n            <DialogContainer/>\n        </div>\n    }\n\n\n    componentDidMount() {\n        this.sceneWrappers = {}\n        this.initScene()\n        this.renderer.setAnimationLoop(this.render3.bind(this))\n    }\n\n    render3(time) {\n        //update the pointer and stats, if configured\n        if(this.tweenManager) this.tweenManager.update(time)\n        this.previewUpdateNodes.forEach(n => n.previewUpdate())\n        if(this.pointer) this.pointer.tick(time)\n        if(this.stats) this.stats.update(time)\n        if(this.controller) this.controller.update(time)\n        if(this.scriptManager.isRunning()) this.scriptManager.tick(time)\n        this.renderer.render( this.scene, this.camera );\n    }\n\n    initScene() {\n\n        const $ = (sel) => document.querySelector(sel)\n        const on = (elem, type, cb) => elem.addEventListener(type,cb)\n\n        const container = this.wrapper\n        this.tweenManager = new TweenManager()\n        this.scene = new Scene();\n        this.stageRot = new Group()\n        this.scene.add(this.stageRot)\n        this.stagePos = new Group()\n        this.stageRot.add(this.stagePos)\n        this.camera = new PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 0.1, 50 );\n        this.renderer = new WebGLRenderer( { antialias: true } );\n        const renderer = this.renderer\n        renderer.setPixelRatio( window.devicePixelRatio );\n        renderer.setSize( window.innerWidth, window.innerHeight );\n        renderer.gammaOutput = true\n        renderer.vr.enabled = true;\n        container.appendChild( renderer.domElement );\n        this.vrmanager = new VRManager(renderer)\n\n        this.audioListener = new AudioListener()\n        this.props.provider.setAudioListener(this.audioListener)\n        this.camera.add(this.audioListener)\n\n        this.initContent()\n\n        window.addEventListener( 'resize', ()=>{\n            this.camera.aspect = window.innerWidth / window.innerHeight;\n            this.camera.updateProjectionMatrix();\n            this.renderer.setSize( window.innerWidth, window.innerHeight );\n        }, false );\n\n\n        on($(\"#enter-button\"),'click',()=>{\n            $(\"#overlay\").style.display = 'none'\n            //we can start playing sound now\n        })\n\n        this.vrmanager.addEventListener(VR_DETECTED,()=>{\n            console.log(\"VR detected\")\n            $(\"#enter-button\").removeAttribute('disabled',false)\n            $(\"#enter-button\").innerText = \"enter vr\"\n            on($(\"#enter-button\"),'click',()=> this.vrmanager.enterVR())\n        })\n\n        const WAIT_FOR_LOAD = false\n\n        if(!WAIT_FOR_LOAD) {\n            $(\"#loading-indicator\").style.display = 'none'\n            $(\"#enter-button\").style.display = 'block'\n            $(\"#enter-button\").removeAttribute('disabled')\n        }\n\n        this.props.provider.onRawChange(this.updateSceneOp.bind(this))\n        this.props.provider.on(TREE_ITEM_PROVIDER.DOCUMENT_SWAPPED, this.documentSwapped.bind(this))\n        SelectionManager.on(SELECTION_MANAGER.CHANGED, this.selectionChanged.bind(this))\n        //clear selection when click on the bg\n        on(this.pointer,POINTER_CLICK,()=> SelectionManager.clearSelection())\n\n        this.controller = new ThreeDOFController(this.stagePos, this.stageRot)\n        // on(this.controller,'move', this.standardProximityHandler)\n\n        this.loadScene()\n    }\n\n    selectionChanged() {\n        const sel = SelectionManager.getSelection()\n        if (sel === null && this.controls) return this.controls.detach(this.selectedNode)\n        const node = this.findNode(sel)\n        if(this.selectedNode !== node && this.controls) this.controls.detach(this.selectedNode)\n        this.selectedNode = node\n        if (this.selectedNode && this.controls) this.controls.attach(this.selectedNode, this.pointer)\n    }\n\n    standardViewClickHandler = (e)  => {\n        if(this.scriptManager.isRunning()) {\n            this.scriptManager.performClickAction(this.props.provider.accessObject(e.target.userData.graphid), e)\n        } else {\n            SelectionManager.setSelection(e.target.userData.graphid)\n        }\n    }\n\n\n    initContent() {\n        if(!this.xr) this.scene.background = new Color(0x000000);\n        const light = new DirectionalLight( 0xffffff, 1.0 );\n        light.position.set( 1, 1, 1 ).normalize();\n        this.scene.add( light );\n        this.scene.add(new AmbientLight(0xffffff,0.2))\n\n        // enable stats visible inside VR\n        this.stats = new VRStats({renderer:this.renderer})\n        if(this.props.editable) {\n            this.camera.add(this.stats)\n        }\n        this.scene.add(this.camera)\n        this.camera.matrixAutoUpdate = false\n\n        //class which handles mouse and VR controller \n        this.pointer = new Pointer(this, {\n            intersectionFilter: ((o) => o.userData.clickable),\n            cameraFollowMouse:false,\n            mouseSimulatesController:false,\n            enableLaser: true,\n            laserLength: 20,\n        })\n\n\n        const STICK_HEIGHT = 1.0\n        const stick = new Mesh(\n            new CylinderBufferGeometry(0.1,0.1,STICK_HEIGHT),\n            new MeshLambertMaterial({color:'aqua'})\n        )\n        stick.position.z = -STICK_HEIGHT/2;\n        stick.rotation.x = toRad(-90)\n        this.pointer.controller1.add(stick)\n\n\n        if(this.props.editable) {\n            this.controls = new TranslateControl()\n            this.controls.name = 'Controls'\n            on(this.controls, 'change', (e) => {\n                const sel = SelectionManager.getSelection()\n                if (sel) {\n                    const node = this.findNode(sel)\n                    const prov = this.props.provider\n                    prov.quick_setPropertyValue(sel, 'tx', node.position.x)\n                    prov.quick_setPropertyValue(sel, 'ty', node.position.y)\n                    prov.quick_setPropertyValue(sel, 'tz', node.position.z)\n                }\n            })\n        }\n\n        if(this.props.editable) {\n            this.tools = new panel2d(this.scene, this.camera)\n            this.tools.position.set(-1, 0, -3)\n            this.scene.add(this.tools)\n\n\n            this.tools.add(new button2d()\n                .setAll({x: 5, y: 5, text: 'add box'})\n                .on(POINTER_CLICK, () => {\n                    const scene = this.props.provider.accessObject(this.currentScene)\n                    this.props.provider.add3DObject(OBJ_TYPES.cube,scene)\n                }))\n            this.tools.add(new button2d()\n                .setAll({x: 5, y: 5 + 30, text: 'add sphere'})\n                .on(POINTER_CLICK, () => {\n                    const scene = this.props.provider.accessObject(this.currentScene)\n                    this.props.provider.add3DObject(OBJ_TYPES.sphere,scene)\n                }))\n            this.tools.add(new button2d()\n                .setAll({x: 5, y: 5 + 30 + 30, text: 'delete'})\n                .on(POINTER_CLICK, ()=>{\n                    deleteObject(this.props.provider)\n                }))\n            this.tools.add(new button2d()\n                .setAll({x: 5, y: 5 + 30 + 30 + 30, text: 'save'})\n                .on(POINTER_CLICK, this.props.provider.save))\n            const runButton = new button2d()\n                .setAll({x:5, y: 5+30*4, text:'run'})\n                .on(POINTER_CLICK,() => {\n                    if(this.scriptManager.isRunning()) {\n                        runButton.set('text','run')\n                        this.scriptManager.stopRunning()\n                    } else {\n                        runButton.set('text','stop')\n                        this.scriptManager.startRunning()\n                        this.scriptManager.startFirstScene()\n                    }\n                })\n            this.tools.add(runButton)\n\n            const rowLayout = (panel) => {\n                let x = 0\n                panel.comps.forEach((c) => {\n                    c.x = x\n                    c.y = 0\n                    x += c.w + panel.padding\n                })\n            }\n\n            const color_group = new group2d().setAll({x: 5, y: 5 + 30 * 5, w: 235, h: 35, layout: rowLayout})\n            SIMPLE_COLORS.forEach(c => {\n                color_group.add(new button2d()\n                    .setAll({text: ' ', normalBg: c})\n                    .on(POINTER_CLICK, () => this.props.provider.setColor(c))\n                )\n            })\n\n            this.tools.add(color_group)\n\n            this.tools.redraw()\n        }\n\n    }\n\n\n    updateSceneOp(op) {\n        //only do scenes with create_object\n        if (op.type === CREATE_OBJECT) {\n            if(op.defaults) {\n                //console.log(\"creating object with defaults\",op.defaults)\n                if(op.defaults.type === 'scene') {\n                    let node =  this.findNode(op.id)\n                    if(node) {\n                        // console.log(\"scene already exists. skipping\", node.name)\n                    } else {\n                        // console.log(\"Making a real scene\", op)\n                        const obj = this.props.provider.accessObject(op.id)\n                        node = new SceneDef().makeNode(obj, this.props.provider)\n                        this.insertNodeMapping(op.id,node)\n                        this.sceneWrappers[op.id] = node\n                        this.stagePos.add(node)\n                        // this.scene.add(node)\n                        this.swapScene(op.id)\n                    }\n                }\n            }\n        }\n        // other objects are done with insert_element\n        if (op.type === INSERT_ELEMENT) {\n            const obj = this.props.provider.accessObject(op.value)\n            if (obj.type === 'scene') return // console.log(\"skipping insert scene\")\n            if(is3DObjectType(obj.type)) {\n                const nodeObj = get3DObjectDef(obj.type).makeNode(obj, this.props.provider)\n                on(nodeObj, POINTER_CLICK, this.standardViewClickHandler)\n                this.insertNodeMapping(obj.id, nodeObj)\n                this.findNode(obj.parent).add(nodeObj)\n                return\n            }\n            if(obj.type === TOTAL_OBJ_TYPES.ASSETS_LIST) return\n            if(obj.type === TOTAL_OBJ_TYPES.ASSET) return\n            if(obj.type === TOTAL_OBJ_TYPES.BEHAVIORS_LIST) return\n            if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR) return\n            if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) return\n            console.warn(\"unknown object type\", obj)\n            return\n        }\n        if (op.type === SET_PROPERTY) {\n            const obj = this.props.provider.accessObject(op.object)\n            if(obj.type === 'asset') return\n            if(obj.type === 'assets') return\n            const node = this.findNode(op.object)\n            if (node) {\n                if(op.name === 'parent') return\n                if(obj.type === 'scene') return new SceneDef().updateProperty(node,obj,op,this.props.provider)\n                if(is3DObjectType(obj.type)) return get3DObjectDef(obj.type).updateProperty(node,obj,op, this.props.provider)\n            } else {\n                console.log(\"could not find the node for object id:\", op)\n                //console.log(\"objects are\",this.obj_node_map)\n            }\n            return\n        }\n        if(op.type === DELETE_ELEMENT) {\n            const obj = this.props.provider.accessObject(op.value)\n            if(is3DObjectType(obj.type)) {\n                const node = this.findNode(obj.id)\n                this.findNode(obj.parent).remove(node)\n            }\n        }\n        // console.log('skipping', op.type)\n    }\n    documentSwapped() {\n        console.log(\"totally new document!\")\n        //nuke all the old stuff\n        Object.keys(this.sceneWrappers).forEach(key => {\n            const scene = this.sceneWrappers[key]\n            if(this.controls) scene.remove(this.controls)\n            this.stagePos.remove(scene)\n        })\n        this.sceneWrappers = {}\n        this.obj_node_map = {}\n        // this.setState({scene: -1})\n        //make new stuff\n        const graph = this.props.provider.getDocGraph()\n        console.log(\"we are building the graph\")\n        //console.log(\"we are rebuilding using this graph\",graph)\n        this.rebuildNode(graph,\"\")\n    }\n\n    rebuildNode(obj, inset) {\n        console.log(inset,\"rebuilding\",obj.type)\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) {\n            const node = new SceneDef().makeNode(obj, this.props.provider)\n            this.insertNodeMapping(obj.id,node)\n            this.sceneWrappers[obj.id] = node\n            this.stagePos.add(node)\n            this.swapScene(obj.id)\n        }\n        if(is3DObjectType(obj.type)) {\n            const node = get3DObjectDef(obj.type).makeNode(obj, this.props.provider)\n            on(node, POINTER_CLICK, this.standardViewClickHandler)\n            this.insertNodeMapping(obj.id, node)\n            this.findNode(obj.parent).add(node)\n        }\n        if(obj.children) {\n            obj.children.forEach(ch => {\n                this.rebuildNode(ch,inset+\"   \")\n            })\n        }\n    }\n\n    swapScene(id) {\n        this.currentScene = id\n        console.log(\"swapping to the scene\",id)\n        //make all scenes invisible except the right one\n        Object.keys(this.sceneWrappers).forEach(key => {\n            const scene = this.sceneWrappers[key]\n            scene.visible = (key === id)\n            if(this.controls) scene.remove(this.controls)\n        })\n        if(this.controls) this.sceneWrappers[id].add(this.controls)\n        this.sceneWrappers[id].position.x = 0\n        this.sceneWrappers[id].position.z = 0\n    }\n\n\n    loadScene() {\n    }\n\n    insertNodeMapping(id, node) {\n        if (typeof id !== 'string') throw new Error(\"cannot map an object to an object. invalid call in insertNodeMapping\")\n        this.obj_node_map[id] = node\n        if(node.previewUpdate) this.previewUpdateNodes.push(node)\n        node.userData.graphid = id\n    }\n\n    findNode(id) {\n        if (!this.obj_node_map[id]) console.warn(\"could not find node for id\", id)\n        return this.obj_node_map[id]\n    }\n\n\n}\n\n\n","import * as ToasterManager from './ToasterManager'\nimport {getAssetsURL} from 'react-visual-editor-framework'\nimport {ASSET_TYPES, MIME_TYPES, TOTAL_OBJ_TYPES} from './Common'\nimport {fetchGraphObject} from '../syncgraph/utils'\nimport {AuthModule} from './AuthModule'\n\nexport function addImageAssetFromExpandedURL(assetId, url,format,title, prov) {\n    if(!AuthModule.supportsAssetUpload()) assetId = title\n\n    const asset = prov.accessObject(prov.getDataGraph().createObject({\n        type:TOTAL_OBJ_TYPES.ASSET,\n        subtype:ASSET_TYPES.IMAGE,\n        assetId:assetId,\n        format:format,\n        src:url,\n        width:100,\n        height:100,\n        title:title,\n        parent:0\n    }))\n    prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n    prov.requestImageCache(prov.assetsManager.getAssetURL(asset)).then(img => {\n        asset.set('width',img.width)\n        asset.set('height',img.height)\n    })\n}\n\nexport function addGeoAnchorAsset(info,title,prov) {\n    const asset = prov.accessObject(prov.getDataGraph().createObject({\n        type:TOTAL_OBJ_TYPES.ASSET,\n        subtype:ASSET_TYPES.GEOLOCATION,\n        title:title,\n        latitude:info.latitude,\n        longitude:info.longitude,\n        altitude:info.altitude,\n        useAltitude:info.useAltitude,\n        parent:0\n    }))\n    prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n}\n\nexport function addImageAssetFromFile (file, prov) {\n    ToasterManager.add('uploading ' + file.name)\n    AuthModule.uploadFile(file).then((ans)=>{\n        ToasterManager.add('uploaded')\n        if(ans.success === false) return console.log(\"there was an error uploading! :(\")\n        return addImageAssetFromExpandedURL(null,getAssetsURL()+ans.asset.id, ans.asset.mimeType, file.name, prov)\n    })\n}\nexport function addImageAssetFromURL  (url, prov) {\n    //TODO: make this format detection code more robust\n    const name = url.substring(url.lastIndexOf('/') + 1)\n    const type = name.substring(name.lastIndexOf(\".\") + 1)\n    let fileType = \"image/unknown\"\n    if (type.toLowerCase() === 'png') fileType = MIME_TYPES.PNG\n    if (type.toLowerCase() === 'jpg') fileType = MIME_TYPES.JPEG\n    if (type.toLowerCase() === 'jpeg') fileType = MIME_TYPES.JPEG\n    return addImageAssetFromExpandedURL(null,url, fileType, name, prov)\n}\nexport function addGLBAssetFromFile (file, prov) {\n    ToasterManager.add('uploading '+ file.name)\n    prov.uploadFile(file).then((ans)=>{\n        ToasterManager.add('uploaded')\n        if(ans.success === false) return console.log(\"there was an error uploading! :(\")\n        const url = getAssetsURL()+ans.asset.id\n        const graph = prov.getDataGraph()\n        const asset = fetchGraphObject(graph,graph.createObject({\n            type:TOTAL_OBJ_TYPES.ASSET,\n            subtype:ASSET_TYPES.GLTF,\n            format:MIME_TYPES.GLB,\n            src:url,\n            title:file.name,\n            parent:0\n        }))\n        prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n    })\n}\n\nexport function addAudioAssetFromFile (file, prov) {\n    ToasterManager.add('uploading')\n    prov.uploadFile(file).then((ans)=>{\n        ToasterManager.add('uploaded')\n        console.log(\"uploaded file with answer\",ans)\n        if(ans.success === false) return console.log(\"there was an error uploading! :(\")\n        const url = getAssetsURL()+ans.asset.id\n        const graph = prov.getDataGraph()\n        const asset = fetchGraphObject(graph,graph.createObject({\n            type:TOTAL_OBJ_TYPES.ASSET,\n            subtype:ASSET_TYPES.AUDIO,\n            format:ans.asset.mimeType,\n            src:url,\n            title:file.name,\n            parent:0\n        }))\n        prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n    })\n}\nexport function addAudioAssetFromURL (assetId, url, fileType, name, prov) {\n    //TODO: make this format detection code more robust\n    if(!name) {\n        name = url.substring(url.lastIndexOf('/') + 1)\n    }\n    if(!fileType) {\n        const type = name.substring(name.lastIndexOf(\".\") + 1)\n        fileType = \"audio/unknown\"\n        if(type.toLowerCase() === 'mp3') fileType = MIME_TYPES.MP3\n        if(type.toLowerCase() === 'aac') fileType = MIME_TYPES.AAC\n    }\n    if(!AuthModule.supportsAssetUpload()) assetId = name\n\n    const graph = prov.getDataGraph()\n    const asset = fetchGraphObject(graph,graph.createObject({\n        type: TOTAL_OBJ_TYPES.ASSET,\n        subtype:ASSET_TYPES.AUDIO,\n        assetId:assetId,\n        format:fileType,\n        src:url,\n        title:name,\n        parent:0\n    }))\n    prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n}\n\nexport function addVideoAssetFromURL (assetId, url, fileType, title, prov) {\n    if(!title) title = url.substring(url.lastIndexOf('/') + 1)\n    if(!AuthModule.supportsAssetUpload()) assetId = title\n    const asset = prov.accessObject(prov.getDataGraph().createObject({\n        type: TOTAL_OBJ_TYPES.ASSET,\n        subtype:ASSET_TYPES.VIDEO,\n        assetId:assetId,\n        format:fileType,\n        src:url,\n        title:title,\n        parent:0\n    }))\n    prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n}\n\n\nexport function addGLBAssetFromURL(assetId, url, fileType, title, prov) {\n    if(!title) title = url.substring(url.lastIndexOf('/') + 1)\n    if(!AuthModule.supportsAssetUpload()) assetId = title\n    const asset = prov.accessObject(prov.getDataGraph().createObject({\n        type: TOTAL_OBJ_TYPES.ASSET,\n        subtype:ASSET_TYPES.GLTF,\n        assetId:assetId,\n        format:fileType,\n        src:url,\n        title:title,\n        parent:0\n    }))\n    prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n}","import React, {Component} from 'react'\nimport {DialogManager, HBox} from 'appy-comps'\nimport {listToArray} from '../../syncgraph/utils'\nimport {addImageAssetFromFile, addImageAssetFromURL} from '../AssetActions'\nimport {Dialog, ToggleButton} from 'react-visual-editor-framework'\n\nexport class AddImageAssetDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            view:'local',\n            url:\"\",\n        }\n        this.fileInput = React.createRef();\n    }\n\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        if(this.state.view === 'remote') {\n            console.log(\"adding the url\",this.state.url)\n            addImageAssetFromURL(this.state.url, this.props.provider)\n        } else {\n            console.log(\"the file input is\",this.fileInput)\n            listToArray(this.fileInput.current.files).forEach(file => {\n                addImageAssetFromFile(file, this.props.provider)\n            })\n        }\n    }\n    switchLocal = () => this.setState({view:'local'})\n    switchRemote = () => this.setState({view:'remote'})\n\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n            <header>add image to assets</header>\n            <section>\n                <HBox>\n                    <ToggleButton onClick={this.switchLocal} selected={this.state.view==='local'}>local</ToggleButton>\n                    <ToggleButton onClick={this.switchRemote} selected={this.state.view==='remote'}>remote</ToggleButton>\n                </HBox>\n                {this.renderSelectedPanel()}\n            </section>\n            <footer>\n                <button onClick={this.cancel}>cancel</button>\n                <button onClick={this.okay}>okay</button>\n            </footer>\n        </Dialog>\n    }\n\n    selectedFile = (e) => {\n        this.setState({fileInput:e.target.value})\n    }\n\n    typedURL = (e) => {\n        this.setState({url:e.target.value})\n    }\n\n    renderSelectedPanel() {\n        if(this.state.view === 'local') {\n            return <HBox>\n                <label>File\n                    <input key=\"f1\" type=\"file\" onChange={this.selectedFile} ref={this.fileInput}/>\n                </label>\n            </HBox>\n        } else {\n            return <HBox>\n                <label>URL\n                    <input key=\"f2\" value={this.state.url} type=\"input\" onChange={this.typedURL}/>\n                </label>\n            </HBox>\n        }\n    }\n}\n","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {listToArray} from '../../syncgraph/utils'\nimport {Dialog} from 'react-visual-editor-framework'\n\nexport class AddGLTFAssetDialog extends Component {\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        listToArray(this.fileinput.files).forEach(file => {\n            console.log(\"got the file\", file)\n        })\n    }\n\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n            <header>add GLTF file assets</header>\n            <section>\n                <p>\n                    chose <b>the directory</b> containing the GLTF file\n                </p>\n                <input type=\"file\" ref={(obj) => this.fileinput = obj} onChange={this.selectedFile} multiple={true}\n                       webkitdirectory=\"true\"/>\n            </section>\n            <footer>\n                <button onClick={this.cancel}>cancel</button>\n                <button onClick={this.okay}>okay</button>\n            </footer>\n        </Dialog>\n    }\n\n    selectedFile = (e) => {\n        console.log(\"selected a file\", e.target)\n    }\n}\n","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {listToArray} from '../../syncgraph/utils'\nimport {addGLBAssetFromFile} from '../AssetActions'\nimport {Dialog} from 'react-visual-editor-framework'\n\nexport class AddGLBAssetDialog extends Component {\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        listToArray(this.fileinput.files).forEach(file => {\n            addGLBAssetFromFile(file, this.props.provider)\n        })\n    }\n\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n            <header>add GLB to assets</header>\n            <section>\n                <p>choose a local GLB file</p>\n                <input type=\"file\" ref={(obj) => this.fileinput = obj} onChange={this.selectedFile} multiple={true}/>\n            </section>\n            <footer>\n                <button onClick={this.cancel}>cancel</button>\n                <button onClick={this.okay}>okay</button>\n            </footer>\n        </Dialog>\n    }\n\n    selectedFile = (e) => {\n        console.log(\"selected a file\", e.target)\n    }\n}\n","import React, {Component} from 'react'\nimport {DialogManager, HBox} from 'appy-comps'\nimport {listToArray} from '../../syncgraph/utils'\nimport {addAudioAssetFromFile, addAudioAssetFromURL} from '../AssetActions'\nimport {Dialog, ToggleButton} from 'react-visual-editor-framework'\n\nexport class AddAudioAssetDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            view:'local',\n            url:\"\",\n        }\n        this.fileInput = React.createRef();\n    }\n\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        if(this.state.view === 'remote') {\n            console.log(\"adding the url\",this.state.url)\n            addAudioAssetFromURL(null,this.state.url, this.props.provider)\n        } else {\n            console.log(\"the file input is\",this.fileInput)\n            listToArray(this.fileInput.current.files).forEach(file => {\n                addAudioAssetFromFile(file, this.props.provider)\n            })\n        }\n    }\n    switchLocal = () => this.setState({view:'local'})\n    switchRemote = () => this.setState({view:'remote'})\n\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n                <header>add audio to assets</header>\n                <section>\n                    <HBox>\n                        <ToggleButton onClick={this.switchLocal} selected={this.state.view==='local'}>local</ToggleButton>\n                        <ToggleButton onClick={this.switchRemote} selected={this.state.view==='remote'}>remote</ToggleButton>\n                    </HBox>\n                    {this.renderSelectedPanel()}\n                </section>\n                <footer>\n                    <button onClick={this.cancel}>cancel</button>\n                    <button onClick={this.okay}>okay</button>\n                </footer>\n        </Dialog>\n    }\n\n    selectedFile = (e) => {\n        //console.log(\"selected a file\", e.target)\n        this.setState({fileInput:e.target.value})\n    }\n\n    typedURL = (e) => {\n        this.setState({url:e.target.value})\n    }\n\n    renderSelectedPanel() {\n        if(this.state.view === 'local') {\n            return <HBox>\n                <label>File\n                    <input key=\"f1\" type=\"file\" onChange={this.selectedFile} ref={this.fileInput}/>\n                </label>\n            </HBox>\n        } else {\n            return <HBox>\n                <label>URL\n                    <input key=\"f2\" value={this.state.url} type=\"input\" onChange={this.typedURL}/>\n                </label>\n            </HBox>\n        }\n    }\n}\n","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {Dialog} from 'react-visual-editor-framework'\n\nexport class UnsavedDocumentDialog extends Component {\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        this.props.onAnyway()\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel} width=\"600px\" height=\"auto\">\n            <header>Warning. Your document has unsaved changes.</header>\n            <section>\n            <p>Press cancel to go back</p>\n            <p>Press continue to continue anyway and lose the unsaved changes</p>\n            </section>\n            <footer>\n                <button onClick={this.cancel}>cancel</button>\n                <button onClick={this.okay}>continue!</button>\n            </footer>\n        </Dialog>\n    }\n}\n\n","/* eslint-disable */\nconst THREE = require('three'); //requireimport * as THREE from 'three'\n\n// Copyright 2016 The Draco Authors.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n\n/**\n * @param {THREE.LoadingManager} manager\n */\n\nconst DRACOLoader = ( function () { \n\n    function DRACOLoader (manager) {\n        this.timeLoaded = 0;\n        this.manager = manager || THREE.DefaultLoadingManager;\n        this.materials = null;\n        this.verbosity = 0;\n        this.attributeOptions = {};\n        this.drawMode = THREE.TrianglesDrawMode;\n        // Native Draco attribute type to Three.JS attribute type.\n        this.nativeAttributeMap = {\n            'position' : 'POSITION',\n            'normal' : 'NORMAL',\n            'color' : 'COLOR',\n            'uv' : 'TEX_COORD'\n        };\n    }\n\n    DRACOLoader.prototype = {\n\n        constructor: DRACOLoader,\n\n        load: function(url, onLoad, onProgress, onError) {\n            var scope = this;\n            var loader = new THREE.FileLoader(scope.manager);\n            loader.setPath(this.path);\n            loader.setResponseType('arraybuffer');\n            loader.load(url, function(blob) {\n                scope.decodeDracoFile(blob, onLoad);\n            }, onProgress, onError);\n        },\n\n        setPath: function(value) {\n            this.path = value;\n            return this;\n        },\n\n        setVerbosity: function(level) {\n            this.verbosity = level;\n            return this;\n        },\n\n        /**\n         *  Sets desired mode for generated geometry indices.\n         *  Can be either:\n         *      THREE.TrianglesDrawMode\n         *      THREE.TriangleStripDrawMode\n         */\n        setDrawMode: function(drawMode) {\n            this.drawMode = drawMode;\n            return this;\n        },\n\n        /**\n         * Skips dequantization for a specific attribute.\n         * |attributeName| is the THREE.js name of the given attribute type.\n         * The only currently supported |attributeName| is 'position', more may be\n         * added in future.\n         */\n        setSkipDequantization: function(attributeName, skip) {\n            var skipDequantization = true;\n            if (typeof skip !== 'undefined')\n            skipDequantization = skip;\n            this.getAttributeOptions(attributeName).skipDequantization =\n                skipDequantization;\n            return this;\n        },\n\n        /**\n         * Decompresses a Draco buffer. Names of attributes (for ID and type maps)\n         * must be one of the supported three.js types, including: position, color,\n         * normal, uv, uv2, skinIndex, skinWeight.\n         *\n         * @param {ArrayBuffer} rawBuffer\n         * @param {Function} callback\n         * @param {Object|undefined} attributeUniqueIdMap Provides a pre-defined ID\n         *     for each attribute in the geometry to be decoded. If given,\n         *     `attributeTypeMap` is required and `nativeAttributeMap` will be\n         *     ignored.\n         * @param {Object|undefined} attributeTypeMap Provides a predefined data\n         *     type (as a typed array constructor) for each attribute in the\n         *     geometry to be decoded.\n         */\n        decodeDracoFile: function(rawBuffer, callback, attributeUniqueIdMap,\n                                attributeTypeMap) {\n        var scope = this;\n        DRACOLoader.getDecoderModule()\n            .then( function ( module ) {\n                scope.decodeDracoFileInternal( rawBuffer, module.decoder, callback,\n                attributeUniqueIdMap, attributeTypeMap);\n            });\n        },\n\n        decodeDracoFileInternal: function(rawBuffer, dracoDecoder, callback,\n                                        attributeUniqueIdMap, attributeTypeMap) {\n            /*\n            * Here is how to use Draco Javascript decoder and get the geometry.\n            */\n            var buffer = new dracoDecoder.DecoderBuffer();\n            buffer.Init(new Int8Array(rawBuffer), rawBuffer.byteLength);\n            var decoder = new dracoDecoder.Decoder();\n\n            /*\n            * Determine what type is this file: mesh or point cloud.\n            */\n            var geometryType = decoder.GetEncodedGeometryType(buffer);\n            if (geometryType == dracoDecoder.TRIANGULAR_MESH) {\n                if (this.verbosity > 0) {\n                console.log('Loaded a mesh.');\n                }\n            } else if (geometryType == dracoDecoder.POINT_CLOUD) {\n                if (this.verbosity > 0) {\n                console.log('Loaded a point cloud.');\n                }\n            } else {\n                var errorMsg = 'THREE.DRACOLoader: Unknown geometry type.';\n                console.error(errorMsg);\n                throw new Error(errorMsg);\n            }\n            callback(this.convertDracoGeometryTo3JS(dracoDecoder, decoder,\n                geometryType, buffer, attributeUniqueIdMap, attributeTypeMap));\n        },\n\n        addAttributeToGeometry: function(dracoDecoder, decoder, dracoGeometry,\n                                            attributeName, attributeType, attribute,\n                                            geometry, geometryBuffer) {\n            if (attribute.ptr === 0) {\n                var errorMsg = 'THREE.DRACOLoader: No attribute ' + attributeName;\n                console.error(errorMsg);\n                throw new Error(errorMsg);\n            }\n\n            var numComponents = attribute.num_components();\n            var numPoints = dracoGeometry.num_points();\n            var numValues = numPoints * numComponents;\n            var attributeData;\n            var TypedBufferAttribute;\n\n            switch ( attributeType ) {\n\n                case Float32Array:\n                attributeData = new dracoDecoder.DracoFloat32Array();\n                decoder.GetAttributeFloatForAllPoints(\n                    dracoGeometry, attribute, attributeData);\n                geometryBuffer[ attributeName ] = new Float32Array( numValues );\n                TypedBufferAttribute = THREE.Float32BufferAttribute;\n                break;\n\n                case Int8Array:\n                attributeData = new dracoDecoder.DracoInt8Array();\n                decoder.GetAttributeInt8ForAllPoints(\n                    dracoGeometry, attribute, attributeData );\n                geometryBuffer[ attributeName ] = new Int8Array( numValues );\n                TypedBufferAttribute = THREE.Int8BufferAttribute;\n                break;\n\n                case Int16Array:\n                attributeData = new dracoDecoder.DracoInt16Array();\n                decoder.GetAttributeInt16ForAllPoints(\n                    dracoGeometry, attribute, attributeData);\n                geometryBuffer[ attributeName ] = new Int16Array( numValues );\n                TypedBufferAttribute = THREE.Int16BufferAttribute;\n                break;\n\n                case Int32Array:\n                attributeData = new dracoDecoder.DracoInt32Array();\n                decoder.GetAttributeInt32ForAllPoints(\n                    dracoGeometry, attribute, attributeData);\n                geometryBuffer[ attributeName ] = new Int32Array( numValues );\n                TypedBufferAttribute = THREE.Int32BufferAttribute;\n                break;\n\n                case Uint8Array:\n                attributeData = new dracoDecoder.DracoUInt8Array();\n                decoder.GetAttributeUInt8ForAllPoints(\n                    dracoGeometry, attribute, attributeData);\n                geometryBuffer[ attributeName ] = new Uint8Array( numValues );\n                TypedBufferAttribute = THREE.Uint8BufferAttribute;\n                break;\n\n                case Uint16Array:\n                attributeData = new dracoDecoder.DracoUInt16Array();\n                decoder.GetAttributeUInt16ForAllPoints(\n                    dracoGeometry, attribute, attributeData);\n                geometryBuffer[ attributeName ] = new Uint16Array( numValues );\n                TypedBufferAttribute = THREE.Uint16BufferAttribute;\n                break;\n\n                case Uint32Array:\n                attributeData = new dracoDecoder.DracoUInt32Array();\n                decoder.GetAttributeUInt32ForAllPoints(\n                    dracoGeometry, attribute, attributeData);\n                geometryBuffer[ attributeName ] = new Uint32Array( numValues );\n                TypedBufferAttribute = THREE.Uint32BufferAttribute;\n                break;\n\n                default:\n                var errorMsg = 'THREE.DRACOLoader: Unexpected attribute type.';\n                console.error( errorMsg );\n                throw new Error( errorMsg );\n\n            }\n\n            // Copy data from decoder.\n            for (var i = 0; i < numValues; i++) {\n                geometryBuffer[attributeName][i] = attributeData.GetValue(i);\n            }\n            // Add attribute to THREEJS geometry for rendering.\n            geometry.addAttribute(attributeName,\n                new TypedBufferAttribute(geometryBuffer[attributeName],\n                    numComponents));\n            dracoDecoder.destroy(attributeData);\n        },\n\n        convertDracoGeometryTo3JS: function(dracoDecoder, decoder, geometryType,\n                                            buffer, attributeUniqueIdMap,\n                                            attributeTypeMap) {\n            // TODO: Should not assume native Draco attribute IDs apply.\n            if (this.getAttributeOptions('position').skipDequantization === true) {\n                 decoder.SkipAttributeTransform(dracoDecoder.POSITION);\n            }\n            var dracoGeometry;\n            var decodingStatus;\n            var start_time = performance.now();\n            if (geometryType === dracoDecoder.TRIANGULAR_MESH) {\n                dracoGeometry = new dracoDecoder.Mesh();\n                decodingStatus = decoder.DecodeBufferToMesh(buffer, dracoGeometry);\n            } else {\n                dracoGeometry = new dracoDecoder.PointCloud();\n                decodingStatus =\n                    decoder.DecodeBufferToPointCloud(buffer, dracoGeometry);\n            }\n            if (!decodingStatus.ok() || dracoGeometry.ptr == 0) {\n                var errorMsg = 'THREE.DRACOLoader: Decoding failed: ';\n                errorMsg += decodingStatus.error_msg();\n                console.error(errorMsg);\n                dracoDecoder.destroy(decoder);\n                dracoDecoder.destroy(dracoGeometry);\n                throw new Error(errorMsg);\n            }\n\n            var decode_end = performance.now();\n            dracoDecoder.destroy(buffer);\n            /*\n            * Example on how to retrieve mesh and attributes.\n            */\n            var numFaces;\n            if (geometryType == dracoDecoder.TRIANGULAR_MESH) {\n                numFaces = dracoGeometry.num_faces();\n                if (this.verbosity > 0) {\n                    console.log('Number of faces loaded: ' + numFaces.toString());\n                }\n            } else {\n               numFaces = 0;\n            }\n\n            var numPoints = dracoGeometry.num_points();\n            var numAttributes = dracoGeometry.num_attributes();\n            if (this.verbosity > 0) {\n                console.log('Number of points loaded: ' + numPoints.toString());\n                console.log('Number of attributes loaded: ' +\n                    numAttributes.toString());\n            }\n\n            // Verify if there is position attribute.\n            // TODO: Should not assume native Draco attribute IDs apply.\n            var posAttId = decoder.GetAttributeId(dracoGeometry,\n                                                dracoDecoder.POSITION);\n            if (posAttId == -1) {\n                var errorMsg = 'THREE.DRACOLoader: No position attribute found.';\n                console.error(errorMsg);\n                dracoDecoder.destroy(decoder);\n                dracoDecoder.destroy(dracoGeometry);\n                throw new Error(errorMsg);\n            }\n            var posAttribute = decoder.GetAttribute(dracoGeometry, posAttId);\n\n            // Structure for converting to THREEJS geometry later.\n            var geometryBuffer = {};\n            // Import data to Three JS geometry.\n            var geometry = new THREE.BufferGeometry();\n\n            // Do not use both the native attribute map and a provided (e.g. glTF) map.\n            if ( attributeUniqueIdMap ) {\n\n                // Add attributes of user specified unique id. E.g. GLTF models.\n                for (var attributeName in attributeUniqueIdMap) {\n                    var attributeType = attributeTypeMap[attributeName];\n                    var attributeId = attributeUniqueIdMap[attributeName];\n                    var attribute = decoder.GetAttributeByUniqueId(dracoGeometry,\n                                                                attributeId);\n                    this.addAttributeToGeometry(dracoDecoder, decoder, dracoGeometry,\n                        attributeName, attributeType, attribute, geometry, geometryBuffer);\n                }\n\n            } else {\n\n                // Add native Draco attribute type to geometry.\n                for (var attributeName in this.nativeAttributeMap) {\n                    var attId = decoder.GetAttributeId(dracoGeometry,\n                        dracoDecoder[this.nativeAttributeMap[attributeName]]);\n                    if (attId !== -1) {\n                    if (this.verbosity > 0) {\n                        console.log('Loaded ' + attributeName + ' attribute.');\n                    }\n                    var attribute = decoder.GetAttribute(dracoGeometry, attId);\n                    this.addAttributeToGeometry(dracoDecoder, decoder, dracoGeometry,\n                        attributeName, Float32Array, attribute, geometry, geometryBuffer);\n                    }\n                }\n\n            }\n\n            // For mesh, we need to generate the faces.\n            if (geometryType == dracoDecoder.TRIANGULAR_MESH) {\n                if (this.drawMode === THREE.TriangleStripDrawMode) {\n                    var stripsArray = new dracoDecoder.DracoInt32Array();\n                    var numStrips = decoder.GetTriangleStripsFromMesh(\n                        dracoGeometry, stripsArray);\n                    geometryBuffer.indices = new Uint32Array(stripsArray.size());\n                    for (var i = 0; i < stripsArray.size(); ++i) {\n                         geometryBuffer.indices[i] = stripsArray.GetValue(i);\n                    }\n                    dracoDecoder.destroy(stripsArray);\n                } else {\n                    var numIndices = numFaces * 3;\n                    geometryBuffer.indices = new Uint32Array(numIndices);\n                    var ia = new dracoDecoder.DracoInt32Array();\n                    for (var i = 0; i < numFaces; ++i) {\n                        decoder.GetFaceFromMesh(dracoGeometry, i, ia);\n                        var index = i * 3;\n                        geometryBuffer.indices[index] = ia.GetValue(0);\n                        geometryBuffer.indices[index + 1] = ia.GetValue(1);\n                        geometryBuffer.indices[index + 2] = ia.GetValue(2);\n                    }\n                    dracoDecoder.destroy(ia);\n                }\n            }\n\n            geometry.drawMode = this.drawMode;\n            if (geometryType == dracoDecoder.TRIANGULAR_MESH) {\n            geometry.setIndex(new(geometryBuffer.indices.length > 65535 ?\n                    THREE.Uint32BufferAttribute : THREE.Uint16BufferAttribute)\n                (geometryBuffer.indices, 1));\n            }\n\n            // TODO: Should not assume native Draco attribute IDs apply.\n            // TODO: Can other attribute types be quantized?\n            var posTransform = new dracoDecoder.AttributeQuantizationTransform();\n            if (posTransform.InitFromAttribute(posAttribute)) {\n                // Quantized attribute. Store the quantization parameters into the\n                // THREE.js attribute.\n                geometry.attributes['position'].isQuantized = true;\n                geometry.attributes['position'].maxRange = posTransform.range();\n                geometry.attributes['position'].numQuantizationBits =\n                    posTransform.quantization_bits();\n                geometry.attributes['position'].minValues = new Float32Array(3);\n                for (var i = 0; i < 3; ++i) {\n                    geometry.attributes['position'].minValues[i] =\n                        posTransform.min_value(i);\n                }\n            }\n            dracoDecoder.destroy(posTransform);\n            dracoDecoder.destroy(decoder);\n            dracoDecoder.destroy(dracoGeometry);\n\n            this.decode_time = decode_end - start_time;\n            this.import_time = performance.now() - decode_end;\n\n            if (this.verbosity > 0) {\n            console.log('Decode time: ' + this.decode_time);\n            console.log('Import time: ' + this.import_time);\n            }\n            return geometry;\n        },\n\n        isVersionSupported: function(version, callback) {\n            DRACOLoader.getDecoderModule()\n                .then( function ( module ) {\n                callback( module.decoder.isVersionSupported( version ) );\n                });\n        },\n\n        getAttributeOptions: function(attributeName) {\n            if (typeof this.attributeOptions[attributeName] === 'undefined')\n            this.attributeOptions[attributeName] = {};\n            return this.attributeOptions[attributeName];\n        }\n    };\n\n    DRACOLoader.decoderPath = './';\n    DRACOLoader.decoderConfig = {};\n    DRACOLoader.decoderModulePromise = null;\n\n    /**\n     * Sets the base path for decoder source files.\n     * @param {string} path\n     */\n    DRACOLoader.setDecoderPath = function ( path ) {\n       DRACOLoader.decoderPath = path;\n    };\n\n    /**\n     * Sets decoder configuration and releases singleton decoder module. Module\n     * will be recreated with the next decoding call.\n     * @param {Object} config\n     */\n    DRACOLoader.setDecoderConfig = function ( config ) {\n        var wasmBinary = THREE.DRACOLoader.decoderConfig.wasmBinary;\n        DRACOLoader.decoderConfig = config || {};\n        DRACOLoader.releaseDecoderModule();\n\n        // Reuse WASM binary.\n        if ( wasmBinary ) DRACOLoader.decoderConfig.wasmBinary = wasmBinary;\n    };\n\n    /**\n     * Releases the singleton DracoDecoderModule instance. Module will be recreated\n     * with the next decoding call.\n     */\n    DRACOLoader.releaseDecoderModule = function () {\n    DRACOLoader.decoderModulePromise = null;\n    };\n\n    /**\n     * Gets WebAssembly or asm.js singleton instance of DracoDecoderModule\n     * after testing for browser support. Returns Promise that resolves when\n     * module is available.\n     * @return {Promise<{decoder: DracoDecoderModule}>}\n     */\n    DRACOLoader.getDecoderModule = function () {\n        var scope = this;\n        var path = DRACOLoader.decoderPath;\n        var config = DRACOLoader.decoderConfig;\n        var promise = DRACOLoader.decoderModulePromise;\n\n        if ( promise ) return promise;\n\n        // Load source files.\n        if ( typeof DracoDecoderModule !== 'undefined' ) {\n            // Loaded externally.\n            promise = Promise.resolve();\n        } else if ( typeof WebAssembly !== 'object' || config.type === 'js' ) {\n            // Load with asm.js.\n            promise = DRACOLoader._loadScript( path + 'draco_decoder.js' );\n        } else {\n            // Load with WebAssembly.\n            config.wasmBinaryFile = path + 'draco_decoder.wasm';\n            promise = DRACOLoader._loadScript( path + 'draco_wasm_wrapper.js' )\n                .then( function () {\n                return DRACOLoader._loadArrayBuffer( config.wasmBinaryFile );\n                } )\n                .then( function ( wasmBinary ) {\n                config.wasmBinary = wasmBinary;\n                } );\n        }\n\n        // Wait for source files, then create and return a decoder.\n        promise = promise.then( function () {\n            return new Promise( function ( resolve ) {\n            config.onModuleLoaded = function ( decoder ) {\n                scope.timeLoaded = performance.now();\n                // Module is Promise-like. Wrap before resolving to avoid loop.\n                resolve( { decoder: decoder } );\n            };\n            DracoDecoderModule( config );\n            } );\n        } );\n\n        DRACOLoader.decoderModulePromise = promise;\n        return promise;\n    };\n\n    /**\n     * @param {string} src\n     * @return {Promise}\n     */\n    DRACOLoader._loadScript = function ( src ) {\n        var prevScript = document.getElementById( 'decoder_script' );\n        if ( prevScript !== null ) {\n            prevScript.parentNode.removeChild( prevScript );\n        }\n        var head = document.getElementsByTagName( 'head' )[ 0 ];\n        var script = document.createElement( 'script' );\n        script.id = 'decoder_script';\n        script.type = 'text/javascript';\n        script.src = src;\n        return new Promise( function ( resolve ) {\n            script.onload = resolve;\n            head.appendChild( script );\n        });\n    };\n\n    /**\n     * @param {string} src\n     * @return {Promise}\n     */\n    DRACOLoader._loadArrayBuffer = function ( src ) {\n        var loader = new THREE.FileLoader();\n        loader.setResponseType( 'arraybuffer' );\n        return new Promise( function( resolve, reject ) {\n            loader.load( src, resolve, undefined, reject );\n        });\n    };\n\n    return DRACOLoader;\n\n} )();\n\nexport default DRACOLoader","import * as THREE from 'three'\nimport React, {Component} from \"react\"\nimport GLTFLoader from './GLTFLoader'\nimport DRACOLoader from './DRACOLoader'\nimport SkeletonUtils from './SkeletonUtils'\nimport OrbitControls from './OrbitControls'\n\nexport default class GLTFAssetView extends Component {\n    componentDidMount() {\n        this.initThreeJS()\n    }\n    componentWillReceiveProps(nextProps, nextContext) {\n        if(this.props.asset && nextProps.asset.id !== this.props.asset.id) {\n            this.swapModel(nextProps.asset)\n        }\n    }\n\n    swapModel(asset) {\n        if(this.model) {\n            this.scene.remove(this.model)\n        }\n\n\n        const url = this.props.provider.assetsManager.getAssetURL(asset)\n\n        this.props.provider.getLogger().log(\"GLTFAssetView loading the url\",url)\n        if(!url) {\n            this.props.provider.getLogger().error(\"GLTFAssetView url is empty!\")\n            return\n        }\n\n\n        const loader = new GLTFLoader()\n        loader.setCrossOrigin('anonymous');\n        const draco = new DRACOLoader()\n        DRACOLoader.setDecoderPath( './draco/' );\n        loader.setDRACOLoader( draco );\n\n        loader.load(url, (gltf)=> {\n            console.log(\"loaded\", url)\n\n            let model = gltf.scene || gltf.scenes[0]\n\n            // clone it, in case the loader is returning the same cached version?\n            this.model = SkeletonUtils.clone( model  );\n            model = this.model\n            model.updateMatrixWorld();\n\n            let clips = gltf.animations || [];\n            this.setClips(clips)\n\n            let boundingBox = new THREE.Box3().setFromObject(model);\n            let boundingBoxSize = boundingBox.getSize(new THREE.Vector3()).length();\n            let BoundingBoxCenter = boundingBox.getCenter(new THREE.Vector3());\n\n            this.controls.reset();\n\n            // this.setClips(node.userData)\n            model.position.x += model.position.x -BoundingBoxCenter.x\n            model.position.y += model.position.y -BoundingBoxCenter.y\n            model.position.z += model.position.z -BoundingBoxCenter.z\n\n            this.controls.maxDistance = boundingBoxSize * 10;\n            this.camera.near = boundingBoxSize / 100;\n            this.camera.far = boundingBoxSize * 100;\n            this.camera.updateProjectionMatrix();\n\n            this.camera.position.copy(BoundingBoxCenter);\n            this.camera.position.x += boundingBoxSize / 2.0;\n            this.camera.position.y += boundingBoxSize / 5.0;\n            this.camera.position.z += boundingBoxSize / 2.0;\n            this.camera.lookAt(BoundingBoxCenter);\n\n            this.controls.enabled = true;\n            this.playAllClips()\n            this.scene.add(model)\n        })\n\n    }\n\n    render() {\n        return <div id={\"gltf-viewer\"} ref={c => this.sceneContainer = c}/>\n    }\n    initThreeJS() {\n        this.scene = new THREE.Scene();\n        this.scene.background = new THREE.Color( 0x000000 );\n        this.camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 0.1, 1000 );\n        this.scene.add(this.camera)\n        this.renderer = new THREE.WebGLRenderer( { antialias: true } );\n        this.renderer.setPixelRatio( window.devicePixelRatio );\n        this.renderer.setSize( window.innerWidth, window.innerHeight );\n        this.renderer.gammaOutput = true\n        this.sceneContainer.appendChild( this.renderer.domElement );\n        this.clips = []\n        this.mixer = null\n        this.model = null\n\n        this.controls = new OrbitControls( this.camera, this.renderer.domElement );\n        this.controls.screenSpacePanning = true;\n\n        this.renderer.setAnimationLoop(this.renderThree)\n\n        const light = new THREE.DirectionalLight( 0xffffff, 1.0 );\n        light.position.set( 1, 1, 1 ).normalize();\n        this.scene.add( light );\n        this.scene.add(new THREE.AmbientLight(0xffffff,0.2))\n        //console.log(\"rendering the asset\",asset)\n\n        this.swapModel(this.props.asset)\n    }\n\n    playAllClips () {\n        this.clips.forEach((clip) => {\n          this.mixer.clipAction(clip).reset().play();\n        });\n    }\n    \n    setClips ( clips ) {\n        if (this.mixer) {\n          this.mixer.stopAllAction();\n          this.mixer.uncacheRoot(this.mixer.getRoot());\n          this.mixer = null;\n        }\n    \n        clips.forEach((clip) => {\n          if (clip.validate()) clip.optimize();\n        });\n    \n        if (!clips.length) return;\n        this.clips = clips\n        this.mixer = new THREE.AnimationMixer( this.model );\n    }\n\n    checkAspectRatio() {\n        if(!this.renderer\n            || !this.renderer.domElement\n            || !this.sceneContainer\n        ) return\n        const w = this.sceneContainer.clientWidth\n        const h = this.sceneContainer.clientHeight\n        const aspect = w/h\n        if(Math.abs(this.camera.aspect - aspect) > 0.001 ) {\n            this.camera.aspect = aspect\n            this.camera.updateProjectionMatrix()\n            this.renderer.setSize(w-4,h-4)\n        }\n    }\n\n    renderThree = (time) => {\n        const dt = (time - this.prevTime) / 1000;\n        this.checkAspectRatio()\n\n        this.controls.update();\n        this.mixer && this.mixer.update(dt);\n\n        this.renderer.render( this.scene, this.camera );\n        this.prevTime = time;\n\n    }\n\n}\n","import React, {Component} from \"react\"\nimport {map, tileLayer, marker, divIcon, latLng} from \"leaflet/dist/leaflet-src.js\"\nimport \"leaflet/dist/leaflet.css\"\nimport {TREE_ITEM_PROVIDER} from 'react-visual-editor-framework'\nimport {HBox} from 'appy-comps'\n\nexport default class GeoAssetView extends Component {\n\n\n    constructor(props, context) {\n        super(props, context)\n        this.updateLocation = (e) => {\n            const obj = this.props.provider.accessObject(this.props.asset.id)\n            const ll = latLng({\n                lat: obj.latitude,\n                lon: obj.longitude\n            })\n            if(this.marker) this.marker.setLatLng(ll)\n            if(this.mymap)  this.mymap.panTo(ll)\n        }\n    }\n\n    loadCurrentLocation = () => {\n        navigator.geolocation.getCurrentPosition((success)=>{\n            console.log(\"success\",success)\n            const coords = success.coords\n            this.props.provider.quick_setPropertyValue(this.props.asset.id,'latitude',coords.latitude)\n            this.props.provider.quick_setPropertyValue(this.props.asset.id,'longitude',coords.longitude)\n        },(error)=>{\n            console.log(\"error\",error)\n        })\n    }\n\n    onMapClick = (e) => {\n        this.props.provider.quick_setPropertyValue(this.props.asset.id,'latitude',e.latlng.lat)\n        this.props.provider.quick_setPropertyValue(this.props.asset.id,'longitude',e.latlng.lng)\n    }\n\n    render() {\n        const style = {\n            width: '400px',\n            height: '400px',\n            border: '1px solid black',\n        }\n        this.updateLocation()\n        return <div>\n            <HBox>\n                <button onClick={this.loadCurrentLocation}>set to current location</button>\n            </HBox>\n            <div id=\"mapid\" ref={d => this.div = d} style={style}></div>\n        </div>\n    }\n\n    componentDidMount() {\n        this.mymap = map('mapid').setView([this.props.asset.longitude, this.props.asset.latitude], 18);\n        tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {\n            maxZoom: 18,\n            attribution: 'Map data &copy; <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors, ' +\n                '<a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, ' +\n                'Imagery © <a href=\"https://www.mapbox.com/\">Mapbox</a>',\n            id: 'mapbox.streets'\n        }).addTo(this.mymap);\n        this.mymap.on('click',this.onMapClick)\n\n        const customIcon = divIcon({className:'map-icon'})\n        this.marker = marker([this.props.asset.longitude, this.props.asset.latitude],{\n            title:'this is the geo location',\n            icon: customIcon\n        }).addTo(this.mymap)\n\n        this.props.provider.on(TREE_ITEM_PROVIDER.PROPERTY_CHANGED, this.updateLocation)\n        this.updateLocation()\n    }\n    componentWillUnmount() {\n        this.props.provider.off(TREE_ITEM_PROVIDER.PROPERTY_CHANGED, this.updateLocation)\n    }\n}\n\n\n\n","import React, {Component} from \"react\"\nimport {fetchGraphObject} from '../syncgraph/utils'\nimport {ASSET_TYPES} from '../vr/Common'\nimport GLTFAssetView from '../vr/GLTFAssetView'\nimport GeoAssetView from '../vr/GeoAssetView'\n\nexport default class AssetView extends Component {\n    render() {\n        const prov = this.props.provider\n        const asset = fetchGraphObject(prov.getDataGraph(),this.props.asset)\n        return <div id={\"asset-view\"}>\n            <h3>{asset.subtype} : <b>{asset.title}</b></h3>\n            {this.renderAsset(asset)}\n        </div>\n    }\n\n    renderAsset(asset) {\n        const url = this.props.provider.assetsManager.getAssetURL(asset)\n        if(asset.subtype === ASSET_TYPES.IMAGE) return <img src={url} alt={asset.title}/>\n        if(asset.subtype === ASSET_TYPES.AUDIO) return <audio src={url} controls/>\n        // added playsinline so video shows in editor on ipad \n        if(asset.subtype === ASSET_TYPES.VIDEO) return <video src={url} controls playsInline crossOrigin=\"anonymous\"/>\n        if(asset.subtype === ASSET_TYPES.BEHAVIOR) return <div>{url}</div>\n        if(asset.subtype === ASSET_TYPES.GLTF) return <GLTFAssetView asset={asset} provider={this.props.provider}/>\n        if(asset.subtype === ASSET_TYPES.GEOLOCATION) return <GeoAssetView asset={asset} provider={this.props.provider}/>\n        return <div>unknown type</div>\n    }\n}\n","function cloneObjectDeep(shapeid, graph, newParent) {\n    const id = shapeid\n    const id2 = graph.createObject()\n    const props = graph.getPropertiesForObject(id)\n    props.forEach(key => {\n        if(key === 'children') {\n            const children = graph.getPropertyValue(id, key)\n            const children2 = cloneArrayDeep(children, graph, id2)\n            graph.createProperty(id2, key, children2)\n        } else {\n            let value = graph.getPropertyValue(id, key)\n            if(key === 'parent') value = newParent\n            graph.createProperty(id2, key, value)\n        }\n    })\n    return id2\n}\n\nfunction cloneArrayDeep(arr,graph,newParent) {\n    const arr2 = graph.createArray()\n    const len = graph.getArrayLength(arr)\n    for (let i = 0; i < len; i++) {\n        const ch = graph.getElementAt(arr,i)\n        const ch2 = cloneObjectDeep(ch,graph,newParent)\n        graph.insertElement(arr2,i,ch2)\n    }\n    return arr2\n}\n\nexport default class GraphAccessor {\n    constructor(graph) {\n        this.graph = graph\n    }\n    object(id) {\n        if(id && id.id && id.exists && id.exists()) {\n            console.log(\"someone created a graphaccessor on an existing object\")\n            return id\n        }\n        if(this.graph.hasObject(id)) {\n            const obj = {}\n            this.graph.getPropertiesForObject(id).forEach(key => {\n                obj[key] = this.graph.getPropertyValue(id, key)\n            })\n            obj.id = id\n            obj.exists = function() { return true }\n            obj.set = (key, value) => {\n                this.graph.setProperty(id,key,value)\n                return obj\n            }\n            obj.props = () => {\n                const o = {}\n                this.graph.getPropertiesForObject(id).forEach(key => {\n                    o[key] = this.graph.getPropertyValue(id, key)\n                })\n                return o\n            }\n            obj.array = (key) => {\n                // console.log(\"looking at key\",key)\n                // console.log(\"self is\",obj)\n                const CH = obj[key]\n                // console.log(\"children id is\",CH)\n                const len = this.graph.getArrayLength(CH)\n                const ch = []\n                for (let i = 0; i < len; i++) {\n                    ch.push(this.graph.getElementAt(CH, i))\n                }\n                return ch\n            }\n            obj.getChildren = () => {\n                if(obj.children) return obj.array('children').map(id => this.object(id))\n                return []\n            }\n            obj.insertChildLast = (child) => {\n                this.graph.setProperty(child.id,'parent',obj.id)\n                const CH = this.graph.getPropertyValue(obj.id,'children')\n                const len = this.graph.getArrayLength(CH)\n                const prev = this.graph.getElementAt(CH,len-1)\n                this.graph.insertAfter(CH,prev,child.id)\n            }\n            obj.insertFirstChild = (child) => {\n                this.graph.setProperty(child.id,'parent',obj.id)\n                const ch = this.graph.getPropertyValue(obj.id,'children')\n                this.graph.insertAfter(ch,null,child.id)\n            }\n            obj.insertChildAfter = (child, prev) => {\n                this.graph.setProperty(child.id,'parent',obj.id)\n                const ch = this.graph.getPropertyValue(obj.id,'children')\n                this.graph.insertAfter(ch,prev.id,child.id)\n            }\n            obj.child = (index) => this.object(obj.array('children')[index])\n            obj.removeFromParent = () => {\n                const parent = this.object(obj.parent)\n                const n = parent.array('children').findIndex(ch => ch === obj.id)\n                // const n = indexOf(graph, parent.children, obj.id)\n                if (n >= 0) {\n                    this.graph.removeElement(parent.children, n)\n                } else {\n                    console.error(\"could not find index for child\", obj, 'in children', parent.children)\n                }\n            }\n            obj.getParent = () => {\n                return this.object(obj.parent)\n            }\n            obj.clone = () => {\n                const id2 = cloneObjectDeep(obj.id,this.graph,obj.parent)\n                return this.object(id2)\n            }\n            obj.find = (match,list) => {\n                if(!list) list = []\n                if(match(obj)) list.push(obj)\n                if(obj.children) obj.getChildren().forEach(ch => {\n                    ch.find(match,list)\n                })\n                return list\n            }\n            return obj\n        } else {\n            return {\n                exists: function() { return false }\n            }\n        }\n    }\n}\n","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {AuthModule} from '../AuthModule'\nimport {Dialog, toQueryString} from 'react-visual-editor-framework'\n\n\nexport class OpenFileDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            docList:[]\n        }\n    }\n    refreshList = () => {\n        this.props.provider.loadDocList().then((docs) => this.setState({docList:docs}))\n    }\n    componentDidMount() {\n        this.refreshList()\n    }\n    generateDocUrl(doc) {\n        const opts = Object.assign({},this.props.provider.options,{\n            mode:'edit',\n            doc:doc.id\n        })\n        delete opts.AuthModule\n        const url = `./?${toQueryString(opts)}`\n        return url\n    }\n    deleteDoc(info) {\n        return this.props.provider.removeDoc(info).then((res)=>{\n            console.log('removed?',res)\n            this.refreshList()\n        })\n    }\n\n    dismiss = () => {\n        DialogManager.hide()\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.dismiss}>\n            <header>Open document</header>\n            <section>\n                <ul>{this.state.docList.map((doc, i) => {\n\n                    return <li key={i}>\n                        <b>{doc.title}</b>\n                        <a className={\"button\"} href={this.generateDocUrl(doc)}>open</a>\n                        {this.renderDeleteButton(doc)}\n                    </li>\n                })}\n                </ul>\n            </section>\n            <footer>\n                <button onClick={this.dismiss}>dismiss</button>\n            </footer>\n        </Dialog>\n    }\n\n    renderDeleteButton(doc) {\n        if(!AuthModule.supportsDocDelete()) return \"\"\n        return <button onClick={()=>this.deleteDoc(doc)}>delete</button>\n\n    }\n\n}\n","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {isAudioType, isGLTFType, isImageType, isVideoType} from '../Common'\nimport {AuthModule} from '../AuthModule'\nimport {\n    addAudioAssetFromURL,\n    addGLBAssetFromURL,\n    addImageAssetFromExpandedURL,\n    addVideoAssetFromURL\n} from '../AssetActions'\nimport {Dialog} from 'react-visual-editor-framework'\n\nexport class OpenAssetDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            assetList:[]\n        }\n    }\n    refreshList = () => {\n        this.props.provider.loadAssetList()\n            .then((assets) => {\n                if(this.props.filter) assets = assets.filter(this.props.filter)\n                this.setState({assetList:assets})\n            })\n    }\n    componentDidMount() {\n        this.refreshList()\n    }\n    addAsset(info) {\n        DialogManager.hide()\n        if(isImageType(info.mimeType)) {\n            return addImageAssetFromExpandedURL(info.id, info.url,info.mimeType, info.title, this.props.provider)\n        }\n        if(isAudioType(info.mimeType)) {\n            return addAudioAssetFromURL(info.id, info.url, info.mimeType, info.title, this.props.provider)\n        }\n        if(isVideoType(info.mimeType)) {\n            return addVideoAssetFromURL(info.id, info.url, info.mimeType, info.title, this.props.provider)\n        }\n        if(isGLTFType(info.mimeType)) {\n            return addGLBAssetFromURL(info.id, info.url, info.mimeType, info.title, this.props.provider)\n        }\n        console.log(\"can't add this type\",info.mimeType)\n    }\n    deleteAsset(info) {\n        return this.props.provider.removeAssetSource(info).then((res)=>{\n            console.log('removed?',res)\n            this.refreshList()\n        })\n    }\n\n    okay = () => {\n        DialogManager.hide()\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.okay}>\n            <header>Add Asset</header>\n            <section>\n                <ul>{this.state.assetList.map((doc, i) => {\n                    return <li key={i}>\n                        <b>{doc.title} </b>\n                        <i> {doc.mimeType}</i>\n                        <button onClick={()=>this.addAsset(doc)}>add</button>\n                        {this.renderDeleteButton(doc)}\n                    </li>\n                })}\n                </ul>\n            </section>\n            <footer>\n                <button onClick={this.okay}>close</button>\n            </footer>\n        </Dialog>\n    }\n\n    renderDeleteButton(doc) {\n        if(!AuthModule.supportsAssetUpload()) return \"\"\n        return <button onClick={()=>this.deleteAsset(doc)}>delete</button>\n\n    }\n}\n","import React, {Component} from \"react\"\nimport {SelectionManager, SELECTION_MANAGER, TREE_ITEM_PROVIDER} from 'react-visual-editor-framework'\nimport {TOTAL_OBJ_TYPES} from './Common'\nimport AceEditor from 'react-ace'\nimport 'brace/mode/javascript'\nimport 'brace/theme/github'\nimport * as ToasterManager from '../vr/ToasterManager'\n\nexport default class ScriptEditor extends Component {\n    constructor(props) {\n        super(props)\n        this.refresh = () => {\n            const id = SelectionManager.getSelection()\n            const obj = this.props.provider.accessObject(id)\n            if(obj.exists() && obj.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) {\n                this.props.provider.fetchBehaviorAssetContents(id).then(text => {\n                    this.setState({id:id, text:text})\n                })\n            } else {\n            }\n        }\n        this.state = {\n            id:null,\n            text:'empty',\n        }\n    }\n    componentDidMount() {\n        this.refresh()\n        this.props.provider.on(TREE_ITEM_PROVIDER.PROPERTY_CHANGED,this.refresh)\n        SelectionManager.on(SELECTION_MANAGER.CHANGED,this.swap)\n    }\n\n    componentWillUnmount() {\n        this.props.provider.off(TREE_ITEM_PROVIDER.PROPERTY_CHANGED,this.refresh)\n        SelectionManager.off(SELECTION_MANAGER.CHANGED,this.swap)\n    }\n    swap = () => {\n        const obj = this.props.provider.accessObject(SelectionManager.getSelection())\n        if(obj.exists()  && obj.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) {\n            this.refresh()\n        }\n    }\n    changeText = (value) => this.setState({text:value})\n    save = (e) => {\n        const ann = this.editor.editor.getSession().getAnnotations()\n        const errors = ann.filter(a => a.type === 'error')\n        if(errors.length > 0) {\n            ToasterManager.add(\"errors in behavior\")\n        } else {\n            ToasterManager.add(\"saved behavior\")\n            this.props.provider.updateBehaviorAssetContents(this.state.id,this.state.text)\n        }\n    }\n    render() {\n        if(this.state.id === null) return <div>loading</div>\n        return <AceEditor mode=\"javascript\"\n                          theme=\"github\"\n                          name=\"script-editor\"\n                          value={this.state.text}\n                          onChange={this.changeText}\n                          onBlur={this.save}\n                          showGutter={true}\n                          width={'100%'}\n                          height={'100%'}\n                          ref={ed => this.editor = ed}\n        />\n    }\n\n}","import React, {Component} from 'react'\nimport {DialogManager, HBox, VBox} from 'appy-comps'\nimport {AuthModule} from '../AuthModule'\nimport {Dialog, Spacer} from 'react-visual-editor-framework'\n\nexport class OpenScriptDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            scripts:[]\n        }\n    }\n    refreshList = () => {\n        this.props.provider.loadScriptList()\n            .then((scripts) => this.setState({scripts:scripts}))\n    }\n    componentDidMount() {\n        this.refreshList()\n    }\n    addScript(info) {\n        DialogManager.hide()\n        console.log(\"URL is\",info.url)\n        info.url = info.name\n        console.log(\"Now URL is\",info.url)\n        const beh = this.props.provider.addBehaviorAssetFromURL(info)\n        if(this.props.onAdd) this.props.onAdd(beh)\n    }\n    deleteScript(info) {\n        return this.props.provider.removeBehaviorAssetSource(info.name)\n            .then(()=> this.refreshList())\n    }\n\n    okay = () => DialogManager.hide()\n\n    render() {\n        return <Dialog visible={true} onScrimClick={this.okay}>\n            <header>Choose Behavior Script</header>\n            <section>\n                <ul className=\"behaviors-list\">{this.state.scripts.map((doc, i) => {\n                    return <HBox key={doc.name}>\n                        <VBox>\n                            <div>\n                                <i>{doc.name}</i> -  <b>{doc.title}</b>\n                            </div>\n\n                            <p>{doc.description}</p>\n                        </VBox>\n                        <Spacer/>\n                        <button onClick={()=>this.addScript(doc)}>add</button>\n                        {this.renderDeleteButton(doc)}\n                    </HBox>\n                })}\n                </ul>\n            </section>\n            <footer>\n                <button onClick={this.okay}>close</button>\n            </footer>\n        </Dialog>\n    }\n\n    renderDeleteButton(doc) {\n        if(!AuthModule.supportsScriptEdit()) return \"\"\n        return <button onClick={()=>this.deleteScript(doc)}>delete</button>\n    }\n\n}\n","export const CUSTOM_BEHAVIOR_SCRIPT = `\n/*\n #title untitled behavior\n #description does something\n*/\n({\n  // defines a target property. must be a scene\n    properties: {\n        scene: { \n            type:'enum', \n            title: 'target scene', \n            value:null, \n            hints: {\n                type:'node',\n                nodeType:'scene'\n            }\n        },\n    },\n    start: function(evt) {\n        //called when the program starts\n    },\n    click: function(evt) {\n        //called when object is clicked on\n        //this.navigateScene(this.properties.scene)\n    }\n})\n`\n\n\n\nexport const CUSTOM_SCENE_SCRIPT = `\n/*\n #title scene script\n #description does something\n*/\n({\n    // defines a target property. must be a scene\n    properties: {\n        scene: { \n            type:'enum', \n            title: 'target scene', \n            value:null, \n            hints: {\n                type:'node',\n                nodeType:'scene'\n            }\n        },\n    },\n    start: function(evt) {\n        //called when the program starts\n    },\n    enter: function(evt) {\n        //called when entering a scene\n    },\n    tick: function(evt) {\n        //called on every frame\n    },\n    exit: function(evt) {\n        //called when exiting a scene\n    },\n    stop: function(evt) {\n        //called when the program stops\n    },\n})\n`","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {Dialog, QRCanvas} from 'react-visual-editor-framework'\n\nexport class QRDialog extends Component {\n\n    okay = () => {\n        DialogManager.hide()\n    }\n\n    render() {\n        let url = null\n        if(this.props.url) url = this.props.url\n        let wurl = url.replace(\"https\",\"wxrv\")\n        wurl = wurl.replace(\"http\",\"wxrv\")\n        return <Dialog visible={true} onScrimClick={this.okay}>\n                <header>{this.props.text?this.props.text:'Scan'}</header>\n                <section>\n                    <label><a href={url}>{url}</a></label>\n                    <QRCanvas url={wurl} width={160} height={160}/>\n                </section>\n                <footer>\n                    <button onClick={this.okay}>dismiss</button>\n                </footer>\n        </Dialog>\n    }\n\n}\n","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {AuthModule} from '../AuthModule'\nimport {Dialog} from 'react-visual-editor-framework'\n\nexport class PasswordDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            field:\"\"\n        }\n    }\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        AuthModule.doPasswordLogin(this.state.field)\n    }\n    keyDown = (e) => {\n        if(e.key === 'Enter') this.okay()\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel} width=\"600px\" height=\"auto\">\n            <header>login with the password from your env file</header>\n            <section>\n                <label>password</label>\n                <input type={\"password\"} value={this.state.field}\n                       onKeyDown={this.keyDown}\n                       onChange={(e)=>{\n                    this.setState({field:e.target.value})\n                }}/>\n            </section>\n            <footer>\n                <button onClick={this.cancel}>cancel</button>\n                <button onClick={this.okay}>okay</button>\n            </footer>\n        </Dialog>\n    }\n}\n\n","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {AuthModule} from '../AuthModule'\nimport {Dialog, getLoginURL} from 'react-visual-editor-framework'\n\nexport class GithubAuthDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            data:null\n        }\n    }\n    componentDidMount() {\n        console.log(\"opening dialog\")\n        AuthModule.getJSON(getLoginURL()).then(data => {\n            console.log(\"got the data\",data)\n            this.setState({data:data})\n        })\n    }\n\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        console.log(\"opening window with the data\",this.state.data)\n        AuthModule.login(this.state.data)\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n            <header>Github Auth</header>\n            <section>\n                <p>To log into MrEd you need a github account. Press the button\n                below to log into github and approve MrEd's access. The app will only use\n                Github for authentication. It does not have access to any of your projects or code.\n                </p>\n                <button onClick={this.okay}>Open Github</button>\n            </section>\n            <footer>\n                <button onClick={this.cancel}>cancel</button>\n            </footer>\n        </Dialog>\n    }\n}\n\n","import React, {Component} from 'react'\n\nexport class ErrorCatcher extends Component {\n\n\n    constructor(props, context) {\n        super(props, context)\n        this.state = {error:false }\n    }\n\n    componentDidCatch(error, errorInfo) {\n        this.setState({error:true})\n        const logger = this.props.logger\n        if(!logger) {\n            console.log(\"NO LOGGER!\")\n            return\n        }\n        logger.error(\"an error occurred at the react level\")\n        logger.error(error)\n        logger.error(errorInfo)\n    }\n\n    render() {\n        if(this.state.error === true) {\n            return <div><h1>An error happened. Please look at the console</h1></div>\n        }\n\n        return this.props.children\n    }\n\n}","import {LinearFilter, NearestFilter, sRGBEncoding, Texture} from 'three'\n\n/**\n *\n * Gif parser by @gtk2k\n * https://github.com/gtk2k/gtk2k.github.io/tree/master/animation_gif\n *\n */\n\nconst parseGIF = function(gif) {\n    console.log(\"parsing\",gif)\n    let pos = 0;\n    const delayTimes = [];\n    let graphicControl = null;\n    const frames = [];\n    const disposals = [];\n    const transparencies = [];\n    const transparentColors= [];\n    let loopCnt = 0;\n    if (\n        gif[0] === 0x47 &&\n        gif[1] === 0x49 &&\n        gif[2] === 0x46 && // 'GIF'\n        gif[3] === 0x38 &&\n        (gif[4] === 0x39 || gif[4] === 0x37) && \n        gif[5] === 0x61\n    ) {\n        // '89a'\n        pos += 13 + +!!(gif[10] & 0x80) * Math.pow(2, (gif[10] & 0x07) + 1) * 3;\n        const gifHeader = gif.subarray(0, pos);\n        while (gif[pos] && gif[pos] !== 0x3b) {\n            const offset = pos,\n                blockId = gif[pos];\n            if (blockId === 0x21) {\n                const label = gif[++pos];\n                if ([0x01, 0xfe, 0xf9, 0xff].indexOf(label) !== -1) {\n                    label === 0xf9 && delayTimes.push((gif[pos + 3] + (gif[pos + 4] << 8)) * 10);\n                    label === 0xff && (loopCnt = gif[pos + 15] + (gif[pos + 16] << 8));\n                    while (gif[++pos]) pos += gif[pos];\n                    if (label === 0xf9) {\n                        graphicControl = gif.subarray(offset, pos + 1);\n                        disposals.push((graphicControl[3] >> 2) & 0x07);\n                        transparencies.push((graphicControl[3]) & 0x01);\n                        transparentColors.push(graphicControl[6]);\n                    }\n                } else {\n                    throw new Error(\"parseGIF: unknown label\");\n                }\n            } else if (blockId === 0x2c) {\n                pos += 9;\n                pos += 1 + +!!(gif[pos] & 0x80) * (Math.pow(2, (gif[pos] & 0x07) + 1) * 3);\n                while (gif[++pos]) pos += gif[pos];\n                const imageData = gif.subarray(offset, pos + 1);\n                frames.push(URL.createObjectURL(new Blob([gifHeader, graphicControl, imageData])));\n            } else {\n                throw new Error(\"parseGIF: unknown blockId\");\n            }\n            pos++;\n        }\n    } else {\n        throw new Error(\"parseGIF: no GIF89a\");\n    }\n    return { delayTimes, loopCnt, frames, disposals, transparencies, transparentColors };\n};\n\n//\n// self.onmessage = msg => {\n//     try {\n//         const result = parseGIF(new Uint8Array(msg.data.payload));\n//         self.postMessage({ id: msg.data.id, result });\n//     } catch (e) {\n//         self.postMessage({ id: msg.data.id, err: e.message });\n//     }\n// };\n//\n\nclass GIFTexture extends Texture {\n    constructor(frames, delays, disposals, transparencies, transparentColors) {\n        super(document.createElement(\"canvas\"));\n        this.image.width = frames[0].width;\n        this.image.height = frames[0].height;\n\n        this._ctx = this.image.getContext(\"2d\");\n\n        this.generateMipmaps = false;\n        this.isVideoTexture = true;\n        this.minFilter = NearestFilter;\n\n        this.frames = frames;\n        this.delays = delays;\n        this.disposals = disposals;\n        this.transparencies = transparencies // is each frame transparent or not\n\n        this.transparent = false\n        this.transparencies.forEach( (value) => {\n            if (value) this.transparent = true\n        })\n \n        this.transparentColors = transparentColors // the color index for transparent colors\n        this.frame = 0;\n        this.frameStartTime = Date.now();\n        this.firstDrawCount = 0\n        this.playing = true\n    }\n\n    update() {\n        if (!this.frames || !this.delays || !this.disposals) return;\n        if(this.firstDrawCount > this.frames.length && !this.playing) return;\n        const now = Date.now();\n        if (now - this.frameStartTime > this.delays[this.frame]) {\n            if (this.disposals[this.frame] === 2) {\n                this._ctx.clearRect(0, 0, this.image.width, this.image.width);\n            }\n            this.frame = (this.frame + 1) % this.frames.length;\n            this.frameStartTime = now;\n            this._ctx.drawImage(this.frames[this.frame], 0, 0, this.image.width, this.image.height);\n            this.needsUpdate = true;\n            this.firstDrawCount+=1\n        }\n    }\n}\n\n\nexport function createGIFTexture(url, prov) {\n    return new Promise((resolve, reject) => {\n        fetch(url,{ mode: \"cors\" })\n            .then(r => r.arrayBuffer())\n            .then(r => new Uint8Array(r))\n            .then(r => {\n                if(prov) {\n                    if(r.length < 100) {\n                        prov.getLogger().log(\"array length is too short\", String.fromCharCode(115))\n                        let str = \"\"\n                        for(let i=0; i<r.length; i++) {\n                            str += String.fromCharCode(r[i])\n                        }\n                        prov.getLogger().log(str)\n                    }\n                }\n                return r\n            })\n            .then(rawImageData => parseGIF(rawImageData, [rawImageData]))\n            .then(result => {\n                console.log(\"result of gif parsing is\",result)\n                const { frames, delayTimes, disposals, transparencies, transparentColors } = result;\n                let loadCnt = 0;\n                for (let i = 0; i < frames.length; i++) {\n                    const img = new Image();\n                    img.crossOrigin = \"anonymous\"\n                    // eslint-disable-next-line\n                    img.onload = e => {\n                        loadCnt++;\n                        frames[i] = e.target;\n                        if (loadCnt === frames.length) {\n                            const texture = new GIFTexture(frames, delayTimes, disposals, transparencies, transparentColors);\n                            texture.image.src = url;\n                            texture.encoding = sRGBEncoding;\n                            texture.minFilter = LinearFilter;\n                            resolve(texture);\n                        }\n                    };\n                    img.src = frames[i];\n                }\n            })\n            .catch(reject);\n    });\n}","import {ASSET_TYPES} from './Common'\nimport {TextureLoader, VideoTexture, Audio, AudioLoader} from 'three'\nimport {AuthModule} from './AuthModule'\nimport {getAssetsURL} from 'react-visual-editor-framework'\nimport {createGIFTexture} from './GifSupport'\nimport GLTFLoader from './GLTFLoader'\nimport DRACOLoader from './DRACOLoader'\n\nexport class AssetsManager {\n    constructor(provider) {\n        this.provider = provider\n        this.assets_url_map = {}\n        this.videocache = {}\n        this.audiocache = {}\n        this.gifcache = {}\n    }\n\n    cacheAssetsList() {\n        return AuthModule.getJSON(`${getAssetsURL()}list`).then(assets => {\n            if(!assets || !assets.forEach) return\n            if(AuthModule.supportsAssetUpload()) {\n                //doc server version\n                assets.forEach(asset => {\n                    this.assets_url_map[asset.id] = getAssetsURL()+asset.id\n                })\n            } else {\n                //glitch server version\n                assets.forEach(asset => {\n                    this.assets_url_map[asset.title] = asset.url\n                })\n                console.log(\"cached the assets\",this.assets_url_map)\n            }\n        })\n    }\n\n    getAssetURL(asset) {\n        if(AuthModule.supportsAssetUpload() && !AuthModule.isLoggedIn()) {\n            //TODO: Josh hack to work around listing assets when not logged in on docserver\n            return getAssetsURL()+asset.assetId\n        }\n        if(asset.assetId) {\n            return this.assets_url_map[asset.assetId]\n        } else {\n            return asset.src\n        }\n    }\n\n\n    playMediaAsset(asset, trusted=false) {\n        const lg = this.provider.getLogger()\n        if(asset.subtype === ASSET_TYPES.AUDIO) {\n            lg.log(\"playing the audio asset\",asset)\n            const url = this.getAssetURL(asset)\n            if(!url) {\n                lg.error('could not find the url for the asset',asset)\n                return\n            }\n            lg.log(\"playing the audio from the url\",url)\n            if(this.audiocache[asset.id]) {\n                //already loaded\n                const sound = this.audiocache[asset.id]\n                if(sound.isPlaying) sound.stop()\n                sound.play()\n            } else {\n                const sound = new Audio(this.provider.getAudioListener())\n                const audioLoader = new AudioLoader()\n                audioLoader.load(url, function (buffer) {\n                    sound.setBuffer(buffer);\n                    sound.setLoop(false);\n                    sound.setVolume(0.5);\n                    sound.play();\n                });\n                this.audiocache[asset.id] = sound\n            }\n        }\n        if(asset.subtype === ASSET_TYPES.VIDEO) {\n            const url = this.getAssetURL(asset)\n            const video = this.videocache[url]\n            if (video) {\n                if(trusted) video.muted = false\n                video.play()\n            }\n        }\n        if(asset.subtype === ASSET_TYPES.IMAGE) {\n            const url = this.getAssetURL(asset)\n            const gif = this.gifcache[url]\n            if(gif) {\n                gif.playing = true\n            }\n        }\n\n    }\n\n    stopMediaAsset(asset) {\n        if(asset.subtype === ASSET_TYPES.AUDIO) {\n            if(this.audiocache[asset.id]) {\n                this.audiocache[asset.id].stop()\n                delete this.audiocache[asset.id]\n                this.audiocache[asset.id] = null\n            }\n        }\n        if(asset.subtype === ASSET_TYPES.VIDEO) {\n            const url = this.getAssetURL(asset)\n            const video = this.videocache[url]\n            if (video) {\n                video.pause()\n            }\n        }\n        if(asset.subtype === ASSET_TYPES.IMAGE) {\n            const url = this.getAssetURL(asset)\n            const gif = this.gifcache[url]\n            if(gif) {\n                gif.playing = false\n            }\n        }\n    }\n\n    isMediaAssetPlaying(asset) {\n        if(asset.subtype === ASSET_TYPES.AUDIO) {\n            if(this.audiocache[asset.id]) {\n                return this.audiocache[asset.id].isPlaying\n            }\n        }\n        if(asset.subtype === ASSET_TYPES.VIDEO) {\n            const url = this.getAssetURL(asset)\n            const video = this.videocache[url]\n            if(video) {\n                //TODO: @josh this probably isn't right.\n                //TODO: instead we should listen for media events and track the status\n                const val = !(video.paused)\n                return val\n            }\n        }\n        if(asset.subtype === ASSET_TYPES.IMAGE) {\n            const url = this.getAssetURL(asset)\n            const gif = this.gifcache[url]\n            if(gif) {\n                return gif.playing\n            }\n        }\n        return false\n    }\n\n    setMediaVolume(asset, vol) {\n        if(asset.subtype === ASSET_TYPES.AUDIO) {\n            if(this.audiocache[asset.id]) {\n                this.audiocache[asset.id].setVolume(vol)\n            }\n        }\n        if(asset.subtype === ASSET_TYPES.VIDEO) {\n            const url = this.getAssetURL(asset)\n            const video = this.videocache[url]\n            if (video) {\n                video.volume = vol\n            }\n        }\n    }\n\n    stopAllMedia() {\n        const cache = this.videocache\n        Object.keys(cache).forEach(key => {\n            const item = cache[key]\n            if(item.pause) {\n                item.pause()\n            }\n        })\n        Object.keys(this.audiocache).forEach(key => {\n            if(this.audiocache[key] && this.audiocache[key].stop) {\n                this.audiocache[key].stop()\n            }\n        })\n\n    }\n\n\n    getTexture(id) {\n        const asset = this.provider.accessObject(id)\n        if(!asset.exists()) {\n            this.provider.getLogger().error(\"==== invalid asset reference\",id)\n            return Promise.resolve(null)\n        }\n        const url = this.getAssetURL(asset)\n        if(!url) {\n            this.provider.getLogger().error(\"==== null url from asset\",asset)\n            return Promise.resolve(null)\n        }\n        this.provider.getLogger().log(\"loading asset url\",url)\n        if(asset.subtype === ASSET_TYPES.IMAGE) {\n            this.provider.getLogger().log(\"asset info\",asset)\n            if(asset.format === 'image/gif') {\n                let gifprom\n                if(!this.gifcache[url]) {\n                    gifprom = createGIFTexture(url,this.provider).then(gif=>{\n                        this.gifcache[url]=gif\n                        return gif\n                    })\n                } else {\n                    gifprom = Promise.resolve(this.gifcache[url])\n                }\n                return gifprom\n            } else {\n                return new Promise((res,rej)=>{\n                    new TextureLoader().load(url,\n                        (tex)=>res(tex),\n                        (p)=>console.log(\"Progress\",p),\n                        (e)=>{\n                            this.provider.getLogger().error(\"error loading texture\",e)\n                            rej(e)\n                        })\n                    })\n            }\n        }\n        if(asset.subtype === ASSET_TYPES.VIDEO) {\n            let video\n            if(!this.videocache[url]) {\n                video = document.createElement('video')\n                video.crossOrigin = 'anonymous'\n                video.preload = \"auto\"\n                // video will only play inline on mobile devices if it's muted\n                // we will loop video\n                video.muted = true;\n                //video.loop = true;\n                video.setAttribute( 'playsinline', '' );\n\n                video.src = url\n                this.videocache[url] = video\n            } else {\n                video = this.videocache[url]\n            }\n            return Promise.resolve(new VideoTexture(video))\n        }\n        return Promise.resolve(null)\n    }\n\n    getGLTF(id) {\n        const asset = this.provider.accessObject(id)\n        if(!asset.exists()) {\n            this.provider.getLogger().error(\"==== invalid asset reference\",id)\n            return Promise.resolve(null)\n        }\n\n        const url = this.getAssetURL(asset)\n        if(!url) {\n            this.provider.getLogger().error(\"==== null url from asset\",asset)\n            return Promise.resolve(null)\n        }\n        this.provider.getLogger().log(\"ModelDef loading the model asset url\",url)\n\n        const loader = new GLTFLoader()\n        loader.setCrossOrigin('anonymous');\n        const draco = new DRACOLoader()\n        DRACOLoader.setDecoderPath( './draco/' );\n        loader.setDRACOLoader( draco );\n        return new Promise((res,rej)=>{\n            loader.load(url, (gltf)=> res(gltf),\n                (xhr)=> console.log('Progress',xhr),\n                (error)=>{\n                    this.provider.getLogger().error(\"error loading texture\",error)\n                    rej(error)\n                })\n        })\n\n    }\n}","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {Dialog, Spacer} from 'react-visual-editor-framework'\n\n\nexport class SaveDocumentAsDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            newTitle:\"Copy of \" + props.provider.getDocTitle()\n        }\n    }\n    edited = (e) => {\n        this.setState({newTitle:e.target.value})\n    }\n    dismiss = () => {\n        DialogManager.hide()\n    }\n    saveAs = () => {\n        DialogManager.hide()\n        this.props.provider.duplicateDocument(this.state.newTitle)\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.dismiss} width=\"600px\" height=\"auto\">\n            <header>Save Document As</header>\n            <section>\n                <label>title</label>\n                <input type=\"text\" value={this.state.newTitle} onChange={this.edited} style={{flex:1.0}}/>\n            </section>\n            <footer>\n                <Spacer/>\n                <button onClick={this.dismiss}>cancel</button>\n                <button onClick={this.saveAs}>save as</button>\n            </footer>\n        </Dialog>\n    }\n\n}\n","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {Dialog} from 'react-visual-editor-framework'\n\nexport class BadAssetsDialog extends Component {\n    dismiss = () => {\n        DialogManager.hide()\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n            <header>Warning. There were errors loading some assets</header>\n            <section>\n                <ul>\n                    {this.props.provider.badAssets.map((asset,i) => {\n                        return <li key={i}><b>{asset.title}</b>\n                            <br/>{asset.src}\n                        </li>\n                    })}\n                </ul>\n            </section>\n            <footer>\n                <button onClick={this.dismiss}>keep going anyway</button>\n            </footer>\n        </Dialog>\n    }\n}\n\n","import React, {Component} from 'react'\nimport * as ToasterManager from './ToasterManager'\n\nexport class ToasterNotification extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            notification:'saved',\n            visible:false\n        }\n    }\n\n    add = (payload) => {\n        this.setState({notification:payload, visible:true})\n        setTimeout(this.hide,2000)\n    }\n\n    hide = () => this.setState({visible:false})\n\n    componentWillMount() {\n        ToasterManager.onAdd(this.add)\n    }\n    componentWillUnmount() {\n        ToasterManager.offAdd(this.add)\n    }\n\n    render() {\n        return <div style={{\n            position:'absolute',\n            bottom:'10px',\n            left:'10px',\n            backgroundColor:'rgba(0,0,0,0.6)',\n            borderRadius:'1em',\n            color:'white',\n            fontSize:'24pt',\n            padding:'1em',\n            display:this.state.visible?'block':'none'\n        }}>{this.state.notification}</div>\n    }\n}\n","import React, {Component} from 'react'\nimport inspect from \"util-inspect\"\nimport \"./console.css\"\n\nexport class ConsoleView extends Component {\n    clearLog = () => {\n        this.setState({messages:[]})\n    }\n\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            messages:[]\n        }\n    }\n    componentDidMount() {\n        this.props.logger.addEventListener(\"log\",(e)=>{\n            this.state.messages.push(e)\n            this.setState({messages:this.state.messages})\n        })\n        this.props.logger.addEventListener(\"error\",(e)=>{\n            this.state.messages.push(e)\n            this.setState({messages:this.state.messages})\n        })\n    }\n\n    render() {\n        return <div className=\"console wide\">\n            <div className=\"toolbar gray\">\n                <button className=\"action gray fa fa-trash borderless\" onClick={this.clearLog}/>\n                <button className=\"action gray fa fa-exclamation-triangle borderless\"/>\n                <input type=\"text\" placeholder=\"filter messages\" className=\"spacer\"/>\n            </div>\n            <ul className={\"message-log\"}>\n                {this.state.messages.map((msg,i) => {\n                    const loc = (msg.remote?\"remote\":\"local\")\n                    return <li key={i}>\n                        <b className={`location ${loc}`}>{loc}</b>\n                        <b className={`type ${msg.type}`}>{msg.type}</b>\n                        <i>{msg.count}</i>\n                        {this.formatMessage(msg)}\n                    </li>\n                })}\n\n            </ul>\n        </div>\n    }\n\n    formatMessage(msg) {\n        // console.log(\"formatting\",msg.data)\n        const msgs =  msg.data.map((str,i) => {\n            if(typeof str === 'string' || str instanceof String) {\n                return <b key={i}>{str}</b>\n            }\n            return <b key={i}>{inspect(str,{depth: 2})}</b>\n        })\n        return <span>{msgs}</span>\n    }\n}\n","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {Dialog} from 'react-visual-editor-framework'\n\nexport class SimpleMessageDialog extends Component {\n    okay = () => {\n        DialogManager.hide()\n    }\n\n    render() {\n        return <Dialog visible={true} onScrimClick={this.okay}>\n            <header>Property Error</header>\n            <section>\n                <p>{this.props.text}</p>\n            </section>\n            <footer>\n                <button onClick={this.okay}>dismiss</button>\n            </footer>\n        </Dialog>\n    }\n\n}\n","import SyncGraphProvider from '../syncgraph/SyncGraphProvider'\nimport React, {Component} from 'react'\nimport {VRCanvas} from './VRCanvas'\nimport ImmersiveVREditor from './ImmersiveVREditor'\nimport {\n    fetchGraphObject,\n    insertAsFirstChild,\n    insertAsLastChild,\n    listToArray,\n    removeFromParent\n} from '../syncgraph/utils'\nimport CubeDef from \"./defs/CubeDef\"\nimport SceneDef from \"./defs/SceneDef\"\nimport {\n    Spacer,\n    InputManager,\n    PropSheet,\n    PROP_TYPES,\n    SelectionManager,\n    SELECTION_MANAGER,\n    TreeTable,\n    getAssetsURL,\n    getDocsURL,\n    getScriptsURL,\n    TREE_ITEM_PROVIDER,\n    toQueryString,\n} from \"react-visual-editor-framework\"\nimport {DialogContainer, DialogManager, HBox, PopupContainer, PopupManagerContext, VBox} from \"appy-comps\"\nimport {\n    ASSET_TYPES,\n    canBeDeleted,\n    canHaveBehavior,\n    canHaveScene,\n    canHaveShape,\n    get3DObjectDef,\n    HORIZONTAL_ALIGNMENT,\n    is3DObjectType,\n    isGLTFFile,\n    isImageType,\n    ITEM_ICONS,\n    NONE_ASSET,\n    OBJ_TYPES,\n    parseBehaviorScript,\n    PROP_DEFS,\n    REC_TYPES,\n    SIMPLE_COLORS,\n    TOTAL_OBJ_TYPES\n} from './Common'\nimport {AddImageAssetDialog} from './dialogs/AddImageAssetDialog'\nimport {AddGLTFAssetDialog} from './dialogs/AddGLTFAssetDialog'\nimport {AddGLBAssetDialog} from './dialogs/AddGLBAssetDialog'\nimport {AddAudioAssetDialog} from './dialogs/AddAudioAssetDialog'\nimport {UnsavedDocumentDialog} from \"./dialogs/UnsavedDocumentDialog\"\nimport AssetView from '../metadoc/AssetView'\nimport * as ToasterMananager from './ToasterManager'\nimport GraphAccessor from \"../syncgraph/GraphAccessor\"\nimport {OpenFileDialog} from './dialogs/OpenFileDialog'\nimport {AuthModule, CONNECTED, USER_CHANGE} from './AuthModule'\nimport {OpenAssetDialog} from './dialogs/OpenAssetDialog'\nimport ScriptEditor from './ScriptEditor'\nimport {OpenScriptDialog} from './dialogs/OpenScriptDialog'\nimport {CUSTOM_BEHAVIOR_SCRIPT, CUSTOM_SCENE_SCRIPT} from './Templates'\nimport {\n    addScene,\n    deleteObject,\n    generateAddAssetPopup,\n    newDoc,\n    showAddAssetPopup,\n    showAddBehaviorPopup,\n    showAddPopup\n} from './Actions'\nimport {addGeoAnchorAsset, addGLBAssetFromFile, addImageAssetFromFile} from './AssetActions'\nimport {QRDialog} from './dialogs/QRDialog'\nimport {PasswordDialog} from './dialogs/PasswordDialog'\nimport {GithubAuthDialog} from './dialogs/GithubAuthDialog'\nimport {ErrorCatcher} from './ErrorCatcher'\nimport {AssetsManager} from './AssetsManager'\nimport {ConsoleLogger} from '../syncgraph/PubnubSyncWrapper'\nimport {SaveDocumentAsDialog} from './dialogs/SaveDocumentAsDialog'\nimport {BadAssetsDialog} from './dialogs/BadAssetsDialog'\nimport {ToasterNotification} from './ToasterNotification'\nimport preval from \"preval.macro\"\nimport {ConsoleView} from './ConsoleView'\nimport {SimpleMessageDialog} from './dialogs/SimpleMessageDialog'\n\nexport default class VREditor extends SyncGraphProvider {\n    constructor(options) {\n        super(options)\n        this.imagecache = {}\n        this.behaviorCache = {}\n        this.orbit_state = {}\n        this.badAssets = []\n        this.assetsManager = new AssetsManager(this)\n    }\n    getPopupManager() {\n        return this.popupManager\n    }\n    getDocType() { return \"vr\" }\n    getApp = () => {\n        if(this.mode === 'edit') return <VREditorApp provider={this}/>\n        if(this.mode === 'vredit') return <ImmersiveVREditor provider={this} editable={true}/>\n        if(this.mode === 'embed-view') return <ImmersiveVREditor provider={this} editable={false}/>\n        if(this.mode === 'vrview') return <ImmersiveVREditor provider={this} editable={false}/>\n        console.log(\"no mode!\")\n    }\n    getTitle = () => \"MrEd\"\n    getDocTitle = () => this.accessObject(this.getSceneRoot()).title\n    setDocTitle = (title) => this.accessObject(this.getSceneRoot()).set('title',title)\n    getLogger = () => {\n        if(this.pubnub) return this.pubnub.getLogger()\n        if(!this.consoleLogger)  this.consoleLogger = new ConsoleLogger()\n        return this.consoleLogger\n    }\n\n    makeEmptyRoot(doc) {\n        //make root\n        const root = fetchGraphObject(doc,doc.createObject({\n            type:TOTAL_OBJ_TYPES.ROOT,\n            title:'Untitled Project',\n            splashImage:NONE_ASSET.id,\n            defaultScene:NONE_ASSET.id,\n            children:doc.createArray()\n        }))\n        const rootObj = new GraphAccessor(doc).object(root.id)\n        //make scene\n        const scene1 = new SceneDef().make(doc,rootObj)\n        //make cube\n        const obj = new CubeDef().make(doc,scene1)\n        //make assets\n        const assets = fetchGraphObject(doc,doc.createObject({type:TOTAL_OBJ_TYPES.ASSETS_LIST,\n            title:'Assets', children: doc.createArray(), parent:0}))\n        //make behaviors\n        const behaviors = fetchGraphObject(doc,doc.createObject({type:TOTAL_OBJ_TYPES.BEHAVIORS_LIST,\n            title:'Behaviors', children: doc.createArray(), parent:0}))\n        //tie it all together\n        insertAsFirstChild(doc,root,scene1)\n        insertAsFirstChild(doc,scene1,obj)\n        insertAsLastChild(doc,root,behaviors)\n        insertAsLastChild(doc,root,assets)\n    }\n    docLoaded = () => {\n        //pre-cache all of the behaviors\n        this.accessObject(this.getBehaviorsObject()).getChildren()\n            .filter(a => a.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT)\n            .forEach((b)=>{\n                this.fetchBehaviorAssetContents(b.id).then((contents)=> {\n                    try {\n                        const info = parseBehaviorScript(contents)\n                        info.text = contents\n                        this.setCachedBehaviorAsset(b.id, info)\n                    } catch (e) {\n                        console.error(e)\n                    }\n                })\n            })\n        // if(this.syncdoc.getHistory().length > 300) {\n        //     throw new Error(\"pretending to crash loading the doc \" + this.syncdoc.getHistory().length)\n        // }\n        //get a list of assets for calculating the correct URLS.\n        return this.assetsManager.cacheAssetsList()\n            .then(()=>{\n                Promise.all(this.accessObject(this.getAssetsObject()).getChildren()\n                    .map(asset => {\n                        // this.getLogger().log(\"checking asset\",asset)\n                        if(asset.subtype === ASSET_TYPES.VIDEO) {\n                            return this.assetsManager.getTexture(asset.id).then(tex => {\n                                if (!tex) {\n                                    this.getLogger().error(\"error loading a texture\", asset)\n                                    this.addAssetLoadingError(asset)\n                                }\n                            })\n                        }\n                        if(asset.subtype === ASSET_TYPES.IMAGE) {\n                            return this.assetsManager.getTexture(asset.id).then(tex => {\n                                if (!tex) {\n                                    this.getLogger().error(\"error loading a texture\", asset)\n                                    this.addAssetLoadingError(asset)\n                                }\n                            })\n                        }\n                        if(asset.subtype === ASSET_TYPES.GLTF) {\n                            return this.assetsManager.getGLTF(asset.id).then(model => {\n                                if (!model) {\n                                    this.getLogger().error(\"error loading a model\", asset)\n                                    this.addAssetLoadingError(asset)\n                                }\n                            })\n                        }\n                        return Promise.resolve(\"all good\")\n                    })).then((answers)=>{\n                        console.log(\"fully loaded all assets now\")\n                        console.log(\"error count is\",this.badAssets.length)\n                    if(this.badAssets.length > 0) {\n                        this.showBadAssetsDialog()\n                    }\n                })\n            })\n    }\n\n    addAssetLoadingError(asset) {\n        this.badAssets.push(asset)\n    }\n\n    getRendererForItem = (item) => {\n        const obj = this.accessObject(item)\n        if(!obj.exists()) return <div>???</div>\n        if(obj.type === TOTAL_OBJ_TYPES.ASSET) return <div><i className={ITEM_ICONS[obj.subtype]}/> {obj.title}</div>\n        if(ITEM_ICONS[obj.type]) return <div><i className={ITEM_ICONS[obj.type]}/> {obj.title}</div>\n        return <div>{obj.title}</div>\n    }\n\n    getProperties(item) {\n        function copyPropDef(def,value) {\n            const out = {};\n            Object.keys(def).forEach((key) => out[key] = def[key])\n            out.value = value\n            return out;\n        }\n        let defs = []\n        if(!item) return defs\n\n        //show the ID for all objects\n        defs.push({\n            key:'id',\n            name:\"ID\",\n            type:PROP_TYPES.STRING,\n            value:item,\n            locked:true\n        })\n\n        const obj = this.accessObject(item)\n        //if a behavior object is selected, get the defs from the root behavior asset\n        if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR) {\n            const behaviorProps = this.getCachedBehaviorPropDefs(obj.behavior)\n            if(behaviorProps) {\n                Object.keys(behaviorProps).forEach(pname => {\n                    const propdef = behaviorProps[pname]\n                    const ndef = {\n                        key: pname,\n                        name: pname,\n                        type: propdef.type,\n                        value: obj[pname]\n                    }\n                    if(propdef.hints) ndef.hints = propdef.hints\n                    defs.push(ndef)\n                })\n            } else {\n                console.warn(\"Missing prop defs for behavior object\")\n            }\n            defs.push({\n                key:'behavior',\n                name:\"Script\",\n                type:PROP_TYPES.STRING,\n                value:obj.behavior,\n                locked:true,\n                custom:true,\n            })\n        }\n\n        const props = this.syncdoc.getPropertiesForObject(item)\n        if(props) {\n            props.forEach(key => {\n                if(key === 'type') return\n                if(key === 'children') return\n                if(key === 'parent') return\n                const value = this.syncdoc.getPropertyValue(item,key)\n                if(PROP_DEFS[key]) {\n                    const def = copyPropDef(PROP_DEFS[key],value)\n                    if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) {\n                        if(key === 'title' || key === 'description') def.locked = true\n                    }\n                    if(obj.type === TOTAL_OBJ_TYPES.ASSET && obj.subtype === ASSET_TYPES.IMAGE) {\n                        if(key === 'width' || key === 'height') def.locked = true\n                    }\n                    return defs.push(def)\n                }\n                // console.log(\"unknown property\",key)\n            })\n        }\n\n\n\n        if(is3DObjectType(obj.type)) {\n            defs.push({\n                key: 'scale',\n                name: 'Scale',\n                type: PROP_TYPES.GROUP,\n                group: ['sx','sy','sz'],\n                custom:true,\n            })\n            defs.push({\n                key: 'translation',\n                name: 'Translation',\n                type: PROP_TYPES.GROUP,\n                group: ['tx','ty','tz'],\n                custom:true,\n            })\n            defs.push({\n                key: 'rotation',\n                name: 'Rotation',\n                type: PROP_TYPES.GROUP,\n                group: ['rx','ry','rz'],\n                custom:true,\n            })\n        }\n\n        return defs\n    }\n    setPropertyValue(item, def, value) {\n\n        //block duplicate titles\n        if(def.key === 'title') {\n            const root = this.accessObject(this.getSceneRoot())\n            const matches = root.find(ob=> ob.title === value  && item !== ob.id)\n            if(matches.length > 0) {\n                DialogManager.show(<SimpleMessageDialog text={` You already have an object titled '${value}'. Titles must be unique.`}/>)\n                throw new Error(\"cannot set title to duplicate value\")\n            }\n        }\n\n        //scale should update all three dimensions\n        if(def.key === 'scale' || def.key === 'translation' || def.key === 'rotation') {\n            def.group.forEach(key => super.setPropertyValue(item,{key:key}, value[key]))\n            return\n        }\n        super.setPropertyValue(item,def,value)\n        //size the plane to match the aspect ratio of the asset\n        if(def.key === PROP_DEFS.asset.key) {\n            const asset = this.accessObject(value)\n            if(asset.subtype === ASSET_TYPES.IMAGE) {\n                let height = (asset.height / asset.width) * this.accessObject(item).width\n                super.setPropertyValue(item, {key: 'height'}, height)\n            }\n            if(asset.subtype === ASSET_TYPES.GLTF) {\n                console.log(\"adjusting to a gtlf\")\n            }\n        }\n    }\n    getValuesForEnum(key,obj,def) {\n        const realobj = this.accessObject(obj)\n        //if this is a property on a behavior, then use the hints to generate a target list\n        if(realobj.exists() && realobj.type === TOTAL_OBJ_TYPES.BEHAVIOR) {\n            if(def.hasHints()) {\n                const hints = def.getHints()\n                if(hints.type === 'node') {\n                    return this.accessObject(this.getSceneRoot())\n                        .find(obj => obj.type === hints.nodeType)\n                        .map(ch => ch.id)\n                }\n                if(hints.type === 'audio') {\n                    return this.accessObject(this.getAssetsObject()).getChildren().filter(a => a.subtype === ASSET_TYPES.AUDIO).map(a => a.id)\n                }\n                if(hints.type === 'video') {\n                    return this.accessObject(this.getAssetsObject()).getChildren().filter(a => a.subtype === ASSET_TYPES.VIDEO).map(a => a.id)\n                }\n                if(hints.type === 'media') {\n                    return this.accessObject(this.getAssetsObject()).getChildren().filter(a => a.subtype === ASSET_TYPES.AUDIO || a.subtype === ASSET_TYPES.VIDEO || a.subtype === ASSET_TYPES.IMAGE).map(a => a.id)\n                }\n            }\n        }\n\n        if (key === PROP_DEFS.asset.key) {\n            const assets = this.accessObject(this.getAssetsObject()).getChildren()\n            if(acceptsImageAsset(realobj.type) && acceptsVideoAsset(realobj.type)) return withNone(assets.filter(a => a.subtype === ASSET_TYPES.VIDEO || a.subtype === ASSET_TYPES.IMAGE).map(a => a.id))\n            if(acceptsVideoAsset(realobj.type)) return withNone(assets.filter(a => a.subtype === ASSET_TYPES.VIDEO).map(a => a.id))\n            if(acceptsModelAsset(realobj.type)) return withNone(assets.filter(a => a.subtype === ASSET_TYPES.GLTF).map(a => a.id))\n            if(acceptsImageAsset(realobj.type)) return withNone(assets.filter(a => a.subtype === ASSET_TYPES.IMAGE).map(a => a.id))\n        }\n        if(key === PROP_DEFS.horizontalAlign.key) {\n            return Object.keys(HORIZONTAL_ALIGNMENT).map(key => HORIZONTAL_ALIGNMENT[key])\n        }\n        if(key === PROP_DEFS.defaultScene.key) {\n            return withNone(this.accessObject(this.getSceneRoot()).getChildren()\n                .filter(ch => ch.type === TOTAL_OBJ_TYPES.SCENE)\n                .map(ch => ch.id))\n        }\n        if(key === PROP_DEFS.texture.key) {\n            let assets = this.accessObject(this.getAssetsObject()).getChildren()\n            assets = assets.filter(a => a.subtype === ASSET_TYPES.IMAGE).map(a => a.id)\n            return withNone(assets)\n        }\n        if(key === PROP_DEFS.targetImage.key) {\n            let assets = this.accessObject(this.getAssetsObject()).getChildren()\n            assets = assets.filter(a => a.subtype === ASSET_TYPES.IMAGE).map(a => a.id)\n            return assets\n        }\n        if(key === PROP_DEFS.targetGeoLocation.key) {\n            let assets = this.accessObject(this.getAssetsObject()).getChildren()\n            assets = assets.filter(a => a.subtype === ASSET_TYPES.GEOLOCATION).map(a => a.id)\n            return assets\n        }\n        if(key === PROP_DEFS.recType.key) {\n            return Object.keys(REC_TYPES)\n        }\n        if(key === PROP_DEFS.splashImage.key) {\n            let assets = this.accessObject(this.getAssetsObject())\n                .getChildren()\n                .filter(a => a.subtype === ASSET_TYPES.IMAGE)\n                .map(a => a.id)\n            return withNone(assets)\n        }\n        if(key === PROP_DEFS.cloneTarget.key) {\n            let nodes = this.accessObject(this.getSceneRoot()).find(ch => is3DObjectType(ch.type)).map(a => a.id)\n            return withNone(nodes)\n        }\n    }\n    getRendererForEnum(key,obj) {\n        const realobj = this.accessObject(obj)\n        if(realobj.exists() && realobj.type === TOTAL_OBJ_TYPES.BEHAVIOR) return EnumTitleRenderer\n        switch(key) {\n            case PROP_DEFS.asset.key: return EnumTitleRenderer\n            case PROP_DEFS.defaultScene.key: return EnumTitleRenderer\n            case PROP_DEFS.texture.key: return EnumTitleRenderer\n            case PROP_DEFS.targetImage.key: return EnumTitleRenderer\n            case PROP_DEFS.targetGeoLocation.key: return EnumTitleRenderer\n            case PROP_DEFS.splashImage.key: return EnumTitleRenderer\n            case PROP_DEFS.cloneTarget.key: return EnumTitleRenderer\n            default: return null\n        }\n    }\n\n    getSelectedSceneObject() {\n        const sel = SelectionManager.getSelection()\n        if(sel === null) return this.getFirstSceneObject()\n        const selected = this.accessObject(sel)\n        if(!selected.exists()) return selected\n        if(selected.type === TOTAL_OBJ_TYPES.SCENE) return selected\n        if(is3DObjectType(selected.type))  return this.findSceneObjectParent(selected)\n        if(selected.type === TOTAL_OBJ_TYPES.BEHAVIOR) return this.findSceneObjectParent(selected)\n        this.getLogger().error(\"We shouldn't ever get here\")\n        return this.accessObject(0)\n    }\n    getFirstSceneObject() {\n        return this.accessObject(this.getSceneRoot()).getChildren()[0]\n    }\n    findSceneObjectParent(obj) {\n        if(obj === null) return null\n        if(!obj.exists()) return null\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) return obj\n        obj = this.accessObject(obj.parent)\n        return this.findSceneObjectParent(obj)\n    }\n\n    getAssetsObject = () => this.getDataGraph().getObjectByProperty('type',TOTAL_OBJ_TYPES.ASSETS_LIST)\n    getBehaviorsObject = () => this.getDataGraph().getObjectByProperty('type',TOTAL_OBJ_TYPES.BEHAVIORS_LIST)\n\n    quick_setPropertyValue(item, key, value) {\n        const ov = this.getDataGraph().getPropertyValue(item,key)\n        const op = this.cmd.setProperty(item,key,value)\n        op.prevValue = ov\n        if(op.value === op.prevValue) return\n        this.getRawGraph().process(op)\n        //TODO: this should be fired through the graph already. I shouldn't need to fire this\n        this.fire(TREE_ITEM_PROVIDER.PROPERTY_CHANGED,{\n            provider: this,\n            child:item,\n            propKey:key,\n            oldValue:ov,\n            newValue:value\n        })\n    }\n\n    editIn2D = () => {\n        this.save().then(()=>{\n            const opts = Object.assign({},this.options,{mode:'edit', doc:this.getDocId()})\n            delete opts.AuthModule\n            const loc = document.location\n            const url = `${loc.protocol}//${loc.host}${loc.pathname}?${toQueryString(opts)}`\n            DialogManager.show(<QRDialog text={\"Edit in 2D\"} url={url}/>)\n        })\n    }\n\n    editInVR = () => {\n        this.save().then(()=>{\n            const opts = Object.assign({},this.options,{mode:'vredit', doc:this.getDocId()})\n            delete opts.AuthModule\n            const loc = document.location\n            const url = `${loc.protocol}//${loc.host}${loc.pathname}?${toQueryString(opts)}`\n            DialogManager.show(<QRDialog text={\"Edit in AR/VR\"} url={url}/>)\n        })\n    }\n\n    viewInVR = () => {\n        this.save().then(()=> {\n            const opts = Object.assign({}, this.options, {mode: 'play', doc:this.getDocId()})\n            delete opts.AuthModule\n            const loc = document.location\n            const url = `${loc.protocol}//${loc.host}${loc.pathname}?${toQueryString(opts)}`\n            DialogManager.show(<QRDialog text={\"View in AR/VR\"} url={url}/>)\n        })\n    }\n\n\n    add3DObject = (type, parent) => {\n        const obj = get3DObjectDef(type).make(this.getDataGraph(),parent)\n        parent.insertFirstChild(obj)\n        SelectionManager.setSelection(obj.id)\n        ToasterMananager.add('added '+type)\n    }\n\n    calculateContextMenu(item) {\n        const cmds = []\n        const obj = this.accessObject(item)\n        if(canBeDeleted(obj.type)) {\n            cmds.push({title: 'delete', icon: ITEM_ICONS.delete, fun: () => deleteObject(this)});\n        }\n        if(obj.type === TOTAL_OBJ_TYPES.ASSETS_LIST) {\n            return generateAddAssetPopup(this)\n        }\n        if(obj.type === TOTAL_OBJ_TYPES.BEHAVIORS_LIST) {\n            cmds.push({\n                title:'Add Behavior from Server',\n                enabled:AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.behavior_script,\n                fun: () => this.showOpenBehaviorDialog()\n            })\n        }\n        if(canHaveShape(obj.type)) {\n            cmds.push({ divider:true })\n            Object.keys(OBJ_TYPES).forEach(type => cmds.push({\n                title: type,\n                icon: ITEM_ICONS[type],\n                fun: () => this.add3DObject(type,obj)\n            }))\n        }\n        if(canHaveScene(obj.type)) {\n            cmds.push({title: 'scene', icon: ITEM_ICONS.scene, fun: ()=>addScene(this)})\n        }\n\n        if(canHaveBehavior(obj.type)) {\n            cmds.push({ divider:true })\n            this.accessObject(this.getBehaviorsObject()).getChildren()\n                .filter(a => a.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT)\n                .forEach((b) => {\n                    cmds.push({\n                        title: b.title,\n                        icon: ITEM_ICONS.behavior_script,\n                        fun: () => this.addBehaviorToObject(b, item)\n                    })\n                })\n                cmds.push({\n                    title: 'Add Behavior from server',\n                    icon: ITEM_ICONS.behavior_script,\n                    enabled:AuthModule.isLoggedIn(),\n                    fun: () => {\n                        DialogManager.show(<OpenScriptDialog provider={this} onAdd={(beh)=>{\n                            this.addBehaviorToObject(beh,item).then(b=>{\n                                SelectionManager.setSelection(b.id)\n                            })\n                        }}/>)\n                    }\n                })\n        }\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) {\n            cmds.push({ divider:true })\n            if(AuthModule.scriptEditingSupported) {\n                cmds.push({title: 'Add Scene script', icon: ITEM_ICONS.behavior, fun: () => this.addSceneScript(item)})\n            }\n        }\n\n\n        if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR) {\n            cmds.push({ divider:true })\n            cmds.push({title:'view code', icon: ITEM_ICONS.behavior, fun: ()=>SelectionManager.setSelection(obj.behavior)})\n        }\n\n        if(canBeDeleted(obj.type)) {\n            cmds.push({divider: true})\n            cmds.push({title: 'cut', icon: ITEM_ICONS.cut, fun: this.cutSelection})\n            cmds.push({title: 'copy', icon: ITEM_ICONS.copy, fun: this.copySelection})\n            cmds.push({title: 'paste', icon: ITEM_ICONS.paste, fun: this.pasteSelection})\n        }\n        return cmds\n    }\n\n    cutSelection = (e) => {\n        if(e && e.target) {\n            if (e.target.getAttribute('type') === 'input') return\n            if (e.target.nodeName === 'INPUT') return\n            if (e.target.nodeName === 'TEXTAREA') return\n        }\n        if(SelectionManager.isEmpty()) return\n        const obj = this.accessObject(SelectionManager.getSelection())\n        SelectionManager.setClipboard(obj.id)\n        obj.removeFromParent()\n        SelectionManager.clearSelection()\n    }\n    copySelection = (e) => {\n        if(e && e.target) {\n            if (e.target.getAttribute('type') === 'input') return\n            if (e.target.nodeName === 'INPUT') return\n            if (e.target.nodeName === 'TEXTAREA') return\n        }\n        if(SelectionManager.isEmpty()) return\n        const obj = this.accessObject(SelectionManager.getSelection())\n        SelectionManager.setClipboard(obj.id)\n    }\n    pasteSelection = (e) => {\n        //don't intercept if this is a paste into a text field\n        if(e && e.target) {\n            if (e.target.getAttribute('type') === 'input') return\n            if (e.target.nodeName === 'INPUT') return\n            if (e.target.nodeName === 'TEXTAREA') return\n        }\n        const obj1 = this.accessObject(SelectionManager.getClipboard())\n        let parent = null\n        if(is3DObjectType(obj1.type)) parent = this.getSelectedSceneObject()\n        if(obj1.type === 'scene') parent = this.accessObject(this.getSceneRoot())\n        if (!parent) return console.error(\"no parent to ad too! bad obj type?\",obj1.type)\n        parent.insertChildLast(obj1.clone())\n    }\n\n    // ============ drag and drop ============\n    canBeMoved(node) {\n        const p = this.accessObject(node)\n        if(p.type === TOTAL_OBJ_TYPES.ROOT) return false\n        if(p.type === TOTAL_OBJ_TYPES.BEHAVIORS_LIST) return false\n        if(p.type === TOTAL_OBJ_TYPES.ASSETS_LIST) return false\n        return true\n    }\n    canAddChild(parent,child) {\n        const p = this.accessObject(parent)\n        const c = this.accessObject(child)\n        if(p.type === TOTAL_OBJ_TYPES.ROOT && c.type === TOTAL_OBJ_TYPES.SCENE) return true\n        if(p.type === TOTAL_OBJ_TYPES.SCENE && is3DObjectType(c.type)) return true\n        if(is3DObjectType(p.type) && c.type === TOTAL_OBJ_TYPES.BEHAVIOR) return true\n        if(canHaveShape(p.type) && is3DObjectType(c.type)) return true\n        return false\n    }\n    canBeSibling(src,tgt) {\n        const s = this.accessObject(src)\n        const t = this.accessObject(tgt)\n        if(s.type === TOTAL_OBJ_TYPES.SCENE && t.type === TOTAL_OBJ_TYPES.SCENE) return true\n        if(is3DObjectType(s.type) && is3DObjectType(t.type)) return true\n        return false\n    }\n    canAddExternalChild(parent,child) {\n        const obj = this.accessObject(parent)\n        if(obj.type === TOTAL_OBJ_TYPES.ASSETS_LIST) return true\n        return false\n    }\n    acceptDrop(e,tgt) {\n        const obj = this.accessObject(tgt)\n        if(obj.type === TOTAL_OBJ_TYPES.ASSETS_LIST) {\n            listToArray(e.dataTransfer.files).forEach(file => {\n                if(isImageType(file.type)) return addImageAssetFromFile(file,this)\n                if(isGLTFFile(file)) return addGLBAssetFromFile(file,this)\n            })\n        }\n    }\n    moveChildToNewParent(child,parent) {\n        child = this.accessObject(child)\n        parent = this.accessObject(parent)\n        child.removeFromParent()\n        parent.insertFirstChild(child)\n    }\n    moveChildAfterSibling(child,sibling) {\n        child = this.accessObject(child)\n        sibling = this.accessObject(sibling)\n        child.removeFromParent()\n        const parent = sibling.getParent()\n        parent.insertChildAfter(child,sibling)\n    }\n    requestImageCache(src) {\n        const img = new Image()\n        img.crossOrigin = \"anonymous\"\n        this.imagecache[src] = img\n        return new Promise((res,rej) => {\n            img.src = src\n            img.onload = () => {\n                this.fire(TREE_ITEM_PROVIDER.STRUCTURE_CHANGED,{ provider: this })\n                res(img)\n            }\n        })\n    }\n\n    createCustomEditor(item,def,provider, value, onChange) {\n        if(def.key === PROP_DEFS.color.key\n            || def.key === PROP_DEFS.backgroundColor.key\n            || def.key === PROP_DEFS.borderColor.key\n            || def.key === PROP_DEFS.textColor.key\n            || def.key === PROP_DEFS.startColor.key\n            || def.key === PROP_DEFS.endColor.key\n        ) return <ColorEditor def={def} item={item} onChange={onChange} value={value}/>\n\n        if(def.key === 'scale') return <GroupPropertyEditor def={def} item={item} onChange={onChange} provider={this}/>\n        if(def.key === 'translation') return <GroupPropertyEditor def={def} item={item} onChange={onChange} provider={this}/>\n        if(def.key === 'rotation') return <GroupPropertyEditor def={def} item={item} onChange={onChange} provider={this}/>\n        if(def.key === 'behavior') return <button onClick={()=>SelectionManager.setSelection(value)}>view code</button>\n        return <i>no custom editor for {def.key}</i>\n    }\n\n    setColor = (color) => {\n        if(SelectionManager.isEmpty()) return\n        this.accessObject(SelectionManager.getSelection()).set('color',color)\n    }\n\n    showAddImageAssetDialog = () => DialogManager.show(<AddImageAssetDialog provider={this}/>)\n    showAddAudioAssetDialog = () => DialogManager.show(<AddAudioAssetDialog provider={this}/>)\n    showAddGLTFAssetDialog  = () => DialogManager.show(<AddGLTFAssetDialog provider={this}/>)\n    showAddGLBAssetDialog   = () => DialogManager.show(<AddGLBAssetDialog provider={this}/>)\n    showOpenDocumentDialog  = () => DialogManager.show(<OpenFileDialog provider={this}/>)\n    showOpenAssetDialog     = () => DialogManager.show(<OpenAssetDialog provider={this}/>)\n    showAddServerImageDialog= () => DialogManager.show(<OpenAssetDialog provider={this} filter={a => isImageType(a.mimeType)}/>)\n    showOpenBehaviorDialog  = () => DialogManager.show(<OpenScriptDialog provider={this}/>)\n    showAddGeoLocationAssetDialog = () => {\n        addGeoAnchorAsset({\n            latitude:0,\n            longitude:0,\n            altitude:0,\n            useAltitude:false,\n        },\"new geo location\",this)\n    }\n    showPasswordDialog = () => DialogManager.show(<PasswordDialog provider={this}/>)\n    showGithubDialog = () => DialogManager.show(<GithubAuthDialog provider={this}/>)\n\n    accessObject = (id) => {\n        return new GraphAccessor(this.getDataGraph()).object(id)\n    }\n\n    loadDocList() {\n        return AuthModule.getJSON(`${getDocsURL()}list`)\n    }\n    removeDoc(doc) {\n        return AuthModule.fetch(`${getDocsURL()}delete/${doc.id}`,{\n            method:'POST',\n            body:doc.id,\n        }).then(res => res.json())\n    }\n    loadAssetList() {\n        return AuthModule.getJSON(`${getAssetsURL()}list`)\n    }\n    removeAssetSource(info) {\n        return AuthModule.fetch(`${getAssetsURL()}delete/${info.id}`,{\n            method:'POST',\n            body:info.id,\n        }).then(res => res.json())\n    }\n    loadScriptList() {\n        return AuthModule.getJSON(`${getScriptsURL()}list`)\n    }\n\n\n    // ======== behaviors ===============\n    addBehaviorAssetFromURL = (info) => {\n        const graph = this.getDataGraph()\n        const behavior = fetchGraphObject(graph,graph.createObject({\n            type:TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT,\n            title:info.title,\n            description:info.description,\n            src:info.url,\n            parent:0\n        }))\n        this.accessObject(this.getBehaviorsObject()).insertChildLast(behavior)\n        SelectionManager.setSelection(behavior.id)\n        return behavior\n    }\n    removeBehaviorAssetSource(name) {\n        const url = `${getScriptsURL()}delete/${name}`\n        console.log(\"removing\",url)\n        return AuthModule.fetch(url,{\n            method:'POST',\n            body:name,\n        }).then(res => res.json())\n    }\n    addCustomBehaviorAsset = (TEMPLATE) => {\n        const randi = (Math.floor(Math.random()*100000000))\n        const fname =`behavior_${randi}.js`\n        const url = `${getScriptsURL()}${fname}`;\n        const contents = TEMPLATE?TEMPLATE:CUSTOM_BEHAVIOR_SCRIPT\n        console.log(\"posting it to\",url)\n        return AuthModule.fetch(url,{\n            method:'POST',\n            body:contents,\n        })\n            .then(res => res.json())\n            .then(ans => {\n                console.log(\"got back the answer\",ans)\n                const graph = this.getDataGraph()\n                const behavior = fetchGraphObject(graph,graph.createObject({\n                    type:TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT,\n                    title:ans.script.title,\n                    description:ans.script.description,\n                    src:fname,\n                    parent:0\n                }))\n                this.accessObject(this.getBehaviorsObject()).insertChildLast(behavior)\n                SelectionManager.setSelection(behavior.id)\n                return behavior\n\n            })\n            .catch(err => console.error(err))\n    }\n    addSceneScript = (obj) => {\n        this.addCustomBehaviorAsset(CUSTOM_SCENE_SCRIPT)\n            .then((b)=>this.addBehaviorToObject(b,obj))\n    }\n    addBehaviorToObject = (b,item) => {\n        return this.fetchBehaviorAssetContents(b.id).then((contents)=>{\n            try {\n                const def = {\n                    type: TOTAL_OBJ_TYPES.BEHAVIOR,\n                    title: b.title,\n                    description: b.description,\n                    parent: 0,\n                    behavior:b.id,\n                }\n                const obj = parseBehaviorScript(contents)\n                this.setCachedBehaviorAsset(b.id,obj)\n                //copy properties to the behavior def\n                if(obj.properties) {\n                    Object.keys(obj.properties).forEach(name => {\n                        def[name] = obj.properties[name].value\n                    })\n                }\n                const graph = this.getDataGraph()\n                const behavior = fetchGraphObject(graph, graph.createObject(def))\n                this.accessObject(item).insertChildLast(behavior)\n                return behavior\n            } catch (e) {\n                console.error(e)\n            }\n        })\n    }\n    fetchBehaviorAssetContents(id) {\n        const obj = this.accessObject(id)\n        const url = getScriptsURL()+obj.src\n        return AuthModule.fetch(url,{\n            method:'GET',\n        }).then(res => res.text())\n    }\n    updateBehaviorAssetContents(id,text) {\n        if(!AuthModule.supportsScriptEdit()) return\n        //update the cache first\n        try {\n            const info = parseBehaviorScript(text)\n            info.text = text\n            this.setCachedBehaviorAsset(id, info)\n\n            const obj = this.accessObject(id)\n            const url = getScriptsURL() + obj.src\n            return AuthModule.fetch(url, {\n                method: 'POST',\n                body: text,\n            }).then(res => res.json())\n                .then(ans => {\n                    obj.set('title', ans.script.title)\n                    obj.set('description', ans.script.description)\n                })\n        } catch(e) {\n            console.error(\"error parsing the script\",e)\n            ToasterMananager.add('error parsing')\n        }\n    }\n    getCachedBehaviorPropDefs(behavior) {\n        if(!this.behaviorCache[behavior]) {\n            console.error(\"no parsed behavior in the cache\",behavior)\n            return null\n        }\n        return this.behaviorCache[behavior].properties;\n    }\n    getCachedBehaviorAsset(id) {\n        return this.behaviorCache[id]\n    }\n    setCachedBehaviorAsset(id, asset) {\n        this.behaviorCache[id] = asset\n    }\n\n    setAudioListener(al) {\n        this.audioListener = al\n    }\n    getAudioListener() {\n        return this.audioListener\n    }\n\n    showBadAssetsDialog() {\n        DialogManager.show(<BadAssetsDialog provider={this}/>)\n    }\n}\n\nclass VREditorApp extends Component {\n    showSaveAsDialog = () => {\n        DialogManager.show(<SaveDocumentAsDialog provider={this.props.provider}/>)\n    }\n    resizeLeft = (e) => {\n        window.addEventListener('mousemove',this.resizeLeftWindow)\n        window.addEventListener('mouseup', this.endResizeLeftWindow)\n    }\n    resizeLeftWindow =(e) => {\n        this.setState({leftDivider:e.clientX+'px'})\n    }\n    endResizeLeftWindow = (e) => {\n        window.removeEventListener('mousemove', this.resizeLeftWindow)\n        window.removeEventListener('mouseup', this.endResizeLeftWindow)\n    }\n\n    resizeRight = (e) => {\n        window.addEventListener('mousemove', this.resizeRightWindow)\n        window.addEventListener('mouseup', this.endResizeRightWindow)\n    }\n    resizeRightWindow = (e)=>{\n        const size = document.querySelector('.grid').getBoundingClientRect()\n        this.setState({rightDivider:(size.width-e.clientX)+'px'})\n    }\n    endResizeRightWindow = (e) => {\n        window.removeEventListener('mousemove', this.resizeRightWindow)\n        window.removeEventListener('mouseup', this.endResizeRightWindow)\n    }\n\n    resizeBottom = (e) => {\n        window.addEventListener('mousemove', this.resizeBottomWindow)\n        window.addEventListener('mouseup', this.endResizeBottomWindow)\n    }\n    resizeBottomWindow = (e) => {\n        const size = document.querySelector('.grid').getBoundingClientRect()\n        this.setState({bottomDivider:(size.height-e.clientY)+'px'})\n    }\n    endResizeBottomWindow = (e) => {\n        window.removeEventListener('mousemove', this.resizeBottomWindow)\n        window.removeEventListener('mouseup', this.endResizeBottomWindow)\n    }\n\n    toggleLeftPane = (e) => {\n        if(this.state.leftDivider === '0px') {\n            this.setState({leftDivider:'250px'})\n        } else {\n            this.setState({leftDivider:'0px'})\n        }\n    }\n    toggleRightPane = (e) => {\n        if(this.state.rightDivider === '0px') {\n            this.setState({rightDivider:'250px'})\n        } else {\n            this.setState({rightDivider:'0px'})\n        }\n    }\n    toggleBottomPane = (e) => {\n        if(this.state.bottomDivider === '0px') {\n            this.setState({bottomDivider:'250px'})\n        } else {\n            this.setState({bottomDivider:'0px'})\n        }\n    }\n\n\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            mode:'canvas',\n            user:null,\n            running:false,\n            connected:false,\n            dirty:true,\n            leftDivider: '250px',\n            rightDivider: '250px',\n            bottomDivider:'250px',\n        }\n\n        this.im = new InputManager()\n        this.im.addKeyBinding({id: 'save', key: InputManager.KEYS.S, modifiers: [InputManager.MODIFIERS.COMMAND]})\n        this.im.addKeyBinding({id: 'undo', key: InputManager.KEYS.Z, modifiers: [InputManager.MODIFIERS.COMMAND]})\n        this.im.addKeyBinding({\n            id: 'redo',\n            key: InputManager.KEYS.Z,\n            modifiers: [InputManager.MODIFIERS.COMMAND, InputManager.MODIFIERS.SHIFT]\n        })\n        this.im.addListener('save', this.props.provider.save)\n        this.im.addListener('undo', this.props.provider.performUndo)\n        this.im.addListener('redo', this.props.provider.performRedo)\n\n        this.im.addKeyBinding({id: 'cut', key: InputManager.KEYS.X, modifiers: [InputManager.MODIFIERS.COMMAND]})\n        this.im.addKeyBinding({id: 'copy', key: InputManager.KEYS.C, modifiers: [InputManager.MODIFIERS.COMMAND]})\n        this.im.addKeyBinding({id: 'paste', key: InputManager.KEYS.V, modifiers: [InputManager.MODIFIERS.COMMAND]})\n\n        this.im.addListener('cut', this.props.provider.cutSelection)\n        this.im.addListener('copy', this.props.provider.copySelection)\n        this.im.addListener('paste', this.props.provider.pasteSelection)\n\n    }\n\n    componentDidMount() {\n        this.im.attachKeyEvents(document)\n        SelectionManager.on(SELECTION_MANAGER.CHANGED,this.selectionChanged)\n        AuthModule.on(USER_CHANGE,()=>this.setState({user:AuthModule.getUsername()}))\n        AuthModule.on(CONNECTED,()=>this.setState({connected:true}))\n        if(AuthModule.isConnected()) this.setState({connected:true})\n        this.props.provider.on(TREE_ITEM_PROVIDER.CLEAR_DIRTY,()=>{\n            this.setState({dirty:false})\n        })\n        this.props.provider.on(TREE_ITEM_PROVIDER.PROPERTY_CHANGED, () => {\n            this.setState({dirty:true})\n        })\n        this.props.provider.on(TREE_ITEM_PROVIDER.SAVED, () => {\n            this.setState({dirty:false})\n        })\n    }\n    componentWillUnmount() {\n        SelectionManager.off(SELECTION_MANAGER.CHANGED,this.selectionChanged)\n    }\n\n    selectionChanged = () => {\n        if(!SelectionManager.isEmpty()) {\n            const item = this.props.provider.accessObject(SelectionManager.getSelection())\n            if(item.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) return this.setState({mode:'script'})\n            if(item.type === PROP_DEFS.asset.key) return this.setState({mode:'asset'})\n        }\n        this.setState({mode:'canvas'})\n    }\n\n    toggleRunning = () => {\n        this.setState({running:!this.state.running})\n    }\n\n    newDoc = () => {\n        if(this.state.dirty) {\n            console.log(\"can't create new becausue dirty\")\n            DialogManager.show(<UnsavedDocumentDialog onAnyway={()=>{\n                console.log(\"we are doing it anyway\")\n                newDoc(this.props.provider)\n            }}/>)\n\n        } else {\n            newDoc(this.props.provider)\n        }\n    }\n\n    showOpenDocumentDialog = () => {\n        if(this.state.dirty) {\n            DialogManager.show(<UnsavedDocumentDialog onAnyway={()=>{\n                console.log(\"we are doing it anyway\")\n                this.props.provider.showOpenDocumentDialog()\n            }}/>)\n        } else {\n            this.props.provider.showOpenDocumentDialog()\n        }\n    }\n\n    render() {\n        if(this.state.connected === false) {\n            return <div>\n                <h1>connecting to server</h1>\n                <DialogContainer/>\n            </div>\n        }\n        const prov = this.props.provider\n        let logger = null\n        if(prov.pubnub) logger = prov.getLogger()\n        if(!prov.getDataGraph()) {\n            return <div>\n                <h1>connecting to server</h1>\n                <DialogContainer/>\n            </div>\n        }\n        const dateTimeStamp = preval`module.exports = new Date().toLocaleString();`\n        const gridStyle = {\n            gridTemplateColumns: `${this.state.leftDivider} 0px 1fr 0px ${this.state.rightDivider}`,\n            gridTemplateRows: `2rem 1fr 2rem 0px ${this.state.bottomDivider}`,\n        }\n\n        return <ErrorCatcher logger={logger}>\n            <div className=\"grid\" style={gridStyle}>\n\n\n                <div className=\"toolbar gray\">\n                    {this.renderLoginButton()}\n                    <Spacer/>\n                    <button className=\"fa fa-file green\" onClick={this.newDoc} title={'new project'}/>\n                    <button className=\"fa fa-save green\" onClick={() => prov.save()} title={'save project'}/>\n                    <button className=\"fa fa-clone green\" onClick={this.showSaveAsDialog} title={\"duplicate project\"}/>\n                </div>\n                <Resizer onMouseDown={this.resizeLeft}/>\n                <div className=\"toolbar gray\">\n                    <button className=\"fa fa-cube yellow\"        onClick={(e)=>showAddPopup(e,prov)}/>\n                    {/*<button className=\"fa fa-globe\"       onClick={(e)=>addScene(prov)}/>*/}\n                    <button className=\"fa fa-archive yellow\"     onClick={(e)=>showAddAssetPopup(e,prov)}/>\n                    <button className=\"fab fa-superpowers yellow\" onClick={(e)=>showAddBehaviorPopup(e,prov)}/>\n                    {/*<button onClick={() => prov.editIn2D()}>2D Edit</button>*/}\n                    {/*<button onClick={() => prov.editInVR()}>AR Edit</button>*/}\n                    {/*<button onClick={() => prov.viewInVR()}>XR View</button>*/}\n                    <Spacer/>\n                    <RunButton onClick={this.toggleRunning} active={this.state.running}/>\n                    <Spacer/>\n                    <button className=\"fa fa-cut purple\" onClick={prov.cutSelection}/>\n                    <button className=\"fa fa-copy purple\" onClick={prov.copySelection}/>\n                    <button className=\"fa fa-paste purple\" onClick={prov.pasteSelection}/>\n                    <button className=\"fas fa-undo purple\" onClick={prov.performUndo}/>\n                    <button className=\"fas fa-redo purple\" onClick={prov.performRedo}/>\n                </div>\n                <Resizer onMouseDown={this.resizeRight}/>\n                <div className=\"toolbar gray\">\n                    <i className=\"fa fa-horse-head\" title={dateTimeStamp}/>\n                    <label>MrEd</label>\n                </div>\n\n                <div className={'panel high-2'}>\n                    <TreeTable root={prov.getSceneRoot()} provider={prov}/>\n                </div>\n                <Resizer onMouseDown={this.resizeLeft}/>\n                <div className=\"panel\">\n                    {this.renderCenterPane(this.state.mode)}\n                </div>\n                <Resizer onMouseDown={this.resizeRight}/>\n                <div className={'panel high-2'} style={{ backgroundColor: '#ecf0f1'}}>\n                    <PropSheet provider={prov}/>\n                </div>\n\n                <Resizer onMouseDown={this.resizeLeft}/>\n                <div className=\"toolbar borderless\">\n                    <button className={'borderless gray far' + ((this.state.leftDivider !== '0px') ? ' fa-caret-square-left' : ' fa-caret-square-right')}\n                            onClick={this.toggleLeftPane}/>\n                    <button className={'borderless gray far' + ((this.state.bottomDivider !== '0px') ? ' fa-caret-square-down' : ' fa-caret-square-up')}\n                            onClick={this.toggleBottomPane}/>\n\n                    <Spacer/>\n                    <span className=\"button blue\" onClick={() => prov.viewInVR()}>\n                        <i className=\"fas fa-external-link-alt\"/>\n                        <b>Phone View</b>\n                    </span>\n                    {this.props.bottomText}\n                    <Spacer/>\n                    <button className={'borderless gray far' + ((this.state.rightDivider !== '0px') ? ' fa-caret-square-right' : ' fa-caret-square-left')}\n                            onClick={this.toggleRightPane}/>\n                </div>\n                <Resizer onMouseDown={this.resizeRight}/>\n\n\n                <ResizerH onMouseDown={this.resizeBottom}/>\n                <ConsoleView logger={this.props.provider.getLogger()}/>\n                <ToasterNotification/>\n                <DialogContainer/>\n                <PopupContainer/>\n\n                {/*<div className=\"glitchButton\" style={{position:'fixed',top:'4px',right:'4px'}}/>*/}\n                {/*<script src=\"https://button.glitch.me/button.js\"/>*/}\n            </div>\n        </ErrorCatcher>\n    }\n    renderCenterPane(mode) {\n        if (mode === 'script') return <ScriptEditor provider={this.props.provider}/>\n        if (mode === 'canvas') return <VRCanvas provider={this.props.provider} running={this.state.running}/>\n        return <AssetView provider={this.props.provider} asset={SelectionManager.getSelection()}/>\n    }\n\n    renderLoginButton() {\n        const buttons = []\n\n        if(AuthModule.supportsAuth()) {\n            if(AuthModule.isLoggedIn()) {\n                buttons.push(<span key=\"logout\" className=\"blue button\" onClick={AuthModule.logout}><i className=\"fa fa-user\"/><b>logout</b></span>)\n            } else {\n                buttons.push(<span key=\"login\" className=\"blue button\" onClick={()=>{\n                    if(AuthModule.supportsPassword()) {\n                        this.props.provider.showPasswordDialog()\n                    } else {\n                        this.props.provider.showGithubDialog()\n//                        AuthModule.login()\n                    }\n                }}><i className=\"fa fa-user\"></i><b>login</b></span>)\n            }\n        }\n        if(AuthModule.supportsDocList()) {\n            buttons.push(<button key=\"open\" className=\"fa fa-folder-open blue\" onClick={this.showOpenDocumentDialog} title={\"open\"}/>)\n        }\n        return buttons\n    }\n}\n\nconst Resizer = (props) => {\n    return <div className=\"resizer\" {...props}/>\n}\nconst ResizerH = (props) => {\n    return <div className=\"resizer-h\" {...props}/>\n}\nconst EnumTitleRenderer = (props) => {\n    let value = \"---\"\n    if(props.value && props.provider)  value = props.provider.accessObject(props.value).title\n    if(props.value === NONE_ASSET.id)  value = NONE_ASSET.title\n    return <b>{value}</b>\n}\n\nclass GroupPropertyEditor extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            sync:false,\n        }\n    }\n    syncChanged = (e) => this.setState({sync: !this.state.sync})\n    changed = (e, key) =>{\n        const obj = this.props.provider.accessObject(this.props.item)\n        const keys = this.props.def.getGroupKeys()\n        const newvals = {}\n        keys.forEach(key=> newvals[key] = obj[key])\n        const val = parseFloat(e.target.value)\n        newvals[key] = val\n        if(this.state.sync) {\n            keys.forEach(key => newvals[key] = val)\n        }\n        this.props.onChange(newvals)\n    }\n    render() {\n        const obj = this.props.provider.accessObject(this.props.item)\n        const keys = this.props.def.getGroupKeys()\n        const boxes = keys.map(key => {\n            return <input key={key}\n                          type=\"number\"\n                          value={obj[key]}\n                          onChange={(e)=>{ this.changed(e,key)}}\n                          step={0.1}/>\n        })\n        return <HBox className=\"combined\">\n            <input type=\"checkbox\" checked={this.state.sync} onChange={this.syncChanged}/>\n            {boxes}\n        </HBox>\n    }\n}\n\nfunction acceptsModelAsset(type) {\n    if(type=== OBJ_TYPES.model) return true\n    return false\n}\nfunction acceptsImageAsset(type) {\n    if(type === OBJ_TYPES.plane\n        || type === OBJ_TYPES.bg360\n        || type === OBJ_TYPES.img2d\n        || type === OBJ_TYPES.cube\n        || type === OBJ_TYPES.sphere\n    ) return true\n    return false\n}\nfunction acceptsVideoAsset(type) {\n    if(type === OBJ_TYPES.plane\n        || type === OBJ_TYPES.bg360\n        || type === OBJ_TYPES.img2d\n    ) return true\n    return false\n}\n\nconst RunButton = (props) => {\n    const clss = props.active?\"run-button active fa fa-stop\":\"run-button fa fa-play\"\n    return <button onClick={props.onClick} className={clss + \" blue\"}/>\n}\n\nfunction withNone(array) {\n    array.push(NONE_ASSET.id)\n    return array\n}\n\nclass ColorEditor extends Component {\n    showPopup = (e) =>{\n        this.context.show(<ColorPopup onChange={this.props.onChange} value={this.props.value}/>, e.target)\n    }\n    render() {\n        return <button\n            style={{backgroundColor:this.props.value}}\n            onClick={this.showPopup}\n        >{this.props.value}</button>\n\n    }\n}\nColorEditor.contextType = PopupManagerContext\n\nclass ColorPopup extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            value:props.value\n        }\n    }\n    onChange = (e) => {\n        this.setState({value:e.target.value})\n        const v = e.target.value\n        if(v.indexOf('#')>=0 && v.length === 7) this.props.onChange(v)\n    }\n    done = () => {\n        this.props.onChange(this.state.value)\n        this.context.hide()\n    }\n    render() {\n        return <VBox style={{\n            width: '130px',\n            height: '100px',\n            backgroundColor: 'white'\n        }}>\n            <HBox>\n                {\n                    SIMPLE_COLORS\n                        .map(c => <button\n                            key={c}\n                            onClick={() => {\n                                this.props.onChange(c)\n                            }}\n                            style={{color: c, padding: '1px', margin: 0, borderWidth: 0,}}\n                            className={\"fa fa-square\"}/>)\n                }\n            </HBox>\n            <input type=\"text\" value={this.state.value}\n                   onChange={this.onChange}/>\n            <button onClick={this.done}>done</button>\n        </VBox>\n    }\n}\nColorPopup.contextType = PopupManagerContext\n","import * as THREE from 'three'\n\nimport {mat4, vec3} from \"gl-matrix/dist/gl-matrix.js\"\n\nvar meshMap = new Map()\n\nconst workingMatrix = mat4.create()\nvar savedOrigin = [0,0,0]\nvar savedDirection = [0,0,-1]\nvar reticleParent = null\nvar reticle = null\n            \nvar reticleTrackedColor = new THREE.Color( 0xDDFFDD );\nvar reticleNotTrackedColor = new THREE.Color( 0xFF6666 );\nvar reticleMaterial = new THREE.MeshStandardMaterial({ color: reticleTrackedColor })\nvar requestNextHit = true\nlet singleton = 0\n\nexport class XRWorldInfo extends THREE.Group {\n\n    constructor(engine,logger) {\n\n        super()\n\n        // run as a singleton\n        if(singleton) {\n            logger.error(\"XRWorldInfo called more than once - very bad\")\n            return singleton\n        }\n        singleton = this\n\n        this.engine = engine\n        this.session = engine.session\n        this.logger = logger\n        this.visible = false\n\n        this._floorPos = vec3.create()\n\n        // enable extended world sensing\n        this.session.updateWorldSensingState({\n            illuminationDetectionState : {\n                enabled : true\n            },\n            meshDetectionState : {\n                enabled : true,\n                normals: true\n            }\n        })\n\n        // don't waste time remaking this every frame\n        this._handleHitResults = this.handleHitResults.bind(this)\n\n        // a reticule\n        reticle = new THREE.Mesh( new THREE.RingGeometry(0.04, 0.05, 36, 64), reticleMaterial)\n        reticle.geometry.applyMatrix(new THREE.Matrix4().makeRotationX(THREE.Math.degToRad(-90)))\n        reticleParent = new THREE.Object3D()\n        reticleParent.add(reticle)\n        reticleParent.matrixAutoUpdate = false\n        reticleParent.visible = false\n\n    }\n\n    setVisible(status) {\n        this.visible = status\n        reticleParent.visible = status\n        meshMap.forEach(object => { object.node.visible = object.mesh.visible = status })\n    }\n\n    refreshWorldInfo(frame) {\n\n        let worldInfo = frame.worldInformation\n        if(!worldInfo || !worldInfo.meshes) {\n            return\n        }\n\n        // mark\n        meshMap.forEach(object => { object.seen = false })\n\n        // update meshes\n        worldInfo.meshes.forEach(worldMesh => {\n            var object = meshMap.get(worldMesh.uid);\n            if (object) {\n                this.handleUpdateNode(worldMesh, object)\n            } else {\n                this.handleNewNode(worldMesh)\n            }\n        })\n\n        // sweep\n        meshMap.forEach(object => { \n            if (!object.seen) {\n                this.handleRemoveNode(object)\n            } \n        })\n\n        // update frame of reference when ready to do so\n        if (requestNextHit) {\n            requestNextHit = false\n            this.session.requestFrameOfReference('head-model').then(headFrameOfReference => {\n                this.session.requestFrameOfReference('eye-level').then((eyeLevelFrameOfReference)=>{\n\n                    // update floor at player\n                    if(true) {\n                        // get player position\n                        let targetPos = vec3.create()\n                        headFrameOfReference.getTransformTo(eyeLevelFrameOfReference, workingMatrix)\n                        mat4.getTranslation(targetPos, workingMatrix)\n\n                        // find floor at player\n                        if( this.findFloorNear(targetPos) ) {\n\n                            // has floor moved significantly?\n                            if( vec3.squaredDistance(targetPos,this._floorPos) > 0.01) {\n                                vec3.copy(this._floorPos,targetPos)\n                                this.logger.log(\"************** floor is at \" + this._floorPos[1] )\n                            }\n\n                        }\n                    }\n\n                    // update reticule\n                    this.session.requestHitTest(savedOrigin, savedDirection, headFrameOfReference)\n                        .then(this._handleHitResults)\n                        .catch(err => {\n                            this.logger.error('Error testing hits', err)\n                        })\n\n                    //(TODO done elsewhere because I am unsure about asyncronity of handleHitResults)\n                    //requestNextHit = true\n                })\n            })\n        }\n    }\n\n    // handle hit testing slightly differently than other samples, since we're doing\n    // it per frame.  The \"boiler plate\" code below is slightly different, setting \n    // requestNextHit on tap instead of executing the hit test.  The custom XREngineHits\n    // does a hit test each frame if the previous one has resolved\n    // TODO unsure why this has to request these frames of reference again\n    handleHitResults(hits) {\n        if (hits && hits.length > 0) {\n            let hit = hits[0]\n            this.session.requestFrameOfReference('head-model').then(headFrameOfReference => {\n                this.session.requestFrameOfReference('eye-level').then((eyeLevelFrameOfReference)=>{\n                    // convert hit matrices from head to eye level coordinate systems\n                    headFrameOfReference.getTransformTo(eyeLevelFrameOfReference, workingMatrix)\n                    mat4.multiply(workingMatrix, workingMatrix, hit.hitMatrix)\n                    const node = reticleParent\n                    node.matrix.fromArray(workingMatrix)\n                    reticleParent.visible = this.visible   // it starts invisible\n                    reticle.material.color = reticleTrackedColor\n                    node.updateMatrixWorld(true)\n                })\n            })\n        } else {\n            reticle.material.color = reticleNotTrackedColor\n        }\n        requestNextHit = true\n    }\n\n    handleUpdateNode(worldMesh, object) {\n        object.seen = true\n        // we don't need to do anything if the timestamp isn't updated\n        if (worldMesh.timeStamp <= object.ts) {\n            return;\n        }\n        if (worldMesh.vertexCountChanged) {\n            let newMesh = this.newMeshNode(worldMesh)\n            object.threeMesh.geometry.dispose()\n            object.node.remove(object.threeMesh)\n            object.node.add(newMesh)\n            object.threeMesh = newMesh\n        } else {\n            if (worldMesh.vertexPositionsChanged) {\n                let position = object.threeMesh.geometry.attributes.position\n                if (position.array.length !== worldMesh.vertexPositions.length) {\n                    this.logger.error(\"position and vertex arrays are different sizes\", position, worldMesh)\n                }\n                position.setArray(worldMesh.vertexPositions);\n                position.needsUpdate = true;\n            }\n            if (worldMesh.textureCoordinatesChanged) {\n                let uv = object.threeMesh.geometry.attributes.uv\n                if (uv.array.length !== worldMesh.textureCoordinates.length) {\n                    this.logger.error(\"uv and vertex arrays are different sizes\", uv, worldMesh)\n                }\n                uv.setArray(worldMesh.textureCoordinates);\n                uv.needsUpdate = true;\n            }\n            if (worldMesh.triangleIndicesChanged) {\n                let index = object.threeMesh.geometry.index\n                if (index.array.length !== worldMesh.triangleIndices) {\n                    this.logger.error(\"uv and vertex arrays are different sizes\", index, worldMesh)\n                }\n                index.setArray(worldMesh.triangleIndices);\n                index.needsUpdate = true;\n            }\n            if (worldMesh.vertexNormalsChanged && worldMesh.vertexNormals.length > 0) {\n                // normals are optional\n                let normals = object.threeMesh.geometry.attributes.normals\n                if (normals.array.length !== worldMesh.vertexNormals) {\n                    this.logger.error(\"uv and vertex arrays are different sizes\", normals, worldMesh)\n                }\n                normals.setArray(worldMesh.vertexNormals);\n                normals.needsUpdate = true;\n            }\n        }\n        object.threeMesh.visible = this.visible\n    }\n\n    handleRemoveNode(object) {\n        this.remove(object.node)\n        object.threeMesh.geometry.dispose()\n        this.engine._removeAnchorForNode(object.node,this.logger)\n        meshMap.delete(object.worldMesh.uid)\n    }\n\n    handleNewNode(worldMesh) {\n        let worldMeshGroup = new THREE.Group();\n        var mesh = this.newMeshNode(worldMesh)\n        worldMeshGroup.add(mesh)\n        this.add(worldMeshGroup)\n        worldMeshGroup.visible = mesh.visible = this.visible\n        this.engine.addAnchoredNode(worldMesh, worldMeshGroup,this.logger)\n        meshMap.set(worldMesh.uid, {\n            ts: worldMesh.timeStamp, \n            worldMesh: worldMesh, \n            node: worldMeshGroup, \n            seen: true, \n            threeMesh: mesh\n        })\n    }\n\n    newMeshNode(worldMesh) {\n        let edgeColor, polyColor\n//        if (worldMesh instanceof XRFaceMesh) {\n//            edgeColor = '#999999'\n//           polyColor = '#999900'\n//        } else\n\n        edgeColor = '#11FF11'\n        polyColor = '#009900'\n\n        let mesh = new THREE.Group();\n        let geometry = new THREE.BufferGeometry()\n        let indices = new THREE.BufferAttribute(worldMesh.triangleIndices, 1)\n        indices.dynamic = true\n        geometry.setIndex(indices)\n\n        let verticesBufferAttribute = new THREE.BufferAttribute( worldMesh.vertexPositions, 3 )\n        verticesBufferAttribute.dynamic = true\n        geometry.addAttribute( 'position', verticesBufferAttribute );\n        let uvBufferAttribute = new THREE.BufferAttribute( worldMesh.textureCoordinates, 2 )\n        uvBufferAttribute.dynamic = true\n        geometry.addAttribute( 'uv', uvBufferAttribute );\n        if (worldMesh.vertexNormals.length > 0) {\n            let normalsBufferAttribute = new THREE.BufferAttribute( worldMesh.vertexNormals, 3 )\n            normalsBufferAttribute.dynamic = true\n            geometry.addAttribute( 'normal', normalsBufferAttribute );\n        } else {\n            geometry.computeVertexNormals()\n        }\n        // transparent mesh\n        var wireMaterial = new THREE.MeshPhongMaterial({color: edgeColor, wireframe: true})\n        var material = new THREE.MeshPhongMaterial({color: polyColor, transparent: true, opacity: 0.25})\n        mesh.add(new THREE.Mesh(geometry, material))\n        mesh.add(new THREE.Mesh(geometry, wireMaterial))\n        mesh.geometry = geometry;  // for later use\n        return mesh\n    }\n\n    ///\n    /// Given a point of interest in local coordinates (targetPos)\n    /// And a radius of consideration - sqrt(targetRadiusSq)\n    /// And a height below the target that is the acceptable highest point (targetTop)\n    /// And a height below the target that is the acceptable lowest point (targetBottom)\n    /// Find a point on the floor if any and update supplied input (targetPos)\n    /// May return false if fails to find a point\n    ///\n\n    findFloorNear(targetPos,targetRadiusSq=9,targetTop=-0.5,targetBottom=-2) {\n\n        // scratch variables\n        let meshPos = vec3.create()\n        let bestPos = vec3.create()\n        let bestY = 0\n\n        // visit all candidate meshes\n        meshMap.forEach(object => {\n\n            let worldMesh = object.worldMesh\n\n            // skip non horizontal features\n            //if(worldMesh.alignment()) return\n\n            // where is mesh center point in world coords?\n            vec3.set(meshPos, worldMesh._center.x, worldMesh._center.y, worldMesh._center.z)\n            vec3.transformMat4(meshPos,meshPos,worldMesh.modelMatrix)\n\n            // a number expressing the distance below the target Y\n            let distanceY = meshPos[1] - targetPos[1]\n\n            // candidate mesh is vertically to high?\n            if(distanceY > targetTop) return\n\n            // candidate mesh is vertically too low?\n            if(distanceY < targetBottom) return\n\n            // how far is a rough mesh extent from target in 2d in distance squared?\n            let distSq = (targetPos[0]-meshPos[0])*(targetPos[0]-meshPos[0])\n                       + (targetPos[2]-meshPos[2])*(targetPos[2]-meshPos[2])\n                       - worldMesh._extent[0] * worldMesh._extent[0]\n                       - worldMesh._extent[1] * worldMesh._extent[1]\n                       - targetRadiusSq;\n\n            // is too far away to be of interest?\n            if(distSq > 0) return\n\n            // distanceY fails to be the lowest acceptable candidate?\n            if(bestY < distanceY) return\n\n            // remember lowest area so far\n            bestY = distanceY\n            vec3.set(bestPos,targetPos[0],meshPos[1],targetPos[2])\n\n        })\n\n        // found nothing\n        if(!bestY) return false\n\n        // get local coordinates floor elevation\n        vec3.copy(targetPos,bestPos)\n\n        return true\n    }\n\n    get floorPos() {\n        return this._floorPos\n    }\n\n}\n\n","import React, {Component} from 'react'\nimport {TreeItemProvider, getDocsURL, getScriptsURL, parseOptions, on} from 'react-visual-editor-framework'\n\nimport ScriptManager, {SceneGraphProvider} from './ScriptManager'\nimport {TweenManager} from './tween'\nimport * as THREE from 'three'\nimport {Group} from 'three'\nimport {VRManager} from 'webxr-boilerplate'\nimport SceneDef from './defs/SceneDef'\nimport {ASSET_TYPES, get3DObjectDef, is3DObjectType, NONE_ASSET, parseBehaviorScript, TOTAL_OBJ_TYPES} from './Common'\nimport {AuthModule} from './AuthModule'\nimport {XRSupport} from './XRSupport'\nimport {XRWorldInfo} from './XRWorldInfo'\nimport {PubnubLogger} from '../syncgraph/PubnubSyncWrapper'\nimport {ErrorCatcher} from './ErrorCatcher'\nimport {AssetsManager} from './AssetsManager'\n\nimport {vec3} from \"gl-matrix/dist/gl-matrix.js\"\n\nimport startupsound from \"./startup-sound.m4a\"\n\nconst $ = (sel) => document.querySelector(sel)\n\n\nfunction attachUtilFunctions(obj, obj_map) {\n    obj.find = (match,list) => {\n        if(!list) list = []\n        if(match(obj)) list.push(obj)\n        if(obj.children) obj.children.forEach(ch => {\n            ch.find(match,list)\n        })\n        return list\n    }\n    obj.exists = ()=>true\n    obj.getParent = () => {\n        return obj_map[obj.parent]\n    }\n}\n\nexport class ImmersivePlayer extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            docLoaded:false,\n            title:'Loading...',\n            showErrors:false,\n            splashImage:null\n        }\n        const opts = parseOptions({})\n        if(!opts.doc) throw new Error(\"doc not specified\")\n        new TreeItemProvider(props.options)\n        this.obj_map = {}\n        this.three_map = {}\n        this.title_map = {}\n        this.previewUpdateNodes = []\n        this.current_scene = null\n        this.root = null\n        this.behavior_map = {}\n        this.behavior_assets = {}\n        this.assets_url_map = {}\n        this.pendingAssets = []\n        this.badAssets = []\n\n        this.sceneAnchor = null\n\n        this.logger = new PubnubLogger(opts.doc)\n        this.scriptManager = new ScriptManager(new Adapter(this),this.logger)\n        this.provider = {\n            accessObject:(id)=>{\n                if(!this.obj_map[id]) return {\n                    exists:()=>false,\n                }\n                return this.obj_map[id]\n            },\n            getLogger:() => this.logger,\n            getAudioListener:() => this.audioListener,\n        }\n        this.assetsManager = new AssetsManager(this.provider)\n        this.provider.assetsManager = this.assetsManager\n    }\n    getLogger() {\n        return this.logger\n    }\n\n    componentDidMount() {\n        this.logger.log(\"mounted ImmersivePlayer\")\n        this.loadDocument()\n        $(\"#progress\").value = 0\n    }\n\n    loadDocument() {\n        const opts = parseOptions({})\n        this.logger.log(\"loading assets\")\n        this.assetsManager.cacheAssetsList().then(()=> {\n            this.logger.log(\"loading document\")\n            AuthModule.getJSON(getDocsURL() + opts.doc).then((payload) => {\n                this.logger.log(\"loaded payload\", this.root)\n                this.root = payload.graph\n                this.root.children.forEach(ch => {\n                    if(ch.type === TOTAL_OBJ_TYPES.ASSETS_LIST) return this.initAssets(ch)\n                })\n\n                this.logger.log(\"the title is\",this.root.title)\n                if(this.root.splashImage && this.root.splashImage !== NONE_ASSET.id) {\n                    this.logger.log(\"the splash image is\",this.root.splashImage)\n                    const asset = this.provider.accessObject(this.root.splashImage)\n                    this.logger.log(\"the asset is\",asset)\n                    const url = this.assetsManager.getAssetURL(asset)\n                    this.logger.log(\"the url is\",url)\n                    this.setState({\n                        splashImage:url\n                    })\n                }\n\n                this.setState({\n                    title:this.root.title,\n                })\n\n                const assetsRoot = this.root.children.find(ch => ch.type === TOTAL_OBJ_TYPES.ASSETS_LIST)\n                this.validateAssets(assetsRoot).then(()=>{\n                    console.log(\"fully validated!\")\n                    $(\"#progress\").value = 100\n                    $(\"#loading-indicator\").style.display = 'none'\n                    this.setState({\n                        docLoaded:true,\n                    })\n                })\n            })\n        })\n    }\n\n    startScene() {\n        this.buildRoot(this.root)\n        this.logger.log(this.root)\n        Promise.all(this.pendingAssets).then(() => {\n            this.logger.log(\"all assets loaded now. starting script manager\")\n            this.scriptManager.startRunning()\n            if (this.root.defaultScene && this.root.defaultScene !== NONE_ASSET.id) {\n                const sc = this.root.children.find(ch => ch.id === this.root.defaultScene)\n                if(!sc) return this.logger.error(\"cannot find the default scene\")\n                this.setCurrentScene(sc)\n            } else {\n                const sc = this.root.children[0]\n                this.setCurrentScene(sc)\n            }\n            this.scriptManager.startFirstScene()\n        })\n    }\n\n    clickedStart = () => {\n        console.log(\"clicked. play the sample audio\")\n        $(\"#overlay\").style.display = 'none'\n        $(\"#test-audio\").play()\n\n        const canvas = this.canvas\n        if(XRSupport.supportsARKit()) {\n            this.xr = new XRSupport()\n            this.xr.getContext(canvas).then((context) => {\n                this.initThreeJS(canvas,context)\n                this.xr.setAnimationLoop( this.renderThreeWithCamera.bind(this))\n                this.xrWorldInfo = new XRWorldInfo(this.xr,this.logger)\n                this.scene.add(this.xrWorldInfo)\n                this.startScene()\n            }).catch(err => {\n                console.error('Error', err)\n            })\n        } else {\n            this.initThreeJS(canvas,0)\n            this.renderer.setAnimationLoop(this.renderThree.bind(this))\n            this.startScene()\n        }\n\n    }\n\n    // start-sound is from https://freesound.org/people/soneproject/sounds/244356/\n    // old one: https://vr.josh.earth/assets/sounds/clang.mp3\n    render() {\n        return <div>\n            <audio id={\"test-audio\"} src={startupsound}/>\n            <div id=\"overlay\">\n                <div id=\"inner\">\n                    <h1 id=\"title\">{this.state.title}</h1>\n                    <h2><button onClick={this.clickedStart} disabled={!this.state.docLoaded}>click to start</button></h2>\n                    \n                    <div id=\"loading-indicator\">\n                        <label>loading...</label><br></br>\n                        <progress max=\"100\" value=\"0\" id=\"progress\"/>\n                    </div>\n                    {this.renderSplashImage()}\n                </div>\n                {this.renderErrors()}\n            </div>\n            <ErrorCatcher logger={this.logger}>\n                <canvas ref={c => this.canvas = c} width={600} height={400}\n                    onClick={this.clickedCanvas}\n                />\n            </ErrorCatcher>\n        </div>\n    }\n\n    clickedCanvas = (e) => {\n        function findKnownParent(node) {\n            if(!node) return null\n            if(node.userData.graphid) return node\n            return findKnownParent(node.parent)\n        }\n\n        this.logger.log(\"clicked on the canvas\")\n        this.canvas.focus()\n        const rect = this.canvas.getBoundingClientRect();\n        const pointer = {\n            x: ( e.clientX - rect.left ) / rect.width * 2 - 1,\n            y: - ( e.clientY - rect.top ) / rect.height * 2 + 1,\n        }\n        this.raycaster.setFromCamera(pointer, this.camera);\n        const scene = this.three_map[this.current_scene.id]\n        const intersect = this.raycaster.intersectObjects(scene.children, true)\n        if(intersect && intersect.length >= 1) {\n            const inter = intersect.find(inter => inter.distance > 0)\n            if(inter) {\n                //this.logger.log(\"found the interesction\", inter)\n                //this.logger.log(\"intersections\", intersect)\n                // let obj = inter.object\n                let obj = findKnownParent(inter.object)\n\n                //this.logger.log(\"obj\", obj)\n               // if (obj.userData && obj.userData.graphid) { \n                    const gobj = this.obj_map[obj.userData.graphid]\n                    //this.logger.log(\"jobj\", gobj)\n                 //   if (gobj) {\n                        this.scriptManager.performClickAction(gobj, e)\n                  // }\n               // }\n            }\n        }\n    }\n\n    buildRoot(graph) {\n        //init assets first\n        graph.children.forEach(ch => {\n            attachUtilFunctions(ch, this.obj_map)\n            if(ch.type === TOTAL_OBJ_TYPES.SCENE) return this.initObject(ch)\n            if(ch.type === TOTAL_OBJ_TYPES.BEHAVIORS_LIST) return this.initBehaviors(ch)\n        })\n    }\n\n    initObject(obj) {\n        attachUtilFunctions(obj, this.obj_map)\n        this.obj_map[obj.id] = obj\n        if(obj.title) this.title_map[obj.title] = obj\n        let node = null\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) {\n            const scene = new SceneDef().makeNode(obj, this.provider)\n            this.three_map[obj.id] = scene\n            scene.userData.graphid = obj.id\n            this.scenes.add(scene)\n            scene.visible = false\n            node = scene\n        }\n        obj.props = () => obj\n\n        if(is3DObjectType(obj.type)) {\n            node = get3DObjectDef(obj.type).makeNode(obj, this.provider)\n            if(node.previewUpdate) this.previewUpdateNodes.push(node)\n            this.three_map[obj.id] = node\n            node.userData.graphid = obj.id\n            on(node, 'click', (e) => {\n                this.scriptManager.performClickAction(obj, e)\n            })\n        }\n        if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR) {\n            this.behavior_map[obj.id] = obj\n        }\n\n        if(obj.children) {\n            obj.children.forEach(ch => {\n                const chnode = this.initObject(ch)\n                if(chnode) node.add(chnode)\n            })\n        }\n\n        return node\n    }\n\n    initThreeJS(canvas, context) {\n        this.tweenManager = new TweenManager()\n        this.scene = new THREE.Scene();\n        this.camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 0.1, 50 );\n        this.renderer = new THREE.WebGLRenderer( { antialias: true, canvas:canvas, context:context } );\n        this.renderer.setPixelRatio( window.devicePixelRatio );\n        this.renderer.setSize( window.innerWidth, window.innerHeight );\n        this.renderer.gammaOutput = true\n        this.renderer.vr.enabled = true;\n        // this.sceneContainer.appendChild( this.renderer.domElement );\n        this.vrmanager = new VRManager(this.renderer)\n        this.audioListener = new THREE.AudioListener()\n        this.camera.add(this.audioListener)\n        if(!this.xr) this.scene.background = new THREE.Color(0x000000);\n        this.camera.matrixAutoUpdate = false\n        this.scene.add(this.camera)\n        window.addEventListener( 'resize', ()=>{\n            const body = document.documentElement\n            this.camera.aspect = body.clientWidth / body.clientHeight;\n            this.camera.updateProjectionMatrix();\n            this.renderer.setSize( body.clientWidth, body.clientHeight);\n        }, false );\n        const light = new THREE.DirectionalLight( 0xffffff, 1.0 );\n        light.position.set( 1, 1, 1 ).normalize();\n        this.scene.add( light );\n        this.scene.add(new THREE.AmbientLight(0xffffff,0.2))\n\n        this.scenes = new Group()\n        this.scene.add(this.scenes)\n\n        this.raycaster = new THREE.Raycaster();\n    }\n\n    renderThreeWithCamera = (bounds,projectionMatrix,viewMatrix, time,frame) => {\n        if(!this.scene || !this.camera) return\n        this.camera.matrix.fromArray(viewMatrix)\n        this.camera.matrixWorldNeedsUpdate = true\n        this.camera.updateMatrixWorld()\n        this.camera.projectionMatrix.fromArray(projectionMatrix)\n        if(this.xrWorldInfo) {\n            this.xrWorldInfo.refreshWorldInfo(frame)\n        }\n        this.renderThree(time,frame)\n    }\n\n    renderThree = (time, frame) => {\n        if(this.tweenManager) this.tweenManager.update(time)\n        this.previewUpdateNodes.forEach(n => n.previewUpdate())\n        if(this.pointer) this.pointer.tick(time)\n        if(this.stats) this.stats.update(time)\n        if(this.controller) this.controller.update(time)\n        let session = null\n        if(this.xr) session = this.xr.session\n        this.scriptManager.tick(time, session)\n        this.renderer.render( this.scene, this.camera );\n    }\n\n    initAssets(assets) {\n        assets.children.forEach(obj => {\n            this.logger.log(\"initing asset\",obj)\n            attachUtilFunctions(obj, this.obj_map)\n            this.obj_map[obj.id] =  obj\n            if(obj.title) this.title_map[obj.title] = obj\n            this.assets_url_map[obj.id] = obj.url\n        })\n    }\n\n    initBehaviors(behaviors) {\n        behaviors.children.forEach(ch => {\n            attachUtilFunctions(ch, this.obj_map)\n            this.obj_map[ch.id] =  ch\n            if(ch.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) {\n                const url = getScriptsURL()+ch.src\n                this.logger.log(\"loading behavior\",ch,'from',url)\n                const prom = AuthModule.fetch(url,{ method:'GET' })\n                    .then(res => res.text())\n                    .then(text => {\n                        const info = parseBehaviorScript(text)\n                        info.text = text\n                        this.behavior_assets[ch.id] = info\n                        return text\n                    }).catch((e)=>{\n                        this.logger.error(\"error loading behavior\",e)\n                    })\n                this.pendingAssets.push(prom)\n            }\n        })\n    }\n\n    setCurrentScene(scene) {\n        // @blair\n        const sceneNode = this.three_map[scene.id]\n        // this.logger.log(\"the scene node is\",sceneNode)\n        // this.logger.log(\"if it exists, scene anchor is\", sceneNode.userData.sceneAnchor)\n        if (sceneNode  && this.xr) {\n            const sceneAnchorNode = sceneNode.userData.sceneAnchor\n            if (!sceneAnchorNode) {\n                this.logger.error(\"no sceneNode? so no children?\")\n            } else {\n                if (sceneAnchorNode.children) {\n                    this.logger.log(\"scene has children: \", sceneNode.children.length)\n                    this.logger.log(\"scene anchor has children: \", sceneAnchorNode.children.length)\n                } else {\n                    this.logger.log(\"no sceneNode children?\")\n                }\n\n                if (!this.sceneAnchor || (this.sceneAnchor && scene.autoRecenter)) {\n                    // create a new scene anchor\n                    if (this.sceneAnchor) {\n                        this.xr.removeSceneAnchor(this.sceneAnchor, this.logger)\n                        this.sceneAnchor = null\n                    }\n                    this.xr.createSceneAnchor(sceneAnchorNode, this.logger).then(anchor => {\n                        this.sceneAnchor = anchor\n                    }).catch(error => {\n                        this.logger.error(`error creating new scene anchor: ${error}`)\n                    })\n                } else {\n                    this.xr.updateAnchoredSceneNode(this.sceneAnchor, sceneAnchorNode, this.logger)\n                }\n            }\n        }\n        this.scenes.children.forEach(sc => sc.visible = false)\n        if(this.three_map[scene.id]) this.three_map[scene.id].visible = true\n        this.current_scene = scene\n    }\n\n    renderSplashImage() {\n        if(this.state.splashImage) {\n            return <img src={this.state.splashImage} width=\"80%\" height=\"auto\" alt={\"splash screen\"}/>\n        } else {\n            return \"\"\n        }\n    }\n\n    validateAssets(assetsList) {\n        return Promise.all(assetsList.children.map(asset => {\n                // this.getLogger().log(\"checking asset\",asset)\n                if(asset.subtype === ASSET_TYPES.VIDEO) {\n                    return this.assetsManager.getTexture(asset.id).then(tex => {\n                        if (!tex) {\n                            this.getLogger().error(\"error loading a texture\", asset)\n                            this.addAssetLoadingError(asset)\n                        }\n                    })\n                }\n                if(asset.subtype === ASSET_TYPES.IMAGE) {\n                    return this.assetsManager.getTexture(asset.id).then(tex => {\n                        if (!tex) {\n                            this.getLogger().error(\"error loading a texture\", asset)\n                            this.addAssetLoadingError(asset)\n                        }\n                    })\n                }\n                if(asset.subtype === ASSET_TYPES.GLTF) {\n                    return this.assetsManager.getGLTF(asset.id).then(model => {\n                        if (!model) {\n                            this.getLogger().error(\"error loading a model\", asset)\n                            this.addAssetLoadingError(asset)\n                        }\n                    })\n                }\n                return Promise.resolve(\"all good\")\n            })).then((answers)=>{\n            console.log(\"fully loaded all assets now\")\n            console.log(\"error count is\",this.badAssets.length)\n            if(this.badAssets.length > 0) {\n                this.showBadAssetsDialog()\n            }\n        })\n    }\n\n    showBadAssetsDialog() {\n        this.logger.log(\"showing a bad assets dialog\")\n        this.setState({\n            showErrors:true\n        })\n    }\n    addAssetLoadingError(asset) {\n        this.badAssets.push(asset)\n    }\n    renderErrors() {\n        if(this.state.showErrors) {\n            return <div id=\"errors-dialog\">\n                <h3>Bad or Missing Assets</h3>\n                <ul>\n                {this.badAssets.map((asset,i) => {\n                    return <li key={i}><b>{asset.title}</b> <i>{asset.src}</i></li>\n                })}\n                </ul>\n                <button onClick={()=>this.setState({showErrors:false})}>dismiss</button>\n                </div>\n        }\n        return \"\"\n    }\n}\n\n// ================  SGP implementation =====================\n\nclass Adapter extends SceneGraphProvider {\n    constructor(player) {\n        super()\n        this.player = player\n        this.logger = this.player.logger\n    }\n\n    getCurrentScene() {\n        if(!this.player.current_scene) this.logger.error(\"the current scene is null\")\n        return this.player.current_scene\n    }\n    getSceneObjects(sc) {\n        return sc.children.filter(ch => is3DObjectType(ch.type))\n    }\n    getBehaviorsForObject (obj) {\n        if(!obj.children) return []\n        return obj.children.filter(ch => ch.type === TOTAL_OBJ_TYPES.BEHAVIOR)\n    }\n    getThreeObject (obj)  {\n        if (!obj) {\n            this.logger.error(\"getThreeObject got invalid obj\")\n        } else {\n            if(obj.id) return this.player.three_map[obj.id]\n        }\n        return this.player.three_map[obj]\n    }\n    getParsedBehaviorAsset (b) {\n        return this.player.behavior_assets[b.behavior]\n    }\n    getAllBehaviors () {\n        return Object.keys(this.player.behavior_map).map(key => this.player.behavior_map[key])\n    }\n    getAllScenes() {\n        return Object.keys(this.player.obj_map)\n            .map(key => this.player.obj_map[key])\n            .filter(obj => obj.type === TOTAL_OBJ_TYPES.SCENE)\n    }\n\n    navigateScene (sceneid) {\n        this.logger.log(\"navigating to \",sceneid)\n        const scene = this.player.obj_map[sceneid]\n        if(!scene) return this.logger.error(\"couldn't find scene for\",sceneid)\n        this.player.setCurrentScene(scene)\n    }\n    playMediaAsset (asset, trusted=false)  {\n        this.player.assetsManager.playMediaAsset(asset,trusted)\n    }\n\n    stopMediaAsset(asset) {\n        this.player.assetsManager.stopMediaAsset(asset)\n    }\n\n\n    getGraphObjectByName(title) {\n        return this.player.title_map[title]\n    }\n    getGraphObjectById (id) {\n        return this.player.obj_map[id]\n    }\n    getCamera() {\n        return this.player.camera\n    }\n\n    getTweenManager() {\n        return this.player.tweenManager\n    }\n\n    getFloorNear(info) {\n        if(!this.player.xr || !this.player.xr.session || !this.player.xrWorldInfo) {\n            this.logger.log(\"XR is not active?\")\n            return\n        }\n\n        let targetPos = vec3.fromValues(info.point.x,info.point.y,info.point.z)\n        let targetRadiusSq = info.targetRadiusSq || 9\n        let targetTop = info.targetTop || -0.5\n        let targetBottom = info.targetBottom || -2\n\n        if(this.player.xrWorldInfo.findFloorNear(targetPos,targetRadiusSq,targetTop,targetBottom)) {\n            return new THREE.Vector3(targetPos[0],targetPos[1],targetPos[2])\n        }\n        return 0\n    }\n\n    startLocalAnchor(info) {\n        this.logger.log(\"start or update anchor of various flavors\")\n        if(!this.player.xr || !this.player.xr.session || !this.player.xrWorldInfo) {\n            this.logger.log(\"XR is not active?\")\n            return\n        }\n        if(!info.node || !info.node.position) {\n            this.logger.log(\"Node is not present or wrong type?\")\n        }\n        switch(info.style) {\n            case \"ray\":\n                this.player.xr.updateRayAnchor(info,this.logger)\n                break\n            case \"floor\":\n            default:\n                {\n                    let point = vec3.fromValues(info.node.position.x, info.node.position.y, info.node.position.z )\n                    if(this.player.xrWorldInfo.findFloorNear(point)) {\n                        this.logger.log(\"Found a floor at \" + point[1])\n                        info.point = point\n                        // this.player.xr.updatePointAnchor(info,this.logger)\n                        // just force it there ... do not bother placing an anchor\n                        info.node.position.y = point[1]\n                    }\n                }\n                break\n        }\n    }\n\n    stopLocalAnchor(info) {\n        this.logger.log(\"stopping vanilla anchor\")\n        if(!this.player.xr || !this.player.xr.session) {\n            this.logger.log(\"XR is not active?\")\n            return\n        }\n        this.player.xr.stopAnchor(info,this.logger)\n    }\n\n    startImageRecognizer(info) {\n        this.logger.log(\"starting the image recognizer\")\n        return new Promise((res,rej) => {\n            //called when an anchor is started that wants to recognize an image\n            // WebXR loaded?\n            if(!this.player.xr || !this.player.xr.session) {\n                this.logger.log(\"XR is not active?\")\n                return\n            }\n\n            this.player.xr.createDetectionImage(info,this.logger).then((name) => {\n                // decorate the info.node with an xr anchor\n                this.player.xr.startImageRecognizer(info, name, this.logger)\n            })\n        })\n    }\n\n    stopImageRecognizer(info) {\n        this.logger.log(\"stopping the image recognizer\")\n\n        if(!this.player.xr || !this.player.xr.session) {\n            this.logger.log(\"XR is not active?\")\n            return\n        }\n\n        this.player.xr.stopImageRecognizer(info, this.logger)\n    }\n\n    startGeoTracker(info) {\n        // WebXR loaded?\n        return new Promise((res, rej) => {\n            if(!this.player.xr || !this.player.xr.session) {\n                this.logger.log(\"XR is not active?\")\n                return\n            }\n\n            this.player.xr.createGeoAnchor(info, this.logger).then(() => {\n                // decorate the info.node with an xr anchor\n                this.player.xr.addGeoAnchoredNode(info, this.logger)\n            })\n        })\n    }\n\n    stopGeoTracker(info) {\n        // WebXR loaded?\n        if(!this.player.xr || !this.player.xr.session) {\n            this.logger.log(\"XR is not active?\")\n            return\n        }\n\n        // decorate the info.node with an xr anchor\n        this.player.xr.stopGeoTracker(info, this.logger)\n    }\n\n    startWorldInfo(info) {\n        if(!this.player.xrWorldInfo) {\n            this.logger.log(\"World Info is not active?\")\n            return\n        }\n        this.player.xrWorldInfo.setVisible(true)\n    }\n\n    stopWorldInfo(info) {\n        if(!this.player.xrWorldInfo) {\n            this.logger.log(\"World Info is not active?\")\n            return\n        }\n        this.player.xrWorldInfo.setVisible(false)\n    }\n\n}\n","import React, {Component} from 'react'\n// import './App.css'\nimport VREditor from './vr/VREditor'\nimport {ImmersivePlayer} from './vr/ImmersivePlayer'\nimport {PopupManagerContext} from 'appy-comps'\nimport {AuthModule} from './vr/AuthModule'\n\nexport default class App extends Component {\n    getApp() {\n        this.props.options.AuthModule = AuthModule\n        if(this.props.options.mode === 'play') {\n            return <ImmersivePlayer options={this.props.options}/>\n        }\n        this.provider = new VREditor(this.props.options)\n        this.provider.popupManager = this.context\n        return this.provider.getApp()\n    }\n\n    render() {\n        return this.getApp()\n    }\n}\nApp.contextType = PopupManagerContext\n\n\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport '@fortawesome/fontawesome-free/css/all.css'\nimport App from './App';\nimport {parseOptions} from 'react-visual-editor-framework'\nimport {PopupManager, PopupManagerContext} from 'appy-comps'\n\nconst default_options = {\n    mode: 'edit',\n}\nconst options = parseOptions(default_options)\nconsole.log(\"options is\",options);\n\nfunction init() {\n    return <PopupManagerContext.Provider value={new PopupManager()}>\n        <App options={options}/>\n    </PopupManagerContext.Provider>\n}\n\nReactDOM.render(init(), document.getElementById(\"root\"));\n\n","/**\n * Created by josh on 11/29/16.\n */\nmodule.exports = {\n    adds: [],\n    add: function add(note) {\n        this.adds.forEach(cb => cb(note))\n    },\n    onAdd: function onAdd(cb) {\n        this.adds.push(cb);\n    },\n    offAdd: function offAdd(cb) {\n        this.adds = this.adds.filter(n => n !== cb)\n    }\n}\n","module.exports = __webpack_public_path__ + \"static/media/startup-sound.8786b4e1.m4a\";"],"sourceRoot":""}