{"version":3,"sources":["utils.js","SelectionManager.js","vr/AuthModule.js","TreeItemProvider.js","syncgraph/UndoQueue.js","metadoc/EventCoalescer.js","syncgraph/PubnubSyncWrapper.js","syncgraph/utils.js","common/Dialog.js","syncgraph/MissingDocDialog.js","syncgraph/SyncGraphProvider.js","common/GridEditorApp.js","common/TreeTable.js","common/HSLUVColorPicker.js","common/StringEditor.js","common/EnumEditor.js","common/ArrayEditor.js","common/PropSheet.js","vr/TransformControls.js","vr/SkeletonUtils.js","vr/defs/ObjectDef.js","vr/defs/CubeDef.js","vr/defs/SphereDef.js","vr/defs/PlaneDef.js","vr/defs/ModelDef.js","vr/defs/BG360Def.js","vr/defs/TextDef.js","vr/defs/Image2DDef.js","vr/defs/GroupDef.js","vr/defs/GPUParticles.js","vr/defs/ParticlesDef.js","vr/defs/PortalDef.js","vr/defs/LocalAnchorDef.js","vr/defs/ImageAnchorDef.js","vr/defs/GeoAnchorDef.js","vr/defs/HudAnchorDef.js","vr/defs/CloneDef.js","vr/Common.js","vr/defs/SceneDef.js","vr/GLTFLoader.js","vr/ScriptManager.js","common/tween.js","vr/XRSupport.js","vr/OrbitControls.js","vr/VRCanvas.js","vr/TranslationArrow.js","vr/TranslateControl.js","vr/panel2d/panel2d.js","vr/panel2d/component2d.js","vr/panel2d/button2d.js","vr/panel2d/group2d.js","vr/3dof.js","vr/Actions.js","vr/ImmersiveVREditor.js","common/InputManager.js","vr/AssetActions.js","vr/dialogs/AddImageAssetDialog.js","vr/dialogs/AddGLTFAssetDialog.js","vr/dialogs/AddGLBAssetDialog.js","vr/dialogs/AddAudioAssetDialog.js","vr/dialogs/UnsavedDocumentDialog.js","vr/DRACOLoader.js","vr/GLTFAssetView.js","vr/GeoAssetView.js","metadoc/AssetView.js","syncgraph/GraphAccessor.js","vr/dialogs/OpenFileDialog.js","vr/dialogs/OpenAssetDialog.js","vr/ScriptEditor.js","vr/dialogs/OpenScriptDialog.js","vr/Templates.js","common/QRCanvas.js","vr/dialogs/QRDialog.js","vr/dialogs/PasswordDialog.js","vr/dialogs/GithubAuthDialog.js","vr/ErrorCatcher.js","vr/GifSupport.js","vr/AssetsManager.js","vr/dialogs/SaveDocumentAsDialog.js","vr/dialogs/BadAssetsDialog.js","vr/ToasterNotification.js","vr/ConsoleView.js","vr/VREditor.js","vr/XRWorldInfo.js","vr/ImmersivePlayer.js","App.js","index.js","vr/ToasterManager.js","vr/startup-sound.m4a"],"names":["parseOptions","opts","loc","document","location","search","substring","split","forEach","part","keyval","on","elem","type","cb","addEventListener","toFlatString","obj","JSON","stringify","makePoint","x","y","minus","pt","this","add","divide","v","multiply","idivide","Math","floor","distance","dx","dy","sqrt","equals","toString","concat","setQuery","oldOpts","final","Object","keys","key","query","map","join","window","history","pushState","toQueryString","SELECTION_MANAGER","src_SelectionManager","SelectionManager","props","classCallCheck","listeners","selected","dropTarget","clip","push","index","indexOf","splice","value","node","fire","length","dropType","USER_CHANGE","AuthModule","AuthModuleSingleton","_this","login","res","win","open","url","authCallback","focus","logout","localStorage","clear","doclistSupported","msg","setUserData","data","payload","close","removeEventListener","ToasterMananager","supported","docDeleteSupported","assetUploadSupported","scriptEditingSupported","passwordSupported","connected","serverID","random","_this2","isLoggedIn","fetch","getInfoURL","then","json","info","console","authentication","assetUpload","scriptEditing","replace","getJSON","getUserURL","success","getItem","password","_this3","setItem","log","accessToken","getAccessToken","options","mode","cache","headers","status","Error","statusText","method","Content-Type","file","getAssetsURL","name","body","TREE_ITEM_PROVIDER","EXPANDED_CHANGED","STRUCTURE_CHANGED","STRUCTURE_ADDED","STRUCTURE_REMOVED","PROPERTY_CHANGED","CLEAR_DIRTY","SAVED","DOCUMENT_SWAPPED","URLS","BASE","getDocsURL","getScriptsURL","AUTO_DETECT_GLITCH","TreeItemProvider","possibleConstructorReturn","getPrototypeOf","call","genID","prefix","save","getSceneRoot","payload_obj","doc","getDocType","id","getDocId","payload_string","docid","doctype","catch","e","hasChildren","item","children","getChildren","expanded_map","SERVER_URL","host","endsWith","calculateServerUrl","init","filter","list","current","isExpanded","def","root","provider","setDocument","warn","makeEmptyRoot","spath","generateSelectionPath","Selection","getSelection","newsel","findNodeFromSelectionPath","setSelection","Promise","rej","FormData","append","size","xml","XMLHttpRequest","onreadystatechange","readyState","response","responseType","setRequestHeader","send","child","parent","sibling","require","SET_PROPERTY","CREATE_PROPERTY","DELETE_PROPERTY","CREATE_OBJECT","DELETE_OBJECT","INSERT_ELEMENT","DELETE_ELEMENT","UndoQueue","graph","createClass","op","last","getHostId","seq","nextSeq","timestamp","Date","now","array","entry","entryid","process","object","prevValue","makeGUID","prev","i","EventCoalescer","onChange","onRawChange","rawlisteners","fireRaw","getPropertiesForObject","getArrayLength","getElementAt","paused","buffer","first","getPropertyValue","bufferOp","settings","publishKey","subscribeKey","PubnubSyncWrapper","handleGraphChange","pubnub","PubNub","logger","PubnubLogger","getServerID","addListener","operation","category","sendHistoryRequest","message","m","handleMessage","subscribe","channels","calculateChannelName","calculateLoggerChannelName","sendMessage","unsubscribe","stop","str","uuid","publish","channel","getDataGraph","hist","getHistory","slice","count","chunk","_this4","evt","handleGetHistory","handleReceiveHistory","error","publisher","getUUID","getListeners","makePayload","Array","from","arguments","inspect","depth","arr","ConsoleLogger","listToArray","prototype","fetchGraphObject","objid","propToArray","CH","len","ch","insertAsFirstChild","setProperty","insertAfter","insertAsLastChild","removeFromParent","n","target","findIndex","removeElement","Dialog","_Component","_getPrototypeOf2","_len","args","_key","apply","clickedScrim","scrim","onScrimClick","inherits","visible","react_default","a","createElement","bodyStyle","width","height","className","ref","onClick","style","Component","MissingDocDialog","cancel","DialogManager","hide","okay","createNewDocument","Dialog_Dialog","DocGraph","CommandGenerator","toDocGraphFromObjectGraph","toObjectGraphFromDocGraph","SyncGraphProvider","getDocTitle","getDocHistory","getDocGraph","getObjectByProperty","getRawGraph","coalescer","syncdoc","hasPropertyValue","expanded","preventDefault","title","docLoaded","resolve","toggleConnected","unpause","pause","isConnected","pauseQueue","unpauseQueue","performUndo","undoqueue","canUndo","undo","performRedo","canRedo","redo","datalisteners","loadDoc","cmd","propKey","oldValue","newValue","showMissingDocDialog","makeDocFromServerHistory","setupDocFlow","makeDocFromServerGraph","shutdown","submit","clearSelection","start","_this5","newDocId","setDocTitle","new_doc","show","MissingDocDialog_MissingDocDialog","GridLayout","clss","leftWidth","rightWidth","showLeft","showRight","gridTemplateColumns","Spacer","ToggleButton","rest","objectWithoutProperties","assign","MenuPopup","es","actions","act","divider","enabled","disabled","PopupManager","fun","icon","ContextMenu","menu","TreeTableItem","onSelect","shiftKey","selMan","addToSelection","onContextMenu","stopPropagation","calculateContextMenu","TreeTable_ContextMenu","toggleItemCollapsed","onDragStart","onDragOver","onDragEnd","onDrop","cls","isSelected","getDropTarget","getDropType","arrow","prov","data-nodeid","getRendererForItem","GridEditorApp_Spacer","renderDragBars","canBeMoved","draggable","TreeTable","dataTransfer","effectAllowed","setData","parentNode","setDragImage","dropEffect","setState","dragTarget","internalDrag","state","canAddExternalChild","setDropTarget","setDropType","canAddChild","canBeSibling","src","dst","parent2","acceptDrop","generateChildren","chs","selection","listener","other_listener","sel","off","newProps","TreeTable_TreeTableItem","HSLUVColorPicker","mousePress","canvasToPoint","lightness","redraw","pressed","mouseMove","mouseUp","drawPicker","drawSlider","drawIndicator","livalToCanvas","l","mouseToCanvas","bounds","getBoundingClientRect","clientX","clientY","mousePressSlider","sliderPressed","hue","canvasToHue","setTimeout","mouseMoveSlider","mouseUpSlider","color","hsluv","hsluvToHex","comps","hexToHsluv","canvasBounds","canvas","h","w","c","getContext","j","fillStyle","fillRect","g","cp","strokeStyle","strokeRect","lineWidth","slider","hueToCanvas","indicator","display","flexDirection","alignItems","can","onMouseDown","onMouseMove","onMouseUp","StringEditor","keypressed","charCode","onCommit","prop","hasHints","getHints","multiline","onBlur","onKeyPress","EnumPicker","Rend","renderer","items","values","val","DefaultEnumRenderer","EnumEditor","EnumEditor_EnumPicker","calculateValues","calculateRenderer","selectValue","renderValue","proxy","getRendererForEnum","getKey","vals","getValuesForEnum","ArrayEditor","addValue","showEditor","enumChanged","renderValues","renderEditor","Renderer","deleteItem","EnumEditor_EnumEditor","TYPES","STRING","NUMBER","BOOLEAN","ENUM","COLOR","GROUP","PropEditor","changed","isType","isLive","setValue","updateNum","checked","customChanged","colorChanged","commit","hasOwnProperty","min","max","isNaN","parseFloat","numberKeyDown","booleanChanged","arrayChanged","openColorEditor","HSLUVColorPicker_HSLUVColorPicker","getValue","nextProps","nextState","getType","isCustom","createCustomEditor","isLocked","StringEditor_StringEditor","step","hints","incrementValue","onKeyDown","backgroundColor","ArrayEditor_ArrayEditor","PropSheet","h2","hand","s","calculateGroups","calculateProps","getName","renderIndeterminate","PropSheet_PropEditor","isIndeterminate","getFullSelection","getProperties","A","B","pa","find","pb","multi","MultiPropProxy","match","addSubProxy","PropProxy","p","group_keys","getGroupKeys","subs","sub","same","custom","locked","live","setPropertyValue","group","THREE","TransformControls","camera","domElement","Object3D","undefined","_gizmo","TransformControlsGizmo","_plane","TransformControlsPlane","scope","defineProperty","changeEvent","mouseDownEvent","mouseUpEvent","objectChangeEvent","ray","Raycaster","_tempVector","Vector3","_tempVector2","_tempQuaternion","Quaternion","_unit","X","Y","Z","_identityQuaternion","_alignVector","pointStart","pointEnd","rotationAxis","rotationAngle","cameraPosition","cameraQuaternion","cameraScale","parentPosition","parentQuaternion","parentScale","worldPositionStart","worldQuaternionStart","worldScaleStart","worldPosition","worldQuaternion","worldScale","eye","_positionStart","_quaternionStart","_scaleStart","propName","defaultValue","propValue","get","set","dispatchEvent","getPointer","event","pointer","changedTouches","rect","left","top","button","onContext","onPointerHover","pointerHover","onPointerDown","onPointerMove","pointerDown","pointerMove","onPointerUp","pointerUp","dispose","attach","detach","axis","updateMatrixWorld","matrixWorld","decompose","PerspectiveCamera","copy","normalize","OrthographicCamera","dragging","setFromCamera","intersect","intersectObjects","picker","planeIntersect","space","snap","rotationSnap","rotation","round","z","position","quaternion","scale","point","applyQuaternion","clone","inverse","translationSnap","setFromMatrixPosition","d","dot","ROTATION_SPEED","distanceTo","unit","cross","angleTo","setFromAxisAngle","getMode","setMode","setTranslationSnap","setRotationSnap","setSize","setSpace","update","create","constructor","isTransformControls","gizmoMaterial","MeshBasicMaterial","depthTest","depthWrite","transparent","side","DoubleSide","fog","gizmoLineMaterial","LineBasicMaterial","linewidth","matInvisible","opacity","matHelper","matRed","matGreen","matBlue","matWhiteTransperent","matYellowTransparent","matCyanTransparent","matMagentaTransparent","matLineRed","matLineGreen","matLineBlue","matLineCyan","matLineMagenta","matLineYellow","matLineGray","matLineYellowTransparent","arrowGeometry","CylinderBufferGeometry","scaleHandleGeometry","BoxBufferGeometry","lineGeometry","BufferGeometry","addAttribute","Float32BufferAttribute","geometry","CircleGeometry","radius","arc","vertices","cos","PI","sin","gizmoTranslate","Mesh","Line","XYZ","OctahedronBufferGeometry","XY","PlaneBufferGeometry","YZ","XZ","pickerTranslate","helperTranslate","START","END","DELTA","gizmoRotate","E","XYZE","helperRotate","AXIS","pickerRotate","TorusBufferGeometry","SphereBufferGeometry","gizmoScale","XYZX","XYZY","XYZZ","pickerScale","helperScale","setupGizmo","gizmoMap","gizmo","tag","updateMatrix","tempGeometry","applyMatrix","matrix","tempVector","tempEuler","Euler","alignVector","zeroVector","lookAtMatrix","Matrix4","tempQuaternion","tempQuaternion2","identityQuaternion","unitX","unitY","unitZ","helper","handles","handle","eyeDistance","multiplyScalar","abs","setFromRotationMatrix","lookAt","atan2","multiplyQuaternions","showX","showY","showZ","material","_opacity","_color","lerp","Color","some","setFromEuler","isTransformControlsGizmo","wireframe","dirVector","tempMatrix","isTransformControlsPlane","targetParentPos","targetPos","sourceParentPos","sourcePos","targetDir","sourceDir","pos","quat","bindBoneMatrix","relativeMatrix","globalMatrix","ObjectDef","parseInt","tx","ty","tz","asset","NONE_ASSET","assetsManager","getTexture","tex","getLogger","alphaTest","MeshLambertMaterial","err","COUNTER","CubeDef","scene","createObject","OBJ_TYPES","cube","rx","ry","rz","sx","sy","sz","createArray","BoxGeometry","userData","clickable","attachAsset","PROP_DEFS","esm_get","SphereDef","sphere","PlaneDef","SkeletonUtils","retarget","source","preserveMatrix","preservePosition","preserveHipPosition","useTargetMatrix","hip","names","bindBones","bone","boneTo","bonesPosition","sourceBones","isObject3D","skeleton","bones","getBones","pose","identity","offsets","getBoneByName","getInverse","setFromMatrixScale","makeRotationFromQuaternion","boneIndex","wBindMatrix","boneInverses","copyPosition","isBone","setPosition","retargetClip","useFirstFramePosition","fps","getHelperFromSkeleton","positionOffset","boneData","numFrames","duration","delta","convertedTracks","mixer","AnimationMixer","boneDatas","clipAction","play","time","times","Float32Array","toArray","VectorKeyframeTrack","QuaternionKeyframeTrack","uncacheAction","AnimationClip","SkeletonHelper","getSkeletonOffsets","Vector2","nameKeys","nameValues","boneParent","getNearestBone","boneToParent","subVectors","laterialAngle","angle","offset","makeRotationFromEuler","renameBones","isArray","findBoneTrackData","tracks","regexp","result","trackData","exec","getEqualsBonesNames","targetSkeleton","targetBones","boneName","sourceLookup","Map","cloneLookup","parallelTraverse","b","callback","sourceNode","clonedNode","traverse","isSkinnedMesh","clonedMesh","sourceMesh","bindMatrix","bind","ModelDef","clicker","enter","scriptManager","model","currentClip","action","shouldPlay","exit","accessObject","tick","dt","deltaTime","useClip","findByName","clips","currentClipName","stopAllAction","uncacheRoot","getRoot","validate","optimize","remove","getGLTF","gltf","scenes","animations","boundingBox","setFromObject","boundingBoxSize","getSize","BoundingBoxCenter","getCenter","setClips","BG360Def","bg360","imageOffsetAngle","imageCropStartAngle","imageCropEndAngle","mat","onBeforeCompile","shader","uniforms","vertexShader","fragmentShader","matShader","customize","TextDef","text","cssStyle","div","innerHTML","classList","setAttribute","divLayer","WebLayer3D","pixelRatio","devicePixelRatio","onLayerCreate","layer","mesh","graphid","refresh","previewUpdate","setText","regenerateText","Image2DDef","img2d","ratio","GroupDef","Group","GPUParticleShader","UPDATEABLE_ATTRIBUTES","GPUParticles","blending","NormalBlending","PARTICLE_COUNT","maxParticles","PARTICLE_CURSOR","DPR","particleUpdate","onTick","reverseTime","fadeIn","fadeOut","rand","sprite","particleSpriteTex","ctx","beginPath","fill","CanvasTexture","wrapS","wrapT","RepeatWrapping","ShaderMaterial","uTime","uScale","tSprite","defaultAttributeValues","particlePositionsStartTime","particleVelColSizeLife","BufferAttribute","setDynamic","particleSystem","Points","frustumCulled","attr","getAttribute","updateRange","itemSize","needsUpdate","ttime","geometryUpdate","old","velocity","acceleration","endColor","positionStartAttribute","startTimeAttribute","velocityAttribute","accelerationAttribute","colorAttribute","endcolorAttribute","sizeAttribute","lifeTimeAttribute","lifetime","sizeRandomness","r","ParticlesDef","particles","pointSize","startColor","texture","positionRandomness","baseVelocity","velocityRandomness","baseColor","colorRandomness","AdditiveBlending","system","spawnParticle","attachTexture","exists","getAssetURL","TextureLoader","load","updateSprite","THREEReflector","childrenMode","textureWidth","textureHeight","clipBias","ReflectorShader","recursion","reflectorPlane","normal","reflectorWorldPosition","cameraWorldPosition","scratchMatrix","clipPlane","viewport","view","q","textureMatrix","virtualCamera","parameters","minFilter","magFilter","format","stencilBuffer","renderTarget","isPowerOfTwo","generateMipmaps","privateScene","privateLight1","intensity","privateLight2","onBeforeRender","portalParentGroup","extractRotation","portalDirection","applyMatrix4","portalInverse","projectionMatrix","matrixWorldInverse","setFromNormalAndCoplanarPoint","constant","sign","elements","currentRenderTarget","getRenderTarget","currentVrEnabled","vr","currentShadowAutoUpdate","shadowMap","autoUpdate","currentClearColor","getClearColor","currentClearAlpha","getClearAlpha","setRenderTarget","setClearColor","setClearAlpha","render","getPixelRatio","tDiffuse","PortalDef","portal","LocalAnchorDef","localanchor","recType","REC_TYPES","SCENE_START","sgp","startLocalAnchor","stopLocalAnchor","ImageAnchorDef","imageanchor","reactivate","targetImage","imageRealworldWidth","preview","toRad","updateImagePreview","image","getGraphObjectById","fireEventAtTarget","startImageRecognizer","stopImageRecognizer","GeoAnchorDef","geoanchor","targetGeoLocation","startGeoTracker","stopGeoTracker","HudAnchorDef","_ObjectDef","hudanchor","getCamera","getThreeObject","CloneDef","cloneTarget","theClone","fireSceneLifecycleEventAtChild","stdhints","description","defaultFloor","subtype","splashImage","fontSize","padding","borderWidth","borderRadius","horizontalAlign","textColor","borderColor","drawBackground","scriptBody","defaultScene","latitude","longitude","altitude","useAltitude","autoRecenter","SIMPLE_COLORS","plane","TOTAL_OBJ_TYPES","SCENE","ASSET","BEHAVIOR","BEHAVIOR_SCRIPT","ASSETS_LIST","BEHAVIORS_LIST","ROOT","HORIZONTAL_ALIGNMENT","LEFT","CENTER","RIGHT","is3DObjectType","canHaveShape","canBeDeleted","get3DObjectDef","degrees","MIME_TYPES","PNG","JPEG","GIF","MP3","AAC","WAV","JAVASCRIPT","GLB","MP4","MOV","ASSET_TYPES","IMAGE","GLTF","AUDIO","VIDEO","GEOLOCATION","isImageType","toLowerCase","ITEM_ICONS","assets","behavior","behavior_script","audio","video","geolocation","cut","paste","delete","parseBehaviorScript","contents","Function","SceneDef","createGraphObjectFromObject","generateUniqueTitle","sc","setDefaultFloor","sceneAnchor","chNode","chObj","parts","GLTFLoader","manager","DefaultLoadingManager","dracoLoader","GLTFRegistry","objects","removeAll","crossOrigin","onLoad","onProgress","onError","resourcePath","path","LoaderUtils","extractUrlBase","itemStart","_onError","itemError","itemEnd","loader","FileLoader","setPath","setResponseType","parse","setCrossOrigin","setResourcePath","setDRACOLoader","content","extensions","decodeText","Uint8Array","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","KHR_BINARY_GLTF","GLTFBinaryExtension","version","extensionsUsed","extensionName","extensionsRequired","KHR_LIGHTS_PUNCTUAL","GLTFLightsExtension","KHR_MATERIALS_UNLIT","GLTFMaterialsUnlitExtension","KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS","GLTFMaterialsPbrSpecularGlossinessExtension","KHR_DRACO_MESH_COMPRESSION","GLTFDracoMeshCompressionExtension","MSFT_TEXTURE_DDS","GLTFTextureDDSExtension","KHR_TEXTURE_TRANSFORM","GLTFTextureTransformExtension","GLTFParser","DDSLoader","ddsLoader","extension","lightDefs","lights","loadLight","lightIndex","lightNode","lightDef","fromArray","range","DirectionalLight","PointLight","SpotLight","spot","innerConeAngle","outerConeAngle","penumbra","decay","getMaterialType","extendParams","materialParams","materialDef","parser","pending","metallicRoughness","pbrMetallicRoughness","baseColorFactor","baseColorTexture","assignTexture","all","BINARY_EXTENSION_HEADER_LENGTH","BINARY_EXTENSION_CHUNK_TYPES","BIN","headerView","DataView","header","magic","getUint32","chunkView","chunkIndex","byteLength","chunkLength","chunkType","contentArray","byteOffset","specularGlossinessParams","pbrSpecularGlossiness","ShaderLib","UniformsUtils","specularMapParsFragmentChunk","glossinessMapParsFragmentChunk","specularMapFragmentChunk","glossinessMapFragmentChunk","lightPhysicalFragmentChunk","roughness","metalness","roughnessMap","metalnessMap","specular","setHex","glossiness","specularMap","glossinessMap","defines","STANDARD","diffuseFactor","diffuseTexture","emissive","glossinessFactor","specularFactor","specularGlossinessTexture","specGlossMapDef","createMaterial","params","isGLTFSpecularGlossinessMaterial","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalScale","displacementMap","displacementScale","displacementBias","alphaMap","envMap","envMapIntensity","refractionRatio","derivatives","cloneMaterial","il","refreshUniforms","uvScaleMap","diffuse","isWebGLRenderTarget","matrixAutoUpdate","uvTransform","flipEnvMap","isCubeTexture","reflectivity","maxMipLevel","properties","__maxMipLevel","USE_GLOSSINESSMAP","USE_ROUGHNESSMAP","GLTFCubicSplineInterpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","Interpolant","decodePrimitive","primitive","bufferViewIndex","bufferView","gltfAttributeMap","attributes","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","attributeName","threeAttributeName","ATTRIBUTES","accessorDef","accessors","componentType","WEBGL_COMPONENT_TYPES","normalized","getDependency","decodeDracoFile","attribute","extendTexture","transform","repeat","texCoord","copySampleValue_","valueSize","beforeStart_","afterEnd_","interpolate_","i1","t0","t","t1","stride","stride2","stride3","td","pp","ppp","offset1","offset0","s2","s3","s0","s1","p0","m0","p1","m1","defaultMaterial","WEBGL_CONSTANTS","Number","Matrix3","Vector4","Texture","5120","Int8Array","5121","5122","Int16Array","5123","Uint16Array","5125","Uint32Array","5126","WEBGL_FILTERS","9728","NearestFilter","9729","LinearFilter","9984","NearestMipMapNearestFilter","9985","LinearMipMapNearestFilter","9986","NearestMipMapLinearFilter","9987","LinearMipMapLinearFilter","WEBGL_WRAPPINGS","33071","ClampToEdgeWrapping","33648","MirroredRepeatWrapping","10497","WEBGL_TYPE_SIZES","BackSide","FrontSide","NeverDepth","LessDepth","EqualDepth","LessEqualDepth","GreaterEqualDepth","NotEqualDepth","AlwaysDepth","AddEquation","SubtractEquation","ReverseSubtractEquation","ZeroFactor","OneFactor","SrcColorFactor","OneMinusSrcColorFactor","SrcAlphaFactor","OneMinusSrcAlphaFactor","DstAlphaFactor","OneMinusDstAlphaFactor","DstColorFactor","OneMinusDstColorFactor","SrcAlphaSaturateFactor","SCALAR","VEC2","VEC3","VEC4","MAT2","MAT3","MAT4","POSITION","NORMAL","TANGENT","TEXCOORD_0","TEXCOORD_1","COLOR_0","WEIGHTS_0","JOINTS_0","PATH_PROPERTIES","translation","weights","INTERPOLATION","CUBICSPLINE","LINEAR","InterpolateLinear","STEP","InterpolateDiscrete","ALPHA_MODES","MIME_TYPE_FORMATS","image/png","RGBAFormat","image/jpeg","RGBFormat","resolveURL","test","addUnknownExtensionsToUserData","knownExtensions","objectDef","gltfExtensions","assignExtrasToUserData","gltfDef","extras","updateMorphTargets","meshDef","morphTargetInfluences","targetNames","morphTargetDictionary","createAttributesKey","attributesKey","sort","cloneBufferAttribute","isInterleavedBufferAttribute","getX","getY","getZ","getW","primitiveCache","textureLoader","fileLoader","addPrimitiveAttributes","primitiveDef","assignAttributeAccessor","accessorIndex","accessor","gltfAttributeName","indices","setIndex","targets","hasMorphPosition","hasMorphNormal","pendingPositionAccessors","pendingNormalAccessors","pendingAccessor","morphPositions","morphNormals","positionAttribute","jl","setXYZ","normalAttribute","morphAttributes","addMorphTargets","markDefs","getDependencies","dependencies","cameras","nodeDefs","nodes","skinDefs","skins","meshDefs","meshes","meshReferences","meshUses","skinIndex","skinLength","joints","nodeIndex","nodeLength","nodeDef","skin","cacheKey","dependency","loadScene","loadNode","loadMesh","loadAccessor","loadBufferView","loadBuffer","loadMaterial","loadTexture","loadSkin","loadAnimation","loadCamera","defs","bufferIndex","bufferDef","buffers","uri","reject","bufferViewDef","bufferViews","sparse","pendingBufferViews","bufferAttribute","TypedArray","elementBytes","BYTES_PER_ELEMENT","itemBytes","byteStride","ibCacheKey","ib","InterleavedBuffer","InterleavedBufferAttribute","itemSizeIndices","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","setArray","setX","setY","setZ","setW","textureIndex","URL","webkitURL","textureDef","textures","textureExtensions","sourceURI","images","isObjectURL","blob","Blob","mimeType","createObjectURL","Loader","Handlers","revokeObjectURL","flipY","sampler","samplers","mapName","mapDef","isCompressedTexture","assignFinalMaterial","useVertexTangents","tangent","useVertexColors","useFlatShading","useSkinning","useMorphTargets","useMorphNormals","isPoints","pointsMaterial","PointsMaterial","Material","isLine","lineMaterial","cachedMaterial","skinning","vertexTangents","vertexColors","VertexColors","flatShading","morphTargets","uv2","uv","materialIndex","materialType","materials","materialExtensions","sgExtension","kmuExtension","MeshStandardMaterial","metallicFactor","roughnessFactor","metallicRoughnessTexture","doubleSided","alphaMode","alphaCutoff","normalTexture","occlusionTexture","strength","emissiveFactor","emissiveTexture","encoding","sRGBEncoding","loadGeometries","primitives","createDracoPrimitive","dracoExtension","geometryPromise","cached","promise","meshIndex","originalMaterials","geometries","SkinnedMesh","normalizeSkinWeights","drawMode","TriangleStripDrawMode","TriangleFanDrawMode","LineSegments","LineLoop","cameraIndex","cameraDef","radToDeg","yfov","aspectRatio","znear","zfar","xmag","ymag","skinDef","skinEntry","inverseBindMatrices","animationIndex","animationDef","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","input","output","inputAccessors","outputAccessors","inputAccessor","outputAccessor","TypedKeyframeTrack","NumberKeyframeTrack","targetName","interpolation","isMesh","track","createInterpolant","getValueSize","isInterpolantFactoryMethodGLTFCubicSpline","Bone","instanceNum","o","light","PropertyBinding","sanitizeNodeName","buildNodeHierachy","nodeId","parentObject","pendingJoints","jointNodes","isGroup","jointNode","Skeleton","sceneIndex","sceneDef","Scene","nodeIds","SceneGraphProvider","beh","vol","SystemFacade","tween","getTweenManager","globalStorage","storage","getGraphObjectByName","trusted","_event","isTrusted","AssetFacade","getObjectById","getCurrentScene","fireSceneLifecycleEvent","navigateScene","fireMessageAtTarget","captureEvent","ScriptManager","sceneGraphProvider","running","system_cache","bubbling","getAllScenes","graphTarget","getParsedBehaviorAsset","getSystemFacadeFromCache","code","startTime","lastTime","session","parentId","stopRunning","fireLifecycleEvent","destroyListeners","getBehaviorsForObject","playMediaAsset","isMediaAssetPlaying","stopMediaAsset","setMediaVolume","Tween","WaitTween","dur","ActionTween","fn","ForeverTween","diff","PROP_TYPES","SINGLE","COMPOUND","LERP_TYPES","ELASTIC","easeLinear","to","PropTween","property","propertyType","lerp_type","lerpType","loop","loopCount","reversed","autoReverse","pow","easeOutElastic","ClipTween","_this6","speed","setLoop","Infinity","setEffectiveTimeScale","prevTime","ParallelTween","_this7","isAlive","SequentialTween","_this8","_startNext","cur","TweenManager","Cesium","XRGeospatialAnchor","XRSupport","imageDetectorMap","geoAnchorMap","_workingMatrix","mat4","_identity","_vec","vec3","lastFrameTime","heightAboveFloor","device","xrCanvas","xrContext","context","_anchoredNodes","that","navigator","xr","requestDevice","xrDevice","requestSession","outputContext","alignEUS","worldSensing","xrSession","useEstimatedElevation","updateGeoElevationLoop","nonStandard_setNumberOfTrackedImages","compatibleXRDevice","baseLayer","XRWebGLLayer","_updateGeoElevationLoop","asyncToGenerator","regenerator_default","mark","_callee","sleep","wrap","_context","next","userAnimationCallback","requestFrameOfReference","frameOfReference","headFrameOfReference","eyeLevelFrameOfReference","__handleAnimationFrame","_handleAnimationFrame","requestAnimationFrame","frame","ended","getDevicePose","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","views","Symbol","iterator","done","getViewport","getViewMatrix","return","anchor","uid","modelMatrix","_handleAnchorUpdateCallback","_handleAnchorUpdate","_handleAnchorDeleteCallback","_handleAnchorDelete","_createSceneAnchor","_callee2","sceneNode","eyeLevel","newAnchor","_context2","abrupt","sent","getTransformTo","getTranslation","fromTranslation","addAnchor","addAnchoredNode","_x","_x2","_removeAnchorFromNode","removeAnchor","screenx","screeny","normalizedX","normalizedY","rayorigin","invert","raydir","fromValues","transformMat4","headLevel","requestHitTest","xrhitresults","_removeAnchorForNode","img","Image","onload","det","realWorldWidth","_fetchImage","idata","toConsumableArray","drawImage","getImageData","documentURI","ToasterManager","nonStandard_createDetectionImage","anchorName","nonStandard_activateDetectionImage","anchorStyle","nonStandard_deactivateDetectionImage","lla","Cartographic","createGeoAnchor","getDefaultElevation","getDeviceCartographic","cartographic","details","_this9","anchoredNode","_mozillaXRViewer","OrbitControls","quatInverse","lastPosition","lastQuaternion","minDistance","maxDistance","minZoom","maxZoom","minPolarAngle","maxPolarAngle","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","keyPanSpeed","autoRotate","autoRotateSpeed","enableKeys","UP","BOTTOM","mouseButtons","ORBIT","MOUSE","ZOOM","MIDDLE","PAN","target0","position0","zoom0","zoom","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","saveState","reset","updateProjectionMatrix","STATE","NONE","setFromUnitVectors","up","setFromVector3","rotateLeft","sphericalDelta","makeSafe","panOffset","setFromSpherical","zoomChanged","distanceToSquared","EPS","onMouseWheel","onTouchStart","onTouchEnd","onTouchMove","startEvent","endEvent","ROTATE","DOLLY","TOUCH_ROTATE","TOUCH_DOLLY","TOUCH_PAN","Spherical","rotateStart","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","getZoomScale","rotateUp","panLeft","objectMatrix","setFromMatrixColumn","panUp","pan","deltaX","deltaY","element","isPerspectiveCamera","targetDistance","tan","fov","clientHeight","isOrthographicCamera","right","clientWidth","bottom","dollyIn","dollyScale","dollyOut","handleMouseDownRotate","handleMouseDownDolly","handleMouseDownPan","handleMouseMoveRotate","handleMouseMoveDolly","handleMouseMovePan","handleMouseWheel","keyCode","handleKeyDown","touches","pageX","pageY","handleTouchStartRotate","handleTouchStartDolly","handleTouchStartPan","handleTouchMoveRotate","handleTouchMoveDolly","handleTouchMovePan","EventDispatcher","defineProperties","center","noZoom","noRotate","noPan","noKeys","staticMoving","dynamicDampingFactor","Adapter","getSelectedSceneObject","findNode","getCachedBehaviorAsset","tweenManager","getFloorNear","MOVE_SPEED","VRCanvas","moveCameraForward","moveCameraBackward","handleKeyPress","recenterOnSelection","orbitControls","cam","transformChanged","quick_setPropertyValue","transformDraggingChanged","docSwapped","obj_node_map","rebuildNode","sceneObj","setCurrentSceneWrapper","selectionChanged","transformControls","findSceneObjectParent","clickedCanvas","raycaster","getCurrentSceneWrapper","findKnownParent","performClickAction","previewUpdateNodes","current_scene_wrapper","assertThisInitialized","inset","makeNode","insertNodeMapping","addSceneWrapper","wrapper","aspect","supportsARKit","setupRenderer","setAnimationLoop","animationLoopWithCamera","animationLoop","saveOrbitControlsState","antialias","setPixelRatio","gammaOutput","audioListener","setAudioListener","background","updateScene","checkAspectRatio","viewMatrix","matrixWorldNeedsUpdate","removeNodeMapping","updateProperty","populateNode","nextContext","stopAllMedia","resetSceneGraph","stopRecognizers","startRecognizers","startRunning","startFirstScene","boxSizing","margin","flex","overflow","tabIndex","nodeid","obj3d","rebuildParentLink","ch3","orbit_state","restoreOrbitControlsState","dump","_this10","graphObj","threeObj","TranslationArrow","control","startHover","endHover","beginDrag","startPoint","intersection","worldToLocal","oldFilter","intersectionFilter","startPosition","POINTER_MOVE","updateDrag","POINTER_RELEASE","endDrag","endPoint","finalPoint","end","makePlane","makeArrow","makeInputGrabber","POINTER_ENTER","POINTER_EXIT","POINTER_PRESS","TranslateControl","_THREE$Group","Panel2D","canvasTexture","redrawHandler","inside","fpt","contains","comp","findAt","POINTER_CLICK","startDrag","draw","dragSphere","moveDrag","Component2D","Button2D","fsize","normalBg","hoverBg","bg","font","metrics","measureText","fillText","Group2D","border","layout","translate","restore","childProps","deg","YAXIS","ThreeDOFController","stagePos","stageRot","states","touchpad","keystates","ArrowLeft","previous","ArrowRight","ArrowUp","ArrowDown","dir","rotateRight","moveForward","moveBackward","applyAxisAngle","_fire","scanGamepads","updateKeys","gamepads","getGamepads","gamepad","startsWith","buttons","axes","down","deleteObject","isEmpty","newDoc","switcher","generateAddAssetPopup","acts","supportsAssetUpload","showAddImageAssetDialog","showAddServerImageDialog","showAddGLTFAssetDialog","showAddGLBAssetDialog","showAddAudioAssetDialog","showOpenAssetDialog","showAddGeoLocationAssetDialog","editor","currentScene","swapScene","ImmersiveVREditor","standardViewClickHandler","isRunning","sceneWrappers","initScene","render3","stats","controller","$","querySelector","container","innerWidth","innerHeight","WebGLRenderer","appendChild","vrmanager","VRManager","AudioListener","initContent","VR_DETECTED","removeAttribute","innerText","enterVR","updateSceneOp","documentSwapped","controls","selectedNode","AmbientLight","VRStats","editable","Pointer","cameraFollowMouse","mouseSimulatesController","enableLaser","laserLength","stick","controller1","tools","panel2d","button2d","setAll","add3DObject","runButton","color_group","group2d","panel","setColor","defaults","nodeObj","InputManager","keyDown","m2","bindings","valid","modifiers","mod","MODIFIERS","COMMAND","metaKey","SHIFT","dispatchEvents","binding","matches","addImageAssetFromExpandedURL","assetId","getAssetsObject","insertChildLast","requestImageCache","addImageAssetFromFile","uploadFile","ans","addGLBAssetFromFile","addAudioAssetFromURL","fileType","lastIndexOf","KEYS","S","C","V","LEFT_ARROW","RIGHT_ARROW","AddImageAssetDialog","fileInput","files","switchLocal","switchRemote","selectedFile","typedURL","React","createRef","GridEditorApp_ToggleButton","renderSelectedPanel","AddGLTFAssetDialog","fileinput","multiple","webkitdirectory","AddGLBAssetDialog","AddAudioAssetDialog","addAudioAssetFromFile","UnsavedDocumentDialog","onAnyway","DRACOLoader","timeLoaded","verbosity","attributeOptions","TrianglesDrawMode","nativeAttributeMap","setVerbosity","level","setDrawMode","setSkipDequantization","skip","skipDequantization","getAttributeOptions","rawBuffer","attributeUniqueIdMap","getDecoderModule","module","decodeDracoFileInternal","decoder","dracoDecoder","DecoderBuffer","Init","Decoder","geometryType","GetEncodedGeometryType","TRIANGULAR_MESH","POINT_CLOUD","errorMsg","convertDracoGeometryTo3JS","addAttributeToGeometry","dracoGeometry","attributeType","geometryBuffer","ptr","attributeData","TypedBufferAttribute","numComponents","num_components","numValues","num_points","DracoFloat32Array","GetAttributeFloatForAllPoints","DracoInt8Array","GetAttributeInt8ForAllPoints","Int8BufferAttribute","DracoInt16Array","GetAttributeInt16ForAllPoints","Int16BufferAttribute","Int32Array","DracoInt32Array","GetAttributeInt32ForAllPoints","Int32BufferAttribute","DracoUInt8Array","GetAttributeUInt8ForAllPoints","Uint8BufferAttribute","DracoUInt16Array","GetAttributeUInt16ForAllPoints","Uint16BufferAttribute","DracoUInt32Array","GetAttributeUInt32ForAllPoints","Uint32BufferAttribute","GetValue","destroy","decodingStatus","SkipAttributeTransform","start_time","performance","DecodeBufferToMesh","PointCloud","DecodeBufferToPointCloud","ok","error_msg","numFaces","decode_end","num_faces","numPoints","numAttributes","num_attributes","posAttId","GetAttributeId","posAttribute","GetAttribute","attributeId","GetAttributeByUniqueId","attId","stripsArray","GetTriangleStripsFromMesh","numIndices","ia","GetFaceFromMesh","posTransform","AttributeQuantizationTransform","InitFromAttribute","isQuantized","maxRange","numQuantizationBits","quantization_bits","minValues","min_value","decode_time","import_time","isVersionSupported","decoderPath","decoderConfig","decoderModulePromise","setDecoderPath","setDecoderConfig","config","wasmBinary","releaseDecoderModule","DracoDecoderModule","WebAssembly","_loadScript","wasmBinaryFile","_loadArrayBuffer","onModuleLoaded","prevScript","getElementById","removeChild","head","getElementsByTagName","script","GLTFAssetView","renderThree","initThreeJS","swapModel","draco","near","far","playAllClips","sceneContainer","screenSpacePanning","GeoAssetView","loadCurrentLocation","getCurrentPosition","coords","onMapClick","latlng","lat","lng","updateLocation","ll","latLng","lon","marker","setLatLng","mymap","panTo","setView","tileLayer","attribution","addTo","customIcon","divIcon","AssetView","renderAsset","alt","playsInline","GLTFAssetView_GLTFAssetView","GeoAssetView_GeoAssetView","cloneObjectDeep","shapeid","newParent","id2","children2","arr2","ch2","insertElement","cloneArrayDeep","createProperty","GraphAccessor","hasObject","insertFirstChild","insertChildAfter","getParent","OpenFileDialog","refreshList","loadDocList","docs","docList","dismiss","removeDoc","href","generateDocUrl","renderDeleteButton","supportsDocDelete","deleteDoc","OpenAssetDialog","loadAssetList","assetList","isVideoType","addVideoAssetFromURL","isGLTFType","addGLBAssetFromURL","removeAssetSource","addAsset","deleteAsset","ScriptEditor","swap","changeText","getSession","getAnnotations","updateBehaviorAssetContents","fetchBehaviorAssetContents","lib_default","theme","showGutter","ed","OpenScriptDialog","loadScriptList","scripts","addBehaviorAssetFromURL","onAdd","removeBehaviorAssetSource","addScript","supportsScriptEdit","deleteScript","CUSTOM_BEHAVIOR_SCRIPT","CUSTOM_SCENE_SCRIPT","QRCanvas","QRCode","toCanvas","QRDialog","wurl","QRCanvas_QRCanvas","PasswordDialog","doPasswordLogin","field","GithubAuthDialog","ErrorCatcher","errorInfo","parseGIF","gif","delayTimes","graphicControl","frames","disposals","transparencies","transparentColors","loopCnt","gifHeader","subarray","blockId","label","imageData","GIFTexture","delays","_ctx","isVideoTexture","frameStartTime","firstDrawCount","playing","clearRect","AssetsManager","assets_url_map","videocache","audiocache","lg","sound","isPlaying","Audio","getAudioListener","AudioLoader","setBuffer","setVolume","muted","volume","arrayBuffer","String","fromCharCode","rawImageData","loadCnt","_loop","createGIFTexture","preload","VideoTexture","xhr","SaveDocumentAsDialog","edited","newTitle","saveAs","duplicateDocument","BadAssetsDialog","badAssets","ToasterNotification","notification","ConsoleView","clearLog","messages","placeholder","formatMessage","msgs","VREditor","getApp","VREditor_VREditorApp","ImmersiveVREditor_ImmersiveVREditor","getTitle","consoleLogger","getBehaviorsObject","setCachedBehaviorAsset","cacheAssetsList","addAssetLoadingError","answers","showBadAssetsDialog","editIn2D","protocol","pathname","QRDialog_QRDialog","editInVR","viewInVR","make","cutSelection","nodeName","setClipboard","copySelection","pasteSelection","obj1","getClipboard","AddImageAssetDialog_AddImageAssetDialog","AddAudioAssetDialog_AddAudioAssetDialog","AddGLTFAssetDialog_AddGLTFAssetDialog","AddGLBAssetDialog_AddGLBAssetDialog","showOpenDocumentDialog","OpenFileDialog_OpenFileDialog","OpenAssetDialog_OpenAssetDialog","showOpenBehaviorDialog","OpenScriptDialog_OpenScriptDialog","showPasswordDialog","PasswordDialog_PasswordDialog","showGithubDialog","GithubAuthDialog_GithubAuthDialog","addCustomBehaviorAsset","TEMPLATE","randi","fname","addSceneScript","addBehaviorToObject","imagecache","behaviorCache","rootObj","scene1","behaviors","behaviorProps","getCachedBehaviorPropDefs","pname","propdef","ndef","out","copyPropDef","realobj","nodeType","acceptsImageAsset","acceptsVideoAsset","withNone","EnumTitleRenderer","getFirstSceneObject","ov","cmds","addScene","canHaveBehavior","tgt","isGLTFFile","VREditor_ColorEditor","VREditor_GroupPropertyEditor","al","BadAssetsDialog_BadAssetsDialog","VREditorApp","showSaveAsDialog","SaveDocumentAsDialog_SaveDocumentAsDialog","resizeLeft","resizeLeftWindow","endResizeLeftWindow","leftDivider","resizeRight","resizeRightWindow","endResizeRightWindow","rightDivider","resizeBottom","resizeBottomWindow","endResizeBottomWindow","bottomDivider","toggleLeftPane","toggleRightPane","toggleBottomPane","toggleRunning","dirty","UnsavedDocumentDialog_UnsavedDocumentDialog","user","im","addKeyBinding","attachKeyEvents","getUsername","gridStyle","gridTemplateRows","ErrorCatcher_ErrorCatcher","renderLoginButton","VREditor_Resizer","GridEditorApp_MenuPopup","showAddPopup","showAddAssetPopup","showAddBehaviorPopup","VREditor_RunButton","active","TreeTable_TreeTable","renderCenterPane","PropSheet_PropSheet","bottomText","VREditor_ResizerH","ConsoleView_ConsoleView","ToasterNotification_ToasterNotification","ScriptEditor_ScriptEditor","VRCanvas_VRCanvas","AssetView_AssetView","supportsAuth","supportsPassword","supportsDocList","Resizer","ResizerH","GroupPropertyEditor","syncChanged","sync","newvals","_this11","boxes","RunButton","ColorEditor","showPopup","VREditor_ColorPopup","_this12","ColorPopup","_this13","_this14","meshMap","workingMatrix","savedOrigin","savedDirection","reticleParent","reticle","reticleTrackedColor","reticleNotTrackedColor","reticleMaterial","requestNextHit","singleton","XRWorldInfo","engine","_floorPos","updateWorldSensingState","illuminationDetectionState","meshDetectionState","normals","_handleHitResults","handleHitResults","makeRotationX","degToRad","worldInfo","worldInformation","seen","worldMesh","handleUpdateNode","handleNewNode","handleRemoveNode","findFloorNear","squaredDistance","hits","hit","hitMatrix","timeStamp","ts","vertexCountChanged","newMesh","newMeshNode","threeMesh","vertexPositionsChanged","vertexPositions","textureCoordinatesChanged","textureCoordinates","triangleIndicesChanged","triangleIndices","vertexNormalsChanged","vertexNormals","worldMeshGroup","dynamic","verticesBufferAttribute","uvBufferAttribute","normalsBufferAttribute","computeVertexNormals","wireMaterial","targetRadiusSq","targetTop","targetBottom","meshPos","bestPos","bestY","_center","distanceY","_extent","attachUtilFunctions","obj_map","ImmersivePlayer","clickedStart","renderThreeWithCamera","xrWorldInfo","startScene","three_map","current_scene","inter","gobj","refreshWorldInfo","showErrors","title_map","behavior_map","behavior_assets","pendingAssets","loadDocument","initAssets","assetsRoot","validateAssets","buildRoot","setCurrentScene","startupsound","renderSplashImage","renderErrors","initObject","initBehaviors","chnode","documentElement","prom","sceneAnchorNode","removeSceneAnchor","createSceneAnchor","updateAnchoredSceneNode","assetsList","player","_this15","sceneid","updateRayAnchor","stopAnchor","_this16","createDetectionImage","_this17","addGeoAnchoredNode","setVisible","App","ImmersivePlayer_ImmersivePlayer","ReactDOM","App_App","exports","adds","note","offAdd","__webpack_require__"],"mappings":"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","file":"static/js/main.f3bc087a.chunk.js","sourcesContent":["export function parseOptions(opts) {\n    let loc = document.location\n    if (loc.search) {\n        const parts = loc.search.substring(1).split('&')\n        parts.forEach((part)=>{\n            const keyval = part.split('=')\n            opts[keyval[0]] = keyval[1]\n        })\n    }\n    // console.log(opts)\n    // if(typeof opts.switcher === 'string') {\n    //     console.log(\"parsing switcher\")\n    // }\n    return opts;\n}\n\n\nexport const on = (elem,type,cb) => elem.addEventListener(type,cb)\nexport const $ = (sel) => document.querySelector(sel)\n\nexport function genID(prefix) {\n    return `${prefix}_${Math.floor(Math.random() * 10000)}`\n}\n\nexport function toFlatString(obj) {\n    return JSON.stringify(obj)\n}\n\n/*\nexport function GET_JSON(path, cb) {\n    return new Promise((res,rej) => {\n        console.log(\"fetching\",path);\n        const req = new XMLHttpRequest()\n        req.onreadystatechange = function() {\n            // console.log(\"got\",req.readyState, req.status)\n            if(req.readyState === 4) {\n                if(req.status === 200) return res(JSON.parse(req.responseText));\n                //if anything other than 200, reject it\n                rej(req)\n            }\n            if(req.status === 500) rej(req);\n            if(req.status === 404) rej(req);\n        };\n        req.open(\"GET\",path,true);\n        req.send();\n    });\n}\n\n\nexport function POST_JSON(path, payload) {\n    // console.log(\"POSTING\",path,payload);\n    return new Promise((res,rej)=>{\n        const req = new XMLHttpRequest();\n        req.onreadystatechange = function() {\n            if(req.readyState === 4 && req.status === 200) {\n                try {\n                    res(JSON.parse(req.responseText));\n                } catch(e) {\n                    rej(e);\n                }\n            }\n            if(req.status === 500) rej(req);\n            if(req.status === 404) rej(req);\n        };\n        req.onerror = (e) => rej(e);\n        req.open(\"POST\",path,true);\n        req.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\n        if(typeof payload === 'string') {\n            req.send(payload)\n        } else {\n            req.send(JSON.stringify(payload));\n        }\n    })\n}\n */\n\n\nexport function makePoint(x,y) {\n    return {\n        x:x,\n        y:y,\n        minus: function(pt) {\n            return makePoint(this.x-pt.x, this.y-pt.y);\n        },\n        add: function(pt) {\n            return makePoint(this.x+pt.x, this.y+pt.y);\n        },\n        divide: function(v) {\n            return makePoint(this.x/v,this.y/v)\n        },\n        multiply: function(v) {\n            return makePoint(this.x*v,this.y*v)\n        },\n        idivide: function(v) {\n            return makePoint(\n                Math.floor(this.x/v),\n                Math.floor(this.y/v)\n            )\n        },\n        floor: function() {\n            return makePoint(\n                Math.floor(this.x),\n                Math.floor(this.y)\n            )\n        },\n        distance(pt) {\n            const dx = pt.x-this.x;\n            const dy = pt.y-this.y;\n            return Math.sqrt(dx*dx+dy*dy)\n        },\n        equals(pt) {\n            return pt.x === this.x && pt.y === this.y\n        },\n        toString() {\n            return `(${x},${y})`\n        }\n    }\n}\n\n//use only capital letters, 65->90\nexport function genAlphaID(count) {\n    let id = \"\"\n    for(let i=0; i<count; i++) {\n        id += String.fromCharCode(65 + Math.floor(Math.random() * (90 - 65)))\n    }\n    return id\n}\n\nexport function setQuery(obj) {\n    const oldOpts = parseOptions({})\n    const final = {}\n    Object.keys(oldOpts).forEach(key=> final[key] = oldOpts[key])\n    Object.keys(obj).forEach(key=> final[key] = obj[key])\n    const query = Object.keys(final).map((key)=>`${key}=${final[key]}`).join('&')\n    window.history.pushState(obj,'a title','?'+query)\n}\nexport function toQueryString(obj) {\n    return Object.keys(obj).map((key)=>`${key}=${obj[key]}`).join('&')\n}\n\n\nexport function shallowCopy(obj) {\n    const out = {};\n    Object.keys(obj).forEach((key) => out[key] = obj[key])\n    return out;\n}\n","\n\nexport const SELECTION_MANAGER = {\n    CHANGED:'CHANGED',\n    DROP_TARGET_CHANGED:'DROP_TARGET'\n}\n\nclass SelectionManager {\n    constructor(props) {\n        this.listeners = {};\n        this.selected = [];\n        this.dropTarget = null;\n        this.clip = null\n    }\n    on(type,cb) {\n        if(!this.listeners[type]) this.listeners[type] = [];\n        this.listeners[type].push(cb);\n    }\n    off(type,cb) {\n        const index = this.listeners[type].indexOf(cb)\n        if(index>=0) this.listeners[type].splice(index,1)\n    }\n    fire(type, value) {\n        if(!this.listeners[type]) this.listeners[type] = [];\n        this.listeners[type].forEach((cb) => cb(value));\n    }\n    setSelection(node) {\n        this.selected = [node]\n        this.fire(SELECTION_MANAGER.CHANGED,this)\n    }\n    addToSelection(node) {\n        this.selected.push(node)\n        this.fire(SELECTION_MANAGER.CHANGED,this)\n    }\n    clearSelection() {\n        this.selected = []\n        this.fire(SELECTION_MANAGER.CHANGED,this)\n    }\n    isSelected(node) {\n        return (this.selected.indexOf(node) >= 0)\n    }\n    getSelection() {\n        if(this.selected.length === 0) return null;\n        return this.selected[0];\n    }\n    isEmpty() {\n        return this.selected.length === 0\n    }\n    getFullSelection() {\n        return this.selected\n    }\n    setDropTarget(node) {\n        if(this.dropTarget !== node) {\n            this.dropTarget = node;\n            this.fire(SELECTION_MANAGER.DROP_TARGET_CHANGED, this.dropTarget)\n        }\n    }\n    getDropTarget() {\n        return this.dropTarget\n    }\n    setDropType(type) {\n        this.dropType = type\n    }\n    getDropType() {\n        return this.dropType\n    }\n\n    setClipboard(clip) {\n        this.clip = clip\n    }\n    getClipboard() {\n        return this.clip\n    }\n}\n\nexport default new SelectionManager();\n","import {getAssetsURL, getInfoURL, getUserURL} from '../TreeItemProvider'\nimport * as ToasterMananager from './ToasterManager'\nimport {genID} from \"../utils\"\n\nexport const USER_CHANGE = 'USER_CHANGE'\nexport const CONNECTED = \"CONNECTED\"\nclass AuthModuleSingleton {\n    constructor() {\n        this.listeners = {}\n        this.supported = false\n        this.doclistSupported = false\n        this.docDeleteSupported = false\n        this.assetUploadSupported = false\n        this.scriptEditingSupported = false\n        this.passwordSupported = false\n        this.connected = false\n        this.serverID = genID(\"serverid\")\n    }\n    on(type,cb) {\n        if(!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].push(cb)\n    }\n    fire(type,payload) {\n        if(!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].forEach(cb => cb(payload))\n    }\n\n    init() {\n        if(this.isLoggedIn()) this.doclistSupported = true\n        fetch(getInfoURL()).then(res => res.json())\n            .then(info => {\n                console.info(\"Server Info:\",info)\n                if(info.authentication === true)      this.supported = true\n                if(info.passwordSupported === true)   this.passwordSupported = true\n                if(info.assetUpload === true)         this.assetUploadSupported = true\n                if(info.scriptEditing === true)       this.scriptEditingSupported = true\n                if(info.docDeleteSupported === true)  this.docDeleteSupported = true\n                this.serverID = getInfoURL().replace(/[.:/]/g,\"\")\n\n\n                this.getJSON(getUserURL()).then(res=>{\n                    if(!res.success) {\n                        this.logout()\n                    } else {\n                        this.fire(USER_CHANGE)\n                        this.doclistSupported = true\n                    }\n                    this.connected = true\n                    this.fire(CONNECTED)\n                }).then(()=>{\n                    this.connected = true\n                    this.fire(CONNECTED)\n                })\n            })\n    }\n    isConnected() {\n        return this.connected\n    }\n\n    isLoggedIn() {\n        if(localStorage.getItem('access-token')) return true\n        return false\n    }\n    supportsPassword() {\n        return this.passwordSupported\n    }\n    supportsAuth() {\n        return this.supported\n    }\n    supportsDocList() {\n        return this.doclistSupported\n    }\n    supportsAssetUpload() {\n        return this.assetUploadSupported\n    }\n    supportsScriptEdit() {\n        return this.scriptEditingSupported\n    }\n    supportsDocDelete() {\n        return this.docDeleteSupported\n    }\n\n    login = (res) => {\n        this.win = window.open(res.url,'_blank')\n        window.addEventListener('message',this.authCallback)\n        if(this.win) this.win.focus()\n    }\n    logout = () => {\n        localStorage.clear()\n        this.doclistSupported = false\n        this.fire(USER_CHANGE)\n    }\n    doPasswordLogin (password) {\n        localStorage.setItem('access-token',password)\n        return this.getJSON(getUserURL()).then(res=>{\n            if(res.success === true) {\n                console.log(\"the logged in response is\", res)\n                this.doclistSupported = true\n                ToasterMananager.add(\"login succeeded\")\n                this.fire(USER_CHANGE)\n            } else {\n                ToasterMananager.add(\"login failed\")\n                localStorage.clear()\n                this.doclistSupported = false\n                this.fire(USER_CHANGE)\n            }\n        })\n\n    }\n    authCallback = (msg) => {\n        this.setUserData(msg.data.payload)\n        this.win.close()\n        window.removeEventListener('message',this.authCallback)\n        this.doclistSupported = true\n        this.fire(USER_CHANGE)\n        ToasterMananager.add(\"login succeeded\")\n    }\n    setUserData(data) {\n        localStorage.setItem('access-token',data.accessToken)\n    }\n    getAccessToken() {\n        return localStorage.getItem('access-token')\n    }\n\n    getUsername() {\n        return this.getAccessToken()\n    }\n\n    getServerID() {\n        return this.serverID\n    }\n\n    fetch(url, options) {\n        options.mode = 'cors'\n        options.cache = 'no-cache'\n        if(!options.headers) options.headers = {}\n        options.headers[\"access-key\"] =  AuthModule.getAccessToken()\n        console.log(\"fetching\",url,'with options',options)\n        return fetch(url,options)\n            .then(res => {\n                if(res.status === 404) throw new Error(res.statusText + \" \" + res.url)\n                return res\n            })\n    }\n    getJSON(url) {\n        return this.fetch(url,{\n            method:'GET',\n            headers: {\n                \"Content-Type\": \"application/json\",\n            }\n        }).then(res => res.json())\n    }\n\n    uploadFile(file) {\n        const url = getAssetsURL()+file.name\n        return this.fetch(url,{\n            method:'POST',\n            body:file\n        }).then(res => res.json())\n    }\n\n}\n\nexport const AuthModule = new AuthModuleSingleton()\n","import {setQuery} from './utils'\nimport Selection from './SelectionManager'\nimport {AuthModule} from './vr/AuthModule'\n\nexport const TREE_ITEM_PROVIDER = {\n    EXPANDED_CHANGED:'EXPANDED_CHANGED',\n    STRUCTURE_CHANGED:'STRUCTURE_CHANGED',\n    STRUCTURE_ADDED:'STRUCTURE_ADDED',\n    STRUCTURE_REMOVED:'STRUCTURE_REMOVED',\n    PROPERTY_CHANGED:'PROPERTY_CHANGED',\n    CLEAR_DIRTY:'CLEAR_DIRTY',\n    SAVED:'SAVED',\n    DOCUMENT_SWAPPED:'DOCUMENT_SWAPPED',\n}\n\nconst URLS = {\n    BASE:'https://vr.josh.earth/generaled/api/'\n    // BASE:'https://buttered-elk.glitch.me/'\n    // BASE:'http://localhost:1234/'\n}\nexport function getDocsURL() {\n    return URLS.BASE + 'doc/'\n}\nexport function getAssetsURL() {\n    return URLS.BASE + 'asset/'\n}\nexport function getScriptsURL() {\n    return URLS.BASE + 'scripts/'\n}\nexport function getLoginURL() {\n    return URLS.BASE + 'auth/github/login'\n}\nexport function getInfoURL() {\n    return URLS.BASE +'info'\n}\nexport function getUserURL() {\n    return URLS.BASE + 'userinfo'\n}\n\n// export const SERVER_URL = \"http://localhost:30065/doc/\"\n// export const SERVER_URL_ASSETS = \"http://localhost:30065/asset/\"\n// export const SERVER_URL = \"http://localhost:55555/doc/\"\n// export const SERVER_URL = \"https://vr.josh.earth/generaled/api/doc/\"\n// export const BASE_URL = \"http://localhost:55555/\"\n// export const BASE_URL = \"https://vr.josh.earth:55555/\"\n// export const SERVER_URL_ASSETS = \"http://localhost:55555/asset/\"\n// export const SERVER_URL_ASSETS = \"https://vr.josh.earth/generaled/api/asset/\"\n// export const SERVER_URL_ASSETS = \"http://josh.earth:30068/asset/\"\n// export const LOGIN_URL = \"http://localhost:55555/auth/github/login\"\n// export const LOGIN_URL = \"https://vr.josh.earth/generaled/api/auth/github/login\"\n\nclass TreeItemProviderInterface {\n    /** register a listener */\n    on(type, cb) {\n        throw new Error(`interface 'on' not implemented`)\n    }\n\n    /** un-register a listener */\n    off(type, cb) {\n        throw  new Error(\"interface 'off' not implemented\")\n    }\n\n    /** fire an event. internal use */\n    fire(type, value) {\n        throw  new Error(\"interface 'fire' not implemented\")\n    }\n\n    // ============== tree interface\n    /** returns the root of the tree structure */\n    getSceneRoot() {\n        throw new Error(\"interface 'getSceneRoot' not implemented\")\n    }\n    /** delete child node */\n    deleteChild(child) { throw new Error(\"deleteChild not implemented yet\")}\n    /** append child to the parent */\n    appendChild(parent,child) { throw new Error(\"appendChild not implemented yet\")}\n    /** insert child node before a particular other node */\n    insertNodeBefore(node,sibling) { throw new Error(\"insertNodeBefore() not implemented yet\")}\n    /** find a given node by ID */\n    findNodeById(id) { throw new Error(\"findNodeById() not implemented yet\")}\n    /** find the parent of the given node */\n    findParent(node) { throw new Error(\"findParent() not implemented yet\")}\n    /** return true if the given node has children */\n    hasChildren(node) { throw new Error(\"hasChildren() not implemented yet\")}\n    /** returns an array of children for the parent node */\n    getChildren(node) { throw new Error(\"getChildren() not implemented yet\")}\n\n    // ========= Tree View support =========\n\n    /** returns true if item is expanded */\n    isExpanded(item) {\n        throw  new Error(\"interface 'isExpanded' not implemented\")\n    }\n\n    /** return a react component for the context menu of the item in the tree view */\n    calculateContextMenu(item) {\n        throw new Error(\"calculateContextMenu() not implemented yet\")\n    }\n    /** toggles the collapsed state of the item */\n    toggleItemCollapsed(item) {\n        throw new Error(\"toggleItemCollapsed() not implemented yet\")\n    }\n    /** returns a react component to display the item in the tree view */\n    getRendererForItem(item) {\n        throw new Error(\"getRendererForItem() not implemented yet\")\n    }\n\n\n\n    // ================ properties ==================\n    /** set the property value using a prop def */\n    setPropertyValue(item, def, value) {\n        throw new Error(\"interface setPropertyValue not implemented\")\n    }\n    setPropertyValueByName(child,name,value) { throw new Error(`interface 'setPropertyValueByName() not implemented'`)}\n    /** return an array of property definitions for the specified tree item */\n    getProperties(item) { throw new Error(`interface 'getProperties()' not implemented`) }\n\n\n    // ================ doc def stuff\n    getDocId() {  throw new Error(\"getDocId() not implemented\")  }\n    getDocType() {  throw new Error(\"getDocType() not implemented\")  }\n    getApp() { throw new Error(\"getApp() not implemented\")  }\n    getTitle() { throw new Error(\"getTitle() not implemented\") }\n}\n\nconst AUTO_DETECT_GLITCH = true\nfunction calculateServerUrl(SERVER_URL) {\n    if(SERVER_URL) {\n        return `https://${SERVER_URL}/`\n    }\n\n    if(AUTO_DETECT_GLITCH) {\n        console.log(\"no server url, checking the document\")\n        const host = document.location.host\n        if (host.endsWith(\".glitch.me\")) {\n            console.log(\"this is a glitch. using autodetected server\")\n            return `https://${host}/`\n        }\n    }\n    return URLS.BASE\n}\n\nexport default class TreeItemProvider extends TreeItemProviderInterface {\n    constructor(options) {\n        super()\n        this.listeners = {};\n        this.expanded_map = {};\n        this.docid = null\n        URLS.BASE = calculateServerUrl(options.SERVER_URL)\n        console.log(\"using server\",URLS.BASE)\n        AuthModule.init()\n    }\n\n    on(type, cb) {\n        if (!this.listeners[type]) this.listeners[type] = [];\n        this.listeners[type].push(cb);\n    }\n\n    fire(type, value) {\n        if (!this.listeners[type]) this.listeners[type] = [];\n        this.listeners[type].forEach((cb) => cb(value));\n    }\n\n    off(type, cb) {\n        if (this.listeners[type]) this.listeners[type] = this.listeners[type].filter(list => list !== cb)\n    }\n\n    isExpanded(item) {\n        if (!item.id) item.id = \"\" + Math.random();\n        if (typeof this.expanded_map[item.id] === 'undefined') this.expanded_map[item.id] = true;\n        return this.expanded_map[item.id];\n    }\n    toggleItemCollapsed(item) {\n        const current = this.isExpanded(item);\n        this.expanded_map[item.id] = !current;\n        this.fire(TREE_ITEM_PROVIDER.EXPANDED_CHANGED,item);\n    }\n\n\n    setPropertyValue(item, def, value) {\n        throw new Error(\"subclass of TreeItemProvider must implement setPropertyValue\")\n    }\n\n    genID = (prefix) => {\n        return `${prefix}_${Math.floor(Math.random() * 1000*1000*1000)}`\n    }\n\n    setDocument(doc, docid) {\n        this.root = doc\n        this.docid = docid\n        this.fire(TREE_ITEM_PROVIDER.STRUCTURE_CHANGED, {\n            provider:this\n        });\n    }\n\n    getDocId() {\n        return this.docid\n    }\n\n    save = () => {\n        console.info(\"saving\",this.getSceneRoot())\n        const payload_obj = {\n            doc:this.getSceneRoot(),\n            type:this.getDocType(),\n            id:this.getDocId()\n        }\n        const payload_string = JSON.stringify(payload_obj,(key,value)=>{\n            if(key === 'parent') return undefined\n            return value\n        })\n        console.info(\"doc is\",payload_string)\n        return AuthModule.fetch(getDocsURL()+this.docid, {\n            method:'POST',\n            body: payload_string,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            },\n        })\n            .then(res => res.json())\n            .then((res)=>{\n            console.log(\"Success result is\",res)\n            setQuery({mode:'edit',doc:this.docid, doctype:this.getDocType()})\n            this.fire(TREE_ITEM_PROVIDER.SAVED,true)\n        }).catch((e)=> console.log(\"error\",e))\n    }\n    loadDoc(docid) {\n        console.log(\"need to load the doc\",docid)\n        AuthModule.getJSON(getDocsURL()+docid).then((payload)=>{\n            console.log(\"got the doc\",payload)\n            if(payload.type !== this.getDocType()) throw new Error(\"incorrect doctype for this provider\",payload.type)\n            this.setDocument(payload.doc,payload.id)\n        }).catch((e)=>{\n            console.warn(\"missing doc\",e)\n            this.setDocument(this.makeEmptyRoot(),this.genID('doc'))\n            setQuery({mode:'edit',doc:this.docid, doctype:this.getDocType()})\n        })\n    }\n    reloadDocument() {\n        const spath = this.generateSelectionPath(Selection.getSelection());\n        console.log(\"got the path\",spath)\n        AuthModule.getJSON(getDocsURL()+this.docid).then((payload)=>{\n            if(payload.type !== this.getDocType()) throw new Error(\"incorrect doctype for this provider\",payload.type)\n            this.setDocument(payload.doc,payload.id)\n            this.fire(TREE_ITEM_PROVIDER.CLEAR_DIRTY,true)\n            const newsel = this.findNodeFromSelectionPath(this.getSceneRoot(),spath)\n            console.log(\"set new selection to \", newsel)\n            Selection.setSelection(newsel)\n        }).catch((e)=>{\n            console.warn(\"couldn't reload the doc\",e)\n        })\n\n    }\n\n    /* required functions for subclasses */\n\n    generateSelectionPath() {\n        throw new Error(\"generateSelectionPath not implemented\")\n    }\n    findNodeFromSelectionPath() {\n        throw new Error(\"findNodeFromSelectionPath not implemented\")\n    }\n    makeEmptyRoot() {\n        throw new Error(\"makeEmptyRoot() not implemented\")\n    }\n\n    getSceneRoot() {\n        return this.root;\n    }\n\n    uploadFile(file) {\n        return new Promise((res,rej)=>{\n            const fd = new FormData()\n            fd.append('file',file)\n            console.info(\"filesize is\",file.size, file.name);\n            const xml = new XMLHttpRequest()\n            xml.onreadystatechange = () => console.log(`ready state = ${xml.readyState} status ${xml.status}`)\n            xml.addEventListener('progress',(e)=>console.log(`progress`))\n            xml.addEventListener('load',(e)=> res(xml.response))\n            xml.addEventListener('error',(e)=>console.log(`error`))\n            xml.addEventListener('abort',(e)=>console.log(`abort`))\n            const url = getAssetsURL()+file.name;\n            console.info(\"uploading to \", url)\n            xml.responseType = 'json'\n            xml.open('POST',url)\n            xml.setRequestHeader('access-key',AuthModule.getAccessToken())\n            xml.send(file)\n        })\n    }\n\n\n    hasChildren = (item) => item && item.children && item.children.length\n    getChildren = (item) => item.children\n\n}\n","const {SET_PROPERTY, CREATE_PROPERTY, DELETE_PROPERTY,\n    CREATE_OBJECT, DELETE_OBJECT,\n    INSERT_ELEMENT, DELETE_ELEMENT\n} = require(\"syncing_protocol\");\n\nexport class UndoQueue {\n    constructor(graph) {\n        this.graph = graph\n        this.history = []\n        this.current = -1\n    }\n\n    submit(op) {\n        // console.log(\"UNDOREDO: submit\",op)\n        this.history.push(op)\n        this.current = this.history.length - 1\n    }\n\n    canUndo() {\n        return this.current >= 0\n    }\n\n    canRedo() {\n        return this.current < this.history.length - 1\n    }\n\n    undo() {\n        const last = this.history[this.current]\n        this.current--\n        // console.log(\"undoing\",last)\n        // this.history.forEach(op => console.log(short(op)))\n        if (last.type === SET_PROPERTY) {\n            if (!last.prevValue) {\n                console.warn(\"undoing set property without a previous value!\", last)\n                return\n            }\n            const op = {\n                type: SET_PROPERTY,\n                host: this.graph.getHostId(),\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                object: last.object,\n                name: last.name,\n                value: last.prevValue,\n            }\n            this.graph.process(op)\n            return\n        }\n        if (last.type === CREATE_PROPERTY) {\n            const op = {\n                type: DELETE_PROPERTY,\n                host: this.graph.getHostId(),\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                object: last.object,\n                name: last.name,\n            }\n            this.graph.process(op)\n            return\n        }\n        if (last.type === CREATE_OBJECT) {\n            const op = {\n                type: DELETE_OBJECT,\n                host: this.graph.getHostId(),\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                id: last.id,\n            }\n            this.graph.process(op)\n            return\n        }\n        if (last.type === INSERT_ELEMENT) {\n            const op = {\n                type: DELETE_ELEMENT,\n                host: this.graph.getHostId(),\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                array: last.array,\n                entry: last.entryid\n            }\n            this.graph.process(op)\n            return\n        }\n        throw new Error(`undo for type not supported: ${last.type}`)\n    }\n\n    redo() {\n        this.current++\n        const last = this.history[this.current]\n        // console.log(\"redoin\",this.current,last.type,last.name,'=',last.value)\n        if (last.type === SET_PROPERTY) {\n            const op = {\n                type: last.type,\n                host: last.host,\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                object: last.object,\n                name: last.name,\n                value: last.value\n            }\n            this.graph.process(op)\n            return\n        }\n        if (last.type === CREATE_PROPERTY) {\n            const op = {\n                type: last.type,\n                host: last.host,\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                object: last.object,\n                name: last.name,\n                value: last.value\n            }\n            this.graph.process(op)\n            return\n        }\n        if (last.type === CREATE_OBJECT) {\n            const op = {\n                type: last.type,\n                host: last.host,\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                id: last.id,\n            }\n            this.graph.process(op)\n            return\n        }\n        if (last.type === INSERT_ELEMENT) {\n            console.log(\"redoing\", last)\n            const op = {\n                type: last.type,\n                host: last.host,\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                array: last.array,\n                value: last.value,\n                entryid: this.graph.makeGUID(),\n                prev: -1,\n            }\n            this.graph.process(op)\n            return\n        }\n        throw new Error(`redo for type not supported: ${last.type}`)\n    }\n\n    dump() {\n        return this.history.map((op, i) => i + \" \" + op.type + \" \" + op.name + \" => \" + op.value)\n    }\n}\n","const {SET_PROPERTY} = require(\"syncing_protocol\");\n\n\nexport class EventCoalescer {\n    constructor(graph) {\n        this.graph = graph\n        this.listeners = []\n        this.rawlisteners = []\n        this.paused = false\n        this.buffer = []\n        this.first = {}\n        this.last = {}\n    }\n\n    pause() {\n        this.paused = true\n    }\n\n    unpause() {\n        this.paused = false\n        this.buffer = []\n        // console.log(\"need to send out set property updates\",this.last)\n        // console.log('the originals are',this.first)\n        Object.keys(this.last).forEach((key) => {\n            Object.keys(this.last[key]).forEach(name => {\n                const op = this.last[key][name]\n                // console.log(\"sending\",short(op))\n                op.prevValue = this.first[key][name].value\n                this.fire(op)\n                this.graph.process(op)\n            })\n        })\n\n        this.first = {}\n        this.last = {}\n\n        // console.log(this.graph.dumpGraph())\n        // this.graph.getHistory().forEach(h => console.log(h.type,h.name,h.value))\n    }\n\n    onChange = cb => this.listeners.push(cb)\n    onRawChange = cb => this.rawlisteners.push(cb)\n    fire = op => this.listeners.forEach(cb => cb(op))\n    fireRaw = op => this.rawlisteners.forEach(cb => cb(op))\n    getPropertiesForObject = (obj) => this.graph.getPropertiesForObject(obj)\n    getArrayLength = (obj) => this.graph.getArrayLength(obj)\n    getElementAt = (obj, index) => this.graph.getElementAt(obj, index)\n    getHostId = () => this.graph.getHostId()\n\n\n    getPropertyValue(obj, key) {\n        // console.log(\"checking\",this.paused,obj,key)\n        if (this.paused && this.last[obj] && this.last[obj][key]) {\n            // console.log(\"returning the raw property values\",this.last[obj][key])\n            return this.last[obj][key].value\n        } else {\n            return this.graph.getPropertyValue(obj, key)\n        }\n    }\n\n    bufferOp(op) {\n        if (!this.first[op.object]) this.first[op.object] = {}\n        if (!this.first[op.object][op.name]) this.first[op.object][op.name] = op\n        if (!this.last[op.object]) this.last[op.object] = {}\n        this.last[op.object][op.name] = op\n        this.buffer.push(op)\n        this.fireRaw(op)\n    }\n\n    process(op) {\n        if (op.type === SET_PROPERTY && this.paused) {\n            this.bufferOp(op)\n        } else {\n            this.fire(op)\n            this.graph.process(op)\n        }\n    }\n}\n","import PubNub from \"pubnub\";\nimport {AuthModule} from '../vr/AuthModule'\nimport inspect from \"util-inspect\";\n\nfunction short(op) {\n    let str = `${op.type} ${op.uuid} |  `\n    if(op.name) {\n        str += `${op.name} = ${op.value}  prev = ${op.prevValue}`\n    }\n    return str\n}\nconst settings = {\n    publishKey: 'pub-c-1cba58da-c59a-4b8b-b756-09e9b33b1edd',\n    subscribeKey: 'sub-c-39263f3a-f6fb-11e7-847e-5ef6eb1f4733',\n}\n\nexport class PubnubSyncWrapper {\n    constructor(provider, graph) {\n        if(!provider) throw new Error('created PubnubSyncWrapper without a provider')\n        if(!graph) throw new Error('created PubnubSyncWrapper without a graph')\n        this.paused = false\n        this.buffer = []\n        this.provider = provider\n\n        graph.onChange((e)=>this.handleGraphChange(e))\n\n        this.pubnub = new PubNub(settings)\n        this.logger = new PubnubLogger(this.provider.getDocId(),this.pubnub)\n    }\n\n    calculateChannelName() {\n        return \"metadoc-docupdate-\" + this.provider.getDocId() + \"_\"+AuthModule.getServerID()\n    }\n    calculateLoggerChannelName() {\n        return \"metadoc-log-\" + this.provider.getDocId()+\"_\"+AuthModule.getServerID()\n    }\n\n    start() {\n        this.pubnub.addListener({\n            status: (e) => {\n                // console.log(e)\n                if (e.operation === 'PNSubscribeOperation' && e.category === 'PNConnectedCategory') {\n                    this.sendHistoryRequest()\n                }\n            },\n            message: (m)=>this.handleMessage(m),\n        })\n\n        this.pubnub.subscribe({channels: [this.calculateChannelName(),this.calculateLoggerChannelName()]})\n    }\n\n    pause() {\n        this.paused = true\n    }\n\n    unpause() {\n        this.paused = false\n        // console.log(\"we need to send the waiting messages\", this.buffer)\n        this.buffer.forEach(op => this.sendMessage(op))\n        this.buffer = []\n        //now request history from the network for anything we missed\n        // this.sendHistoryRequest()\n    }\n\n    shutdown() {\n        this.pubnub.unsubscribe({channels: [this.calculateChannelName()]})\n        this.pubnub.stop()\n    }\n\n    sendMessage(e) {\n        console.log(\"PN_SEND:\", short(e))\n        this.pubnub.publish({\n            channel: this.calculateChannelName(),\n            message: e\n        }, (status, response) => {\n            // console.log(\"published\",status,response)\n        })\n\n    }\n\n    handleGraphChange (e) {\n        // console.log(\"graph changed\",e)\n        const host = this.provider.getDataGraph().getHostId()\n        if (e.host !== host) return\n        if (this.paused) return this.buffer.push(e)\n        this.sendMessage(e)\n    }\n\n    sendHistoryRequest() {\n        // console.log(\"sending a history request\")\n        this.pubnub.publish({\n            channel: this.calculateChannelName(),\n            message: {\n                type: 'GET_HISTORY',\n                host: this.provider.getDataGraph().getHostId()\n            }\n        })\n    }\n\n    handleGetHistory() {\n        // console.log(\"need to send out the history\")\n        const graph = this.provider.getDataGraph()\n        const hist = graph.getHistory().slice()\n        console.log(hist)\n        const chunkSize = 30\n        let count = 0\n        while (hist.length > 0) {\n            if (count > 100) {\n                console.log(\"breaking out. possible infinite loop\")\n                break\n            }\n            count++\n            const chunk = hist.splice(0, chunkSize)\n            console.log(\"sending\", chunk.length, chunk)\n            this.pubnub.publish({\n                channel: this.calculateChannelName(),\n                message: {\n                    type: 'SEND_HISTORY',\n                    host: graph.getHostId(),\n                    history: chunk\n                }\n            }, (status, response) => {\n                console.log(\"published\", status, response)\n            })\n        }\n\n    }\n\n    handleReceiveHistory(msg) {\n        // console.log(\"got some history\", msg.history.length)\n        msg.history.forEach(op => this.provider.getDataGraph().process(op))\n    }\n\n\n    handleMessage (evt) {\n        if (this.paused) return\n//        console.log(\"channel is\",evt.channel)\n        if(evt.channel === this.calculateLoggerChannelName()) {\n            if(evt.publisher !== this.pubnub.getUUID()) {\n                console.log(\"REMOTE LOGGER\", evt.message.length, evt.message.substring(200))\n            }\n            return\n        }\n        const graph = this.provider.getDataGraph()\n        // console.log('PN_REMOTE',evt)\n        if (evt.message.type === 'GET_HISTORY') {\n            // console.log(\"got a history request\",evt.message.host, graph.getHostId())\n            if (evt.message.host !== graph.getHostId()) {\n                return this.handleGetHistory()\n            }\n            return\n        }\n        if (evt.message.type === 'SEND_HISTORY') {\n            if (evt.message.host !== graph.getHostId()) {\n                return this.handleReceiveHistory(evt.message)\n            }\n            return\n        }\n        const op = evt.message\n        if (!op.host) return console.log(\"received a message without a host\", op)\n        if (!op.timestamp) return console.error(\"received a message without a timestamp\", op)\n        if (op.host && op.host === graph.getHostId()) {\n            // console.log(\"SKIP: my own message came in. ignoring it\")\n            return\n        }\n        console.log(\"REMOTE\", op)\n        graph.process(op)\n    }\n\n    getLogger() {\n        return this.logger\n    }\n}\n\n\nexport class PubnubLogger {\n    constructor(docid, pubnub) {\n        this.count = 0\n        this.docid = docid\n        this.listeners = {}\n        if(!pubnub) {\n            this.pubnub = new PubNub(settings)\n        } else {\n            this.pubnub = pubnub\n        }\n    }\n    addEventListener(type,cb) {\n        this.getListeners(type).push(cb)\n    }\n    calculateLoggerChannelName() {\n        return \"metadoc-log-\" + this.docid+\"_\"+AuthModule.getServerID()\n    }\n\n    log() {\n        this.fire('log',this.makePayload(Array.from(arguments)))\n    }\n    error () {\n        this.fire('error',this.makePayload(Array.from(arguments)))\n    }\n\n    getListeners(type) {\n        if(!this.listeners) this.listeners = {}\n        if(!this.listeners[type]) this.listeners[type] = []\n        return this.listeners[type]\n    }\n\n    fire(type, payload) {\n        // console.log(`LOGGER ${type} `, inspect(payload, {depth:3}))\n        payload.type = type\n        this.pubnub.publish({\n            channel: this.calculateLoggerChannelName(),\n            message: inspect(payload,{depth:3})\n        })\n        this.getListeners(type).forEach(cb => cb(payload))\n    }\n    makePayload(arr) {\n        return {\n            data: arr,\n            count: this.count++,\n        }\n    }\n}\n\nexport class ConsoleLogger {\n    constructor() {\n        this.listeners = {}\n        this.count = 0\n    }\n\n    addEventListener(type, cb) {\n        this.getListeners(type).push(cb)\n    }\n\n    getListeners(type) {\n        if (!this.listeners) this.listeners = {}\n        if (!this.listeners[type]) this.listeners[type] = []\n        return this.listeners[type]\n    }\n\n    fire(type, payload) {\n        // console.log(`DUMMY LOGGER ${type} `, payload)\n        payload.type = type\n        this.getListeners(type).forEach(cb => cb(payload))\n    }\n\n    log() {\n        this.fire('log', this.makePayload(Array.from(arguments)))\n    }\n\n    error() {\n        this.fire('error', this.makePayload(Array.from(arguments)))\n    }\n\n    makePayload(arr) {\n        return {\n            data: arr,\n            count: this.count++,\n        }\n    }\n}","export function listToArray(list) {\n    return Array.prototype.slice.call(list)\n}\nexport function createGraphObjectFromObject(graph, json) {\n    return graph.createObject(json)\n}\n\nexport function fetchGraphObject(graph, objid) {\n    const obj = {}\n    graph.getPropertiesForObject(objid).forEach(key => {\n        obj[key] = graph.getPropertyValue(objid, key)\n    })\n    obj.id = objid\n    return obj\n}\n\nexport function propToArray(doc, CH) {\n    const len = doc.getArrayLength(CH)\n    const ch = []\n    for (let i = 0; i < len; i++) {\n        ch.push(doc.getElementAt(CH, i))\n    }\n    return ch\n}\n\nexport function indexOf(graph, array, target) {\n    const arr = propToArray(graph,array)\n    return arr.findIndex(e => e === target)\n}\n\nexport function insertAsFirstChild(graph, parent, child) {\n    graph.setProperty(child.id,'parent',parent.id)\n    const ch = graph.getPropertyValue(parent.id,'children')\n    graph.insertAfter(ch,null,child.id)\n}\n\nexport function insertAsLastChild(graph, parent, child) {\n    graph.setProperty(child.id,'parent',parent.id)\n    const ch = graph.getPropertyValue(parent.id,'children')\n    const len = graph.getArrayLength(ch)\n    const prev = graph.getElementAt(ch,len-1)\n    graph.insertAfter(ch,prev,child.id)\n}\n\nexport function removeFromParent(graph, obj) {\n    const parent = fetchGraphObject(graph, obj.parent)\n    const n = indexOf(graph, parent.children, obj.id)\n    if (n >= 0) {\n        graph.removeElement(parent.children, n)\n    } else {\n        console.error(\"could not find index for child\", obj, 'in children', parent.children)\n    }\n}\n\n\nexport function cloneShape(graph,shape) {\n    const id = shape.id\n    const id2 = graph.createObject()\n    const props = graph.getPropertiesForObject(id)\n    props.forEach(key => {\n        graph.createProperty(id2,key,graph.getPropertyValue(id,key))\n    })\n    const shape2 = fetchGraphObject(graph,id2)\n    return shape2\n}\n","import React, {Component} from 'react'\n\nexport  class Dialog extends Component {\n    clickedScrim = (e) => {\n        if(e.target !== this.scrim) return\n        if(this.props.onScrimClick) this.props.onScrimClick(e)\n    }\n    render() {\n        if(!this.props.visible) return <div/>;\n        const bodyStyle = {}\n        if(this.props.width) bodyStyle.width = this.props.width\n        if(this.props.height) bodyStyle.height = this.props.height\n        return <div className={\"dialog-scrim\"} ref={(scrim)=>this.scrim=scrim} onClick={this.clickedScrim}>\n            <div className={\"dialog-body\"} style={bodyStyle}>{this.props.children}</div>\n        </div>\n\n    }\n}\n","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {Dialog} from '../common/Dialog'\n\nexport class MissingDocDialog extends Component {\n\n    cancel = () => {\n        DialogManager.hide()\n    }\n\n    okay = () => {\n        DialogManager.hide()\n        this.props.provider.createNewDocument(this.props.docid)\n    }\n\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n                <header>Document \"<b>{this.props.docid}</b>\" not found</header>\n                <section>\n                    Create a new document?\n                </section>\n                <footer>\n                    <button onClick={this.cancel}>cancel</button>\n                    <button onClick={this.okay}>okay</button>\n                </footer>\n        </Dialog>\n    }\n\n}","import TreeItemProvider, {getDocsURL, TREE_ITEM_PROVIDER} from '../TreeItemProvider'\nimport {setQuery, toQueryString} from '../utils'\nimport {UndoQueue} from './UndoQueue'\nimport {EventCoalescer} from '../metadoc/EventCoalescer'\nimport SelectionManager from '../SelectionManager'\nimport {PubnubSyncWrapper} from './PubnubSyncWrapper'\nimport {propToArray} from \"./utils\";\nimport * as ToasterMananager from '../vr/ToasterManager'\nimport {DialogManager} from 'appy-comps'\nimport {MissingDocDialog} from './MissingDocDialog'\nimport React from 'react'\nimport {AuthModule} from '../vr/AuthModule'\n\nconst {DocGraph, CommandGenerator, toDocGraphFromObjectGraph, toObjectGraphFromDocGraph} = require(\"syncing_protocol\");\n\n\n\nexport default class SyncGraphProvider extends TreeItemProvider {\n    constructor(options) {\n        super(options)\n        this.options = options || {}\n        this.mode = options.mode || 'edit'\n        this.datalisteners = []\n        this.rawlisteners = []\n        this.expanded = {}\n\n        if(options.doc) {\n            this.loadDoc(options.doc)\n        } else {\n            this.createNewDocument()\n        }\n    }\n    getDocTitle = () => \"untitled\"\n    getDocHistory = () => this.getDataGraph().getHistory()\n    getDocGraph = () => {\n        const root = this.getDataGraph().getObjectByProperty('type','root')\n        return toObjectGraphFromDocGraph(this.getDataGraph(),root)\n    }\n    onRawChange = cb => this.rawlisteners.push(cb)\n    getRawGraph = () => this.coalescer\n    getDataGraph = () => this.syncdoc\n    getSceneRoot = () => this.getDataGraph().getObjectByProperty('type','root')\n    hasChildren = (item) => item && this.getDataGraph().hasPropertyValue(item,'children')\n    getChildren = (item) => {\n        const doc = this.getDataGraph()\n        return propToArray(doc,doc.getPropertyValue(item,'children'))\n    }\n    isExpanded = (item) => {\n        if (typeof this.expanded[item] === 'undefined') this.expanded[item] = true;\n        return this.expanded[item]\n    }\n    toggleItemCollapsed(item) {\n        const current = this.isExpanded(item);\n        this.expanded[item] = !current;\n        this.fire(TREE_ITEM_PROVIDER.EXPANDED_CHANGED,item);\n    }\n\n    setPropertyValue(item, def, value) {\n        const op = this.cmd.setProperty(item,def.key,value)\n        op.prevValue = def.value\n        this.getRawGraph().process(op)\n        this.fire(TREE_ITEM_PROVIDER.PROPERTY_CHANGED,{\n            provider: this,\n            child:item,\n            propKey:def.key,\n            oldValue:def.value,\n            newValue:value\n        })\n    }\n\n    save = (e) => {\n        if(e) e.preventDefault()\n        const payload_obj = {\n            history:this.getDocHistory(),\n            type:this.getDocType(),\n            id:this.getDocId(),\n            graph:this.getDocGraph(),\n            title:this.getDocTitle(),\n        }\n        const payload_string = JSON.stringify(payload_obj)\n        ToasterMananager.add('saving')\n        const opts = {\n            type:this.getDocType(),\n            title:this.getDocTitle(),\n        }\n        const url = getDocsURL()+this.getDocId()+'?'+toQueryString(opts)\n        console.log(`saving ${payload_string.length} chars to ${url}`, payload_obj)\n        return AuthModule.fetch(url,{\n            method:'POST',\n            body:payload_string,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            },\n        })\n            .then(res=>res.json())\n            .then(res => {\n                console.log(\"got back result\",res)\n                setQuery({mode:this.mode,doc:this.getDocId(), doctype:this.getDocType()})\n                ToasterMananager.add(res.message)\n                this.fire(TREE_ITEM_PROVIDER.SAVED,true)\n            }).catch((e)=> console.log(\"error\",e))\n    }\n\n    loadDoc(docid) {\n        return AuthModule.getJSON(getDocsURL()+docid)\n            .then((payload)=>{\n                console.log(\"got the payload\",payload)\n                if(!payload.id) return this.showMissingDocDialog(docid)\n                const doc = this.makeDocFromServerHistory(payload.history)\n                return this.setupDocFlow(doc,docid)\n            })\n            .catch((e)=> {\n                console.error(\"there was an error loading doc\", docid, e)\n                console.log(\"trying to load again without the history\")\n                return AuthModule.getJSON(getDocsURL() + docid)\n                    .then((payload) => {\n                        console.log(\"got the payload\", payload)\n                        const doc = this.makeDocFromServerGraph(payload.graph)\n                        return this.setupDocFlow(doc, docid)\n                    })\n            }).catch((e) => {\n                console.error(\"there was an error loading doc\", docid, e)\n                const doc = new DocGraph()\n                this.makeEmptyRoot(doc)\n                this.setupDocFlow(doc,this.genID('doc'))\n            })\n    }\n\n    createNewDocument(docid) {\n        if(!docid) docid = this.genID(\"doc\")\n        const doc = new DocGraph()\n        this.makeEmptyRoot(doc)\n        this.setupDocFlow(doc,docid)\n    }\n\n    setupDocFlow(doc,docid) {\n        //shut down old network connection\n        if(this.pubnub) this.pubnub.shutdown()\n        this.pubnub = null\n\n        this.syncdoc = doc\n        this.cmd = new CommandGenerator(this.syncdoc)\n        this.root = this.getSceneRoot()\n        this.docid = docid\n        this.undoqueue = new UndoQueue(doc)\n        this.coalescer = new EventCoalescer(this.syncdoc) //sends calls on to sync doc, and fires change event\n        this.coalescer.onChange((op) => this.undoqueue.submit(op))\n\n        this.coalescer.onRawChange(op =>this.rawlisteners.forEach(cb => cb(op)))\n        this.syncdoc.onChange(op => this.rawlisteners.forEach(cb => cb(op)))\n        this.syncdoc.onChange((op)=>{\n            this.fire(TREE_ITEM_PROVIDER.STRUCTURE_CHANGED, { provider:this });\n            this.fire(TREE_ITEM_PROVIDER.PROPERTY_CHANGED, { provider:this });\n        })\n        this.fire(TREE_ITEM_PROVIDER.STRUCTURE_CHANGED, { provider:this });\n        this.fire(TREE_ITEM_PROVIDER.CLEAR_DIRTY,true)\n        SelectionManager.clearSelection()\n        this.pubnub = new PubnubSyncWrapper(this,this.syncdoc)\n        this.pubnub.unpause()\n        this.pubnub.start()\n        return this.docLoaded().then(()=>{\n            this.fire(TREE_ITEM_PROVIDER.DOCUMENT_SWAPPED,{provider:this})\n            setQuery({mode:this.mode,doc:this.getDocId(), doctype:this.getDocType()})\n            this.connected = true\n            this.fire(\"CONNECTED\",this.connected)\n        })\n    }\n\n    reloadDocument() {\n        return AuthModule.getJSON(getDocsURL()+this.docid).then((payload)=>{\n            if(payload.type !== this.getDocType()) throw new Error(\"incorrect doctype for this provider\",payload.type)\n            const doc = this.makeDocFromServerHistory(payload.history)\n            this.setupDocFlow(doc,this.docid)\n        }).catch((e)=>{\n            console.error(\"couldn't reload the doc\",e)\n            const doc = new DocGraph()\n            this.makeEmptyRoot(doc)\n            this.setupDocFlow(doc,this.genID('doc'))\n        })\n\n    }\n\n    duplicateDocument(title) {\n        const newDocId = this.genID(\"doc\")\n        this.save().then(()=> {\n            this.docid = newDocId\n            this.setDocTitle(title)\n            const graph = this.getDocGraph()\n            const new_doc = new DocGraph()\n            toDocGraphFromObjectGraph(graph,new_doc)\n            this.syncdoc = new_doc\n            return this.save()\n        }).then(()=>{\n            ToasterMananager.add('duplicating doc')\n            return this.loadDoc(newDocId)\n        })\n    }\n\n    docLoaded = () => {\n        return Promise.resolve()\n    }\n\n    toggleConnected = () => {\n        this.connected = !this.connected\n        if(this.pubnub) {\n            if(this.connected) {\n                this.pubnub.unpause()\n            } else {\n                this.pubnub.pause()\n            }\n        }\n        this.fire(\"CONNECTED\",this.connected)\n    }\n\n    isConnected = () => this.connected\n\n    pauseQueue = () => this.coalescer.pause()\n    unpauseQueue = () => this.coalescer.unpause()\n\n    performUndo = (e) => {\n        if(e && e.preventDefault) e.preventDefault()\n\n        if(this.undoqueue.canUndo()) {\n            this.undoqueue.undo()\n        } else {\n            console.warn(\"at beginnning of the undo queue\")\n        }\n    }\n    performRedo = (e) => {\n        if(e && e.preventDefault) e.preventDefault()\n        if(this.undoqueue.canRedo()) this.undoqueue.redo()\n    }\n\n    makeDocFromServerHistory(history) {\n        const doc = new DocGraph()\n        history.forEach(op => doc.process(op))\n        return doc\n    }\n\n\n    showMissingDocDialog(docid) {\n        DialogManager.show(<MissingDocDialog docid={docid} provider={this}/>)\n    }\n\n    makeDocFromServerGraph(graph) {\n        console.log(\"Making Doc from Server Graph\",graph)\n        const doc = new DocGraph()\n        toDocGraphFromObjectGraph(graph,doc)\n        return doc\n    }\n}\n","import React, {Component} from 'react'\nimport {PopupManager, VBox} from 'appy-comps'\nimport {makePoint} from '../utils'\n\nconst GridLayout = (props) => {\n    let clss = \"grid fill\";\n    let leftWidth = props.leftWidth\n    let rightWidth = props.rightWidth\n    if (!props.showLeft) {\n        clss += ' hide-left'\n        leftWidth = 0\n    }\n    if (!props.showRight) {\n        clss += ' hide-right'\n        rightWidth = 0\n    }\n    const cols = `\n    [left] ${leftWidth}px\n    [left-resize] 2px\n    [center] auto\n    [right-resize] 2px\n    [right] ${rightWidth}px\n    `\n    const style = {gridTemplateColumns:cols}\n    return <div className={clss} style={style}>{props.children}</div>\n};\n\nexport const Toolbar = (props) => {\n    let cls = \"toolbar\";\n    if (props.left) cls += \" left\";\n    if (props.right) cls += \" right\";\n    if (props.bottom) cls += \" bottom\";\n    if (props.top) cls += \" top\";\n    if (props.center) cls += \" center\";\n    if (props.middle) cls += \" middle\";\n    if (props.scroll) cls += \" scroll\";\n    return <div className={cls}>{props.children}</div>\n};\nexport const Panel = (props) => {\n    let cls = 'panel';\n    if (props.left) cls += \" left\";\n    if (props.right) cls += \" right\";\n    if (props.bottom) cls += \" bottom\";\n    if (props.top) cls += \" top\";\n    if (props.center) cls += \" center\";\n    if (props.middle) cls += \" middle\";\n    if (props.scroll) cls += \" scroll\";\n    if (props.transparent) cls += \" transparent\"\n    return <div className={cls}>{props.children}</div>\n};\nexport const Spacer = (props) => {\n    return <span className='spacer'/>\n};\n\nexport const ToggleButton = (props) => {\n    const {selected, ...rest} = props\n    const clss = selected?\"selected\":\"\"\n    return <button className={clss} {...rest}></button>\n}\n\nexport const MenuPopup = (props) => {\n    return <VBox className={\"popup-menu\"}>\n        {props.actions.map((act,i)=>{\n            if(act.divider) return <div className=\"divider\" key={i}></div>\n            let enabled = false\n            if(typeof act.enabled === 'undefined') enabled = true\n            if(act.enabled === true) enabled = true\n            return <button  key={i}\n                            disabled={!enabled}\n                            onClick={()=>{\n                PopupManager.hide();\n                if(act.fun) act.fun()\n            }}><i className={act.icon}/> {act.title}</button>\n        })}\n    </VBox>\n\n}\n\nexport default class GridEditorApp extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            showLeft: true,\n            showRight: true,\n            leftWidth:250,\n            rightWidth:250,\n            dragSide:'none'\n        }\n    }\n    toggleLeftPane = (e) => this.setState({showLeft: !this.state.showLeft})\n    toggleRightPane = (e) => this.setState({showRight: !this.state.showRight})\n    onMouseDownLeft = (e) => {\n        e.preventDefault()\n        e.stopPropagation()\n        this.setState({dragSide:'left'})\n        window.addEventListener('mousemove',this.onMouseMove)\n        window.addEventListener('mouseup',this.onMouseUp)\n    }\n    onMouseDownRight = (e) => {\n        e.preventDefault()\n        e.stopPropagation()\n        this.setState({dragSide:'right'})\n        window.addEventListener('mousemove',this.onMouseMove)\n        window.addEventListener('mouseup',this.onMouseUp)\n    }\n    onMouseMove = (e) => {\n        e.preventDefault()\n        e.stopPropagation()\n        const cursor = makePoint(e.clientX, e.clientY)\n        if(this.state.dragSide === 'left')  this.setState({leftWidth:cursor.x})\n        if(this.state.dragSide === 'right') this.setState({rightWidth:window.innerWidth-cursor.x})\n    }\n    onMouseUp = (e) => {\n        e.preventDefault()\n        e.stopPropagation()\n        window.removeEventListener('mousemove', this.onMouseMove)\n        window.removeEventListener('mouseup', this.onMouseUp)\n    }\n    render() {\n        return <GridLayout showLeft={this.state.showLeft}\n                           showRight={this.state.showRight}\n                           leftWidth={this.state.leftWidth}\n                           rightWidth={this.state.rightWidth}\n        >\n\n            <div className={'left-resize'}  onMouseDown={this.onMouseDownLeft}/>\n            <div className={'right-resize'} onMouseDown={this.onMouseDownRight}/>\n\n            {this.props.children}\n        </GridLayout>\n    }\n}\n","import React, { Component } from 'react';\nimport selMan, {SELECTION_MANAGER} from \"../SelectionManager\";\nimport {TREE_ITEM_PROVIDER} from '../TreeItemProvider';\nimport {PopupManager, VBox} from \"appy-comps\";\nimport {fetchGraphObject, removeFromParent} from \"../syncgraph/utils\";\nimport {Spacer} from './GridEditorApp'\n\nimport \"./treetable.css\"\n\n\nconst ContextMenu = (props) => {\n    return <VBox className={\"popup-menu\"}>\n        {props.menu.map((item,i)=>{\n            if(item.divider) return <div className=\"divider\" key={i}></div>\n            let enabled = false\n            if(typeof item.enabled === 'undefined') enabled = true\n            if(item.enabled === true) enabled = true\n            return <button key={i}\n                           disabled={!enabled}\n                           onClick={()=>{\n                PopupManager.hide()\n                if(item.fun) item.fun()\n            }}\n            ><i className={item.icon}/> {item.title}</button>\n        })}\n    </VBox>\n}\n\nclass TreeTableItem extends Component {\n    onSelect = (e)=>  {\n        if(e.shiftKey) {\n            selMan.addToSelection(this.props.node)\n        } else {\n            selMan.setSelection(this.props.node)\n        }\n    }\n    onContextMenu = (e) => {\n        e.preventDefault()\n        e.stopPropagation()\n        selMan.setSelection(this.props.node)\n        if(this.props.provider.calculateContextMenu) {\n            const menu = this.props.provider.calculateContextMenu(this.props.node)\n            PopupManager.show(<ContextMenu menu={menu}/>,e.target)\n        }\n    }\n    toggleItemCollapsed = (e) => {\n        e.preventDefault()\n        e.stopPropagation()\n        this.props.provider.toggleItemCollapsed(this.props.node);\n    }\n    onDragStart = (e) => {\n        this.props.onDragStart(e,this.props.node)\n    }\n    onDragOver = (e) => {\n        this.props.onDragOver(e,this.props.node)\n    }\n    onDragEnd = (e) => {\n        this.props.onDragEnd(e,this.props.node)\n    }\n    onDrop = (e) => {\n        this.props.onDrop(e,this.props.node)\n    }\n    render() {\n        let cls = \"tree-node\";\n        const node = this.props.node\n        if (selMan.isSelected(node)) cls += \" selected\"\n        if (selMan.getDropTarget() === node) {\n            cls += \" drop-target\"\n            if(selMan.getDropType() === 'parent') cls += \" drop-parent\"\n        }\n        let arrow = \"\";\n        const prov = this.props.provider\n        if (prov.hasChildren(node)) {\n            const expanded = prov.isExpanded(node)\n            if (expanded) {\n                arrow = <button className=\"fa fa-caret-down fa-fw\" onClick={this.toggleItemCollapsed}/>;\n            } else {\n                arrow = <button className=\"fa fa-caret-right fa-fw\" onClick={this.toggleItemCollapsed}/>;\n            }\n        } else {\n            arrow = <span className=\"fa fa-fw borderless\"/>\n        }\n\n        return <div className={cls}\n                    onClick={this.onSelect}\n                    onContextMenu={this.onContextMenu}\n                    data-nodeid={node.id}\n                    onDragOver={this.onDragOver}\n                    onDrop={this.onDrop}\n        >\n            <span style={{\n                width:this.props.depth*2.5+'em'\n            }}></span>\n            {arrow}\n            {prov.getRendererForItem(node)}\n            <Spacer/>\n            {this.renderDragBars()}\n        </div>\n    }\n\n    renderDragBars() {\n        if(this.props.provider.canBeMoved && !this.props.provider.canBeMoved(this.props.node))  return \"\"\n        return <span className={\"drag fa fa-bars\"}\n              draggable\n              onDragStart={this.onDragStart}\n              onDragEnd={this.onDragEnd}\n        />\n\n    }\n}\n\n\n\nexport default class TreeTable extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            root:this.props.root,\n            dropTarget:null,\n            selection:null,\n            dragTarget:null,\n            internalDrag:false,\n        }\n    }\n    componentDidMount() {\n        this.listener = this.props.provider.on(TREE_ITEM_PROVIDER.EXPANDED_CHANGED,\n            (item)=>  this.setState({root:this.props.provider.getSceneRoot()}))\n        this.props.provider.on(TREE_ITEM_PROVIDER.STRUCTURE_ADDED,\n            (item)=>  this.setState({root:this.props.provider.getSceneRoot()}))\n        this.props.provider.on(TREE_ITEM_PROVIDER.STRUCTURE_CHANGED,\n            (item)=>  this.setState({root:this.props.provider.getSceneRoot()}))\n\n        this.other_listener = selMan.on(SELECTION_MANAGER.CHANGED, (sel)=> this.setState({selection:sel}))\n        selMan.on(SELECTION_MANAGER.DROP_TARGET_CHANGED, (sel) => this.setState({dropTarget:selMan.getDropTarget()}))\n    }\n    componentWillUnmount() {\n        this.props.provider.off(TREE_ITEM_PROVIDER.EXPANDED_CHANGED, this.listener)\n        selMan.off(SELECTION_MANAGER.CHANGED,this.other_listener)\n    }\n    componentWillReceiveProps(newProps) {\n        if(newProps.root) this.setState({root:newProps.root})\n    }\n\n    onDragStart = (e,item) => {\n        console.log('starting to drag the item',item)\n        e.dataTransfer.effectAllowed = \"move\";\n        e.dataTransfer.setData(\"text/html\", e.target.parentNode);\n        e.dataTransfer.setDragImage(e.target.parentNode, 20, 20);\n        e.dataTransfer.dropEffect = 'move'\n        this.setState({dragTarget:item, internalDrag:true})\n    }\n    onDragOver = (e,item) => {\n        if(!this.state.internalDrag) {\n            e.preventDefault()\n            if(this.props.provider.canAddExternalChild(item,e.dataTransfer)) {\n                selMan.setDropTarget(item)\n                selMan.setDropType('parent')\n            } else {\n                selMan.setDropType(null)\n                selMan.setDropTarget(null)\n            }\n            return\n        }\n        const prov = this.props.provider\n        if(prov.canAddChild(item,this.state.dragTarget)) {\n            //use the rop target as a parent\n            selMan.setDropTarget(item)\n            selMan.setDropType('parent')\n            return\n        } else if(prov.canBeSibling(item,this.state.dragTarget)) {\n            //use the drop target as a sibling\n            selMan.setDropType('sibling')\n            selMan.setDropTarget(item)\n        } else {\n            //no valid target\n            selMan.setDropType(null)\n            selMan.setDropTarget(null)\n        }\n    }\n    onDragEnd = (e,item) => {\n        //handle external case\n        if(!this.state.internalDrag){\n            this.setState({dragTarget:null, internalDrag:false})\n            e.preventDefault()\n            e.stopPropagation()\n            return\n        }\n\n        const graph = this.props.provider.getDataGraph()\n        if(!this.state.dragTarget) return\n        if(!this.state.dropTarget) return\n        const src = fetchGraphObject(graph,this.state.dragTarget)\n        const dst = fetchGraphObject(graph,this.state.dropTarget)\n\n\n        //can't drop onto self\n        if(dst.id === src.id) {\n            this.setState({dragTarget:null, internalDrag:false})\n            selMan.setDropTarget(null)\n            return\n        }\n\n\n        //remove from old location\n        removeFromParent(graph,src)\n\n        const dt = selMan.getDropType()\n        if(dt === 'parent') {\n            graph.setProperty(src.id,'parent',dst.id)\n            graph.insertAfter(dst.children,null,src.id)\n        } else {\n            const parent2 = fetchGraphObject(graph,dst.parent)\n            graph.setProperty(src.id, 'parent', parent2.id)\n            graph.insertAfter(parent2.children, dst.id, src.id)\n        }\n        this.setState({dragTarget:null})\n        selMan.setDropTarget(null)\n    }\n    onDrop = (e,item) => {\n        if(!this.state.internalDrag) {\n            e.stopPropagation()\n            e.preventDefault()\n            this.props.provider.acceptDrop(e,item)\n            this.setState({internalDrag:false, dragTarget:null})\n        }\n        // var data = e.dataTransfer.getData(\"text/html\");\n        // console.log('the dropped data is',data)\n    }\n    render() {\n        if(!this.state.root) return <ul>no root yet</ul>\n        const children = [];\n        this.generateChildren(this.state.root,children,0)\n        return <ul className='tree-table'>\n            {children.map((info,i)=>{\n                return <TreeTableItem key={i}\n                                      node={info.node}\n                                      depth={info.depth}\n                                      provider={this.props.provider}\n                                      selection={this.state.selection}\n                                      onDragStart={this.onDragStart}\n                                      onDragOver={this.onDragOver}\n                                      onDragEnd={this.onDragEnd}\n                                      onDrop={this.onDrop}\n                />\n            })}\n        </ul>\n    }\n\n    generateChildren = (root, chs,depth) => {\n        const prov = this.props.provider\n        chs.push({node:root, depth:depth})\n        if(!prov.hasChildren(root)) return\n        if(!prov.isExpanded(root)) return;\n        prov.getChildren(root).forEach((child)=>{\n            this.generateChildren(child,chs,depth+1)\n        })\n    }\n}\n\n","import React, { Component } from 'react'\nimport {makePoint} from \"../utils\"\nimport hsluv from 'hsluv'\nimport {PopupManager} from \"appy-comps\"\n\nexport default class HSLUVColorPicker extends Component {\n    constructor(props) {\n        super(props)\n\n        const comps = hsluv.hexToHsluv(props.value)\n        this.state = {\n            hue:comps[0],\n            lightness:comps[1],\n            value:comps[2],\n        }\n        console.log(\"the current value is\",props.value, hsluv.hexToHsluv(props.value))\n    }\n    componentDidMount() {\n        this.redraw();\n    }\n    canvasToPoint(e) {\n        const canvasBounds = this.canvas.getBoundingClientRect()\n        const pt = makePoint(e.clientX, e.clientY).minus(makePoint(canvasBounds.x,canvasBounds.y))\n        const h = this.canvas.height;\n        const w = this.canvas.width;\n        const f = makePoint(pt.x/w*100, pt.y/h*100)\n        return f;\n    }\n    mousePress = (e) => {\n        const pt = this.canvasToPoint(e)\n        this.setState({lightness:pt.x, value:pt.y})\n        this.redraw()\n        this.pressed = true;\n    }\n    mouseMove = (e) => {\n        if(!this.pressed) return\n        const pt = this.canvasToPoint(e)\n        this.setState({lightness:pt.x, value:pt.y})\n        this.redraw()\n    }\n    mouseUp = (e) => {\n        this.pressed = false\n        this.redraw()\n    }\n    redraw = () => {\n        this.drawPicker()\n        this.drawSlider()\n        this.drawIndicator()\n    }\n    drawPicker() {\n        const canvas = this.canvas\n        if(!canvas) return\n        const c = this.canvas.getContext('2d')\n        let w = 100\n        let h = 100\n        const hue = Math.floor(this.state.hue)\n        for(let i=0; i<=4; i++) {\n            for(let j=0; j<=4; j++) {\n                let color = hsluv.hsluvToHex([hue,i*25,j*25])\n                if(color.length > 7) color = '#000000'\n                c.fillStyle = color\n                c.fillRect(i*20,j*20,20,20)\n            }\n        }\n        const g = 20\n        const cp = this.livalToCanvas(this.state.lightness, this.state.value)\n        c.strokeStyle = 'white'\n        c.strokeRect(Math.floor(cp.x/g)*g, Math.floor(cp.y/g)*g,g,g)\n        c.strokeStyle = 'black'\n        c.strokeRect(Math.floor(cp.x/g)*g+1, Math.floor(cp.y/g)*g+1,g-2,g-2)\n\n        c.strokeStyle = 'black';\n        c.lineWidth = 1.0\n        c.strokeRect(0,0,w,h)\n    }\n\n    livalToCanvas = (l,v) => {\n        return makePoint(l/100*100,v/100*100)\n    }\n\n    mouseToCanvas = (e) => {\n        const bounds = e.target.getBoundingClientRect()\n        return makePoint(e.clientX, e.clientY).minus(makePoint(bounds.x,bounds.y))\n    }\n\n    canvasToHue(pt) {\n        return Math.floor(pt.x/this.slider.width*360);\n    }\n    hueToCanvas(hue) {\n        return hue/360*this.slider.width\n    }\n    mousePressSlider = (e) => {\n        this.sliderPressed = true\n        const pt = this.mouseToCanvas(e)\n        const hue = this.canvasToHue(pt)\n        this.setState({hue:hue})\n        setTimeout(this.redraw,100)\n    }\n    mouseMoveSlider = (e) => {\n        if(!this.sliderPressed) return\n        const pt = this.mouseToCanvas(e)\n        const hue = this.canvasToHue(pt)\n        this.setState({hue:hue})\n        setTimeout(this.redraw,100)\n    }\n    mouseUpSlider = () => {\n        this.sliderPressed = false\n    }\n    drawSlider() {\n        const g = 10\n        const c = this.slider.getContext('2d')\n        const w = this.slider.width\n        const h = this.slider.height\n        c.fillStyle = 'red';\n        c.fillRect(0,0,w,h)\n        for(let x=0; x<w; x+=g) {\n            let hue = this.canvasToHue(makePoint(x,0))\n            let color = hsluv.hsluvToHex([hue,100,50])\n            if(color.length > 7) color = '#000000'\n            c.fillStyle = color\n            c.fillRect(x,0,g,h)\n        }\n        c.strokeStyle = 'black'\n        c.lineWidth = 1.0\n        const x = Math.floor(this.hueToCanvas(this.state.hue)/g)*g\n        c.strokeRect(x,0,g,h)\n        c.strokeRect(0,0,w,h)\n    }\n\n    drawIndicator() {\n        const c = this.indicator.getContext('2d')\n        const w = this.indicator.width\n        const h = this.indicator.height\n        let color = hsluv.hsluvToHex([Math.floor(this.state.hue),Math.floor(this.state.lightness),Math.floor(this.state.value)])\n        if(color.length > 7) color = '#000000'\n        c.fillStyle = color\n        c.fillRect(0,0,w,h)\n        c.strokeStyle = 'black'\n        c.lineWidth = 1.0\n        c.strokeRect(0,0,w,h)\n    }\n\n    close = () => {\n        let color = hsluv.hsluvToHex([Math.floor(this.state.hue),Math.floor(this.state.lightness),Math.floor(this.state.value)])\n        if(color.length > 7) color = '#000000'\n        this.props.onSelect(color)\n        PopupManager.hide()\n    }\n\n    render() {\n        return <div style={{\n            display:'flex',\n            flexDirection:'column',\n            alignItems:'center'\n        }}>\n            <canvas\n                ref={(can)=>this.canvas = can}\n                width={100} height={100}\n                onMouseDown={this.mousePress}\n                onMouseMove={this.mouseMove}\n                onMouseUp={this.mouseUp}\n            />\n            <canvas\n                ref={(can)=>this.slider = can}\n                width={100} height={30}\n                onMouseDown={this.mousePressSlider}\n                onMouseMove={this.mouseMoveSlider}\n                onMouseUp={this.mouseUpSlider}\n            />\n            <canvas\n                ref={(can)=>this.indicator = can}\n                width={32} height={32}\n                onClick={this.close}\n            />\n        </div>\n    }\n}","import React, {Component} from \"react\";\n\nexport class StringEditor extends Component {\n    keypressed = (e) => {\n        if(e.charCode === 13) this.props.onCommit();\n    }\n\n    render() {\n        const prop = this.props.def;\n        if (prop.hasHints()) {\n            const hints = prop.getHints()\n            if (hints.multiline) {\n                return <textarea value={this.props.value}\n                                 onChange={this.props.onChange}\n                                 onBlur={this.props.onBlur}\n                />\n            }\n        }\n        return <input type='string'\n                      value={this.props.value}\n                      onChange={this.props.onChange}\n                      onKeyPress={this.keypressed}\n                      onBlur={this.props.onBlur}\n        />\n    }\n}","import React, {Component} from \"react\";\nimport {HBox, PopupManager, VBox} from \"appy-comps\";\n\nconst EnumPicker = (props) => {\n    const Rend = props.renderer\n    const items = props.values.map(val=>\n        <HBox\n            key={val}\n            onClick={(e)=>props.onSelect(val)}>\n            <Rend value={val} def={props.def} obj={props.obj} provider={props.provider}/>\n        </HBox>\n    )\n    return <VBox className=\"popup-menu\">{items}</VBox>\n}\n\nconst DefaultEnumRenderer = (props) => {\n    let value = \"\"\n    if(typeof props.value !== 'undefined' && props.value !== null) {\n        value = props.value.toString()\n    }\n    return <span>{value}</span>\n}\n\nexport class EnumEditor extends Component {\n    calculateRenderer() {\n        const proxy = this.props.def\n        const obj = this.props.obj\n        if (!this.props.provider.getRendererForEnum) return DefaultEnumRenderer\n        const renderer = this.props.provider.getRendererForEnum(proxy.getKey(), obj)\n        if (!renderer) return DefaultEnumRenderer\n        return renderer\n    }\n\n    calculateValues() {\n        const vals = this.props.provider.getValuesForEnum(this.props.def.getKey(), this.props.obj, this.props.def)\n        if (!vals) {\n            console.log(`no values for enum ${this.props.def.getKey()}`);\n            return []\n        }\n        return vals\n    }\n\n    open = (e) => {\n        PopupManager.show(<EnumPicker\n            values={this.calculateValues()}\n            renderer={this.calculateRenderer()}\n            onSelect={this.selectValue}\n            provider={this.props.provider}\n        />, e.target)\n    }\n    selectValue = (value) => {\n        PopupManager.hide()\n        this.props.onChange(value)\n    }\n    renderValue = (value) => {\n        const def = this.props.def\n        const obj = this.props.obj\n        const Rend = this.calculateRenderer()\n        return <Rend value={value} def={def} obj={obj} provider={this.props.provider}/>\n    }\n\n    render() {\n        return <button onClick={this.open}>{this.renderValue(this.props.value)}</button>\n    }\n}","import React, {Component} from \"react\";\nimport {VBox} from \"appy-comps\";\nimport {EnumEditor} from \"./EnumEditor\";\n\nconst DefaultEnumRenderer = (props) => {\n    let value = \"\"\n    if(typeof props.value !== 'undefined') {\n        value = props.value.toString()\n    }\n    return <span>{value}</span>\n}\n\nexport class ArrayEditor extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            showEditor: false,\n            value: \"\"\n        }\n\n    }\n\n    calculateRenderer() {\n        const def = this.props.def\n        const obj = this.props.obj\n        if (!this.props.provider.getRendererForEnum) return DefaultEnumRenderer\n        const renderer = this.props.provider.getRendererForEnum(def.key, obj)\n        if (!renderer) return DefaultEnumRenderer\n        return renderer\n    }\n\n    addValue = () => {\n        this.setState({showEditor: true})\n    }\n    enumChanged = (value) => {\n        const arr = this.props.value.slice();\n        arr.push(value)\n        this.props.onChange(arr)\n    }\n\n    render() {\n        // const def = this.props.def\n        // const obj = this.props.obj\n        let value = this.props.value\n        if (!value) value = []\n        return <div>\n            {this.renderValues()}\n            <button onClick={this.addValue} className=\"fa fa-plus\"/>\n            {this.renderEditor()}\n        </div>\n    }\n\n    deleteItem(val) {\n        let arr = this.props.value.slice()\n        arr = arr.filter((v) => v !== val)\n        this.props.onChange(arr)\n    }\n\n    renderValues() {\n        const Renderer = this.calculateRenderer()\n        return <VBox>{this.props.value.map((val, i) => {\n            return <div key={i}>\n                <button className=\"fa fa-minus\" onClick={() => this.deleteItem(val)}/>\n                <Renderer value={val} provider={this.props.provider}/>\n            </div>\n        })}</VBox>\n    }\n\n    renderEditor() {\n        if (!this.state.showEditor) return \"\"\n        const def = this.props.def\n        const obj = this.props.obj\n        return <EnumEditor value={this.state.value}\n                           onChange={this.enumChanged}\n                           def={def}\n                           obj={obj}\n                           provider={this.props.provider}/>\n\n    }\n}\n","import React, {Component} from 'react';\nimport {PopupManager} from 'appy-comps'\n\nimport selMan, {SELECTION_MANAGER} from \"../SelectionManager\";\nimport HSLUVColorPicker from \"./HSLUVColorPicker\";\nimport {TREE_ITEM_PROVIDER} from '../TreeItemProvider'\nimport {StringEditor} from \"./StringEditor\";\nimport {EnumEditor} from \"./EnumEditor\";\nimport {ArrayEditor} from \"./ArrayEditor\";\nimport \"./propsheet.css\"\n\nexport const TYPES = {\n    STRING:'string',\n    NUMBER:'number',\n    BOOLEAN:'boolean',\n    ENUM:'enum',\n    COLOR:'color',\n    GROUP:'group',\n}\n\nclass PropEditor extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            value:props.def.getValue()\n        }\n    }\n    componentWillReceiveProps(nextProps) {\n        if(this.props.def !== nextProps.def) {\n            this.setState({value:nextProps.def.getValue()})\n        }\n    }\n    shouldComponentUpdate(nextProps, nextState) {\n        if(nextProps.def.getType() === 'group') return true\n        if(this.state.value !== nextState.value) return true\n        if(this.props.def.getKey() === nextProps.def.getKey()) {\n            if(this.props.def.getValue() === nextProps.def.getValue()) {\n                return false\n            }\n        }\n        return true\n    }\n    changed = (e) => {\n        if(this.props.def.isType(TYPES.STRING)) {\n            this.setState({value:e.target.value})\n            if(this.props.def.isLive()) {\n                this.props.def.setValue(e.target.value)\n            }\n        }\n        if(this.props.def.isType(TYPES.NUMBER)) this.updateNum(e.target.value)\n        if(this.props.def.isType(TYPES.BOOLEAN)) this.setState({value:e.target.checked})\n    }\n    customChanged = value => {\n        if(this.props.def.isType(TYPES.COLOR)) return this.colorChanged(value)\n        this.setState({value:value})\n        this.props.def.setValue(value)\n    }\n    keypressed = (e) => {\n        if(e.charCode === 13) this.commit();\n    }\n    updateNum = (v) => {\n        const def = this.props.def;\n        if(def.hasHints()) {\n            if(def.getHints().hasOwnProperty('min')) {\n                if(v < def.getHints().min) v = def.getHints().min\n            }\n            if(def.getHints().hasOwnProperty('max')) {\n                if (v > def.getHints().max) v = def.getHints().max\n            }\n        }\n        this.setState({value:v})\n        if(!isNaN(parseFloat(v))) {\n            def.setValue(parseFloat(v))\n        }\n    }\n    numberKeyDown = (e) => {\n        if(e.key === 'ArrowUp' && e.shiftKey) {\n            e.preventDefault()\n            this.updateNum(this.state.value+10)\n        }\n        if(e.key === 'ArrowDown' && e.shiftKey) {\n            e.preventDefault()\n            this.updateNum(this.state.value-10)\n        }\n    }\n    booleanChanged = (e) => {\n        this.setState({value:e.target.checked});\n        this.props.def.setValue(e.target.checked)\n    }\n    enumChanged = (value) => {\n        this.setState({value:value})\n        this.props.def.setValue(value)\n    }\n    arrayChanged = (value) => {\n        this.setState({value:value})\n        this.props.def.setValue(value)\n    }\n    colorChanged = (color) => {\n        this.setState({value:color});\n        this.props.def.setValue(color)\n    }\n    commit = () => {\n        this.props.def.setValue(this.state.value)\n    }\n    openColorEditor = (e) => {\n        PopupManager.show(<HSLUVColorPicker onSelect={this.colorChanged} value={this.state.value}/>, e.target)\n    }\n    render() {\n        const prop = this.props.def;\n        const obj = selMan.getSelection();\n        const provider = this.props.provider\n        if (prop.isCustom()) return this.props.provider.createCustomEditor(this.props.item, prop, provider, this.state.value, this.customChanged)\n        if (prop.isLocked()) return <i>{prop.getValue()}</i>\n        if (prop.isType(TYPES.STRING))  return <StringEditor value={this.state.value}\n                                 onChange={this.changed}\n                                 onBlur={this.commit} onCommit={this.commit}\n                                 def={prop} obj={obj}\n                                 provider={this.props.provider}/>\n        if (prop.isType(TYPES.NUMBER))  {\n            let step = 1\n            if(prop.hasHints()) {\n                const hints = prop.getHints()\n                if (hints.incrementValue) {\n                    step = hints.incrementValue\n                }\n            }\n            return <input type='number'\n                          value={this.state.value}\n                          onChange={this.changed}\n                          onKeyPress={this.keypressed}\n                          onKeyDown={this.numberKeyDown}\n                          onBlur={this.commit}\n                          step={step}/>\n        }\n        if (prop.isType(TYPES.BOOLEAN)) return <input type='checkbox'\n                                                  checked={this.state.value}\n                                                  onChange={this.booleanChanged}/>\n        if (prop.isType(TYPES.ENUM)) return <EnumEditor value={this.state.value} onChange={this.enumChanged} def={prop} obj={obj} provider={this.props.provider}/>\n        if (prop.isType(TYPES.COLOR)) return <button style={{ backgroundColor:this.state.value}} onClick={this.openColorEditor}>{this.state.value}</button>\n        if (prop.isType('array')) return <ArrayEditor value={this.state.value} onChange={this.arrayChanged} def={prop} obj={obj} provider={this.props.provider}/>\n        return <b>{prop.getType()}:{prop.getValue()}</b>\n    }\n}\n\n/*class PaletteColorPicker extends Component {\n    chooseColor(c) {\n        this.props.onSelect(c);\n    }\n    render() {\n        const style = {\n            display:'flex',\n            flexDirection:'row',\n            flexWrap:'wrap'\n        }\n        return <div style={style}>\n            {Object.keys(COLORS2).map((key,i) => {\n                let color = COLORS2[key];\n                let scolor = color.toString(16);\n                while(scolor.length < 6) scolor = \"0\"+scolor\n                scolor = '#' +scolor\n                let style = {\n                    backgroundColor:scolor,\n                    color:'red'\n                }\n                return <button key={key}\n                               style={style}\n                               onClick={this.chooseColor.bind(this, scolor)}\n                >&nbsp;</button>\n            })}\n        </div>\n    }\n}\n*/\nexport default class PropSheet extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            selection:null\n        }\n    }\n    componentDidMount() {\n        this.h2 = () => this.setState({selection:selMan.getSelection()})\n        this.props.provider.on(TREE_ITEM_PROVIDER.PROPERTY_CHANGED,this.h2)\n        this.hand = (s) => this.setState({selection:selMan.getSelection()})\n        selMan.on(SELECTION_MANAGER.CHANGED, this.hand)\n    }\n    componentWillUnmount() {\n        selMan.off(SELECTION_MANAGER.CHANGED, this.hand);\n        this.props.provider.off(TREE_ITEM_PROVIDER.PROPERTY_CHANGED,this.h2)\n    }\n    render() {\n        const props = this.calculateGroups(this.calculateProps())\n        const item = selMan.getSelection()\n        return <div className=\"prop-sheet\">{props.map((prop, i) => {\n            return [\n                <label key={prop.getKey()+'-label'} title={prop.getKey()}>{prop.getName()}</label>,\n                this.renderIndeterminate(prop,i),\n                <PropEditor key={prop.getKey()+'-editor'} def={prop} provider={this.props.provider} item={item}/>\n            ]\n        })}</div>\n    }\n    renderIndeterminate(prop, i) {\n        if(prop.isIndeterminate()) {\n            return <i key={prop.getKey()+'-indeterminate'} className=\"icon fa fa-exclamation-circle\"/>\n        } else {\n            return \"\"\n        }\n    }\n    calculateProps() {\n        const items = selMan.getFullSelection()\n        const first = items[0]\n        const prov = this.props.provider\n        let props = prov.getProperties(first)\n        items.forEach((item)=>{\n            props = calculateIntersection(props, prov.getProperties(item))\n        })\n        return props.map((prop)=>{\n            const multi = new MultiPropProxy(prov, prop.key)\n            items.forEach((item)=>{\n                const p2 = prov.getProperties(item)\n                const match = p2.find(def=>def.key === prop.key)\n                multi.addSubProxy(new PropProxy(prov,item,match))\n            })\n            return multi\n        });\n    }\n\n    calculateGroups(props) {\n        const group_defs = props.filter(p => p.getType() === TYPES.GROUP)\n        group_defs.forEach(def => {\n            const group_keys = def.getGroupKeys()\n            //remove any groups in the group keys of a group def\n            props = props.filter(p => group_keys.indexOf(p.getKey())<0)\n        })\n        return props\n    }\n}\n\n//return items from A that are also in B\nfunction calculateIntersection(A,B) {\n    return  A.filter((pa)=> B.find((pb)=>pa.key===pb.key))\n}\n\n\nclass MultiPropProxy {\n    constructor(provider,key) {\n        this.provider = provider\n        this.key = key\n        this.subs = []\n    }\n    addSubProxy(sub) {\n        this.subs.push(sub)\n    }\n    first() {\n        return this.subs[0]\n    }\n    getName()  { return this.first().getName()  }\n    getValue() { return this.first().getValue() }\n    isCustom() { return this.first().isCustom() }\n    hasHints() { return this.first().hasHints() }\n    getHints() { return this.first().getHints() }\n    isLocked() { return this.first().isLocked() }\n    getType()  { return this.first().getType()  }\n    isType(s)  { return this.first().isType(s)  }\n    isLive()   { return this.first().isLive()   }\n    getKey()   { return this.key                }\n    getGroupKeys() { return this.first().getGroupKeys() }\n    setValue(v) {\n        this.subs.forEach((s)=> s.setValue(v))\n    }\n    isIndeterminate() {\n        let same = true\n        let value = this.first().getValue()\n        this.subs.forEach((s)=>{\n            if(s.getValue() !== value) same = false\n        })\n        return !same;\n    }\n}\n\n\nclass PropProxy {\n    constructor(provider, item, def) {\n        this.provider = provider\n        this.item = item\n        this.def = def\n    }\n    getKey() {\n        return this.def.key\n    }\n    getName() {\n        return this.def.name\n    }\n    isCustom() {\n        return this.def.custom\n    }\n    isLocked() {\n        return this.def.locked\n    }\n    getType() {\n        return this.def.type\n    }\n    getValue() {\n        return this.def.value\n    }\n    isLive() {\n        return this.def.live\n    }\n    isType(type) {\n        return this.def.type === type\n    }\n    setValue(value) {\n        return this.provider.setPropertyValue(this.item,this.def,value)\n    }\n    hasHints() {\n        return this.def.hints\n    }\n    getHints() {\n        return this.def.hints\n    }\n    getGroupKeys() {\n        return this.def.group\n    }\n    isIndeterminate() { return false; }\n}\n","/* eslint-disable */\nconst THREE = require('three');//requireimport * as THREE from 'three'\n\n/**\n * @author arodic / https://github.com/arodic\n */\n\nconst TransformControls = function ( camera, domElement ) {\n\n    THREE.Object3D.call( this );\n\n    domElement = ( domElement !== undefined ) ? domElement : document;\n\n    this.visible = false;\n\n    var _gizmo = new TransformControlsGizmo();\n    this.add( _gizmo );\n\n    var _plane = new TransformControlsPlane();\n    this.add( _plane );\n\n    var scope = this;\n\n    // Define properties with getters/setter\n    // Setting the defined property will automatically trigger change event\n    // Defined properties are passed down to gizmo and plane\n\n    defineProperty( \"camera\", camera );\n    defineProperty( \"object\", undefined );\n    defineProperty( \"enabled\", true );\n    defineProperty( \"axis\", null );\n    defineProperty( \"mode\", \"translate\" );\n    defineProperty( \"translationSnap\", null );\n    defineProperty( \"rotationSnap\", null );\n    defineProperty( \"space\", \"world\" );\n    defineProperty( \"size\", 1 );\n    defineProperty( \"dragging\", false );\n    defineProperty( \"showX\", true );\n    defineProperty( \"showY\", true );\n    defineProperty( \"showZ\", true );\n\n    var changeEvent = { type: \"change\" };\n    var mouseDownEvent = { type: \"mouseDown\" };\n    var mouseUpEvent = { type: \"mouseUp\", mode: scope.mode };\n    var objectChangeEvent = { type: \"objectChange\" };\n\n    // Reusable utility variables\n\n    var ray = new THREE.Raycaster();\n\n    var _tempVector = new THREE.Vector3();\n    var _tempVector2 = new THREE.Vector3();\n    var _tempQuaternion = new THREE.Quaternion();\n    var _unit = {\n        X: new THREE.Vector3( 1, 0, 0 ),\n        Y: new THREE.Vector3( 0, 1, 0 ),\n        Z: new THREE.Vector3( 0, 0, 1 )\n    };\n    var _identityQuaternion = new THREE.Quaternion();\n    var _alignVector = new THREE.Vector3();\n\n    var pointStart = new THREE.Vector3();\n    var pointEnd = new THREE.Vector3();\n    var rotationAxis = new THREE.Vector3();\n    var rotationAngle = 0;\n\n    var cameraPosition = new THREE.Vector3();\n    var cameraQuaternion = new THREE.Quaternion();\n    var cameraScale = new THREE.Vector3();\n\n    var parentPosition = new THREE.Vector3();\n    var parentQuaternion = new THREE.Quaternion();\n    var parentScale = new THREE.Vector3();\n\n    var worldPositionStart = new THREE.Vector3();\n    var worldQuaternionStart = new THREE.Quaternion();\n    var worldScaleStart = new THREE.Vector3();\n\n    var worldPosition = new THREE.Vector3();\n    var worldQuaternion = new THREE.Quaternion();\n    var worldScale = new THREE.Vector3();\n\n    var eye = new THREE.Vector3();\n\n    var _positionStart = new THREE.Vector3();\n    var _quaternionStart = new THREE.Quaternion();\n    var _scaleStart = new THREE.Vector3();\n\n    // TODO: remove properties unused in plane and gizmo\n\n    defineProperty( \"parentQuaternion\", parentQuaternion );\n    defineProperty( \"worldPosition\", worldPosition );\n    defineProperty( \"worldPositionStart\", worldPositionStart );\n    defineProperty( \"worldQuaternion\", worldQuaternion );\n    defineProperty( \"worldQuaternionStart\", worldQuaternionStart );\n    defineProperty( \"cameraPosition\", cameraPosition );\n    defineProperty( \"cameraQuaternion\", cameraQuaternion );\n    defineProperty( \"pointStart\", pointStart );\n    defineProperty( \"pointEnd\", pointEnd );\n    defineProperty( \"rotationAxis\", rotationAxis );\n    defineProperty( \"rotationAngle\", rotationAngle );\n    defineProperty( \"eye\", eye );\n\n\n\n        domElement.addEventListener( \"mousedown\", onPointerDown, false );\n        domElement.addEventListener( \"touchstart\", onPointerDown, false );\n        domElement.addEventListener( \"mousemove\", onPointerHover, false );\n        domElement.addEventListener( \"touchmove\", onPointerHover, false );\n        domElement.addEventListener( \"touchmove\", onPointerMove, false );\n        document.addEventListener( \"mouseup\", onPointerUp, false );\n        domElement.addEventListener( \"touchend\", onPointerUp, false );\n        domElement.addEventListener( \"touchcancel\", onPointerUp, false );\n        domElement.addEventListener( \"touchleave\", onPointerUp, false );\n        domElement.addEventListener( \"contextmenu\", onContext, false );\n\n\n\n    this.dispose = function () {\n\n        domElement.removeEventListener( \"mousedown\", onPointerDown );\n        domElement.removeEventListener( \"touchstart\", onPointerDown );\n        domElement.removeEventListener( \"mousemove\", onPointerHover );\n        domElement.removeEventListener( \"touchmove\", onPointerHover );\n        domElement.removeEventListener( \"touchmove\", onPointerMove );\n        document.removeEventListener( \"mouseup\", onPointerUp );\n        domElement.removeEventListener( \"touchend\", onPointerUp );\n        domElement.removeEventListener( \"touchcancel\", onPointerUp );\n        domElement.removeEventListener( \"touchleave\", onPointerUp );\n        domElement.removeEventListener( \"contextmenu\", onContext );\n\n    };\n\n    // Set current object\n    this.attach = function ( object ) {\n\n        this.object = object;\n        this.visible = true;\n\n    };\n\n    // Detatch from object\n    this.detach = function () {\n\n        this.object = undefined;\n        this.visible = false;\n        this.axis = null;\n\n    };\n\n    // Defined getter, setter and store for a property\n    function defineProperty( propName, defaultValue ) {\n\n        var propValue = defaultValue;\n\n        Object.defineProperty( scope, propName, {\n\n            get: function() {\n\n                return propValue !== undefined ? propValue : defaultValue;\n\n            },\n\n            set: function( value ) {\n\n                if ( propValue !== value ) {\n\n                    propValue = value;\n                    _plane[ propName ] = value;\n                    _gizmo[ propName ] = value;\n\n                    scope.dispatchEvent( { type: propName + \"-changed\", value: value } );\n                    scope.dispatchEvent( changeEvent );\n\n                }\n\n            }\n\n        });\n\n        scope[ propName ] = defaultValue;\n        _plane[ propName ] = defaultValue;\n        _gizmo[ propName ] = defaultValue;\n\n    }\n\n    // updateMatrixWorld  updates key transformation variables\n    this.updateMatrixWorld = function () {\n\n        if ( this.object !== undefined ) {\n\n            this.object.updateMatrixWorld();\n            this.object.parent.matrixWorld.decompose( parentPosition, parentQuaternion, parentScale );\n            this.object.matrixWorld.decompose( worldPosition, worldQuaternion, worldScale );\n\n        }\n\n        this.camera.updateMatrixWorld();\n        this.camera.matrixWorld.decompose( cameraPosition, cameraQuaternion, cameraScale );\n\n        if ( this.camera instanceof THREE.PerspectiveCamera ) {\n\n            eye.copy( cameraPosition ).sub( worldPosition ).normalize();\n\n        } else if ( this.camera instanceof THREE.OrthographicCamera ) {\n\n            eye.copy( cameraPosition ).normalize();\n\n        }\n\n        THREE.Object3D.prototype.updateMatrixWorld.call( this );\n\n    };\n\n    this.pointerHover = function( pointer ) {\n\n        if ( this.object === undefined || this.dragging === true || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;\n\n        ray.setFromCamera( pointer, this.camera );\n\n        var intersect = ray.intersectObjects( _gizmo.picker[ this.mode ].children, true )[ 0 ] || false;\n\n        if ( intersect ) {\n\n            this.axis = intersect.object.name;\n\n        } else {\n\n            this.axis = null;\n\n        }\n\n    };\n\n    this.pointerDown = function( pointer ) {\n\n        if ( this.object === undefined || this.dragging === true || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;\n\n        if ( ( pointer.button === 0 || pointer.button === undefined ) && this.axis !== null ) {\n\n            ray.setFromCamera( pointer, this.camera );\n\n            var planeIntersect = ray.intersectObjects( [ _plane ], true )[ 0 ] || false;\n\n            if ( planeIntersect ) {\n\n                var space = this.space;\n\n                if ( this.mode === 'scale') {\n\n                    space = 'local';\n\n                } else if ( this.axis === 'E' ||  this.axis === 'XYZE' ||  this.axis === 'XYZ' ) {\n\n                    space = 'world';\n\n                }\n\n                if ( space === 'local' && this.mode === 'rotate' ) {\n\n                    var snap = this.rotationSnap;\n\n                    if ( this.axis === 'X' && snap ) this.object.rotation.x = Math.round( this.object.rotation.x / snap ) * snap;\n                    if ( this.axis === 'Y' && snap ) this.object.rotation.y = Math.round( this.object.rotation.y / snap ) * snap;\n                    if ( this.axis === 'Z' && snap ) this.object.rotation.z = Math.round( this.object.rotation.z / snap ) * snap;\n\n                }\n\n                this.object.updateMatrixWorld();\n                this.object.parent.updateMatrixWorld();\n\n                _positionStart.copy( this.object.position );\n                _quaternionStart.copy( this.object.quaternion );\n                _scaleStart.copy( this.object.scale );\n\n                this.object.matrixWorld.decompose( worldPositionStart, worldQuaternionStart, worldScaleStart );\n\n                pointStart.copy( planeIntersect.point ).sub( worldPositionStart );\n\n                if ( space === 'local' ) pointStart.applyQuaternion( worldQuaternionStart.clone().inverse() );\n\n            }\n\n            this.dragging = true;\n            mouseDownEvent.mode = this.mode;\n            this.dispatchEvent( mouseDownEvent );\n\n        }\n\n    };\n\n    this.pointerMove = function( pointer ) {\n\n        var axis = this.axis;\n        var mode = this.mode;\n        var object = this.object;\n        var space = this.space;\n\n        if ( mode === 'scale') {\n\n            space = 'local';\n\n        } else if ( axis === 'E' ||  axis === 'XYZE' ||  axis === 'XYZ' ) {\n\n            space = 'world';\n\n        }\n\n        if ( object === undefined || axis === null || this.dragging === false || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;\n\n        ray.setFromCamera( pointer, this.camera );\n\n        var planeIntersect = ray.intersectObjects( [ _plane ], true )[ 0 ] || false;\n\n        if ( planeIntersect === false ) return;\n\n        pointEnd.copy( planeIntersect.point ).sub( worldPositionStart );\n\n        if ( space === 'local' ) pointEnd.applyQuaternion( worldQuaternionStart.clone().inverse() );\n\n        if ( mode === 'translate' ) {\n\n            if ( axis.search( 'X' ) === -1 ) {\n                pointEnd.x = pointStart.x;\n            }\n            if ( axis.search( 'Y' ) === -1 ) {\n                pointEnd.y = pointStart.y;\n            }\n            if ( axis.search( 'Z' ) === -1 ) {\n                pointEnd.z = pointStart.z;\n            }\n\n            // Apply translate\n\n            if ( space === 'local' ) {\n                object.position.copy( pointEnd ).sub( pointStart ).applyQuaternion( _quaternionStart );\n            } else {\n                object.position.copy( pointEnd ).sub( pointStart );\n            }\n\n            object.position.add( _positionStart );\n\n            // Apply translation snap\n\n            if ( this.translationSnap ) {\n\n                if ( space === 'local' ) {\n\n                    object.position.applyQuaternion(_tempQuaternion.copy( _quaternionStart ).inverse() );\n\n                    if ( axis.search( 'X' ) !== -1 ) {\n                        object.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\n                    }\n\n                    if ( axis.search( 'Y' ) !== -1 ) {\n                        object.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\n                    }\n\n                    if ( axis.search( 'Z' ) !== -1 ) {\n                        object.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\n                    }\n\n                    object.position.applyQuaternion( _quaternionStart );\n\n                }\n\n                if ( space === 'world' ) {\n\n                    if ( object.parent ) {\n                        object.position.add( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\n                    }\n\n                    if ( axis.search( 'X' ) !== -1 ) {\n                        object.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\n                    }\n\n                    if ( axis.search( 'Y' ) !== -1 ) {\n                        object.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\n                    }\n\n                    if ( axis.search( 'Z' ) !== -1 ) {\n                        object.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\n                    }\n\n                    if ( object.parent ) {\n                        object.position.sub( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\n                    }\n\n                }\n\n            }\n\n        } else if ( mode === 'scale' ) {\n\n            if ( axis.search( 'XYZ' ) !== -1 ) {\n\n                var d = pointEnd.length() / pointStart.length();\n\n                if ( pointEnd.dot( pointStart ) < 0 ) d *= -1;\n\n                _tempVector.set( d, d, d );\n\n            } else {\n\n                _tempVector.copy( pointEnd ).divide( pointStart );\n\n                if ( axis.search( 'X' ) === -1 ) {\n                    _tempVector.x = 1;\n                }\n                if ( axis.search( 'Y' ) === -1 ) {\n                    _tempVector.y = 1;\n                }\n                if ( axis.search( 'Z' ) === -1 ) {\n                    _tempVector.z = 1;\n                }\n\n            }\n\n            // Apply scale\n\n            object.scale.copy( _scaleStart ).multiply( _tempVector );\n\n        } else if ( mode === 'rotate' ) {\n\n            var ROTATION_SPEED = 20 / worldPosition.distanceTo( _tempVector.setFromMatrixPosition( this.camera.matrixWorld ) );\n\n            var quaternion = this.space === \"local\" ? worldQuaternion : _identityQuaternion;\n\n            var unit = _unit[ axis ];\n\n            if ( axis === 'E' ) {\n\n                _tempVector.copy( pointEnd ).cross( pointStart );\n                rotationAxis.copy( eye );\n                rotationAngle = pointEnd.angleTo( pointStart ) * ( _tempVector.dot( eye ) < 0 ? 1 : -1 );\n\n            } else if ( axis === 'XYZE' ) {\n\n                _tempVector.copy( pointEnd ).sub( pointStart ).cross( eye ).normalize();\n                rotationAxis.copy( _tempVector );\n                rotationAngle = pointEnd.sub( pointStart ).dot( _tempVector.cross( eye ) ) * ROTATION_SPEED;\n\n            } else if ( axis === 'X' || axis === 'Y' || axis === 'Z' ) {\n\n                _alignVector.copy( unit ).applyQuaternion( quaternion );\n\n                rotationAxis.copy( unit );\n\n                _tempVector = unit.clone();\n                _tempVector2 = pointEnd.clone().sub( pointStart );\n                if ( space === 'local' ) {\n                    _tempVector.applyQuaternion( quaternion );\n                    _tempVector2.applyQuaternion( worldQuaternionStart );\n                }\n                rotationAngle = _tempVector2.dot( _tempVector.cross( eye ).normalize() ) * ROTATION_SPEED;\n\n            }\n\n            // Apply rotation snap\n\n            if ( this.rotationSnap ) rotationAngle = Math.round( rotationAngle / this.rotationSnap ) * this.rotationSnap;\n\n            this.rotationAngle = rotationAngle;\n\n            // Apply rotate\n\n            if ( space === 'local' ) {\n\n                object.quaternion.copy( _quaternionStart );\n                object.quaternion.multiply( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) );\n\n            } else {\n\n                object.quaternion.copy( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) );\n                object.quaternion.multiply( _quaternionStart );\n\n            }\n\n        }\n\n        this.dispatchEvent( changeEvent );\n        this.dispatchEvent( objectChangeEvent );\n\n    };\n\n    this.pointerUp = function( pointer ) {\n\n        if ( pointer.button !== undefined && pointer.button !== 0 ) return;\n\n        if ( this.dragging && ( this.axis !== null ) ) {\n\n            mouseUpEvent.mode = this.mode;\n            this.dispatchEvent( mouseUpEvent );\n\n        }\n\n        this.dragging = false;\n\n        if ( pointer.button === undefined ) this.axis = null;\n\n    };\n\n    // normalize mouse / touch pointer and remap {x,y} to view space.\n\n    function getPointer( event ) {\n\n        var pointer = event.changedTouches ? event.changedTouches[ 0 ] : event;\n\n        var rect = domElement.getBoundingClientRect();\n\n        return {\n            x: ( pointer.clientX - rect.left ) / rect.width * 2 - 1,\n            y: - ( pointer.clientY - rect.top ) / rect.height * 2 + 1,\n            button: event.button\n        };\n\n    }\n\n    // mouse / touch event handlers\n\n    function onContext( event ) {\n\n        event.preventDefault();\n\n    }\n\n    function onPointerHover( event ) {\n\n        if ( !scope.enabled ) return;\n\n        scope.pointerHover( getPointer( event ) );\n\n    }\n\n    function onPointerDown( event ) {\n\n        if ( !scope.enabled ) return;\n\n        event.preventDefault();\n\n        document.addEventListener( \"mousemove\", onPointerMove, false );\n\n        scope.pointerHover( getPointer( event ) );\n        scope.pointerDown( getPointer( event ) );\n\n    }\n\n    function onPointerMove( event ) {\n\n        if ( !scope.enabled ) return;\n\n        event.preventDefault();\n\n        scope.pointerMove( getPointer( event ) );\n\n    }\n\n    function onPointerUp( event ) {\n\n        if ( !scope.enabled ) return;\n\n        event.preventDefault(); // Prevent MouseEvent on mobile\n\n        document.removeEventListener( \"mousemove\", onPointerMove, false );\n\n        scope.pointerUp( getPointer( event ) );\n\n    }\n\n    // TODO: depricate\n\n    this.getMode = function () {\n\n        return scope.mode;\n\n    };\n\n    this.setMode = function ( mode ) {\n\n        scope.mode = mode;\n\n    };\n\n    this.setTranslationSnap = function ( translationSnap ) {\n\n        scope.translationSnap = translationSnap;\n\n    };\n\n    this.setRotationSnap = function ( rotationSnap ) {\n\n        scope.rotationSnap = rotationSnap;\n\n    };\n\n    this.setSize = function ( size ) {\n\n        scope.size = size;\n\n    };\n\n    this.setSpace = function ( space ) {\n\n        scope.space = space;\n\n    };\n\n    this.update = function () {\n\n        console.warn( 'TransformControls: update function has been depricated.' );\n\n    };\n\n};\n\nTransformControls.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\n\n    constructor: TransformControls,\n\n    isTransformControls: true\n\n} );\n\n\nconst TransformControlsGizmo = function () {\n\n\n    THREE.Object3D.call( this );\n\n    this.type = 'TransformControlsGizmo';\n\n    // shared materials\n\n    var gizmoMaterial = new THREE.MeshBasicMaterial({\n        depthTest: false,\n        depthWrite: false,\n        transparent: true,\n        side: THREE.DoubleSide,\n        fog: false\n    });\n\n    var gizmoLineMaterial = new THREE.LineBasicMaterial({\n        depthTest: false,\n        depthWrite: false,\n        transparent: true,\n        linewidth: 1,\n        fog: false\n    });\n\n    // Make unique material for each axis/color\n\n    var matInvisible = gizmoMaterial.clone();\n    matInvisible.opacity = 0.15;\n\n    var matHelper = gizmoMaterial.clone();\n    matHelper.opacity = 0.33;\n\n    var matRed = gizmoMaterial.clone();\n    matRed.color.set( 0xff0000 );\n\n    var matGreen = gizmoMaterial.clone();\n    matGreen.color.set( 0x00ff00 );\n\n    var matBlue = gizmoMaterial.clone();\n    matBlue.color.set( 0x0000ff );\n\n    var matWhiteTransperent = gizmoMaterial.clone();\n    matWhiteTransperent.opacity = 0.25;\n\n    var matYellowTransparent = matWhiteTransperent.clone();\n    matYellowTransparent.color.set( 0xffff00 );\n\n    var matCyanTransparent = matWhiteTransperent.clone();\n    matCyanTransparent.color.set( 0x00ffff );\n\n    var matMagentaTransparent = matWhiteTransperent.clone();\n    matMagentaTransparent.color.set( 0xff00ff );\n\n    var matYellow = gizmoMaterial.clone();\n    matYellow.color.set( 0xffff00 );\n\n    var matLineRed = gizmoLineMaterial.clone();\n    matLineRed.color.set( 0xff0000 );\n\n    var matLineGreen = gizmoLineMaterial.clone();\n    matLineGreen.color.set( 0x00ff00 );\n\n    var matLineBlue = gizmoLineMaterial.clone();\n    matLineBlue.color.set( 0x0000ff );\n\n    var matLineCyan = gizmoLineMaterial.clone();\n    matLineCyan.color.set( 0x00ffff );\n\n    var matLineMagenta = gizmoLineMaterial.clone();\n    matLineMagenta.color.set( 0xff00ff );\n\n    var matLineYellow = gizmoLineMaterial.clone();\n    matLineYellow.color.set( 0xffff00 );\n\n    var matLineGray = gizmoLineMaterial.clone();\n    matLineGray.color.set( 0x787878);\n\n    var matLineYellowTransparent = matLineYellow.clone();\n    matLineYellowTransparent.opacity = 0.25;\n\n    // reusable geometry\n\n    var arrowGeometry = new THREE.CylinderBufferGeometry( 0, 0.05, 0.2, 12, 1, false);\n\n    var scaleHandleGeometry = new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125);\n\n    var lineGeometry = new THREE.BufferGeometry( );\n    lineGeometry.addAttribute('position', new THREE.Float32BufferAttribute( [ 0, 0, 0,\t1, 0, 0 ], 3 ) );\n\n    var CircleGeometry = function( radius, arc ) {\n\n        var geometry = new THREE.BufferGeometry( );\n        var vertices = [];\n\n        for ( var i = 0; i <= 64 * arc; ++i ) {\n\n            vertices.push( 0, Math.cos( i / 32 * Math.PI ) * radius, Math.sin( i / 32 * Math.PI ) * radius );\n\n        }\n\n        geometry.addAttribute('position', new THREE.Float32BufferAttribute( vertices, 3 ) );\n\n        return geometry;\n\n    };\n\n    // Special geometry for transform helper. If scaled with position vector it spans from [0,0,0] to position\n\n    var TranslateHelperGeometry = function( radius, arc ) {\n\n        var geometry = new THREE.BufferGeometry()\n\n        geometry.addAttribute('position', new THREE.Float32BufferAttribute( [ 0, 0, 0, 1, 1, 1 ], 3 ) );\n\n        return geometry;\n\n    };\n\n    // Gizmo definitions - custom hierarchy definitions for setupGizmo() function\n\n    var gizmoTranslate = {\n        X: [\n            [ new THREE.Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, -Math.PI / 2 ], null, 'fwd' ],\n            [ new THREE.Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, Math.PI / 2 ], null, 'bwd' ],\n            [ new THREE.Line( lineGeometry, matLineRed ) ]\n        ],\n        Y: [\n            [ new THREE.Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], null, null, 'fwd' ],\n            [ new THREE.Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], [ Math.PI, 0, 0 ], null, 'bwd' ],\n            [ new THREE.Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ] ]\n        ],\n        Z: [\n            [ new THREE.Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ Math.PI / 2, 0, 0 ], null, 'fwd' ],\n            [ new THREE.Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ -Math.PI / 2, 0, 0 ], null, 'bwd' ],\n            [ new THREE.Line( lineGeometry, matLineBlue ), null, [ 0, -Math.PI / 2, 0 ] ]\n        ],\n        XYZ: [\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.1, 0 ), matWhiteTransperent ), [ 0, 0, 0 ], [ 0, 0, 0 ] ]\n        ],\n        XY: [\n            [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.295, 0.295 ), matYellowTransparent ), [ 0.15, 0.15, 0 ] ],\n            [ new THREE.Line( lineGeometry, matLineYellow ), [ 0.18, 0.3, 0 ], null, [ 0.125, 1, 1 ] ],\n            [ new THREE.Line( lineGeometry, matLineYellow ), [ 0.3, 0.18, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ]\n        ],\n        YZ: [\n            [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.295, 0.295 ), matCyanTransparent ), [ 0, 0.15, 0.15 ], [ 0, Math.PI / 2, 0 ] ],\n            [ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.18, 0.3 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ],\n            [ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.3, 0.18 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]\n        ],\n        XZ: [\n            [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.295, 0.295 ), matMagentaTransparent ), [ 0.15, 0, 0.15 ], [ -Math.PI / 2, 0, 0 ] ],\n            [ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.18, 0, 0.3 ], null, [ 0.125, 1, 1 ] ],\n            [ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.3, 0, 0.18 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]\n        ]\n    };\n\n    var pickerTranslate = {\n        X: [\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0.6, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ]\n        ],\n        Y: [\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0.6, 0 ] ]\n        ],\n        Z: [\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0, 0.6 ], [ Math.PI / 2, 0, 0 ] ]\n        ],\n        XYZ: [\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.2, 0 ), matInvisible ) ]\n        ],\n        XY: [\n            [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0.2, 0.2, 0 ] ]\n        ],\n        YZ: [\n            [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0, 0.2, 0.2 ], [ 0, Math.PI / 2, 0 ] ]\n        ],\n        XZ: [\n            [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0.2, 0, 0.2 ], [ -Math.PI / 2, 0, 0 ] ]\n        ]\n    };\n\n    var helperTranslate = {\n        START: [\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\n        ],\n        END: [\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\n        ],\n        DELTA: [\n            [ new THREE.Line( TranslateHelperGeometry(), matHelper ), null, null, null, 'helper' ]\n        ],\n        X: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ -1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n        ],\n        Y: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, -1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\n        ],\n        Z: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, 0, -1e3 ], [ 0, -Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\n        ]\n    };\n\n    var gizmoRotate = {\n        X: [\n            [ new THREE.Line( CircleGeometry( 1, 0.5 ), matLineRed ) ],\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.04, 0 ), matRed ), [ 0, 0, 0.99 ], null, [ 1, 3, 1 ] ],\n        ],\n        Y: [\n            [ new THREE.Line( CircleGeometry( 1, 0.5 ), matLineGreen ), null, [ 0, 0, -Math.PI / 2 ] ],\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.04, 0 ), matGreen ), [ 0, 0, 0.99 ], null, [ 3, 1, 1 ] ],\n        ],\n        Z: [\n            [ new THREE.Line( CircleGeometry( 1, 0.5 ), matLineBlue ), null, [ 0, Math.PI / 2, 0 ] ],\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.04, 0 ), matBlue ), [ 0.99, 0, 0 ], null, [ 1, 3, 1 ] ],\n        ],\n        E: [\n            [ new THREE.Line( CircleGeometry( 1.25, 1 ), matLineYellowTransparent ), null, [ 0, Math.PI / 2, 0 ] ],\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 1.17, 0, 0 ], [ 0, 0, -Math.PI / 2 ], [ 1, 1, 0.001 ]],\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ -1.17, 0, 0 ], [ 0, 0, Math.PI / 2 ], [ 1, 1, 0.001 ]],\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, -1.17, 0 ], [ Math.PI, 0, 0 ], [ 1, 1, 0.001 ]],\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, 1.17, 0 ], [ 0, 0, 0 ], [ 1, 1, 0.001 ]],\n        ],\n        XYZE: [\n            [ new THREE.Line( CircleGeometry( 1, 1 ), matLineGray ), null, [ 0, Math.PI / 2, 0 ] ]\n        ]\n    };\n\n    var helperRotate = {\n        AXIS: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ -1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n        ]\n    };\n\n    var pickerRotate = {\n        X: [\n            [ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, -Math.PI / 2, -Math.PI / 2 ] ],\n        ],\n        Y: [\n            [ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ Math.PI / 2, 0, 0 ] ],\n        ],\n        Z: [\n            [ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ],\n        ],\n        E: [\n            [ new THREE.Mesh( new THREE.TorusBufferGeometry( 1.25, 0.1, 2, 24 ), matInvisible ) ]\n        ],\n        XYZE: [\n            [ new THREE.Mesh( new THREE.SphereBufferGeometry( 0.7, 10, 8 ), matInvisible ) ]\n        ]\n    };\n\n    var gizmoScale = {\n        X: [\n            [ new THREE.Mesh( scaleHandleGeometry, matRed ), [ 0.8, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ],\n            [ new THREE.Line( lineGeometry, matLineRed ), null, null, [ 0.8, 1, 1 ] ]\n        ],\n        Y: [\n            [ new THREE.Mesh( scaleHandleGeometry, matGreen ), [ 0, 0.8, 0 ] ],\n            [ new THREE.Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ], [ 0.8, 1, 1 ] ]\n        ],\n        Z: [\n            [ new THREE.Mesh( scaleHandleGeometry, matBlue ), [ 0, 0, 0.8 ], [ Math.PI / 2, 0, 0 ] ],\n            [ new THREE.Line( lineGeometry, matLineBlue ), null, [ 0, -Math.PI / 2, 0 ], [ 0.8, 1, 1 ] ]\n        ],\n        XY: [\n            [ new THREE.Mesh( scaleHandleGeometry, matYellowTransparent ), [ 0.85, 0.85, 0 ], null, [ 2, 2, 0.2 ] ],\n            [ new THREE.Line( lineGeometry, matLineYellow ), [ 0.855, 0.98, 0 ], null, [ 0.125, 1, 1 ] ],\n            [ new THREE.Line( lineGeometry, matLineYellow ), [ 0.98, 0.855, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ]\n        ],\n        YZ: [\n            [ new THREE.Mesh( scaleHandleGeometry, matCyanTransparent ), [ 0, 0.85, 0.85 ], null, [ 0.2, 2, 2 ] ],\n            [ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.855, 0.98 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ],\n            [ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.98, 0.855 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]\n        ],\n        XZ: [\n            [ new THREE.Mesh( scaleHandleGeometry, matMagentaTransparent ), [ 0.85, 0, 0.85 ], null, [ 2, 0.2, 2 ] ],\n            [ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.855, 0, 0.98 ], null, [ 0.125, 1, 1 ] ],\n            [ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.98, 0, 0.855 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]\n        ],\n        XYZX: [\n            [ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransperent ), [ 1.1, 0, 0 ] ],\n        ],\n        XYZY: [\n            [ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransperent ), [ 0, 1.1, 0 ] ],\n        ],\n        XYZZ: [\n            [ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransperent ), [ 0, 0, 1.1 ] ],\n        ]\n    };\n\n    var pickerScale = {\n        X: [\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0.5, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ]\n        ],\n        Y: [\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0.5, 0 ] ]\n        ],\n        Z: [\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0, 0.5 ], [ Math.PI / 2, 0, 0 ] ]\n        ],\n        XY: [\n            [ new THREE.Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0.85, 0 ], null, [ 3, 3, 0.2 ] ],\n        ],\n        YZ: [\n            [ new THREE.Mesh( scaleHandleGeometry, matInvisible ), [ 0, 0.85, 0.85 ], null, [ 0.2, 3, 3 ] ],\n        ],\n        XZ: [\n            [ new THREE.Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0, 0.85 ], null, [ 3, 0.2, 3 ] ],\n        ],\n        XYZX: [\n            [ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 1.1, 0, 0 ] ],\n        ],\n        XYZY: [\n            [ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 1.1, 0 ] ],\n        ],\n        XYZZ: [\n            [ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 0, 1.1 ] ],\n        ]\n    };\n\n    var helperScale = {\n        X: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ -1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n        ],\n        Y: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, -1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\n        ],\n        Z: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, 0, -1e3 ], [ 0, -Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\n        ]\n    };\n\n    // Creates an Object3D with gizmos described in custom hierarchy definition.\n\n    var setupGizmo = function( gizmoMap ) {\n\n        var gizmo = new THREE.Object3D();\n\n        for ( var name in gizmoMap ) {\n\n            for ( var i = gizmoMap[ name ].length; i --; ) {\n\n                var object = gizmoMap[ name ][ i ][ 0 ].clone();\n                var position = gizmoMap[ name ][ i ][ 1 ];\n                var rotation = gizmoMap[ name ][ i ][ 2 ];\n                var scale = gizmoMap[ name ][ i ][ 3 ];\n                var tag = gizmoMap[ name ][ i ][ 4 ];\n\n                // name and tag properties are essential for picking and updating logic.\n                object.name = name;\n                object.tag = tag;\n\n                if (position) {\n                    object.position.set(position[ 0 ], position[ 1 ], position[ 2 ]);\n                }\n                if (rotation) {\n                    object.rotation.set(rotation[ 0 ], rotation[ 1 ], rotation[ 2 ]);\n                }\n                if (scale) {\n                    object.scale.set(scale[ 0 ], scale[ 1 ], scale[ 2 ]);\n                }\n\n                object.updateMatrix();\n\n                var tempGeometry = object.geometry.clone();\n                tempGeometry.applyMatrix(object.matrix);\n                object.geometry = tempGeometry;\n\n                object.position.set( 0, 0, 0 );\n                object.rotation.set( 0, 0, 0 );\n                object.scale.set(1, 1, 1);\n\n                gizmo.add(object);\n\n            }\n\n        }\n\n        return gizmo;\n\n    };\n\n    // Reusable utility variables\n\n    var tempVector = new THREE.Vector3( 0, 0, 0 );\n    var tempEuler = new THREE.Euler();\n    var alignVector = new THREE.Vector3( 0, 1, 0 );\n    var zeroVector = new THREE.Vector3( 0, 0, 0 );\n    var lookAtMatrix = new THREE.Matrix4();\n    var tempQuaternion = new THREE.Quaternion();\n    var tempQuaternion2 = new THREE.Quaternion();\n    var identityQuaternion = new THREE.Quaternion();\n\n    var unitX = new THREE.Vector3( 1, 0, 0 );\n    var unitY = new THREE.Vector3( 0, 1, 0 );\n    var unitZ = new THREE.Vector3( 0, 0, 1 );\n\n    // Gizmo creation\n\n    this.gizmo = {};\n    this.picker = {};\n    this.helper = {};\n\n    this.add( this.gizmo[ \"translate\" ] = setupGizmo( gizmoTranslate ) );\n    this.add( this.gizmo[ \"rotate\" ] = setupGizmo( gizmoRotate ) );\n    this.add( this.gizmo[ \"scale\" ] = setupGizmo( gizmoScale ) );\n    this.add( this.picker[ \"translate\" ] = setupGizmo( pickerTranslate ) );\n    this.add( this.picker[ \"rotate\" ] = setupGizmo( pickerRotate ) );\n    this.add( this.picker[ \"scale\" ] = setupGizmo( pickerScale ) );\n    this.add( this.helper[ \"translate\" ] = setupGizmo( helperTranslate ) );\n    this.add( this.helper[ \"rotate\" ] = setupGizmo( helperRotate ) );\n    this.add( this.helper[ \"scale\" ] = setupGizmo( helperScale ) );\n\n    // Pickers should be hidden always\n\n    this.picker[ \"translate\" ].visible = false;\n    this.picker[ \"rotate\" ].visible = false;\n    this.picker[ \"scale\" ].visible = false;\n\n    // updateMatrixWorld will update transformations and appearance of individual handles\n\n    this.updateMatrixWorld = function () {\n\n        var space = this.space;\n\n        if ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation\n\n        var quaternion = space === \"local\" ? this.worldQuaternion : identityQuaternion;\n\n        // Show only gizmos for current transform mode\n\n        this.gizmo[ \"translate\" ].visible = this.mode === \"translate\";\n        this.gizmo[ \"rotate\" ].visible = this.mode === \"rotate\";\n        this.gizmo[ \"scale\" ].visible = this.mode === \"scale\";\n\n        this.helper[ \"translate\" ].visible = this.mode === \"translate\";\n        this.helper[ \"rotate\" ].visible = this.mode === \"rotate\";\n        this.helper[ \"scale\" ].visible = this.mode === \"scale\";\n\n\n        var handles = [];\n        handles = handles.concat( this.picker[ this.mode ].children );\n        handles = handles.concat( this.gizmo[ this.mode ].children );\n        handles = handles.concat( this.helper[ this.mode ].children );\n\n        for ( var i = 0; i < handles.length; i++ ) {\n\n            var handle = handles[i];\n\n            // hide aligned to camera\n\n            handle.visible = true;\n            handle.rotation.set( 0, 0, 0 );\n            handle.position.copy( this.worldPosition );\n\n            var eyeDistance = this.worldPosition.distanceTo( this.cameraPosition);\n            handle.scale.set( 1, 1, 1 ).multiplyScalar( eyeDistance * this.size / 7 );\n\n            // TODO: simplify helpers and consider decoupling from gizmo\n\n            if ( handle.tag === 'helper' ) {\n\n                handle.visible = false;\n\n                if ( handle.name === 'AXIS' ) {\n\n                    handle.position.copy( this.worldPositionStart );\n                    handle.visible = !!this.axis;\n\n                    if ( this.axis === 'X' ) {\n\n                        tempQuaternion.setFromEuler( tempEuler.set( 0, 0, 0 ) );\n                        handle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n                        if ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n                            handle.visible = false;\n                        }\n\n                    }\n\n                    if ( this.axis === 'Y' ) {\n\n                        tempQuaternion.setFromEuler( tempEuler.set( 0, 0, Math.PI / 2 ) );\n                        handle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n                        if ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n                            handle.visible = false;\n                        }\n\n                    }\n\n                    if ( this.axis === 'Z' ) {\n\n                        tempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );\n                        handle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n                        if ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n                            handle.visible = false;\n                        }\n\n                    }\n\n                    if ( this.axis === 'XYZE' ) {\n\n                        tempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );\n                        alignVector.copy( this.rotationAxis );\n                        handle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( zeroVector, alignVector, unitY ) );\n                        handle.quaternion.multiply( tempQuaternion );\n                        handle.visible = this.dragging;\n\n                    }\n\n                    if ( this.axis === 'E' ) {\n\n                        handle.visible = false;\n\n                    }\n\n\n                } else if ( handle.name === 'START' ) {\n\n                    handle.position.copy( this.worldPositionStart );\n                    handle.visible = this.dragging;\n\n                } else if ( handle.name === 'END' ) {\n\n                    handle.position.copy( this.worldPosition );\n                    handle.visible = this.dragging;\n\n                } else if ( handle.name === 'DELTA' ) {\n\n                    handle.position.copy( this.worldPositionStart );\n                    handle.quaternion.copy( this.worldQuaternionStart );\n                    tempVector.set( 1e-10, 1e-10, 1e-10 ).add( this.worldPositionStart ).sub( this.worldPosition ).multiplyScalar( -1 );\n                    tempVector.applyQuaternion( this.worldQuaternionStart.clone().inverse() );\n                    handle.scale.copy( tempVector );\n                    handle.visible = this.dragging;\n\n                } else {\n\n                    handle.quaternion.copy( quaternion );\n\n                    if ( this.dragging ) {\n\n                        handle.position.copy( this.worldPositionStart );\n\n                    } else {\n\n                        handle.position.copy( this.worldPosition );\n\n                    }\n\n                    if ( this.axis ) {\n\n                        handle.visible = this.axis.search( handle.name ) !== -1;\n\n                    }\n\n                }\n\n                // If updating helper, skip rest of the loop\n                continue;\n\n            }\n\n            // Align handles to current local or world rotation\n\n            handle.quaternion.copy( quaternion );\n\n            if ( this.mode === 'translate' || this.mode === 'scale' ) {\n\n                // Hide translate and scale axis facing the camera\n\n                var AXIS_HIDE_TRESHOLD = 0.99;\n                var PLANE_HIDE_TRESHOLD = 0.2;\n                var AXIS_FLIP_TRESHOLD = -0.4;\n\n\n                if ( handle.name === 'X' || handle.name === 'XYZX' ) {\n                    if ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n                    }\n                }\n                if ( handle.name === 'Y' || handle.name === 'XYZY' ) {\n                    if ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n                    }\n                }\n                if ( handle.name === 'Z' || handle.name === 'XYZZ' ) {\n                    if ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n                    }\n                }\n                if ( handle.name === 'XY' ) {\n                    if ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n                    }\n                }\n                if ( handle.name === 'YZ' ) {\n                    if ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n                    }\n                }\n                if ( handle.name === 'XZ' ) {\n                    if ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n                    }\n                }\n\n                // Flip translate and scale axis ocluded behind another axis\n\n                if ( handle.name.search( 'X' ) !== -1 ) {\n                    if ( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n                        if ( handle.tag === 'fwd' ) {\n                            handle.visible = false;\n                        } else {\n                            handle.scale.x *= -1;\n                        }\n                    } else if ( handle.tag === 'bwd' ) {\n                        handle.visible = false;\n                    }\n                }\n\n                if ( handle.name.search( 'Y' ) !== -1 ) {\n                    if ( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n                        if ( handle.tag === 'fwd' ) {\n                            handle.visible = false;\n                        } else {\n                            handle.scale.y *= -1;\n                        }\n                    } else if ( handle.tag === 'bwd' ) {\n                        handle.visible = false;\n                    }\n                }\n\n                if ( handle.name.search( 'Z' ) !== -1 ) {\n                    if ( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n                        if ( handle.tag === 'fwd' ) {\n                            handle.visible = false;\n                        } else {\n                            handle.scale.z *= -1;\n                        }\n                    } else if ( handle.tag === 'bwd' ) {\n                        handle.visible = false;\n                    }\n                }\n\n            } else if ( this.mode === 'rotate' ) {\n\n                // Align handles to current local or world rotation\n\n                tempQuaternion2.copy( quaternion );\n                alignVector.copy( this.eye ).applyQuaternion( tempQuaternion.copy( quaternion ).inverse() );\n\n                if ( handle.name.search( \"E\" ) !== - 1 ) {\n\n                    handle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( this.eye, zeroVector, unitY ) );\n\n                }\n\n                if ( handle.name === 'X' ) {\n\n                    tempQuaternion.setFromAxisAngle( unitX, Math.atan2( -alignVector.y, alignVector.z ) );\n                    tempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n                    handle.quaternion.copy( tempQuaternion );\n\n                }\n\n                if ( handle.name === 'Y' ) {\n\n                    tempQuaternion.setFromAxisAngle( unitY, Math.atan2( alignVector.x, alignVector.z ) );\n                    tempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n                    handle.quaternion.copy( tempQuaternion );\n\n                }\n\n                if ( handle.name === 'Z' ) {\n\n                    tempQuaternion.setFromAxisAngle( unitZ, Math.atan2( alignVector.y, alignVector.x ) );\n                    tempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n                    handle.quaternion.copy( tempQuaternion );\n\n                }\n\n            }\n\n            // Hide disabled axes\n            handle.visible = handle.visible && ( handle.name.indexOf( \"X\" ) === -1 || this.showX );\n            handle.visible = handle.visible && ( handle.name.indexOf( \"Y\" ) === -1 || this.showY );\n            handle.visible = handle.visible && ( handle.name.indexOf( \"Z\" ) === -1 || this.showZ );\n            handle.visible = handle.visible && ( handle.name.indexOf( \"E\" ) === -1 || ( this.showX && this.showY && this.showZ ) );\n\n            // highlight selected axis\n\n            handle.material._opacity = handle.material._opacity || handle.material.opacity;\n            handle.material._color = handle.material._color || handle.material.color.clone();\n\n            handle.material.color.copy( handle.material._color );\n            handle.material.opacity = handle.material._opacity;\n\n            if ( !this.enabled ) {\n\n                handle.material.opacity *= 0.5;\n                handle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n            } else if ( this.axis ) {\n\n                if ( handle.name === this.axis ) {\n\n                    handle.material.opacity = 1.0;\n                    handle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n                } else if ( this.axis.split('').some( function( a ) { return handle.name === a; } ) ) {\n\n                    handle.material.opacity = 1.0;\n                    handle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n                } else {\n\n                    handle.material.opacity *= 0.25;\n                    handle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n                }\n\n            }\n\n        }\n\n        THREE.Object3D.prototype.updateMatrixWorld.call( this );\n\n    };\n\n};\n\nTransformControlsGizmo.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\n\n    constructor: TransformControlsGizmo,\n\n    isTransformControlsGizmo: true\n\n} );\n\n\nconst TransformControlsPlane = function () {\n\n\n    THREE.Mesh.call( this,\n        new THREE.PlaneBufferGeometry( 100000, 100000, 2, 2 ),\n        new THREE.MeshBasicMaterial( { visible: false, wireframe: true, side: THREE.DoubleSide, transparent: true, opacity: 0.1 } )\n    );\n\n    this.type = 'TransformControlsPlane';\n\n    var unitX = new THREE.Vector3( 1, 0, 0 );\n    var unitY = new THREE.Vector3( 0, 1, 0 );\n    var unitZ = new THREE.Vector3( 0, 0, 1 );\n\n    var tempVector = new THREE.Vector3();\n    var dirVector = new THREE.Vector3();\n    var alignVector = new THREE.Vector3();\n    var tempMatrix = new THREE.Matrix4();\n    var identityQuaternion = new THREE.Quaternion();\n\n    this.updateMatrixWorld = function() {\n\n        var space = this.space;\n\n        this.position.copy( this.worldPosition );\n\n        if ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation\n\n        unitX.set( 1, 0, 0 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n        unitY.set( 0, 1, 0 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n        unitZ.set( 0, 0, 1 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n\n        // Align the plane for current transform mode, axis and space.\n\n        alignVector.copy( unitY );\n\n        switch ( this.mode ) {\n            case 'translate':\n            case 'scale':\n                switch ( this.axis ) {\n                    case 'X':\n                        alignVector.copy( this.eye ).cross( unitX );\n                        dirVector.copy( unitX ).cross( alignVector );\n                        break;\n                    case 'Y':\n                        alignVector.copy( this.eye ).cross( unitY );\n                        dirVector.copy( unitY ).cross( alignVector );\n                        break;\n                    case 'Z':\n                        alignVector.copy( this.eye ).cross( unitZ );\n                        dirVector.copy( unitZ ).cross( alignVector );\n                        break;\n                    case 'XY':\n                        dirVector.copy( unitZ );\n                        break;\n                    case 'YZ':\n                        dirVector.copy( unitX );\n                        break;\n                    case 'XZ':\n                        alignVector.copy( unitZ );\n                        dirVector.copy( unitY );\n                        break;\n                    case 'XYZ':\n                    case 'E':\n                        dirVector.set( 0, 0, 0 );\n                        break;\n                    default:\n                        break;\n                }\n                break;\n            case 'rotate':\n            default:\n                // special case for rotate\n                dirVector.set( 0, 0, 0 );\n        }\n\n        if ( dirVector.length() === 0 ) {\n\n            // If in rotate mode, make the plane parallel to camera\n            this.quaternion.copy( this.cameraQuaternion );\n\n        } else {\n\n            tempMatrix.lookAt( tempVector.set( 0, 0, 0 ), dirVector, alignVector );\n\n            this.quaternion.setFromRotationMatrix( tempMatrix );\n\n        }\n\n        THREE.Object3D.prototype.updateMatrixWorld.call( this );\n\n    };\n\n};\n\nTransformControlsPlane.prototype = Object.assign( Object.create( THREE.Mesh.prototype ), {\n\n    constructor: TransformControlsPlane,\n\n    isTransformControlsPlane: true\n\n} );\n\nexport default TransformControls\n","/**\n * @author sunag / http://www.sunag.com.br\n */\nconst THREE = require('three');//requireimport * as THREE from 'three'\n\n\nconst SkeletonUtils = {\n\n\tretarget: function () {\n\n\t\tvar pos = new THREE.Vector3(),\n\t\t\tquat = new THREE.Quaternion(),\n\t\t\tscale = new THREE.Vector3(),\n\t\t\tbindBoneMatrix = new THREE.Matrix4(),\n\t\t\trelativeMatrix = new THREE.Matrix4(),\n\t\t\tglobalMatrix = new THREE.Matrix4();\n\n\t\treturn function ( target, source, options ) {\n\n\t\t\toptions = options || {};\n\t\t\toptions.preserveMatrix = options.preserveMatrix !== undefined ? options.preserveMatrix : true;\n\t\t\toptions.preservePosition = options.preservePosition !== undefined ? options.preservePosition : true;\n\t\t\toptions.preserveHipPosition = options.preserveHipPosition !== undefined ? options.preserveHipPosition : false;\n\t\t\toptions.useTargetMatrix = options.useTargetMatrix !== undefined ? options.useTargetMatrix : false;\n\t\t\toptions.hip = options.hip !== undefined ? options.hip : \"hip\";\n\t\t\toptions.names = options.names || {};\n\n\t\t\tvar sourceBones = source.isObject3D ? source.skeleton.bones : this.getBones( source ),\n\t\t\t\tbones = target.isObject3D ? target.skeleton.bones : this.getBones( target ),\n\t\t\t\tbindBones,\n\t\t\t\tbone, name, boneTo,\n\t\t\t\tbonesPosition, i;\n\n\t\t\t// reset bones\n\n\t\t\tif ( target.isObject3D ) {\n\n\t\t\t\ttarget.skeleton.pose();\n\n\t\t\t} else {\n\n\t\t\t\toptions.useTargetMatrix = true;\n\t\t\t\toptions.preserveMatrix = false;\n\n\t\t\t}\n\n\t\t\tif ( options.preservePosition ) {\n\n\t\t\t\tbonesPosition = [];\n\n\t\t\t\tfor ( i = 0; i < bones.length; i ++ ) {\n\n\t\t\t\t\tbonesPosition.push( bones[ i ].position.clone() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( options.preserveMatrix ) {\n\n\t\t\t\t// reset matrix\n\n\t\t\t\ttarget.updateMatrixWorld();\n\n\t\t\t\ttarget.matrixWorld.identity();\n\n\t\t\t\t// reset children matrix\n\n\t\t\t\tfor ( i = 0; i < target.children.length; ++ i ) {\n\n\t\t\t\t\ttarget.children[ i ].updateMatrixWorld( true );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( options.offsets ) {\n\n\t\t\t\tbindBones = [];\n\n\t\t\t\tfor ( i = 0; i < bones.length; ++ i ) {\n\n\t\t\t\t\tbone = bones[ i ];\n\t\t\t\t\tname = options.names[ bone.name ] || bone.name;\n\n\t\t\t\t\tif ( options.offsets && options.offsets[ name ] ) {\n\n\t\t\t\t\t\tbone.matrix.multiply( options.offsets[ name ] );\n\n\t\t\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\n\n\t\t\t\t\t\tbone.updateMatrixWorld();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbindBones.push( bone.matrixWorld.clone() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfor ( i = 0; i < bones.length; ++ i ) {\n\n\t\t\t\tbone = bones[ i ];\n\t\t\t\tname = options.names[ bone.name ] || bone.name;\n\n\t\t\t\tboneTo = this.getBoneByName( name, sourceBones );\n\n\t\t\t\tglobalMatrix.copy( bone.matrixWorld );\n\n\t\t\t\tif ( boneTo ) {\n\n\t\t\t\t\tboneTo.updateMatrixWorld();\n\n\t\t\t\t\tif ( options.useTargetMatrix ) {\n\n\t\t\t\t\t\trelativeMatrix.copy( boneTo.matrixWorld );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\trelativeMatrix.getInverse( target.matrixWorld );\n\t\t\t\t\t\trelativeMatrix.multiply( boneTo.matrixWorld );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// ignore scale to extract rotation\n\n\t\t\t\t\tscale.setFromMatrixScale( relativeMatrix );\n\t\t\t\t\trelativeMatrix.scale( scale.set( 1 / scale.x, 1 / scale.y, 1 / scale.z ) );\n\n\t\t\t\t\t// apply to global matrix\n\n\t\t\t\t\tglobalMatrix.makeRotationFromQuaternion( quat.setFromRotationMatrix( relativeMatrix ) );\n\n\t\t\t\t\tif ( target.isObject3D ) {\n\n\t\t\t\t\t\tvar boneIndex = bones.indexOf( bone ),\n\t\t\t\t\t\t\twBindMatrix = bindBones ? bindBones[ boneIndex ] : bindBoneMatrix.getInverse( target.skeleton.boneInverses[ boneIndex ] );\n\n\t\t\t\t\t\tglobalMatrix.multiply( wBindMatrix );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tglobalMatrix.copyPosition( relativeMatrix );\n\n\t\t\t\t}\n\n\t\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\t\tbone.matrix.getInverse( bone.parent.matrixWorld );\n\t\t\t\t\tbone.matrix.multiply( globalMatrix );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbone.matrix.copy( globalMatrix );\n\n\t\t\t\t}\n\n\t\t\t\tif ( options.preserveHipPosition && name === options.hip ) {\n\n\t\t\t\t\tbone.matrix.setPosition( pos.set( 0, bone.position.y, 0 ) );\n\n\t\t\t\t}\n\n\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\n\n\t\t\t\tbone.updateMatrixWorld();\n\n\t\t\t}\n\n\t\t\tif ( options.preservePosition ) {\n\n\t\t\t\tfor ( i = 0; i < bones.length; ++ i ) {\n\n\t\t\t\t\tbone = bones[ i ];\n\t\t\t\t\tname = options.names[ bone.name ] || bone.name;\n\n\t\t\t\t\tif ( name !== options.hip ) {\n\n\t\t\t\t\t\tbone.position.copy( bonesPosition[ i ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( options.preserveMatrix ) {\n\n\t\t\t\t// restore matrix\n\n\t\t\t\ttarget.updateMatrixWorld( true );\n\n\t\t\t}\n\n\t\t};\n\n\t}(),\n\n\tretargetClip: function ( target, source, clip, options ) {\n\n\t\toptions = options || {};\n\t\toptions.useFirstFramePosition = options.useFirstFramePosition !== undefined ? options.useFirstFramePosition : false;\n\t\toptions.fps = options.fps !== undefined ? options.fps : 30;\n\t\toptions.names = options.names || [];\n\n\t\tif ( ! source.isObject3D ) {\n\n\t\t\tsource = this.getHelperFromSkeleton( source );\n\n\t\t}\n\n\t\tvar numFrames = Math.round( clip.duration * ( options.fps / 1000 ) * 1000 ),\n\t\t\tdelta = 1 / options.fps,\n\t\t\tconvertedTracks = [],\n\t\t\tmixer = new THREE.AnimationMixer( source ),\n\t\t\tbones = this.getBones( target.skeleton ),\n\t\t\tboneDatas = [],\n\t\t\tpositionOffset,\n\t\t\tbone, boneTo, boneData,\n\t\t\tname, i, j;\n\n\t\tmixer.clipAction( clip ).play();\n\t\tmixer.update( 0 );\n\n\t\tsource.updateMatrixWorld();\n\n\t\tfor ( i = 0; i < numFrames; ++ i ) {\n\n\t\t\tvar time = i * delta;\n\n\t\t\tthis.retarget( target, source, options );\n\n\t\t\tfor ( j = 0; j < bones.length; ++ j ) {\n\n\t\t\t\tname = options.names[ bones[ j ].name ] || bones[ j ].name;\n\n\t\t\t\tboneTo = this.getBoneByName( name, source.skeleton );\n\n\t\t\t\tif ( boneTo ) {\n\n\t\t\t\t\tbone = bones[ j ];\n\t\t\t\t\tboneData = boneDatas[ j ] = boneDatas[ j ] || { bone: bone };\n\n\t\t\t\t\tif ( options.hip === name ) {\n\n\t\t\t\t\t\tif ( ! boneData.pos ) {\n\n\t\t\t\t\t\t\tboneData.pos = {\n\t\t\t\t\t\t\t\ttimes: new Float32Array( numFrames ),\n\t\t\t\t\t\t\t\tvalues: new Float32Array( numFrames * 3 )\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( options.useFirstFramePosition ) {\n\n\t\t\t\t\t\t\tif ( i === 0 ) {\n\n\t\t\t\t\t\t\t\tpositionOffset = bone.position.clone();\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbone.position.sub( positionOffset );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tboneData.pos.times[ i ] = time;\n\n\t\t\t\t\t\tbone.position.toArray( boneData.pos.values, i * 3 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! boneData.quat ) {\n\n\t\t\t\t\t\tboneData.quat = {\n\t\t\t\t\t\t\ttimes: new Float32Array( numFrames ),\n\t\t\t\t\t\t\tvalues: new Float32Array( numFrames * 4 )\n\t\t\t\t\t\t};\n\n\t\t\t\t\t}\n\n\t\t\t\t\tboneData.quat.times[ i ] = time;\n\n\t\t\t\t\tbone.quaternion.toArray( boneData.quat.values, i * 4 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tmixer.update( delta );\n\n\t\t\tsource.updateMatrixWorld();\n\n\t\t}\n\n\t\tfor ( i = 0; i < boneDatas.length; ++ i ) {\n\n\t\t\tboneData = boneDatas[ i ];\n\n\t\t\tif ( boneData ) {\n\n\t\t\t\tif ( boneData.pos ) {\n\n\t\t\t\t\tconvertedTracks.push( new THREE.VectorKeyframeTrack(\n\t\t\t\t\t\t\".bones[\" + boneData.bone.name + \"].position\",\n\t\t\t\t\t\tboneData.pos.times,\n\t\t\t\t\t\tboneData.pos.values\n\t\t\t\t\t) );\n\n\t\t\t\t}\n\n\t\t\t\tconvertedTracks.push( new THREE.QuaternionKeyframeTrack(\n\t\t\t\t\t\".bones[\" + boneData.bone.name + \"].quaternion\",\n\t\t\t\t\tboneData.quat.times,\n\t\t\t\t\tboneData.quat.values\n\t\t\t\t) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tmixer.uncacheAction( clip );\n\n\t\treturn new THREE.AnimationClip( clip.name, - 1, convertedTracks );\n\n\t},\n\n\tgetHelperFromSkeleton: function ( skeleton ) {\n\n\t\tvar source = new THREE.SkeletonHelper( skeleton.bones[ 0 ] );\n\t\tsource.skeleton = skeleton;\n\n\t\treturn source;\n\n\t},\n\n\tgetSkeletonOffsets: function () {\n\n\t\tvar targetParentPos = new THREE.Vector3(),\n\t\t\ttargetPos = new THREE.Vector3(),\n\t\t\tsourceParentPos = new THREE.Vector3(),\n\t\t\tsourcePos = new THREE.Vector3(),\n\t\t\ttargetDir = new THREE.Vector2(),\n\t\t\tsourceDir = new THREE.Vector2();\n\n\t\treturn function ( target, source, options ) {\n\n\t\t\toptions = options || {};\n\t\t\toptions.hip = options.hip !== undefined ? options.hip : \"hip\";\n\t\t\toptions.names = options.names || {};\n\n\t\t\tif ( ! source.isObject3D ) {\n\n\t\t\t\tsource = this.getHelperFromSkeleton( source );\n\n\t\t\t}\n\n\t\t\tvar nameKeys = Object.keys( options.names ),\n\t\t\t\tnameValues = Object.values( options.names ),\n\t\t\t\tsourceBones = source.isObject3D ? source.skeleton.bones : this.getBones( source ),\n\t\t\t\tbones = target.isObject3D ? target.skeleton.bones : this.getBones( target ),\n\t\t\t\toffsets = [],\n\t\t\t\tbone, boneTo,\n\t\t\t\tname, i;\n\n\t\t\ttarget.skeleton.pose();\n\n\t\t\tfor ( i = 0; i < bones.length; ++ i ) {\n\n\t\t\t\tbone = bones[ i ];\n\t\t\t\tname = options.names[ bone.name ] || bone.name;\n\n\t\t\t\tboneTo = this.getBoneByName( name, sourceBones );\n\n\t\t\t\tif ( boneTo && name !== options.hip ) {\n\n\t\t\t\t\tvar boneParent = this.getNearestBone( bone.parent, nameKeys ),\n\t\t\t\t\t\tboneToParent = this.getNearestBone( boneTo.parent, nameValues );\n\n\t\t\t\t\tboneParent.updateMatrixWorld();\n\t\t\t\t\tboneToParent.updateMatrixWorld();\n\n\t\t\t\t\ttargetParentPos.setFromMatrixPosition( boneParent.matrixWorld );\n\t\t\t\t\ttargetPos.setFromMatrixPosition( bone.matrixWorld );\n\n\t\t\t\t\tsourceParentPos.setFromMatrixPosition( boneToParent.matrixWorld );\n\t\t\t\t\tsourcePos.setFromMatrixPosition( boneTo.matrixWorld );\n\n\t\t\t\t\ttargetDir.subVectors(\n\t\t\t\t\t\tnew THREE.Vector2( targetPos.x, targetPos.y ),\n\t\t\t\t\t\tnew THREE.Vector2( targetParentPos.x, targetParentPos.y )\n\t\t\t\t\t).normalize();\n\n\t\t\t\t\tsourceDir.subVectors(\n\t\t\t\t\t\tnew THREE.Vector2( sourcePos.x, sourcePos.y ),\n\t\t\t\t\t\tnew THREE.Vector2( sourceParentPos.x, sourceParentPos.y )\n\t\t\t\t\t).normalize();\n\n\t\t\t\t\tvar laterialAngle = targetDir.angle() - sourceDir.angle();\n\n\t\t\t\t\tvar offset = new THREE.Matrix4().makeRotationFromEuler(\n\t\t\t\t\t\tnew THREE.Euler(\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\tlaterialAngle\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\n\t\t\t\t\tbone.matrix.multiply( offset );\n\n\t\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\n\n\t\t\t\t\tbone.updateMatrixWorld();\n\n\t\t\t\t\toffsets[ name ] = offset;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn offsets;\n\n\t\t};\n\n\t}(),\n\n\trenameBones: function ( skeleton, names ) {\n\n\t\tvar bones = this.getBones( skeleton );\n\n\t\tfor ( var i = 0; i < bones.length; ++ i ) {\n\n\t\t\tvar bone = bones[ i ];\n\n\t\t\tif ( names[ bone.name ] ) {\n\n\t\t\t\tbone.name = names[ bone.name ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tgetBones: function ( skeleton ) {\n\n\t\treturn Array.isArray( skeleton ) ? skeleton : skeleton.bones;\n\n\t},\n\n\tgetBoneByName: function ( name, skeleton ) {\n\n\t\tfor ( var i = 0, bones = this.getBones( skeleton ); i < bones.length; i ++ ) {\n\n\t\t\tif ( name === bones[ i ].name )\n\n\t\t\t\treturn bones[ i ];\n\n\t\t}\n\n\t},\n\n\tgetNearestBone: function ( bone, names ) {\n\n\t\twhile ( bone.isBone ) {\n\n\t\t\tif ( names.indexOf( bone.name ) !== - 1 ) {\n\n\t\t\t\treturn bone;\n\n\t\t\t}\n\n\t\t\tbone = bone.parent;\n\n\t\t}\n\n\t},\n\n\tfindBoneTrackData: function ( name, tracks ) {\n\n\t\tvar regexp = /\\[(.*)\\]\\.(.*)/,\n\t\t\tresult = { name: name };\n\n\t\tfor ( var i = 0; i < tracks.length; ++ i ) {\n\n\t\t\t// 1 is track name\n\t\t\t// 2 is track type\n\t\t\tvar trackData = regexp.exec( tracks[ i ].name );\n\n\t\t\tif ( trackData && name === trackData[ 1 ] ) {\n\n\t\t\t\tresult[ trackData[ 2 ] ] = i;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn result;\n\n\t},\n\n\tgetEqualsBonesNames: function ( skeleton, targetSkeleton ) {\n\n\t\tvar sourceBones = this.getBones( skeleton ),\n\t\t\ttargetBones = this.getBones( targetSkeleton ),\n\t\t\tbones = [];\n\n\t\tsearch : for ( var i = 0; i < sourceBones.length; i ++ ) {\n\n\t\t\tvar boneName = sourceBones[ i ].name;\n\n\t\t\tfor ( var j = 0; j < targetBones.length; j ++ ) {\n\n\t\t\t\tif ( boneName === targetBones[ j ].name ) {\n\n\t\t\t\t\tbones.push( boneName );\n\n\t\t\t\t\tcontinue search;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn bones;\n\n\t},\n\n\tclone: function ( source ) {\n\n\t\tvar sourceLookup = new Map();\n\t\tvar cloneLookup = new Map();\n\n\t\tvar clone = source.clone();\n\n\t\tparallelTraverse( source, clone, function ( sourceNode, clonedNode ) {\n\n\t\t\tsourceLookup.set( clonedNode, sourceNode );\n\t\t\tcloneLookup.set( sourceNode, clonedNode );\n\n\t\t} );\n\n\t\tclone.traverse( function ( node ) {\n\n\t\t\tif ( ! node.isSkinnedMesh ) return;\n\n\t\t\tvar clonedMesh = node;\n\t\t\tvar sourceMesh = sourceLookup.get( node );\n\t\t\tvar sourceBones = sourceMesh.skeleton.bones;\n\n\t\t\tclonedMesh.skeleton = sourceMesh.skeleton.clone();\n\t\t\tclonedMesh.bindMatrix.copy( sourceMesh.bindMatrix );\n\n\t\t\tclonedMesh.skeleton.bones = sourceBones.map( function ( bone ) {\n\n\t\t\t\treturn cloneLookup.get( bone );\n\n\t\t\t} );\n\n\t\t\tclonedMesh.bind( clonedMesh.skeleton, clonedMesh.bindMatrix );\n\n\t\t} );\n\n\t\treturn clone;\n\n\t}\n\n};\n\n\nfunction parallelTraverse ( a, b, callback ) {\n\n\tcallback( a, b );\n\n\tfor ( var i = 0; i < a.children.length; i ++ ) {\n\n\t\tparallelTraverse( a.children[ i ], b.children[ i ], callback );\n\n\t}\n\n}\n\nexport default SkeletonUtils","import {NONE_ASSET} from '../Common'\nimport {DoubleSide, MeshLambertMaterial} from 'three'\n\nexport default class ObjectDef {\n    updateProperty(node, obj, op, provider) {\n        if (op.name === 'tx') node.position.x = parseFloat(op.value)\n        if (op.name === 'ty') node.position.y = parseFloat(op.value)\n        if (op.name === 'tz') node.position.z = parseFloat(op.value)\n        if (op.name === 'rx') node.rotation.x = parseFloat(op.value)\n        if (op.name === 'ry') node.rotation.y = parseFloat(op.value)\n        if (op.name === 'rz') node.rotation.z = parseFloat(op.value)\n        if (op.name === 'sx') node.scale.x = parseFloat(op.value)\n        if (op.name === 'sy') node.scale.y = parseFloat(op.value)\n        if (op.name === 'sz') node.scale.z = parseFloat(op.value)\n        if (op.name === 'visible') node.visible = op.value\n\n        if (op.name === 'color') {\n            let color = op.value\n            if(color.indexOf('#') === 0) color = color.substring(1)\n            node.material.color.set(parseInt(color,16))\n        }\n\n    }\n    reset(node, obj) {\n        node.position.set(obj.tx,obj.ty,obj.tz)\n        node.visible = obj.visible\n    }\n\n    attachAsset(node, obj, provider) {\n        if(obj.asset === NONE_ASSET.id) {\n            node.material = new MeshLambertMaterial({color: obj.color, side:DoubleSide})\n            return\n        }\n        provider.assetsManager.getTexture(obj.asset).then(tex => {\n            provider.getLogger().log(\"loadded asset\",obj.asset)\n            provider.getLogger().log(tex)\n            if(!tex) provider.getLogger().error(\"error loading asset\",obj.asset)\n            const opts = {\n                color: obj.color,\n                side: DoubleSide,\n                map:tex\n            }\n            if(obj.transparent) {\n                opts.transparent = true\n                opts.alphaTest = 0.5\n            }\n            node.material = new MeshLambertMaterial(opts)\n        }).catch(err => {\n            provider.getLogger().error('error somwhere',err.message,err)\n        })\n    }\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport ObjectDef from './ObjectDef'\nimport {NONE_ASSET, OBJ_TYPES, PROP_DEFS} from '../Common'\nimport {BoxGeometry, Mesh, MeshLambertMaterial} from 'three'\n\nlet COUNTER = 0\n\nexport default class CubeDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create cube w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.cube,\n            title:'cube '+COUNTER++,\n            visible:true,\n            width:0.3, height:0.3, depth:0.3,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#00ff00',\n            children:graph.createArray(),\n            asset:NONE_ASSET.id,\n            transparent:false,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new Mesh(\n            new BoxGeometry(obj.width, obj.height, obj.depth),\n            new MeshLambertMaterial({color: obj.color})\n        )\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        this.attachAsset(node, obj, provider)\n        return node\n    }\n\n\n\n    updateProperty(node, obj, op, provider) {\n        if (op.name === 'width' || op.name === 'height' || op.name === 'depth') {\n            node.geometry = new BoxGeometry(obj.width, obj.height, obj.depth)\n            return\n        }\n        if (op.name === PROP_DEFS.asset.key || op.name === PROP_DEFS.transparent.key) return this.attachAsset(node, obj, provider)\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport ObjectDef from './ObjectDef'\nimport {NONE_ASSET, OBJ_TYPES, PROP_DEFS} from '../Common'\nimport {Mesh, MeshLambertMaterial, SphereBufferGeometry} from 'three'\n\nlet COUNTER = 0\n\nexport default class SphereDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create sphere w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.sphere,\n            title:'sphere '+COUNTER++,\n            visible:true,\n            radius: 0.3/2,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#0000ff',\n            children:graph.createArray(),\n            asset:NONE_ASSET.id,\n            transparent:false,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new Mesh(\n            new SphereBufferGeometry(obj.radius),\n            new MeshLambertMaterial({color: obj.color})\n        )\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        this.attachAsset(node, obj, provider)\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        if (op.name === 'radius') node.geometry = new SphereBufferGeometry(op.value)\n        if (op.name === PROP_DEFS.asset.key || op.name === PROP_DEFS.transparent.key) return this.attachAsset(node, obj, provider)\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport * as THREE from \"three\"\nimport {NONE_ASSET, PROP_DEFS} from '../Common'\nimport ObjectDef from './ObjectDef'\n\nexport default class PlaneDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create plane w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:'plane',\n            title:'a plane',\n            visible:true,\n            width: 0.5,\n            height: 0.5,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#ffffff',\n            children:graph.createArray(),\n            asset:NONE_ASSET.id,\n            transparent:false,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new THREE.Mesh(\n            new THREE.PlaneBufferGeometry(obj.width,obj.height),\n            new THREE.MeshLambertMaterial({color: obj.color, side: THREE.DoubleSide})\n        )\n        this.attachAsset(node, obj, provider)\n        node.userData.clickable = true\n        // on(node,POINTER_CLICK,e =>SelectionManager.setSelection(node.userData.graphid))\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        if (op.name === 'width') node.geometry = new THREE.PlaneBufferGeometry(op.value,obj.height)\n        if (op.name === 'height') node.geometry = new THREE.PlaneBufferGeometry(obj.width,op.value)\n        if (op.name === PROP_DEFS.asset.key || op.name === PROP_DEFS.transparent.key) return this.attachAsset(node, obj, provider)\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport * as THREE from \"three\"\nimport {MeshLambertMaterial} from \"three\"\nimport {NONE_ASSET, PROP_DEFS} from '../Common'\nimport SkeletonUtils from '../SkeletonUtils'\nimport ObjectDef from './ObjectDef'\n\nexport default class ModelDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create model w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:'model',\n            title:'a model',\n            visible:true,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#ffffff',\n            children:graph.createArray(),\n            asset:NONE_ASSET.id,\n            transparent:false,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new THREE.Group()\n        node.name = obj.title\n        const clicker =  new THREE.Mesh(\n            new THREE.SphereBufferGeometry(1),\n            new MeshLambertMaterial({color:\"red\", transparent:true, opacity: 0.2})\n        )\n        clicker.material.visible = true\n        clicker.userData.clickable = true\n        node.userData.clicker = clicker\n        node.add(clicker)\n        // on(clicker,POINTER_CLICK,e =>SelectionManager.setSelection(node.userData.graphid))\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        this.attachAsset(node, obj, provider)\n\n        node.enter = (evt,scriptManager) => {\n            node.userData.clicker.visible = false\n            // if (node.userData.mixer) {\n            //     provider.addMixer(obj.id, node.userData.mixer)\n            // }\n            if (node.userData.model) {\n                if (node.userData.currentClip) {\n                    node.userData.action = node.userData.mixer.clipAction( node.userData.currentClip );\n                    node.userData.action.play()\n                }\n            } else {\n                node.userData.shouldPlay = true\n            }\n        }\n        node.exit = (evt,scriptManager) => {\n            const ob2 = provider.accessObject(obj.id)\n            if(ob2.asset === NONE_ASSET.id) {\n                node.userData.clicker.visible = true\n            }\n            // if (node.userData.mixer) {\n            //     provider.removeMixer(obj.id)\n            // }\n        }\n        node.tick = (evt,scriptManager) => {\n            const dt = evt.deltaTime / 1000;\n            node.userData.mixer && node.userData.mixer.update(dt);\n        }\n\n        // node.playAllClips = (evt, scriptManager) => {\n        //     node.userData.clips.forEach((clip) => {\n        //         node.userData.mixer.clipAction(clip).reset().play();\n        //     });\n        // }\n        // need to get this into the render loop somehow\n\n        node.useClip = (name) => {\n            if (node.userData.model) {\n                var clip = THREE.AnimationClip.findByName( node.userData.clips, name );\n                if (clip) {\n                    node.userData.currentClip = clip\n                }\n            } else {\n                node.userData.currentClipName = name\n            }\n        }\n\n        node.play = () => {\n            if (node.userData.currentClip) {\n                node.userData.mixer.stopAllAction();\n                node.userData.action = node.userData.mixer.clipAction( node.userData.currentClip );\n                node.userData.action.play()\n            }\n        }\n\n        node.stop = () => {\n            if (node.userData.mixer) {\n                node.userData.mixer.stopAllAction();            \n            }\n        }\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        if (op.name === PROP_DEFS.asset.key) return this.attachAsset(node, obj, provider)\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n    setClips ( userData ) {\n        if (userData.mixer) {\n          userData.mixer.stopAllAction();\n          userData.mixer.uncacheRoot(userData.mixer.getRoot());\n          userData.mixer = null;\n        }\n    \n        userData.clips.forEach((clip) => {\n          if (clip.validate()) clip.optimize();\n        });\n\n        if (!userData.clips.length) return;\n    \n        userData.currentClip = userData.clips[0]\n        userData.mixer = new THREE.AnimationMixer( userData.model );\n    }\n        \n    attachAsset(node, obj, provider) {\n        if(obj.asset === NONE_ASSET.id) {\n            // node.material = new MeshLambertMaterial({color: obj.color, side:THREE.DoubleSide})\n            console.log(\"REMOVE NODE CHILDREN\")\n            if(node.userData.model) {\n                node.remove(node.userData.model)\n                delete node.userData.model\n            }\n            node.userData.clicker.visible = true\n            return\n        }\n\n        node.userData.shouldPlay = false\n        node.userData.currentClip = null\n        node.userData.model = null\n        node.userData.currentClipName = null\n\n        provider.assetsManager.getGLTF(obj.asset).then(gltf => {\n            //swap the model\n            if(node.userData.model) node.remove(node.userData.model)\n\n            node.userData.model = gltf.scene || gltf.scenes[0]\n\n            // clone it, in case the loader is returning the same cached version?\n            node.userData.model = SkeletonUtils.clone( node.userData.model  );\n\n            node.userData.clips = gltf.animations || [];\n\n            node.add(node.userData.model)\n            node.userData.model.updateMatrixWorld();\n\n            //calculate the size of the model\n            // if(node.userData.model.geometry) {\n                // node.userData.model.geometry.computeBoundingSphere()\n                // node.userData.boundingSphere = node.userData.model.geometry.boundingSphere\n                // const bs = node.userData.boundingSphere\n                const model = node.userData.model\n\n                node.userData.boundingBox = new THREE.Box3().setFromObject(model);\n                node.userData.boundingBoxSize = node.userData.boundingBox.getSize(new THREE.Vector3()).length();\n                node.userData.BoundingBoxCenter = node.userData.boundingBox.getCenter(new THREE.Vector3());     \n                      \n                node.userData.mixer = null\n                this.setClips(node.userData)\n\n                // Really don't want to move it\n                ///\n                // model.position.x += model.position.x - node.userData.BoundingBoxCenter.x\n                // model.position.y += model.position.y - node.userData.BoundingBoxCenter.y\n                // model.position.z += model.position.z - node.userData.BoundingBoxCenter.z\n\n                // model.position.x = -bs.center.x\n                // model.position.y = -bs.center.y\n                // model.position.z = -bs.center.z\n\n                if (node.userData.currentClipName) {\n                    var clip = THREE.AnimationClip.findByName( node.userData.clips, node.userData.currentClipName );\n                    if (clip) {\n                        node.userData.currentClip = clip\n                    }\n                    node.userData.currentClipName = null\n                }\n\n                if (node.userData.shouldPlay && node.userData.currentClip) {\n                    node.userData.action = node.userData.mixer.clipAction( node.userData.currentClip );\n                    node.userData.action.play()\n                    node.userData.shouldPlay = false\n                }\n                node.userData.clicker.geometry = new THREE.SphereBufferGeometry(node.userData.boundingBoxSize / 2)\n            // }\n            //disable the clicker sphere\n            node.userData.clicker.visible = false\n        })\n    }\n\n}\n","import {fetchGraphObject} from '../../syncgraph/utils'\nimport {NONE_ASSET, OBJ_TYPES, PROP_DEFS} from '../Common'\nimport * as THREE from 'three'\nimport {MeshLambertMaterial} from 'three'\nimport {DoubleSide} from 'three'\n\nfunction customize(node,mat,obj) {\n    mat.onBeforeCompile = (shader) => {\n        //add uniform\n        shader.uniforms.imageOffsetAngle    = { value: obj.imageOffsetAngle }\n        shader.uniforms.imageCropStartAngle = { value: obj.imageCropStartAngle }\n        shader.uniforms.imageCropEndAngle   = { value: obj.imageCropEndAngle }\n        //prepend to the shader the defs\n        shader.vertexShader = `\n            uniform float imageOffsetAngle;\n            varying float vImageOffsetAngle;\n            uniform float imageCropStartAngle;            \n            varying float vImageCropStartAngle;            \n            uniform float imageCropEndAngle;            \n            varying float vImageCropEndAngle;            \n        ` + shader.vertexShader\n\n        //copy into fragment shader\n        shader.vertexShader = shader.vertexShader.replace('#include <begin_vertex>',`\n            #include <begin_vertex>\n            vImageOffsetAngle = imageOffsetAngle;\n            vImageCropStartAngle = imageCropStartAngle;\n            vImageCropEndAngle = imageCropEndAngle;\n        `)\n\n        //prepend to the fragment shader the defs\n        shader.fragmentShader = `\n                varying float vImageOffsetAngle;\n                varying float vImageCropStartAngle;\n                varying float vImageCropEndAngle;\n            `+shader.fragmentShader\n        //use in the shader\n        shader.fragmentShader = shader.fragmentShader.replace('#include <dithering_fragment>',`\n            if(vUv.x < vImageCropStartAngle) discard;\n            if(vUv.x > vImageCropEndAngle)  discard;\n            // gl_FragColor.r = vUv.x;\n            // vec3 jv = vec3(cos(gl_FragCoord.x/50.0)); \n            // vec3 empty = vec3(0.0,0.0,0.0);//vec3(jv,jv,jv)\n            // gl_FragColor.rgb = mix(empty,diffuseColor.rgb,jv);\n        `)\n        node.userData.matShader = shader\n    }\n}\n\nexport default class BG360Def {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create sphere w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.bg360,\n            title:'background',\n            visible:true,\n            asset:NONE_ASSET.id,\n            transparent:false,\n            parent:scene.id,\n            imageOffsetAngle:0.0, //offset in UV coords, 0 to 1\n            imageCropStartAngle:0.0, //crop left edge of image\n            imageCropEndAngle:1.0, //crop right edge of image\n        }))\n    }\n    makeNode(obj, provider) {\n        const mat = new THREE.MeshLambertMaterial({color: 'white', side: THREE.BackSide})\n        const node = new THREE.Mesh(new THREE.SphereBufferGeometry(20.0, 50,50),mat)\n        this.attachAsset(node, obj, provider)\n        customize(node,mat,obj)\n        node.name = obj.title\n        node.userData.clickable = true\n        node.visible = obj.visible\n        return node\n    }\n    updateProperty(node, obj, op, provider) {\n        if (op.name === PROP_DEFS.asset.key || op.name === PROP_DEFS.transparent.key) return this.attachAsset(node, obj, provider)\n        if(node.userData.matShader) {\n            if (op.name === 'imageOffsetAngle') node.userData.matShader.uniforms.imageOffsetAngle.value = op.value\n            if (op.name === 'imageCropStartAngle') node.userData.matShader.uniforms.imageCropStartAngle.value = op.value\n            if (op.name === 'imageCropEndAngle') node.userData.matShader.uniforms.imageCropEndAngle.value = op.value\n        } else {\n            console.warn(\"BG360: no shader reference?!\")\n        }\n    }\n\n    attachAsset(node, obj, provider) {\n        if(obj.asset === NONE_ASSET.id) {\n            node.material = new MeshLambertMaterial({side:DoubleSide})\n            return\n        }\n        provider.assetsManager.getTexture(obj.asset).then(tex => {\n            provider.getLogger().log(\"loadded asset\",obj.asset)\n            provider.getLogger().log(tex)\n            if(!tex) provider.getLogger().error(\"error loading asset\",obj.asset)\n            const opts = {\n                side: DoubleSide,\n                map:tex\n            }\n            if(obj.transparent) {\n                opts.transparent = true\n                opts.alphaTest = 0.5\n            }\n            node.material = new MeshLambertMaterial(opts)\n        }).catch(err => {\n            provider.getLogger().error('error somwhere',err.message,err)\n        })\n    }\n\n}\n","import ObjectDef from './ObjectDef'\nimport {fetchGraphObject} from '../../syncgraph/utils'\nimport {OBJ_TYPES, PROP_DEFS} from '../Common'\nimport * as THREE from 'three'\nimport WebLayer3D from 'three-web-layer'\n\nexport default class TextDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create sphere w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.text,\n            title:'some text',\n            visible:true,\n            text:'cool <b>formatted</b> <i>text</i>',\n            cssStyle:\n`color:black; \nbackground-color:white;\nwidth: 10em;\nfont-size: 200%;\n`,\n\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n\n            children:graph.createArray(),\n            parent:scene.id\n        }))\n    }\n\n    makeNode(obj) {\n        const div = document.createElement('div')\n        div.innerHTML = obj.text\n        div.id = `div_${obj.id}`\n        div.classList.add('weblayer-div')\n        if(obj.cssStyle) div.setAttribute('style',obj.cssStyle)\n        const divLayer = new WebLayer3D(div,{\n            pixelRatio: window.devicePixelRatio,\n            onLayerCreate(layer) {\n                layer.mesh.material.side = THREE.DoubleSide\n                layer.mesh.userData.graphid = obj.id\n                layer.mesh.userData.clickable = true\n            }\n        })\n\n        divLayer.refresh(true)\n        divLayer.userData.clickable = true\n        const node = new THREE.Object3D()\n\n        node.previewUpdate = function() {\n            divLayer.update()\n        }        \n        node.setText = function (text) {\n            if (text !== node.userData.text) {\n                node.userData.text = text\n                node.userData.div.innerHTML = text\n                //if(obj.cssStyle) node.userData.div.setAttribute('style',obj.cssStyle)\n\n                // shouldn't be explicitly calling refresh\n                //node.userData.divLayer.refresh(true)\n            }\n        }\n\n        node.add(divLayer)\n        node.userData.divLayer = divLayer\n        node.userData.text = obj.text\n        node.userData.div = div\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        this.regenerateText(node,obj)\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        if(    op.name === PROP_DEFS.text.key) this.regenerateText(node,obj)\n        if(    op.name === PROP_DEFS.cssStyle.key) this.regenerateText(node,obj)\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n\n    regenerateText(node, obj) {\n        node.userData.div.innerHTML = obj.text\n        if(obj.cssStyle) node.userData.div.setAttribute('style',obj.cssStyle)\n        node.userData.divLayer.refresh(true)\n    }\n}\n\n\n\n","import {fetchGraphObject} from '../../syncgraph/utils'\nimport {NONE_ASSET, OBJ_TYPES, PROP_DEFS} from '../Common'\nimport * as THREE from 'three'\nimport ObjectDef from './ObjectDef'\n\nexport default class Image2DDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create Image2D with missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.img2d,\n            title:'image',\n            visible:true,\n            width:0.5,\n            ratio:1,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            asset:NONE_ASSET.id,\n            transparent:false,\n            parent:scene.id,\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new THREE.Mesh(\n            new THREE.PlaneBufferGeometry(obj.width, obj.width*obj.ratio),\n            new THREE.MeshLambertMaterial({color: 'white', side: THREE.DoubleSide})\n        )\n        node.name = obj.title\n        node.userData.clickable = true\n        // on(node,POINTER_CLICK,e =>SelectionManager.setSelection(node.userData.graphid))\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        this.attachAsset(node, obj, provider)\n        return node\n    }\n    updateProperty(node, obj, op, provider) {\n        if (op.name === PROP_DEFS.asset.key || op.name === PROP_DEFS.transparent.key) return this.attachAsset(node, obj, provider)\n        if( op.name === PROP_DEFS.width.key || op.name === 'ratio') {\n            node.geometry = new THREE.PlaneBufferGeometry(obj.width, obj.width*(1/obj.ratio))\n            return\n        }\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport {Group} from 'three'\nimport ObjectDef from './ObjectDef'\nimport {OBJ_TYPES} from '../Common'\n\nlet COUNTER = 0\n\nexport default class GroupDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create cube w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.group,\n            title:'group '+COUNTER++,\n            visible:true,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#00ff00',\n            children:graph.createArray(),\n            parent:scene.id\n        }))\n    }\n    makeNode(obj) {\n        const node = new Group()\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n}\n","import {\n    BufferAttribute,\n    BufferGeometry,\n    CanvasTexture,\n    Color,\n    NormalBlending,\n    Object3D,\n    Points,\n    RepeatWrapping,\n    ShaderMaterial,\n    Vector3\n} from 'three'\n\n/*\n* modified from the version from the ThreeJS examples repo\n */\n\nconst GPUParticleShader = {\n\n    vertexShader:\n        `\n                uniform float uTime;\n                uniform float uScale;\n                uniform bool reverseTime;\n                uniform float fadeIn;\n                uniform float fadeOut;\n    \n                attribute vec3 positionStart;\n                attribute float startTime;\n                attribute vec3 velocity;\n                attribute vec3 acceleration;\n                attribute vec3 color;\n                attribute vec3 endColor;\n                attribute float size;\n                attribute float lifeTime;\n    \n                varying vec4 vColor;\n                varying vec4 vEndColor;\n                varying float lifeLeft;\n                varying float alpha;\n    \n                void main() {\n                    vColor = vec4( color, 1.0 );\n                    vEndColor = vec4( endColor, 1.0);\n                    vec3 newPosition;\n                    float timeElapsed = uTime - startTime;\n                    if(reverseTime) timeElapsed = lifeTime - timeElapsed;\n                    if(timeElapsed < fadeIn) {\n                        alpha = timeElapsed/fadeIn;\n                    }\n                    if(timeElapsed >= fadeIn && timeElapsed <= (lifeTime - fadeOut)) {\n                        alpha = 1.0;\n                    }\n                    if(timeElapsed > (lifeTime - fadeOut)) {\n                        alpha = 1.0 - (timeElapsed - (lifeTime-fadeOut))/fadeOut;\n                    }\n                    \n                    lifeLeft = 1.0 - ( timeElapsed / lifeTime );\n                    gl_PointSize = ( uScale * size );// * lifeLeft;\n                    newPosition = positionStart \n                        + (velocity * timeElapsed)\n                        + (acceleration * 0.5 * timeElapsed * timeElapsed)\n                        ;\n                    if (lifeLeft < 0.0) { \n                        lifeLeft = 0.0; \n                        gl_PointSize = 0.;\n                    }\n                    //while active use the new position\n                    if( timeElapsed > 0.0 ) {\n                        gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );\n                    } else {\n                        //if dead use the initial position and set point size to 0\n                        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n                        lifeLeft = 0.0;\n                        gl_PointSize = 0.;\n                    }\n                }\n                `\n    ,\n\n    fragmentShader: `\n                varying vec4 vColor;\n                varying vec4 vEndColor;\n                varying float lifeLeft;\n                varying float alpha;\n                uniform sampler2D tSprite;\n                void main() {\n                    // color based on particle texture and the lifeLeft. \n                    // if lifeLeft is 0 then make invisible\n                    vec4 tex = texture2D( tSprite, gl_PointCoord );\n                    vec4 color = mix(vColor, vEndColor, 1.0-lifeLeft);\n                    gl_FragColor = vec4( color.rgb*tex.rgb, alpha * tex.a);\n                }\n    \n            `\n};\n\nconst UPDATEABLE_ATTRIBUTES = [\n    'positionStart', 'startTime',\n    'velocity', 'acceleration',\n    'color', 'endColor',\n    'size', 'lifeTime']\n\nexport default class GPUParticles extends Object3D {\n    constructor(options) {\n        super()\n        options = options || {};\n\n\n        this.blending = options.blending? options.blending : NormalBlending\n        this.PARTICLE_COUNT = options.maxParticles || 1000000;\n        this.PARTICLE_CURSOR = 0;\n        this.time = 0;\n        this.offset = 0;\n        this.count = 0;\n        this.DPR = window.devicePixelRatio;\n        this.particleUpdate = false;\n        this.onTick = options.onTick\n\n        this.reverseTime = options.reverseTime\n        this.fadeIn = options.fadeIn || 1\n        if(this.fadeIn === 0) this.fadeIn = 0.001\n        this.fadeOut = options.fadeOut || 1\n        if(this.fadeOut === 0) this.fadeOut = 0.001\n\n        // preload a 10_000 random numbers from -0.5 to 0.5\n        this.rand = [];\n        let i;\n        for (i = 1e5; i>0; i--) {\n            this.rand.push( Math.random() - 0.5 );\n        }\n        this.i = i\n\n        //setup the texture\n        this.sprite = options.particleSpriteTex || null;\n        if(!this.sprite) {\n            const can = document.createElement('canvas')\n            can.width = 16\n            can.height = 16\n            const ctx = can.getContext('2d')\n            ctx.fillStyle = 'black'\n            ctx.fillRect(0,0,can.width,can.height)\n            ctx.fillStyle = 'rgba(255,255,255,0.5)'\n            ctx.beginPath()\n            ctx.arc(8,8,8,0,Math.PI*2)\n            ctx.fill()\n            this.sprite = new CanvasTexture(can)\n        }\n        this.sprite.wrapS = this.sprite.wrapT = RepeatWrapping;\n\n        //setup the shader material\n        this.material = new ShaderMaterial( {\n            transparent: true,\n            depthWrite: false,\n            uniforms: {\n                'uTime': {\n                    value: 0.0\n                },\n                'uScale': {\n                    value: 1.0\n                },\n                'tSprite': {\n                    value: this.sprite\n                },\n                reverseTime: {\n                    value: this.reverseTime\n                },\n                fadeIn: {\n                    value: this.fadeIn\n                },\n                fadeOut: {\n                    value: this.fadeOut,\n                }\n            },\n            blending: this.blending,\n            vertexShader: GPUParticleShader.vertexShader,\n            fragmentShader: GPUParticleShader.fragmentShader\n        } );\n\n        // define defaults for all values\n        this.material.defaultAttributeValues.particlePositionsStartTime = [ 0, 0, 0, 0 ];\n        this.material.defaultAttributeValues.particleVelColSizeLife = [ 0, 0, 0, 0 ];\n\n\n        // geometry\n        this.geometry = new BufferGeometry();\n\n        //vec3 attributes\n        this.geometry.addAttribute('position',      new BufferAttribute(new Float32Array(this.PARTICLE_COUNT * 3), 3).setDynamic(true));\n        this.geometry.addAttribute('positionStart', new BufferAttribute(new Float32Array(this.PARTICLE_COUNT * 3), 3).setDynamic(true));\n        this.geometry.addAttribute('velocity',      new BufferAttribute(new Float32Array(this.PARTICLE_COUNT * 3), 3).setDynamic(true));\n        this.geometry.addAttribute('acceleration',  new BufferAttribute(new Float32Array(this.PARTICLE_COUNT * 3), 3).setDynamic(true));\n        this.geometry.addAttribute('color',         new BufferAttribute(new Float32Array(this.PARTICLE_COUNT * 3), 3).setDynamic(true));\n        this.geometry.addAttribute('endColor',      new BufferAttribute(new Float32Array(this.PARTICLE_COUNT * 3), 3).setDynamic(true));\n\n        //scalar attributes\n        this.geometry.addAttribute('startTime',     new BufferAttribute(new Float32Array(this.PARTICLE_COUNT), 1).setDynamic(true));\n        this.geometry.addAttribute('size',          new BufferAttribute(new Float32Array(this.PARTICLE_COUNT), 1).setDynamic(true));\n        this.geometry.addAttribute('lifeTime',      new BufferAttribute(new Float32Array(this.PARTICLE_COUNT), 1).setDynamic(true));\n\n\n        this.particleSystem = new Points(this.geometry, this.material);\n        this.particleSystem.frustumCulled = false;\n        this.add(this.particleSystem);\n    }\n\n    /*\n      This updates the geometry on the shader if at least one particle has been spawned.\n      It uses the offset and the count to determine which part of the data needs to actually\n      be sent to the GPU. This ensures no more data than necessary is sent.\n     */\n    geometryUpdate () {\n        if (this.particleUpdate === true) {\n            this.particleUpdate = false;\n            UPDATEABLE_ATTRIBUTES.forEach(name => {\n                const attr = this.geometry.getAttribute(name)\n                if (this.offset + this.count < this.PARTICLE_COUNT) {\n                    attr.updateRange.offset = this.offset * attr.itemSize\n                    attr.updateRange.count = this.count * attr.itemSize\n                } else {\n                    attr.updateRange.offset = 0\n                    attr.updateRange.count = -1\n                }\n                attr.needsUpdate = true\n            })\n            this.offset = 0;\n            this.count = 0;\n        }\n    }\n\n\n    //use one of the random numbers\n    random () {\n        return ++ this.i >= this.rand.length ? this.rand[ this.i = 1 ] : this.rand[ this.i ];\n    }\n\n    update ( ttime ) {\n        this.time = ttime/1000\n        this.material.uniforms.uTime.value = this.time;\n        if(this.onTick) this.onTick(this,this.time)\n        this.geometryUpdate();\n    }\n\n    dispose () {\n        this.material.dispose();\n        this.sprite.dispose();\n        this.geometry.dispose();\n    }\n\n    updateSprite(sprite) {\n        if(sprite) {\n            const old = this.sprite\n            this.sprite = sprite\n            this.sprite.wrapS = this.sprite.wrapT = RepeatWrapping;\n            this.material.uniforms.tSprite.value = sprite\n            if(old) old.dispose()\n        }\n    }\n\n    /* spawn a particle\n\n    This works by updating values inside of\n    the attribute arrays, then updates the count and the PARTICLE_CURSOR and\n    sets particleUpdate to true.\n\n    This if spawnParticle is called three times in a row before rendering,\n    then count will be 3 and the cursor will have moved by three.\n     */\n    spawnParticle ( options ) {\n        // console.log('spawnparticle')\n        let position = new Vector3()\n        let velocity = new Vector3()\n        let acceleration = new Vector3()\n        let color = new Color()\n        let endColor = new Color()\n\n        const positionStartAttribute = this.geometry.getAttribute('positionStart')\n        const startTimeAttribute = this.geometry.getAttribute('startTime')\n        const velocityAttribute = this.geometry.getAttribute('velocity')\n        const accelerationAttribute = this.geometry.getAttribute('acceleration')\n        const colorAttribute = this.geometry.getAttribute('color')\n        const endcolorAttribute = this.geometry.getAttribute('endColor')\n        const sizeAttribute = this.geometry.getAttribute('size')\n        const lifeTimeAttribute = this.geometry.getAttribute('lifeTime')\n\n        options = options || {};\n\n        // setup reasonable default values for all arguments\n\n        position = options.position !== undefined ? position.copy(options.position) : position.set(0, 0, 0);\n        velocity = options.velocity !== undefined ? velocity.copy(options.velocity) : velocity.set(0, 0, 0);\n        acceleration = options.acceleration !== undefined ? acceleration.copy(options.acceleration) : acceleration.set(0, 0, 0);\n        color = options.color !== undefined ? color.copy(options.color) : color.set(0xffffff);\n        endColor = options.endColor !== undefined ? endColor.copy(options.endColor) : endColor.copy(color)\n\n        const lifetime = options.lifetime !== undefined ? options.lifetime : 5\n        let size = options.size !== undefined ? options.size : 10\n        const sizeRandomness = options.sizeRandomness !== undefined ? options.sizeRandomness : 0\n\n        if (this.DPR !== undefined) size *= this.DPR;\n\n        const i = this.PARTICLE_CURSOR\n\n        // position\n        positionStartAttribute.array[i * 3 + 0] = position.x\n        positionStartAttribute.array[i * 3 + 1] = position.y\n        positionStartAttribute.array[i * 3 + 2] = position.z\n\n        velocityAttribute.array[i * 3 + 0] = velocity.x;\n        velocityAttribute.array[i * 3 + 1] = velocity.y;\n        velocityAttribute.array[i * 3 + 2] = velocity.z;\n\n        accelerationAttribute.array[i * 3 + 0] = acceleration.x;\n        accelerationAttribute.array[i * 3 + 1] = acceleration.y;\n        accelerationAttribute.array[i * 3 + 2] = acceleration.z;\n\n        colorAttribute.array[i * 3 + 0] = color.r;\n        colorAttribute.array[i * 3 + 1] = color.g;\n        colorAttribute.array[i * 3 + 2] = color.b;\n\n        endcolorAttribute.array[i * 3 + 0] = endColor.r;\n        endcolorAttribute.array[i * 3 + 1] = endColor.g;\n        endcolorAttribute.array[i * 3 + 2] = endColor.b;\n\n        //size, lifetime and starttime\n        sizeAttribute.array[i] = size + this.random() * sizeRandomness;\n        lifeTimeAttribute.array[i] = lifetime;\n        startTimeAttribute.array[i] = this.time + this.random() * 2e-2;\n\n        // offset\n        if (this.offset === 0) this.offset = this.PARTICLE_CURSOR;\n        // counter and cursor\n        this.count++;\n        this.PARTICLE_CURSOR++;\n        //wrap the cursor around\n        if (this.PARTICLE_CURSOR >= this.PARTICLE_COUNT) this.PARTICLE_CURSOR = 0;\n        this.particleUpdate = true;\n    };\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport {AdditiveBlending, Color, TextureLoader, Vector3} from 'three'\nimport ObjectDef from './ObjectDef'\nimport {NONE_ASSET, OBJ_TYPES, PROP_DEFS} from '../Common'\nimport GPUParticles from './GPUParticles'\n\nexport const rand = (min,max) => Math.random()*(max-min) + min\n\nlet COUNTER = 0\n\nexport default class ParticlesDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create cube w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.particles,\n            title:'particles '+COUNTER++,\n            visible:true,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            children:graph.createArray(),\n            pointSize:10.0,\n            lifetime:3.0,\n            startColor:'#ff0000',\n            endColor:'#0000ff',\n            parent:scene.id,\n            texture:NONE_ASSET.id,\n        }))\n    }\n    makeNode(obj, provider) {\n        const options = {\n            velocity: new Vector3(0,1,0),\n            position: new Vector3(0,0,0),\n            size:obj.pointSize,\n            lifetime:obj.lifetime,\n            color: new Color(1.0,0.0,1.0),\n            endColor: new Color(0,1,1),\n        }\n\n        const node = new GPUParticles({\n            maxParticles: 10000,\n            position: new Vector3(0,0,0),\n            positionRandomness: 0.0,\n            baseVelocity: new Vector3(0.0, 0.0, -1),\n            velocity: new Vector3(0.0, 0.0, 0.0),\n            velocityRandomness: 1.0,\n            acceleration: new Vector3(0,0.0,0),\n            baseColor: new Color(1.0,1.0,0.5),\n            color: new Color(1.0,0,0),\n            colorRandomness: 0.5,\n            lifetime: 3,\n            size: 10,\n            sizeRandomness: 1.0,\n            blending: AdditiveBlending,\n            onTick: (system, time) => {\n                options.velocity.set(rand(-1,1),1,rand(-1,1))\n                system.spawnParticle(options);\n            }\n        })\n        node.tick = function(evt) {\n            node.update(evt.time)\n        }\n        this.attachTexture(node,obj,provider)\n        node.userData.options = options\n        node.name = obj.title\n        node.userData.clickable = false\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        if(op.name === PROP_DEFS.pointSize.key) return node.userData.options.size = obj.pointSize\n        if(op.name === PROP_DEFS.lifetime.key) return node.userData.options.lifetime = obj.lifetime\n        if(op.name === PROP_DEFS.startColor.key) return node.userData.options.color.set(obj.startColor)\n        if(op.name === PROP_DEFS.endColor.key) return node.userData.options.endColor.set(obj.endColor)\n        if(op.name === PROP_DEFS.texture.key) return this.attachTexture(node,obj,provider)\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n    attachTexture(node, obj, provider) {\n        if(obj.asset === NONE_ASSET.id) {\n            node.updateSprite(null)\n            return\n        }\n        const texture = provider.accessObject(obj.texture)\n        if(!texture.exists()) return\n        const url = provider.assetsManager.getAssetURL(texture)\n        provider.getLogger().log(\"ParticlesDef: loading the asset url\",url)\n        const tex = new TextureLoader().load(url)\n        node.updateSprite(tex)\n    }\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport ObjectDef from './ObjectDef'\nimport {NONE_ASSET, OBJ_TYPES, PROP_DEFS} from '../Common'\nimport * as THREE from 'three'\n\n//////////////////////////////////////////////////////////////////////\n// portal object itself\n//////////////////////////////////////////////////////////////////////\n      \n//\n// Build a constructor that can be invoked later by user\n//\nlet THREEReflector = function ( geometry, options ) {\n\n    let scope = this\n\n    // glue for threejs class injection\n    THREE.Mesh.call( scope, geometry );\n    scope.type = 'Reflector';\n  \n    // caller option handling\n    options = options || {};\n    var childrenMode = options.childrenMode || 0\n    var color = ( options.color !== undefined ) ? new THREE.Color( options.color ) : new THREE.Color( 0xFFFFFF );\n    var clear = ( options.clear !== undefined ) ? new THREE.Color( options.clear ) : new THREE.Color( 0xFF0000 );\n    var textureWidth = options.textureWidth || 512;\n    var textureHeight = options.textureHeight || 512;\n    var clipBias = options.clipBias || 0;\n    var shader = options.shader || THREEReflector.ReflectorShader;\n    var recursion = options.recursion !== undefined ? options.recursion : 1;\n\n    // Build a few static variables to avoid thrashing memory at runtime\n    var reflectorPlane = new THREE.Plane();\n    var normal = new THREE.Vector3();\n    var reflectorWorldPosition = new THREE.Vector3();\n    var cameraWorldPosition = new THREE.Vector3();\n    var scratchMatrix = new THREE.Matrix4();\n    var lookAtPosition = new THREE.Vector3( 0, 0, - 1 );\n    var clipPlane = new THREE.Vector4();\n    var viewport = new THREE.Vector4();\n    var view = new THREE.Vector3();\n    var target = new THREE.Vector3();\n    var q = new THREE.Vector4();\n    var size = new THREE.Vector2();\n    var textureMatrix = new THREE.Matrix4();\n    var virtualCamera = new THREE.PerspectiveCamera();\n\n    // Build a texture to render into\n    var parameters = {\n      minFilter: THREE.LinearFilter,\n      magFilter: THREE.LinearFilter,\n      format: THREE.RGBFormat,\n      stencilBuffer: false\n    }\n    var renderTarget = this.renderTarget = new THREE.WebGLRenderTarget(\n      textureWidth,\n      textureHeight,\n      parameters\n    )\n    if ( ! THREE.Math.isPowerOfTwo( textureWidth ) || ! THREE.Math.isPowerOfTwo( textureHeight ) ) {\n      renderTarget.texture.generateMipmaps = false;\n    }\n\n    // After the target texture is rendered it needs to pretend it is a material so threejs can paint it\n    var material = new THREE.ShaderMaterial( {\n      side: THREE.DoubleSide,\n      uniforms: THREE.UniformsUtils.clone( shader.uniforms ),\n      fragmentShader: shader.fragmentShader,\n      vertexShader: shader.vertexShader\n    } );\n    material.uniforms[ \"tDiffuse\" ].value = renderTarget.texture;\n    material.uniforms[ \"color\" ].value = color;\n    material.uniforms[ \"textureMatrix\" ].value = textureMatrix;\n    scope.material = material;\n\n    // Have a private scene\n    let privateScene = this.privateScene = new THREE.Scene()\n    this.privateLight1 = new THREE.PointLight(0xffffff, 1, 1000)\n    this.privateLight1.intensity = 2\n    this.privateLight2 = new THREE.DirectionalLight()\n    this.privateScene.add(scope.privateLight1)\n    this.privateScene.add(scope.privateLight2)          \n  \n    // Every frame when painting this object, quickly go ahead and remake the texture based on a portal camera view\n    scope.onBeforeRender = function ( renderer, portalParentGroup, camera ) {\n\n        // number of bounces - may be less useful for portals than mirrors?\n        if ( 'recursion' in camera.userData ) {\n          if ( camera.userData.recursion === recursion ) return;\n          camera.userData.recursion ++;\n        }\n\n        // find positions and vector between\n        reflectorWorldPosition.setFromMatrixPosition( scope.matrixWorld )\n        cameraWorldPosition.setFromMatrixPosition( camera.matrixWorld )\n        view.subVectors( reflectorWorldPosition, cameraWorldPosition )\n\n        // get a normal for the direction of the portal based on where we are\n        scratchMatrix.extractRotation( scope.matrixWorld )\n        let portalDirection = view.dot(normal)<0 ? 1 : -1\n        normal.set( 0, 0, portalDirection )\n        normal.applyMatrix4( scratchMatrix )\n\n        // get a clone of the current camera as a scratch space\n        // TODO slightly wasteful of CPU\n        virtualCamera = camera.clone()\n\n        // transform the camera to be relative to the portals pose in the exterior world\n        let portalInverse = scratchMatrix.getInverse(scope.matrixWorld)\n        virtualCamera.applyMatrix(portalInverse)\n\n        // clear this for some reason?\n        virtualCamera.userData.recursion = 0;\n      \n        // Update the texture matrix\n        textureMatrix.set(\n          0.5, 0.0, 0.0, 0.5,\n          0.0, 0.5, 0.0, 0.5,\n          0.0, 0.0, 0.5, 0.5,\n          0.0, 0.0, 0.0, 1.0\n        );\n        textureMatrix.multiply( virtualCamera.projectionMatrix )\n        textureMatrix.multiply( virtualCamera.matrixWorldInverse )\n        textureMatrix.multiply( scope.matrixWorld )\n\n        //////////////////////////////////////////////////\n        // Now update projection matrix with new clip plane, implementing code from: http://www.terathon.com/code/oblique.html\n        // Paper explaining this technique: http://www.terathon.com/lengyel/Lengyel-Oblique.pdf\n        //////////////////////////////////////////////////\n\n        if(true) {\n            reflectorPlane.setFromNormalAndCoplanarPoint( normal, reflectorWorldPosition );\n            reflectorPlane.applyMatrix4( virtualCamera.matrixWorldInverse );\n\n            clipPlane.set( reflectorPlane.normal.x, reflectorPlane.normal.y, reflectorPlane.normal.z, reflectorPlane.constant );\n\n            var projectionMatrix = virtualCamera.projectionMatrix;\n\n            q.x = ( Math.sign( clipPlane.x ) + projectionMatrix.elements[ 8 ] ) / projectionMatrix.elements[ 0 ];\n            q.y = ( Math.sign( clipPlane.y ) + projectionMatrix.elements[ 9 ] ) / projectionMatrix.elements[ 5 ];\n            q.z = -1.0;\n            q.w = ( 1.0 + projectionMatrix.elements[ 10 ] ) / projectionMatrix.elements[ 14 ];\n\n            // Calculate the scaled plane vector\n            clipPlane.multiplyScalar( 2.0 / clipPlane.dot( q ) );\n\n            // Replacing the third row of the projection matrix\n            projectionMatrix.elements[ 2 ] = clipPlane.x;\n            projectionMatrix.elements[ 6 ] = clipPlane.y;\n            projectionMatrix.elements[ 10 ] = clipPlane.z + 1.0 - clipBias;\n            projectionMatrix.elements[ 14 ] = clipPlane.w;\n        }\n\n        // move children to private scene\n        scope.children.slice().forEach(child=>{\n        \tscope.remove(child)\n        \tprivateScene.add(child)\n        })\n\n        // Render to the texture\n        {\n            // Save renderer state\n            let currentRenderTarget = renderer.getRenderTarget();\n            let currentVrEnabled = renderer.vr.enabled;\n            let currentShadowAutoUpdate = renderer.shadowMap.autoUpdate;\n            let currentClearColor = renderer.getClearColor()\n            let currentClearAlpha = renderer.getClearAlpha()\n\n            // Render to buffer\n            renderer.vr.enabled = false; // Avoid camera modification and recursion\n            renderer.shadowMap.autoUpdate = false; // Avoid re-computing shadows\n            renderer.setRenderTarget( renderTarget )\n            renderer.setClearColor( clear )\n            renderer.setClearAlpha(0)\n            renderer.clear()\n            renderer.render( privateScene, virtualCamera, renderTarget )\n\n            // Restore renderer settings\n            renderer.setClearColor(currentClearColor,currentClearAlpha)\n            renderer.setClearAlpha(currentClearAlpha)\n            renderer.vr.enabled = currentVrEnabled\n            renderer.shadowMap.autoUpdate = currentShadowAutoUpdate\n            renderer.setRenderTarget( currentRenderTarget )\n        }\n\n        // move children back to main scene\n        privateScene.children.slice().forEach(child=>{\n        \tprivateScene.remove(child)\n        \tscope.add(child)\n        })\n\n        // restore viewport\n        var bounds = camera.bounds;\n        if ( bounds !== undefined ) {\n          renderer.getSize( size );\n          var pixelRatio = renderer.getPixelRatio();\n          viewport.x = bounds.x * size.width * pixelRatio;\n          viewport.y = bounds.y * size.height * pixelRatio;\n          viewport.z = bounds.z * size.width * pixelRatio;\n          viewport.w = bounds.w * size.height * pixelRatio;\n          renderer.state.viewport( viewport );\n        }\n\n    }\n\n}\n\n//\n// Attach a copy shader to the Reflector which makes the texture present as a material to threejs\n// (this is done prior to allowing users to use the reflector itself)\n//\n\nTHREEReflector.prototype = Object.create( THREE.Mesh.prototype );\nTHREEReflector.prototype.constructor = THREEReflector;\nTHREEReflector.ReflectorShader = {\n  uniforms: {\n    'color': {type: 'c',value: null},\n    'tDiffuse': {type: 't',value: null},\n    'textureMatrix': {type: 'm4',value: null}\n  },\n  vertexShader: [\n    'uniform mat4 textureMatrix;',\n    'varying vec4 vUv;',\n    'void main() {',\n    '   vUv = textureMatrix * vec4( position, 1.0 );',\n    '   gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',\n    '}'\n  ].join( '\\n' ),\n  fragmentShader: [\n    'uniform vec3 color;',\n    'uniform sampler2D tDiffuse;',\n    'varying vec4 vUv;',\n    'float blendOverlay( float base, float blend ) {',\n    '   return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );',\n    '}',\n    'vec3 blendOverlay( vec3 base, vec3 blend ) {',\n    '   return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );',\n    '}',\n    'void main() {',\n    '   vec4 base = texture2DProj( tDiffuse, vUv );',\n    '   gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );',\n    '}'\n  ].join( '\\n' )\n}\n\n/////////////////////////////////////////////////\n// app logic to manage it\n/////////////////////////////////////////////////\n\nlet COUNTER = 0\n\nexport default class PortalDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create portal w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:'portal',\n            title:'portal '+COUNTER++,\n            visible:true,\n            width:2, height:1, depth:0.1,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            clipBias: 0.001,\n            recursion: 1,\n            textureWidth: 512,\n            textureHeight: 512,\n            color:'#ffffff',\n            clear:'#ff0000',\n            children:graph.createArray(),\n            asset:NONE_ASSET.id,\n            transparent:false,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        let width = obj.width || 1\n        let height = obj.height || 1\n        var geometry = new THREE.PlaneBufferGeometry( width, height )\n        let node = this.portal = new THREEReflector( geometry, {\n          clipBias: 0.001,\n          textureWidth: 512,\n          textureHeight: 512,\n          color: obj.color || \"white\",\n          clear: obj.clear || \"red\",\n          recursion: 1,\n        })\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        this.attachAsset(node, obj, provider)\n        return node\n     }\n\n    updateProperty(node, obj, op, provider) {\n    \t// TODO TBD\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport {Group, Mesh, MeshLambertMaterial, SphereBufferGeometry} from 'three'\nimport ObjectDef from './ObjectDef'\nimport {OBJ_TYPES, REC_TYPES} from '../Common'\n\nlet COUNTER = 0\n\nexport default class LocalAnchorDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't localanchor w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.localanchor,\n            title:'localanchor '+COUNTER++,\n            visible:true,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#00ff00',\n            children:graph.createArray(),\n            recType:REC_TYPES.SCENE_START,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new Group()\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = true\n\n        const clicker =  new Mesh(\n            new SphereBufferGeometry(1),\n            new MeshLambertMaterial({color:\"green\", transparent:true, opacity: 0.2})\n        )\n        clicker.material.visible = true\n        clicker.userData.clickable = true\n        node.userData.clicker = clicker\n        node.add(clicker)\n\n        node.enter = (evt, scriptManager) => {\n            clicker.visible = false\n            node.visible = true\n            node.userData.info = {\n                recType: obj.recType,\n                object: obj,\n                node: node,\n                callback: (info) => {\n                    node.visible = true\n                }\n            }\n            scriptManager.sgp.startLocalAnchor(node.userData.info)\n        }\n        node.exit = (evt, scriptManager) => {\n            clicker.visible = true\n            scriptManager.sgp.stopLocalAnchor(node.userData.info)\n        }\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport {Group, Mesh, MeshLambertMaterial, SphereBufferGeometry, PlaneBufferGeometry, TextureLoader, DoubleSide} from 'three'\nimport ObjectDef from './ObjectDef'\nimport {OBJ_TYPES, REC_TYPES, PROP_DEFS, toRad} from '../Common'\n\nlet COUNTER = 0\n\nexport default class ImageAnchorDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't imageanchor w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.imageanchor,\n            title:'image anchor '+COUNTER++,\n            visible:true,\n            reactivate: false,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#00ff00',\n            children:graph.createArray(),\n            targetImage:null,\n            imageRealworldWidth:1,\n            recType:REC_TYPES.SCENE_START,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new Group()\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n\n        const clicker =  new Mesh(\n            new SphereBufferGeometry(1),\n            new MeshLambertMaterial({color:\"red\", transparent:true, opacity: 0.2})\n        )\n        clicker.material.visible = true\n        clicker.userData.clickable = true\n        node.userData.clicker = clicker\n        node.add(clicker)\n\n        const preview = new Mesh(\n            new PlaneBufferGeometry(1,1),\n            new MeshLambertMaterial({color:'white',transparent:true, opacity: 0.5, side: DoubleSide})\n        )\n        preview.rotation.x = toRad(90)\n        node.add(preview)\n        node.userData.preview = preview\n        this.updateImagePreview(node,obj,provider)\n\n        node.enter = (evt, scriptManager) => {\n            clicker.visible = false\n            node.visible = false\n            preview.visible = false\n            node.userData.info = {\n                image: scriptManager.sgp.getGraphObjectById(obj.targetImage),\n                imageRealworldWidth: obj.imageRealworldWidth,\n                reactivate: obj.reactivate,\n                recType: obj.recType,\n                object: obj,\n                node: node,\n                callback: (info) => {\n                    scriptManager.fireEventAtTarget(obj, 'recognized', info)\n                    node.visible = true\n                }\n            }\n            scriptManager.sgp.startImageRecognizer(node.userData.info)\n        }\n        node.exit = (evt, scriptManager) => {\n            clicker.visible = true\n            preview.visible = true\n            scriptManager.sgp.stopImageRecognizer(node.userData.info)\n        }\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        if(op.name === PROP_DEFS.targetImage.key) {\n            return this.updateImagePreview(node,obj,provider)\n        }\n        if(op.name === PROP_DEFS.imageRealworldWidth.key) {\n            return this.updateImagePreview(node,obj,provider)\n        }\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n    updateImagePreview(node,obj,provider) {\n        const targetImage = provider.accessObject(obj.targetImage)\n        if(targetImage.exists()) {\n            const url = provider.assetsManager.getAssetURL(targetImage)\n            provider.getLogger().log(\"ImageAnchor loading the asset url\",url)\n            const tex = new TextureLoader().load(url)\n            node.userData.preview.material = new MeshLambertMaterial({color:'white',transparent:true, opacity:0.5, side:DoubleSide, map:tex})\n            let height = (targetImage.height / targetImage.width)\n            let width = 1\n            node.userData.preview.geometry = new PlaneBufferGeometry(width,height)\n            //console.log(obj)\n            let scale = obj.imageRealworldWidth\n            node.userData.preview.scale.set(scale,scale,scale)\n        }\n        if(provider.accessObject(obj.targetImage).exists()) {\n            node.userData.preview.visible = true\n            node.userData.clicker.visible = false\n        } else {\n            node.userData.preview.visible = false\n            node.userData.clicker.visible = true\n        }\n    }\n\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport {Group, Mesh, MeshLambertMaterial, SphereBufferGeometry} from 'three'\nimport ObjectDef from './ObjectDef'\nimport {OBJ_TYPES, REC_TYPES} from '../Common'\nlet COUNTER = 0\n\nexport default class GeoAnchorDef extends ObjectDef {\n    make(graph, scene) {\n        if (!scene.id) throw new Error(\"can't create geo anchor w/ missing parent\")\n        return fetchGraphObject(graph, graph.createObject({\n            type: OBJ_TYPES.geoanchor,\n            title: 'geo anchor ' + COUNTER++,\n            visible: true,\n            tx: 0, ty: 0, tz: 0,\n            rx: 0, ry: 0, rz: 0,\n            sx: 1, sy: 1, sz: 1,\n            color: '#00ff00',\n            children: graph.createArray(),\n            targetGeoLocation: null,\n            recType: REC_TYPES.SCENE_START,\n            parent: scene.id\n        }))\n    }\n    makeNode(obj) {\n        const node = new Group()\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n\n        const clicker =  new Mesh(\n            new SphereBufferGeometry(1),\n            new MeshLambertMaterial({color:\"red\", transparent:true, opacity: 0.2})\n        )\n        clicker.material.visible = true\n        clicker.userData.clickable = true\n        node.userData.clicker = clicker\n        node.add(clicker)\n        node.enter = (evt, scriptManager) => {\n            clicker.visible = false\n            node.visible = false\n            node.userData.info = {\n                location:scriptManager.sgp.getGraphObjectById(obj.targetGeoLocation),\n                recType:obj.recType,\n                object:obj,\n                node:node,\n                callback:(info) => {\n                    scriptManager.fireEventAtTarget(obj, 'localized', info)\n                    node.visible = true\n                }\n            }\n            scriptManager.sgp.startGeoTracker(node.userData.info)\n        }\n        node.exit = (evt, scriptManager) => {\n            clicker.visible = true\n            scriptManager.sgp.stopGeoTracker(node.userData.info)\n        }\n        return node\n    }\n}","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport {Group, Mesh, MeshLambertMaterial, SphereBufferGeometry} from 'three'\nimport ObjectDef from './ObjectDef'\nimport {OBJ_TYPES} from '../Common'\n\nlet COUNTER = 0\n\nexport class HudAnchorDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't add hudanchor w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.hudanchor,\n            title:'hud anchor '+COUNTER++,\n            visible:true,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            children:graph.createArray(),\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new Group()\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n\n        const clicker =  new Mesh(\n            new SphereBufferGeometry(1),\n            new MeshLambertMaterial({color:\"red\", transparent:true, opacity: 0.2})\n        )\n        clicker.material.visible = true\n        clicker.userData.clickable = true\n        node.userData.clicker = clicker\n        node.add(clicker)\n\n        node.enter = (evt,scriptManager) => {\n            node.parent.remove(node)\n            node.position.z = 0\n            clicker.visible = false\n            scriptManager.sgp.getCamera().add(node)\n        }\n        node.exit = (evt,scriptManager) => {\n            scriptManager.sgp.getCamera().remove(node)\n            clicker.visible = true\n            const scene = scriptManager.sgp.getThreeObject(obj.parent)\n            scene.add(node)\n            node.position.set(obj.tx, obj.ty, obj.tz)\n            node.rotation.set(obj.rx,obj.ry,obj.rz)\n            node.scale.set(obj.sx,obj.sy,obj.sz)\n        }\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        return super.updateProperty(node,obj,op,provider)\n    }\n}\n","import ObjectDef from './ObjectDef'\nimport {NONE_ASSET, OBJ_TYPES} from '../Common'\nimport {fetchGraphObject} from '../../syncgraph/utils'\nimport * as THREE from 'three'\nimport {MeshLambertMaterial} from 'three'\n\nlet COUNTER = 0\n\n\nexport default class CloneDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create cube w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.clone,\n            title:'clone '+COUNTER++,\n            visible:true,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            children:graph.createArray(),\n            cloneTarget:NONE_ASSET.id,\n            parent:scene.id\n        }))\n    }\n\n    makeNode(obj,provider) {\n        const node = new THREE.Group()\n        node.name = obj.title\n        const clicker = new THREE.Mesh(\n            new THREE.SphereBufferGeometry(1),\n            new MeshLambertMaterial({color: \"red\", transparent: true, opacity: 0.2})\n        )\n        clicker.material.visible = true\n        clicker.userData.clickable = true\n        node.userData.clicker = clicker\n        node.add(node.userData.clicker)\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx, obj.ry, obj.rz)\n        node.scale.set(obj.sx, obj.sy, obj.sz)\n        node.visible = obj.visible\n        node.enter = (evt, scriptManager) => {\n            clicker.visible = false\n            const cloneTarget = scriptManager.sgp.getGraphObjectById(obj.cloneTarget)\n            const cloneNode = scriptManager.sgp.getThreeObject(cloneTarget)\n            const theClone = cloneNode.clone()\n            node.add(theClone)\n            node.userData.theClone = theClone\n            node.userData.cloneTarget = cloneTarget\n\n            if(node.userData.theClone.enter) node.userData.theClone.enter(evt,scriptManager)\n            node.userData.cloneTarget.find(child => scriptManager.fireSceneLifecycleEventAtChild('enter',evt,child,obj.id))\n        }\n        node.tick  = (evt,scriptManager) => {\n            if(node.userData.theClone.tick) node.userData.theClone.tick(evt,scriptManager)\n            node.userData.cloneTarget.find(child => scriptManager.fireSceneLifecycleEventAtChild('tick',evt,child,obj.id))\n        }\n        node.exit = (evt,scriptManager) => {\n            if(node.userData.theClone.exit) node.userData.theClone.exit(evt,scriptManager)\n            node.userData.cloneTarget.find(child => scriptManager.fireSceneLifecycleEventAtChild('exit',evt,child,obj.id))\n\n            clicker.visible = true\n            node.remove(node.userData.theClone)\n            node.userData.theClone = null\n        }\n        return node\n    }\n\n}\n","import {TYPES} from '../common/PropSheet'\nimport CubeDef from './defs/CubeDef'\nimport SphereDef from './defs/SphereDef'\nimport PlaneDef from './defs/PlaneDef'\nimport ModelDef from './defs/ModelDef'\nimport BG360Def from './defs/BG360Def'\nimport TextDef from './defs/TextDef'\nimport Image2DDef from './defs/Image2DDef'\nimport GroupDef from './defs/GroupDef'\nimport ParticlesDef from './defs/ParticlesDef'\nimport PortalDef from './defs/PortalDef'\nimport LocalAnchorDef from './defs/LocalAnchorDef'\nimport ImageAnchorDef from './defs/ImageAnchorDef'\nimport GeoAnchorDef from './defs/GeoAnchorDef'\nimport {HudAnchorDef} from './defs/HudAnchorDef'\nimport CloneDef from './defs/CloneDef'\n\nexport const NONE_ASSET = {\n    id:-30,\n    title:'NONE'\n}\n\nconst stdhints = {\n    incrementValue:0.1,\n}\nexport const PROP_DEFS = {\n    title: {\n        key:'title',\n        name:'Title',\n        type:TYPES.STRING\n    },\n    description: {\n        key:'description',\n        name:'Description',\n        type:TYPES.STRING\n    },\n    width: {\n        key:'width',\n        name:'Width',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    height: {\n        key:'height',\n        name:'Height',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    depth: {\n        key:'depth',\n        name:'Depth',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    radius: {\n        key:'radius',\n        name:'Radius',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    tx: {\n        key:'tx',\n        name:'TX',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    ty: {\n        key:'ty',\n        name:'TY',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    tz: {\n        key:'tz',\n        name:'TZ',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    rx: {\n        key:'rx',\n        name:'RX',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    ry: {\n        key:'ry',\n        name:'RY',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    rz: {\n        key:'rz',\n        name:'RZ',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    sx: {\n        key:'sx',\n        name:'SX',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    sy: {\n        key:'sy',\n        name:'SY',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    sz: {\n        key:'sz',\n        name:'SZ',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    color: {\n        key:'color',\n        name:'Color',\n        type:TYPES.COLOR,\n        custom:true,\n    },\n    defaultFloor: {\n        key:'defaultFloor',\n        name:'Default Floor',\n        type:TYPES.BOOLEAN\n    },\n    src: {\n        key:'src',\n        name:'src',\n        type:TYPES.STRING,\n        locked:true,\n    },\n    asset: {\n        key:'asset',\n        name:'asset',\n        type:TYPES.ENUM,\n    },\n    subtype: {\n        key:'subtype',\n        name:'kind',\n        type:TYPES.STRING,\n        locked:true,\n    },\n    format: {\n        key:'format',\n        name:'format',\n        type:TYPES.STRING,\n        locked:true,\n    },\n    imageOffsetAngle: {\n        key:'imageOffsetAngle',\n        name:'Image Offset Angle',\n        type:TYPES.NUMBER,\n        hints: {\n            incrementValue:0.05,\n        }\n    },\n    imageCropStartAngle: {\n        key:'imageCropStartAngle',\n        name:'Image Crop Start Angle',\n        type:TYPES.NUMBER,\n        hints: {\n            incrementValue:0.05,\n        }\n    },\n    imageCropEndAngle: {\n        key:'imageCropEndAngle',\n        name:'Image Crop End Angle',\n        type:TYPES.NUMBER,\n        hints: {\n            incrementValue:0.05,\n        }\n    },\n    transparent: {\n        key:'transparent',\n        name:\"Transparent\",\n        type:TYPES.BOOLEAN\n    },\n    imageRealworldWidth: {\n        key:'imageRealworldWidth',\n        name:'Image width in meters',\n        type: TYPES.NUMBER,\n        hints: {\n            incrementValue:0.01\n        }\n    },\n    recType: {\n        key:'recType',\n        name:'Recognition Type',\n        type: TYPES.ENUM,\n    },\n\n    targetImage: {\n        key:'targetImage',\n        name:'Image to Recognize',\n        type: TYPES.ENUM,\n    },\n\n    targetGeoLocation: {\n        key:'targetGeoLocation',\n        name:'Target Location',\n        type: TYPES.ENUM,\n    },\n\n    splashImage: {\n        key:'splashImage',\n        name:'Splash Image',\n        type: TYPES.ENUM,\n    },\n\n    text: {\n        key:'text',\n        name:'Text',\n        type:TYPES.STRING,\n        hints: {\n            multiline:true\n        }\n    },\n    fontSize: {\n        key:'fontSize',\n        name:'Font Size',\n        type:TYPES.NUMBER,\n    },\n    padding: {\n        key:'padding',\n        name:'Padding',\n        type:TYPES.NUMBER,\n    },\n    borderWidth: {\n        key:'borderWidth',\n        name:'Border width',\n        type:TYPES.NUMBER,\n    },\n    borderRadius: {\n        key:'borderRadius',\n        name:'Corner Size',\n        type:TYPES.NUMBER,\n    },\n    horizontalAlign: {\n        key:'horizontalAlign',\n        name:'H Align',\n        type:TYPES.ENUM,\n        locked:false,\n    },\n    textColor: {\n        key:'textColor',\n        name:'Text Color',\n        type:TYPES.COLOR,\n        custom:true,\n    },\n    backgroundColor: {\n        key:'backgroundColor',\n        name:'BG Color',\n        type:TYPES.COLOR,\n        custom:true,\n    },\n    borderColor: {\n        key:'borderColor',\n        name:'Border Color',\n        type:TYPES.COLOR,\n        custom:true,\n    },\n    startColor: {\n        key:'startColor',\n        name:'Start',\n        type:TYPES.COLOR,\n        custom:true,\n    },\n    endColor: {\n        key:'endColor',\n        name:'End',\n        type:TYPES.COLOR,\n        custom:true,\n    },\n    drawBackground: {\n        key:'drawBackground',\n        name:'BG?',\n        type:TYPES.BOOLEAN,\n    },\n    scriptBody: {\n        key:'scriptBody',\n        name:'code',\n        type:TYPES.STRING,\n        hints: {\n            multiline:true\n        }\n    },\n    defaultScene: {\n        key:'defaultScene',\n        name:'Start Scene',\n        type:TYPES.ENUM,\n    },\n    visible: {\n        key:'visible',\n        name:'Visible',\n        type:TYPES.BOOLEAN\n    },\n\n    reactivate: {\n        key: 'reactivate',\n        name: \"Reactivate Image Search\",\n        type: TYPES.BOOLEAN\n    },\n\n    pointSize: {\n        key:'pointSize',\n        name:'Point Size',\n        type:TYPES.NUMBER,\n    },\n    lifetime: {\n        key:'lifetime',\n        name:'Lifetime',\n        type:TYPES.NUMBER,\n        hints: stdhints,\n    },\n    texture: {\n        key:'texture',\n        name:'texture',\n        type:TYPES.ENUM,\n    },\n    cssStyle: {\n        key:'cssStyle',\n        name:'Style',\n        type:TYPES.STRING,\n        hints: {\n            multiline:true\n        }\n    },\n    latitude: {\n        key:'latitude',\n        name:\"Latitude\",\n        type:TYPES.NUMBER, //value in degrees\n    },\n    longitude: {\n        key:'longitude',\n        name:\"Longitude\",\n        type:TYPES.NUMBER, //value in degrees\n    },\n    altitude: {\n        key:'altitude',\n        name:\"altitude\",\n        type:TYPES.NUMBER, //value in meters\n    },\n    useAltitude: {\n        key:'useAltitude',\n        name:\"use altitude?\",\n        type:TYPES.BOOLEAN,\n    },\n    autoRecenter: {\n        key:'autoRecenter',\n        name:\"Recenter on Load\",\n        type:TYPES.BOOLEAN\n    },\n\n    cloneTarget: {\n        key:'cloneTarget',\n        name:'clone target',\n        type: TYPES.ENUM,\n    },\n}\n\nexport const SIMPLE_COLORS = [\"#ffffff\",\"#ff0000\",\"#ffff00\",\"#00ff00\",\"#00ffff\",\"#0000ff\",\"#ff00ff\",\"#000000\"]\n\nexport const OBJ_TYPES = {\n    cube:'cube',\n    sphere:'sphere',\n    plane:'plane',\n    model:'model',\n    bg360:'bg360',\n    text:'text',\n    img2d:'img2d',\n    group:'group',\n    particles:'particles',\n    portal:'portal',\n    localanchor:'localanchor',\n    imageanchor:'imageanchor',\n    geoanchor:'geoanchor',\n    hudanchor:'hudanchor',\n    clone:'clone',\n}\n\nexport const TOTAL_OBJ_TYPES = {\n    SCENE:'scene',\n    ASSET:'asset',\n    BEHAVIOR:'behavior',\n    BEHAVIOR_SCRIPT:'behavior_script',\n    ASSETS_LIST: 'assets',\n    BEHAVIORS_LIST: 'behaviors',\n    ROOT: 'root'\n}\nexport const HORIZONTAL_ALIGNMENT = {\n    LEFT:'LEFT',\n    CENTER:'CENTER',\n    RIGHT:'RIGHT',\n}\n\n\nexport function is3DObjectType(type) {\n    if(type === OBJ_TYPES.cube) return true\n    if(type === OBJ_TYPES.sphere) return true\n    if(type === OBJ_TYPES.plane) return true\n    if(type === OBJ_TYPES.model) return true\n    if(type === OBJ_TYPES.text) return true\n    if(type === OBJ_TYPES.bg360) return true\n    if(type === OBJ_TYPES.img2d) return true\n    if(type === OBJ_TYPES.group) return true\n    if(type === OBJ_TYPES.particles) return true\n    if(type === OBJ_TYPES.portal) return true\n    if(type === OBJ_TYPES.localanchor) return true\n    if(type === OBJ_TYPES.imageanchor) return true\n    if(type === OBJ_TYPES.geoanchor) return true\n    if(type === OBJ_TYPES.hudanchor) return true\n    if(type === OBJ_TYPES.clone) return true\n    return false\n}\n\nexport function canHaveShape(type) {\n    if(type === OBJ_TYPES.group) return true\n    if(type === OBJ_TYPES.localanchor) return true\n    if(type === OBJ_TYPES.imageanchor) return true\n    if(type === OBJ_TYPES.geoanchor) return true\n    if(type === OBJ_TYPES.hudanchor) return true\n    if(type === TOTAL_OBJ_TYPES.SCENE) return true\n    return false\n}\n\nexport function canHaveBehavior(type) {\n    if(is3DObjectType(type)) return true\n    if(type === TOTAL_OBJ_TYPES.SCENE) return true\n    return false\n}\n\nexport function canHaveScene(type) {\n    if(type === TOTAL_OBJ_TYPES.ROOT) return true\n    return false\n}\n\nexport function canBeDeleted(type) {\n    if(type === TOTAL_OBJ_TYPES.ROOT) return false\n    if(type === TOTAL_OBJ_TYPES.ASSETS_LIST) return false\n    if(type === TOTAL_OBJ_TYPES.BEHAVIORS_LIST) return false\n    return true\n}\n\nexport function get3DObjectDef(type) {\n    if(type === OBJ_TYPES.cube) return new CubeDef()\n    if(type === OBJ_TYPES.sphere) return new SphereDef()\n    if(type === OBJ_TYPES.plane) return new PlaneDef()\n    if(type === OBJ_TYPES.model) return new ModelDef()\n    if(type === OBJ_TYPES.bg360) return new BG360Def()\n    if(type === OBJ_TYPES.text) return new TextDef()\n    if(type === OBJ_TYPES.img2d) return new Image2DDef()\n    if(type === OBJ_TYPES.group) return new GroupDef()\n    if(type === OBJ_TYPES.particles) return new ParticlesDef()\n    if(type === OBJ_TYPES.portal) return new PortalDef()\n    if(type === OBJ_TYPES.localanchor) return new LocalAnchorDef()\n    if(type === OBJ_TYPES.imageanchor) return new ImageAnchorDef()\n    if(type === OBJ_TYPES.geoanchor) return new GeoAnchorDef()\n    if(type === OBJ_TYPES.hudanchor) return new HudAnchorDef()\n    if(type === OBJ_TYPES.clone) return new CloneDef()\n    throw new Error(`unknown 3d object type ${type}`)\n}\n\nexport const toRad = (degrees) => degrees*Math.PI/180\n\nexport const MIME_TYPES = {\n    PNG:'image/png',\n    JPEG:'image/jpeg',\n    GIF:'image/gif',\n    MP3: 'audio/mpeg',\n    AAC: 'audio/aac',\n    WAV:'audio/wav',\n    JAVASCRIPT: 'text/javascript',\n    GLB: 'model/gltf-binary',\n    MP4:'video/mp4',\n    MOV:'video/quicktime',\n}\nexport const ASSET_TYPES = {\n    BEHAVIOR:'behavior',\n    IMAGE:'image',\n    GLTF: 'gltf',\n    AUDIO:'audio',\n    VIDEO:'video',\n    GEOLOCATION: 'geolocation'\n}\nexport function isImageType(type) {\n    if (!type) return false\n    if (type.toLowerCase() === MIME_TYPES.PNG) return true\n    if (type.toLowerCase() === MIME_TYPES.JPEG) return true\n    if (type.toLowerCase() === MIME_TYPES.GIF) return true\n    return false;\n}\nexport function isAudioType(type) {\n    if(!type) return false\n    if(type.toLowerCase() === MIME_TYPES.MP3) return true\n    if(type.toLowerCase() === MIME_TYPES.AAC) return true\n    if(type.toLowerCase() === MIME_TYPES.WAV) return true\n    return false\n}\n\nexport function isVideoType(type) {\n    if(!type) return false\n    if(type.toLowerCase() === MIME_TYPES.MP4) return true\n    if(type.toLowerCase() === MIME_TYPES.MOV) return true\n    return false\n}\nexport function isGLTFType(type) {\n    if(!type) return false\n    if(type.toLowerCase() === MIME_TYPES.GLB) return true\n    return false\n}\n\n\nexport function isGLTFFile(file) {\n    if (!file) return false\n    console.log(\"looking at the file\", file, 'type', file.type, 'type')\n    if (!file.type || file.type === '' || file.type.length === 0) {\n        console.log(\"no mimetype. check extension\")\n        if (file.name.toLowerCase().indexOf(\".gltf\") > 0) return true\n        if (file.name.toLowerCase().indexOf(\".glb\") > 0) return true\n    }\n    if (file.type.toLowerCase() === 'image/gltf') return true\n    return false;\n}\n\nexport const ITEM_ICONS = {\n    plane: 'fa fa-plane',\n    cube: 'fa fa-square',\n    sphere: 'fa fa-circle',\n    model: 'fa fa-cube',\n    asset: 'fa fa-file',\n    assets: 'fa fa-archive',\n    behavior:'fab fa-superpowers',\n    behavior_script:'fab fa-superpowers',\n    scene: 'fa fa-globe',\n    bg360:'fa fa-image',\n    img2d:'fa fa-image',\n    image:'fa fa-file-image',\n    text:'fa fa-font',\n    audio:'fa fa-file-audio',\n    video:'fas fa-file-video',\n    group:'fa fa-object-group',\n    particles:'fa fa-certificate',\n    portal:'fa fa-object-group',\n    gltf:'fa fa-cube',\n    localanchor:'fa fa-anchor',\n    imageanchor:'fa fa-anchor',\n    geoanchor:'fa fa-globe',\n    geolocation:'fas fa-globe-americas',\n    hudanchor: 'fa fa-eye',\n\n    cut:'fa fa-cut',\n    copy:'fa fa-copy',\n    paste:'fa fa-paste',\n    delete:'fa fa-close'\n}\n\n\nexport function parseBehaviorScript(contents) {\n    // eslint-disable-next-line\n    return Function(`\"use strict\";\n    const toRadians = (deg) => Math.PI/180*deg; \n    return(${contents})`)();\n}\n\nexport const REC_TYPES = {\n    SCENE_START:'SCENE_START'\n}\n","import {createGraphObjectFromObject, fetchGraphObject} from \"../../syncgraph/utils\";\nimport {\n    Group,\n    Mesh,\n    MeshLambertMaterial,\n    PlaneBufferGeometry\n} from 'three'\nimport {OBJ_TYPES, PROP_DEFS} from '../Common'\n\nfunction isAnchorType(type) {\n    if(type === OBJ_TYPES.geoanchor) return true\n    if(type === OBJ_TYPES.localanchor) return true\n    if(type === OBJ_TYPES.imageanchor) return true\n    if(type === OBJ_TYPES.hudanchor) return true\n    return false\n}\n\nfunction generateUniqueTitle(prefix,count, root) {\n    const title = prefix + ' ' + count\n    const dup = root.getChildren().find(sc =>  sc.title === title)\n    if(dup) {\n        return generateUniqueTitle(prefix,count+1,root)\n    } else {\n        return title\n    }\n}\n\nexport default class SceneDef {\n    make(graph, root) {\n        if(!root.id) throw new Error(\"can't create scene w/ missing parent\")\n        let title = generateUniqueTitle('Scene ',0,root)\n        return fetchGraphObject(graph,createGraphObjectFromObject(graph,{\n            type:'scene',\n            title:title,\n            autoRecenter:true,\n            defaultFloor: false,\n            parent:root.id,\n            children:graph.createArray()\n        }))\n    }\n    makeNode(obj,provider) {\n        const scene = new Group()\n        scene.name = obj.title\n        this.setDefaultFloor(scene,obj.defaultFloor)\n        scene.start = () => {\n            scene.userData.sceneAnchor = new Group()\n            scene.userData.sceneAnchor.name = \"SceneAnchor\"\n            scene.children.slice().forEach(chNode => {\n                const chObj = provider.accessObject(chNode.userData.graphid)\n                if(!chObj.exists()) return\n                if(isAnchorType(chObj.type)) return\n                if(chObj.type === OBJ_TYPES.geoanchor) return\n                if(chObj.type === OBJ_TYPES.localanchor) return\n                if(chObj.type === OBJ_TYPES.imageanchor) return\n                if(chObj.type === OBJ_TYPES.hudanchor) return\n                scene.userData.sceneAnchor.add(chNode)\n            })\n            scene.add(scene.userData.sceneAnchor)\n        }\n        scene.stop = () => {\n            const toMove = scene.userData.sceneAnchor.children.slice()\n            toMove.forEach(chNode => scene.add(chNode))\n            scene.remove(scene.userData.sceneAnchor)\n        }\n        return scene\n    }\n\n    updateProperty(node, obj, op, provider) {\n        console.log(\"update property\",node.name,op.name,op.value)\n        if(op.name === PROP_DEFS.defaultFloor.key) {\n            console.log('setting the floor too',op.value)\n            this.setDefaultFloor(node,op.value)\n        }\n    }\n\n    setDefaultFloor(scene,val) {\n        if (val === true) {\n            const floor = new Mesh(\n                new PlaneBufferGeometry(100, 100, 10, 10),\n                new MeshLambertMaterial({color: 'blue'})\n            )\n            floor.name = 'defaultFloor'\n            floor.rotation.x = -90 * Math.PI / 180\n            scene.parts = {}\n            scene.parts.floor = floor\n            scene.add(floor)\n        } else {\n            if (scene.parts && scene.parts.floor) {\n                scene.remove(scene.parts.floor)\n                delete scene.parts.floor\n            }\n        }\n    }\n\n    getFloorPart(node) {\n        if(!node) return null\n        if(!node.parts) return null\n        return node.parts.floor\n    }\n\n}\n","/* eslint-disable */\nconst THREE = require('three');//requireimport * as THREE from 'three'\n\n/**\n * @author Rich Tibbett / https://github.com/richtr\n * @author mrdoob / http://mrdoob.com/\n * @author Tony Parisi / http://www.tonyparisi.com/\n * @author Takahiro / https://github.com/takahirox\n * @author Don McCurdy / https://www.donmccurdy.com\n */\n\nconst GLTFLoader = ( function () {\n\n\tfunction GLTFLoader( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\t\tthis.dracoLoader = null;\n\n\t}\n\n\tGLTFLoader.prototype = {\n\n\t\tconstructor: GLTFLoader,\n\n\t\tcrossOrigin: 'anonymous',\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar scope = this;\n\n\t\t\tvar resourcePath;\n\n\t\t\tif ( this.resourcePath !== undefined ) {\n\n\t\t\t\tresourcePath = this.resourcePath;\n\n\t\t\t} else if ( this.path !== undefined ) {\n\n\t\t\t\tresourcePath = this.path;\n\n\t\t\t} else {\n\n\t\t\t\tresourcePath = THREE.LoaderUtils.extractUrlBase( url );\n\n\t\t\t}\n\n\t\t\t// Tells the LoadingManager to track an extra item, which resolves after\n\t\t\t// the model is fully loaded. This means the count of items loaded will\n\t\t\t// be incorrect, but ensures manager.onLoad() does not fire early.\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\tvar _onError = function ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t};\n\n\t\t\tvar loader = new THREE.FileLoader( scope.manager );\n\n\t\t\tloader.setPath( this.path );\n\t\t\tloader.setResponseType( 'arraybuffer' );\n\n\t\t\tloader.load( url, function ( data ) {\n\n\t\t\t\ttry {\n\n\t\t\t\t\tscope.parse( data, resourcePath, function ( gltf ) {\n\n\t\t\t\t\t\tonLoad( gltf );\n\n\t\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t\t}, _onError );\n\n\t\t\t\t} catch ( e ) {\n\n\t\t\t\t\t_onError( e );\n\n\t\t\t\t}\n\n\t\t\t}, onProgress, _onError );\n\n\t\t},\n\n\t\tsetCrossOrigin: function ( value ) {\n\n\t\t\tthis.crossOrigin = value;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetPath: function ( value ) {\n\n\t\t\tthis.path = value;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetResourcePath: function ( value ) {\n\n\t\t\tthis.resourcePath = value;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetDRACOLoader: function ( dracoLoader ) {\n\n\t\t\tthis.dracoLoader = dracoLoader;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tparse: function ( data, path, onLoad, onError ) {\n\n\t\t\tvar content;\n\t\t\tvar extensions = {};\n\n\t\t\tif ( typeof data === 'string' ) {\n\n\t\t\t\tcontent = data;\n\n\t\t\t} else {\n\n\t\t\t\tvar magic = THREE.LoaderUtils.decodeText( new Uint8Array( data, 0, 4 ) );\n\n\t\t\t\tif ( magic === BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\textensions[ EXTENSIONS.KHR_BINARY_GLTF ] = new GLTFBinaryExtension( data );\n\n\t\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\t\tif ( onError ) onError( error );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tcontent = extensions[ EXTENSIONS.KHR_BINARY_GLTF ].content;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tcontent = THREE.LoaderUtils.decodeText( new Uint8Array( data ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar json = JSON.parse( content );\n\n\t\t\tif ( json.asset === undefined || json.asset.version[ 0 ] < 2 ) {\n\n\t\t\t\tif ( onError ) onError( new Error( 'THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead.' ) );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( json.extensionsUsed ) {\n\n\t\t\t\tfor ( var i = 0; i < json.extensionsUsed.length; ++ i ) {\n\n\t\t\t\t\tvar extensionName = json.extensionsUsed[ i ];\n\t\t\t\t\tvar extensionsRequired = json.extensionsRequired || [];\n\n\t\t\t\t\tswitch ( extensionName ) {\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_LIGHTS_PUNCTUAL:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFLightsExtension( json );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_UNLIT:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsUnlitExtension( json );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsPbrSpecularGlossinessExtension( json );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFDracoMeshCompressionExtension( json, this.dracoLoader );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.MSFT_TEXTURE_DDS:\n\t\t\t\t\t\t\textensions[ EXTENSIONS.MSFT_TEXTURE_DDS ] = new GLTFTextureDDSExtension();\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n\t\t\t\t\t\t\textensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] = new GLTFTextureTransformExtension( json );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tif ( extensionsRequired.indexOf( extensionName ) >= 0 ) {\n\n\t\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".' );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar parser = new GLTFParser( json, extensions, {\n\n\t\t\t\tpath: path || this.resourcePath || '',\n\t\t\t\tcrossOrigin: this.crossOrigin,\n\t\t\t\tmanager: this.manager\n\n\t\t\t} );\n\n\t\t\tparser.parse( onLoad, onError );\n\n\t\t}\n\n\t};\n\n\t/* GLTFREGISTRY */\n\n\tfunction GLTFRegistry() {\n\n\t\tvar objects = {};\n\n\t\treturn\t{\n\n\t\t\tget: function ( key ) {\n\n\t\t\t\treturn objects[ key ];\n\n\t\t\t},\n\n\t\t\tadd: function ( key, object ) {\n\n\t\t\t\tobjects[ key ] = object;\n\n\t\t\t},\n\n\t\t\tremove: function ( key ) {\n\n\t\t\t\tdelete objects[ key ];\n\n\t\t\t},\n\n\t\t\tremoveAll: function () {\n\n\t\t\t\tobjects = {};\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t/*********************************/\n\t/********** EXTENSIONS ***********/\n\t/*********************************/\n\n\tvar EXTENSIONS = {\n\t\tKHR_BINARY_GLTF: 'KHR_binary_glTF',\n\t\tKHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n\t\tKHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n\t\tKHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: 'KHR_materials_pbrSpecularGlossiness',\n\t\tKHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n\t\tKHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n\t\tMSFT_TEXTURE_DDS: 'MSFT_texture_dds'\n\t};\n\n\t/**\n\t * DDS Texture Extension\n\t *\n\t * Specification:\n\t * https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/MSFT_texture_dds\n\t *\n\t */\n\tfunction GLTFTextureDDSExtension() {\n\n\t\tif ( ! THREE.DDSLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.MSFT_TEXTURE_DDS;\n\t\tthis.ddsLoader = new THREE.DDSLoader();\n\n\t}\n\n\t/**\n\t * Lights Extension\n\t *\n\t * Specification: PENDING\n\t */\n\tfunction GLTFLightsExtension( json ) {\n\n\t\tthis.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\n\n\t\tvar extension = ( json.extensions && json.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ] ) || {};\n\t\tthis.lightDefs = extension.lights || [];\n\n\t}\n\n\tGLTFLightsExtension.prototype.loadLight = function ( lightIndex ) {\n\n\t\tvar lightDef = this.lightDefs[ lightIndex ];\n\t\tvar lightNode;\n\n\t\tvar color = new THREE.Color( 0xffffff );\n\t\tif ( lightDef.color !== undefined ) color.fromArray( lightDef.color );\n\n\t\tvar range = lightDef.range !== undefined ? lightDef.range : 0;\n\n\t\tswitch ( lightDef.type ) {\n\n\t\t\tcase 'directional':\n\t\t\t\tlightNode = new THREE.DirectionalLight( color );\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tcase 'point':\n\t\t\t\tlightNode = new THREE.PointLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\tbreak;\n\n\t\t\tcase 'spot':\n\t\t\t\tlightNode = new THREE.SpotLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\t// Handle spotlight properties.\n\t\t\t\tlightDef.spot = lightDef.spot || {};\n\t\t\t\tlightDef.spot.innerConeAngle = lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\n\t\t\t\tlightDef.spot.outerConeAngle = lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\n\t\t\t\tlightNode.angle = lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Unexpected light type, \"' + lightDef.type + '\".' );\n\n\t\t}\n\n\t\t// Some lights (e.g. spot) default to a position other than the origin. Reset the position\n\t\t// here, because node-level parsing will only override position if explicitly specified.\n\t\tlightNode.position.set( 0, 0, 0 );\n\n\t\tlightNode.decay = 2;\n\n\t\tif ( lightDef.intensity !== undefined ) lightNode.intensity = lightDef.intensity;\n\n\t\tlightNode.name = lightDef.name || ( 'light_' + lightIndex );\n\n\t\treturn Promise.resolve( lightNode );\n\n\t};\n\n\t/**\n\t * Unlit Materials Extension (pending)\n\t *\n\t * PR: https://github.com/KhronosGroup/glTF/pull/1163\n\t */\n\tfunction GLTFMaterialsUnlitExtension() {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\n\n\t}\n\n\tGLTFMaterialsUnlitExtension.prototype.getMaterialType = function () {\n\n\t\treturn THREE.MeshBasicMaterial;\n\n\t};\n\n\tGLTFMaterialsUnlitExtension.prototype.extendParams = function ( materialParams, materialDef, parser ) {\n\n\t\tvar pending = [];\n\n\t\tmaterialParams.color = new THREE.Color( 1.0, 1.0, 1.0 );\n\t\tmaterialParams.opacity = 1.0;\n\n\t\tvar metallicRoughness = materialDef.pbrMetallicRoughness;\n\n\t\tif ( metallicRoughness ) {\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tvar array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t};\n\n\t/* BINARY EXTENSION */\n\n\tvar BINARY_EXTENSION_BUFFER_NAME = 'binary_glTF';\n\tvar BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\n\tvar BINARY_EXTENSION_HEADER_LENGTH = 12;\n\tvar BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4E4F534A, BIN: 0x004E4942 };\n\n\tfunction GLTFBinaryExtension( data ) {\n\n\t\tthis.name = EXTENSIONS.KHR_BINARY_GLTF;\n\t\tthis.content = null;\n\t\tthis.body = null;\n\n\t\tvar headerView = new DataView( data, 0, BINARY_EXTENSION_HEADER_LENGTH );\n\n\t\tthis.header = {\n\t\t\tmagic: THREE.LoaderUtils.decodeText( new Uint8Array( data.slice( 0, 4 ) ) ),\n\t\t\tversion: headerView.getUint32( 4, true ),\n\t\t\tlength: headerView.getUint32( 8, true )\n\t\t};\n\n\t\tif ( this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported glTF-Binary header.' );\n\n\t\t} else if ( this.header.version < 2.0 ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.' );\n\n\t\t}\n\n\t\tvar chunkView = new DataView( data, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tvar chunkIndex = 0;\n\n\t\twhile ( chunkIndex < chunkView.byteLength ) {\n\n\t\t\tvar chunkLength = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tvar chunkType = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tif ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON ) {\n\n\t\t\t\tvar contentArray = new Uint8Array( data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength );\n\t\t\t\tthis.content = THREE.LoaderUtils.decodeText( contentArray );\n\n\t\t\t} else if ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN ) {\n\n\t\t\t\tvar byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n\t\t\t\tthis.body = data.slice( byteOffset, byteOffset + chunkLength );\n\n\t\t\t}\n\n\t\t\t// Clients must ignore chunks with unknown types.\n\n\t\t\tchunkIndex += chunkLength;\n\n\t\t}\n\n\t\tif ( this.content === null ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: JSON content not found.' );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * DRACO Mesh Compression Extension\n\t *\n\t * Specification: https://github.com/KhronosGroup/glTF/pull/874\n\t */\n\tfunction GLTFDracoMeshCompressionExtension( json, dracoLoader ) {\n\n\t\tif ( ! dracoLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: No DRACOLoader instance provided.' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\n\t\tthis.json = json;\n\t\tthis.dracoLoader = dracoLoader;\n\n\t}\n\n\tGLTFDracoMeshCompressionExtension.prototype.decodePrimitive = function ( primitive, parser ) {\n\n\t\tvar json = this.json;\n\t\tvar dracoLoader = this.dracoLoader;\n\t\tvar bufferViewIndex = primitive.extensions[ this.name ].bufferView;\n\t\tvar gltfAttributeMap = primitive.extensions[ this.name ].attributes;\n\t\tvar threeAttributeMap = {};\n\t\tvar attributeNormalizedMap = {};\n\t\tvar attributeTypeMap = {};\n\n\t\tfor ( var attributeName in gltfAttributeMap ) {\n\n\t\t\tvar threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tthreeAttributeMap[ threeAttributeName ] = gltfAttributeMap[ attributeName ];\n\n\t\t}\n\n\t\tfor ( attributeName in primitive.attributes ) {\n\n\t\t\tvar threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tif ( gltfAttributeMap[ attributeName ] !== undefined ) {\n\n\t\t\t\tvar accessorDef = json.accessors[ primitive.attributes[ attributeName ] ];\n\t\t\t\tvar componentType = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t\tattributeTypeMap[ threeAttributeName ] = componentType;\n\t\t\t\tattributeNormalizedMap[ threeAttributeName ] = accessorDef.normalized === true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.getDependency( 'bufferView', bufferViewIndex ).then( function ( bufferView ) {\n\n\t\t\treturn new Promise( function ( resolve ) {\n\n\t\t\t\tdracoLoader.decodeDracoFile( bufferView, function ( geometry ) {\n\n\t\t\t\t\tfor ( var attributeName in geometry.attributes ) {\n\n\t\t\t\t\t\tvar attribute = geometry.attributes[ attributeName ];\n\t\t\t\t\t\tvar normalized = attributeNormalizedMap[ attributeName ];\n\n\t\t\t\t\t\tif ( normalized !== undefined ) attribute.normalized = normalized;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve( geometry );\n\n\t\t\t\t}, threeAttributeMap, attributeTypeMap );\n\n\t\t\t} );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Texture Transform Extension\n\t *\n\t * Specification:\n\t */\n\tfunction GLTFTextureTransformExtension() {\n\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\n\n\t}\n\n\tGLTFTextureTransformExtension.prototype.extendTexture = function ( texture, transform ) {\n\n\t\ttexture = texture.clone();\n\n\t\tif ( transform.offset !== undefined ) {\n\n\t\t\ttexture.offset.fromArray( transform.offset );\n\n\t\t}\n\n\t\tif ( transform.rotation !== undefined ) {\n\n\t\t\ttexture.rotation = transform.rotation;\n\n\t\t}\n\n\t\tif ( transform.scale !== undefined ) {\n\n\t\t\ttexture.repeat.fromArray( transform.scale );\n\n\t\t}\n\n\t\tif ( transform.texCoord !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Custom UV sets in \"' + this.name + '\" extension not yet supported.' );\n\n\t\t}\n\n\t\ttexture.needsUpdate = true;\n\n\t\treturn texture;\n\n\t};\n\n\t/**\n\t * Specular-Glossiness Extension\n\t *\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_pbrSpecularGlossiness\n\t */\n\tfunction GLTFMaterialsPbrSpecularGlossinessExtension() {\n\n\t\treturn {\n\n\t\t\tname: EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,\n\n\t\t\tspecularGlossinessParams: [\n\t\t\t\t'color',\n\t\t\t\t'map',\n\t\t\t\t'lightMap',\n\t\t\t\t'lightMapIntensity',\n\t\t\t\t'aoMap',\n\t\t\t\t'aoMapIntensity',\n\t\t\t\t'emissive',\n\t\t\t\t'emissiveIntensity',\n\t\t\t\t'emissiveMap',\n\t\t\t\t'bumpMap',\n\t\t\t\t'bumpScale',\n\t\t\t\t'normalMap',\n\t\t\t\t'displacementMap',\n\t\t\t\t'displacementScale',\n\t\t\t\t'displacementBias',\n\t\t\t\t'specularMap',\n\t\t\t\t'specular',\n\t\t\t\t'glossinessMap',\n\t\t\t\t'glossiness',\n\t\t\t\t'alphaMap',\n\t\t\t\t'envMap',\n\t\t\t\t'envMapIntensity',\n\t\t\t\t'refractionRatio',\n\t\t\t],\n\n\t\t\tgetMaterialType: function () {\n\n\t\t\t\treturn THREE.ShaderMaterial;\n\n\t\t\t},\n\n\t\t\textendParams: function ( materialParams, materialDef, parser ) {\n\n\t\t\t\tvar pbrSpecularGlossiness = materialDef.extensions[ this.name ];\n\n\t\t\t\tvar shader = THREE.ShaderLib[ 'standard' ];\n\n\t\t\t\tvar uniforms = THREE.UniformsUtils.clone( shader.uniforms );\n\n\t\t\t\tvar specularMapParsFragmentChunk = [\n\t\t\t\t\t'#ifdef USE_SPECULARMAP',\n\t\t\t\t\t'\tuniform sampler2D specularMap;',\n\t\t\t\t\t'#endif'\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar glossinessMapParsFragmentChunk = [\n\t\t\t\t\t'#ifdef USE_GLOSSINESSMAP',\n\t\t\t\t\t'\tuniform sampler2D glossinessMap;',\n\t\t\t\t\t'#endif'\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar specularMapFragmentChunk = [\n\t\t\t\t\t'vec3 specularFactor = specular;',\n\t\t\t\t\t'#ifdef USE_SPECULARMAP',\n\t\t\t\t\t'\tvec4 texelSpecular = texture2D( specularMap, vUv );',\n\t\t\t\t\t'\ttexelSpecular = sRGBToLinear( texelSpecular );',\n\t\t\t\t\t'\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture',\n\t\t\t\t\t'\tspecularFactor *= texelSpecular.rgb;',\n\t\t\t\t\t'#endif'\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar glossinessMapFragmentChunk = [\n\t\t\t\t\t'float glossinessFactor = glossiness;',\n\t\t\t\t\t'#ifdef USE_GLOSSINESSMAP',\n\t\t\t\t\t'\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );',\n\t\t\t\t\t'\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture',\n\t\t\t\t\t'\tglossinessFactor *= texelGlossiness.a;',\n\t\t\t\t\t'#endif'\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar lightPhysicalFragmentChunk = [\n\t\t\t\t\t'PhysicalMaterial material;',\n\t\t\t\t\t'material.diffuseColor = diffuseColor.rgb;',\n\t\t\t\t\t'material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );',\n\t\t\t\t\t'material.specularColor = specularFactor.rgb;',\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar fragmentShader = shader.fragmentShader\n\t\t\t\t\t.replace( 'uniform float roughness;', 'uniform vec3 specular;' )\n\t\t\t\t\t.replace( 'uniform float metalness;', 'uniform float glossiness;' )\n\t\t\t\t\t.replace( '#include <roughnessmap_pars_fragment>', specularMapParsFragmentChunk )\n\t\t\t\t\t.replace( '#include <metalnessmap_pars_fragment>', glossinessMapParsFragmentChunk )\n\t\t\t\t\t.replace( '#include <roughnessmap_fragment>', specularMapFragmentChunk )\n\t\t\t\t\t.replace( '#include <metalnessmap_fragment>', glossinessMapFragmentChunk )\n\t\t\t\t\t.replace( '#include <lights_physical_fragment>', lightPhysicalFragmentChunk );\n\n\t\t\t\tdelete uniforms.roughness;\n\t\t\t\tdelete uniforms.metalness;\n\t\t\t\tdelete uniforms.roughnessMap;\n\t\t\t\tdelete uniforms.metalnessMap;\n\n\t\t\t\tuniforms.specular = { value: new THREE.Color().setHex( 0x111111 ) };\n\t\t\t\tuniforms.glossiness = { value: 0.5 };\n\t\t\t\tuniforms.specularMap = { value: null };\n\t\t\t\tuniforms.glossinessMap = { value: null };\n\n\t\t\t\tmaterialParams.vertexShader = shader.vertexShader;\n\t\t\t\tmaterialParams.fragmentShader = fragmentShader;\n\t\t\t\tmaterialParams.uniforms = uniforms;\n\t\t\t\tmaterialParams.defines = { 'STANDARD': '' };\n\n\t\t\t\tmaterialParams.color = new THREE.Color( 1.0, 1.0, 1.0 );\n\t\t\t\tmaterialParams.opacity = 1.0;\n\n\t\t\t\tvar pending = [];\n\n\t\t\t\tif ( Array.isArray( pbrSpecularGlossiness.diffuseFactor ) ) {\n\n\t\t\t\t\tvar array = pbrSpecularGlossiness.diffuseFactor;\n\n\t\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t\t}\n\n\t\t\t\tif ( pbrSpecularGlossiness.diffuseTexture !== undefined ) {\n\n\t\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', pbrSpecularGlossiness.diffuseTexture ) );\n\n\t\t\t\t}\n\n\t\t\t\tmaterialParams.emissive = new THREE.Color( 0.0, 0.0, 0.0 );\n\t\t\t\tmaterialParams.glossiness = pbrSpecularGlossiness.glossinessFactor !== undefined ? pbrSpecularGlossiness.glossinessFactor : 1.0;\n\t\t\t\tmaterialParams.specular = new THREE.Color( 1.0, 1.0, 1.0 );\n\n\t\t\t\tif ( Array.isArray( pbrSpecularGlossiness.specularFactor ) ) {\n\n\t\t\t\t\tmaterialParams.specular.fromArray( pbrSpecularGlossiness.specularFactor );\n\n\t\t\t\t}\n\n\t\t\t\tif ( pbrSpecularGlossiness.specularGlossinessTexture !== undefined ) {\n\n\t\t\t\t\tvar specGlossMapDef = pbrSpecularGlossiness.specularGlossinessTexture;\n\t\t\t\t\tpending.push( parser.assignTexture( materialParams, 'glossinessMap', specGlossMapDef ) );\n\t\t\t\t\tpending.push( parser.assignTexture( materialParams, 'specularMap', specGlossMapDef ) );\n\n\t\t\t\t}\n\n\t\t\t\treturn Promise.all( pending );\n\n\t\t\t},\n\n\t\t\tcreateMaterial: function ( params ) {\n\n\t\t\t\t// setup material properties based on MeshStandardMaterial for Specular-Glossiness\n\n\t\t\t\tvar material = new THREE.ShaderMaterial( {\n\t\t\t\t\tdefines: params.defines,\n\t\t\t\t\tvertexShader: params.vertexShader,\n\t\t\t\t\tfragmentShader: params.fragmentShader,\n\t\t\t\t\tuniforms: params.uniforms,\n\t\t\t\t\tfog: true,\n\t\t\t\t\tlights: true,\n\t\t\t\t\topacity: params.opacity,\n\t\t\t\t\ttransparent: params.transparent\n\t\t\t\t} );\n\n\t\t\t\tmaterial.isGLTFSpecularGlossinessMaterial = true;\n\n\t\t\t\tmaterial.color = params.color;\n\n\t\t\t\tmaterial.map = params.map === undefined ? null : params.map;\n\n\t\t\t\tmaterial.lightMap = null;\n\t\t\t\tmaterial.lightMapIntensity = 1.0;\n\n\t\t\t\tmaterial.aoMap = params.aoMap === undefined ? null : params.aoMap;\n\t\t\t\tmaterial.aoMapIntensity = 1.0;\n\n\t\t\t\tmaterial.emissive = params.emissive;\n\t\t\t\tmaterial.emissiveIntensity = 1.0;\n\t\t\t\tmaterial.emissiveMap = params.emissiveMap === undefined ? null : params.emissiveMap;\n\n\t\t\t\tmaterial.bumpMap = params.bumpMap === undefined ? null : params.bumpMap;\n\t\t\t\tmaterial.bumpScale = 1;\n\n\t\t\t\tmaterial.normalMap = params.normalMap === undefined ? null : params.normalMap;\n\n\t\t\t\tif ( params.normalScale ) material.normalScale = params.normalScale;\n\n\t\t\t\tmaterial.displacementMap = null;\n\t\t\t\tmaterial.displacementScale = 1;\n\t\t\t\tmaterial.displacementBias = 0;\n\n\t\t\t\tmaterial.specularMap = params.specularMap === undefined ? null : params.specularMap;\n\t\t\t\tmaterial.specular = params.specular;\n\n\t\t\t\tmaterial.glossinessMap = params.glossinessMap === undefined ? null : params.glossinessMap;\n\t\t\t\tmaterial.glossiness = params.glossiness;\n\n\t\t\t\tmaterial.alphaMap = null;\n\n\t\t\t\tmaterial.envMap = params.envMap === undefined ? null : params.envMap;\n\t\t\t\tmaterial.envMapIntensity = 1.0;\n\n\t\t\t\tmaterial.refractionRatio = 0.98;\n\n\t\t\t\tmaterial.extensions.derivatives = true;\n\n\t\t\t\treturn material;\n\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Clones a GLTFSpecularGlossinessMaterial instance. The ShaderMaterial.copy() method can\n\t\t\t * copy only properties it knows about or inherits, and misses many properties that would\n\t\t\t * normally be defined by MeshStandardMaterial.\n\t\t\t *\n\t\t\t * This method allows GLTFSpecularGlossinessMaterials to be cloned in the process of\n\t\t\t * loading a glTF model, but cloning later (e.g. by the user) would require these changes\n\t\t\t * AND also updating `.onBeforeRender` on the parent mesh.\n\t\t\t *\n\t\t\t * @param  {THREE.ShaderMaterial} source\n\t\t\t * @return {THREE.ShaderMaterial}\n\t\t\t */\n\t\t\tcloneMaterial: function ( source ) {\n\n\t\t\t\tvar target = source.clone();\n\n\t\t\t\ttarget.isGLTFSpecularGlossinessMaterial = true;\n\n\t\t\t\tvar params = this.specularGlossinessParams;\n\n\t\t\t\tfor ( var i = 0, il = params.length; i < il; i ++ ) {\n\n\t\t\t\t\ttarget[ params[ i ] ] = source[ params[ i ] ];\n\n\t\t\t\t}\n\n\t\t\t\treturn target;\n\n\t\t\t},\n\n\t\t\t// Here's based on refreshUniformsCommon() and refreshUniformsStandard() in WebGLRenderer.\n\t\t\trefreshUniforms: function ( renderer, scene, camera, geometry, material, group ) {\n\n\t\t\t\tif ( material.isGLTFSpecularGlossinessMaterial !== true ) {\n\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tvar uniforms = material.uniforms;\n\t\t\t\tvar defines = material.defines;\n\n\t\t\t\tuniforms.opacity.value = material.opacity;\n\n\t\t\t\tuniforms.diffuse.value.copy( material.color );\n\t\t\t\tuniforms.emissive.value.copy( material.emissive ).multiplyScalar( material.emissiveIntensity );\n\n\t\t\t\tuniforms.map.value = material.map;\n\t\t\t\tuniforms.specularMap.value = material.specularMap;\n\t\t\t\tuniforms.alphaMap.value = material.alphaMap;\n\n\t\t\t\tuniforms.lightMap.value = material.lightMap;\n\t\t\t\tuniforms.lightMapIntensity.value = material.lightMapIntensity;\n\n\t\t\t\tuniforms.aoMap.value = material.aoMap;\n\t\t\t\tuniforms.aoMapIntensity.value = material.aoMapIntensity;\n\n\t\t\t\t// uv repeat and offset setting priorities\n\t\t\t\t// 1. color map\n\t\t\t\t// 2. specular map\n\t\t\t\t// 3. normal map\n\t\t\t\t// 4. bump map\n\t\t\t\t// 5. alpha map\n\t\t\t\t// 6. emissive map\n\n\t\t\t\tvar uvScaleMap;\n\n\t\t\t\tif ( material.map ) {\n\n\t\t\t\t\tuvScaleMap = material.map;\n\n\t\t\t\t} else if ( material.specularMap ) {\n\n\t\t\t\t\tuvScaleMap = material.specularMap;\n\n\t\t\t\t} else if ( material.displacementMap ) {\n\n\t\t\t\t\tuvScaleMap = material.displacementMap;\n\n\t\t\t\t} else if ( material.normalMap ) {\n\n\t\t\t\t\tuvScaleMap = material.normalMap;\n\n\t\t\t\t} else if ( material.bumpMap ) {\n\n\t\t\t\t\tuvScaleMap = material.bumpMap;\n\n\t\t\t\t} else if ( material.glossinessMap ) {\n\n\t\t\t\t\tuvScaleMap = material.glossinessMap;\n\n\t\t\t\t} else if ( material.alphaMap ) {\n\n\t\t\t\t\tuvScaleMap = material.alphaMap;\n\n\t\t\t\t} else if ( material.emissiveMap ) {\n\n\t\t\t\t\tuvScaleMap = material.emissiveMap;\n\n\t\t\t\t}\n\n\t\t\t\tif ( uvScaleMap !== undefined ) {\n\n\t\t\t\t\t// backwards compatibility\n\t\t\t\t\tif ( uvScaleMap.isWebGLRenderTarget ) {\n\n\t\t\t\t\t\tuvScaleMap = uvScaleMap.texture;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( uvScaleMap.matrixAutoUpdate === true ) {\n\n\t\t\t\t\t\tuvScaleMap.updateMatrix();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tuniforms.uvTransform.value.copy( uvScaleMap.matrix );\n\n\t\t\t\t}\n\n\t\t\t\tif ( material.envMap ) {\n\n\t\t\t\t\tuniforms.envMap.value = material.envMap;\n\t\t\t\t\tuniforms.envMapIntensity.value = material.envMapIntensity;\n\n\t\t\t\t\t// don't flip CubeTexture envMaps, flip everything else:\n\t\t\t\t\t//  WebGLRenderTargetCube will be flipped for backwards compatibility\n\t\t\t\t\t//  WebGLRenderTargetCube.texture will be flipped because it's a Texture and NOT a CubeTexture\n\t\t\t\t\t// this check must be handled differently, or removed entirely, if WebGLRenderTargetCube uses a CubeTexture in the future\n\t\t\t\t\tuniforms.flipEnvMap.value = material.envMap.isCubeTexture ? - 1 : 1;\n\n\t\t\t\t\tuniforms.reflectivity.value = material.reflectivity;\n\t\t\t\t\tuniforms.refractionRatio.value = material.refractionRatio;\n\n\t\t\t\t\tuniforms.maxMipLevel.value = renderer.properties.get( material.envMap ).__maxMipLevel;\n\n\t\t\t\t}\n\n\t\t\t\tuniforms.specular.value.copy( material.specular );\n\t\t\t\tuniforms.glossiness.value = material.glossiness;\n\n\t\t\t\tuniforms.glossinessMap.value = material.glossinessMap;\n\n\t\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\n\t\t\t\tuniforms.bumpMap.value = material.bumpMap;\n\t\t\t\tuniforms.normalMap.value = material.normalMap;\n\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t\t\tif ( uniforms.glossinessMap.value !== null && defines.USE_GLOSSINESSMAP === undefined ) {\n\n\t\t\t\t\tdefines.USE_GLOSSINESSMAP = '';\n\t\t\t\t\t// set USE_ROUGHNESSMAP to enable vUv\n\t\t\t\t\tdefines.USE_ROUGHNESSMAP = '';\n\n\t\t\t\t}\n\n\t\t\t\tif ( uniforms.glossinessMap.value === null && defines.USE_GLOSSINESSMAP !== undefined ) {\n\n\t\t\t\t\tdelete defines.USE_GLOSSINESSMAP;\n\t\t\t\t\tdelete defines.USE_ROUGHNESSMAP;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t/*********************************/\n\t/********** INTERPOLATION ********/\n\t/*********************************/\n\n\t// Spline Interpolation\n\t// Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\n\tfunction GLTFCubicSplineInterpolant( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tTHREE.Interpolant.call( this, parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tGLTFCubicSplineInterpolant.prototype = Object.create( THREE.Interpolant.prototype );\n\tGLTFCubicSplineInterpolant.prototype.constructor = GLTFCubicSplineInterpolant;\n\n\tGLTFCubicSplineInterpolant.prototype.copySampleValue_ = function ( index ) {\n\n\t\t// Copies a sample value to the result buffer. See description of glTF\n\t\t// CUBICSPLINE values layout in interpolate_() function below.\n\n\t\tvar result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tvalueSize = this.valueSize,\n\t\t\toffset = index * valueSize * 3 + valueSize;\n\n\t\tfor ( var i = 0; i !== valueSize; i ++ ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t};\n\n\tGLTFCubicSplineInterpolant.prototype.beforeStart_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\n\tGLTFCubicSplineInterpolant.prototype.afterEnd_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\n\tGLTFCubicSplineInterpolant.prototype.interpolate_ = function ( i1, t0, t, t1 ) {\n\n\t\tvar result = this.resultBuffer;\n\t\tvar values = this.sampleValues;\n\t\tvar stride = this.valueSize;\n\n\t\tvar stride2 = stride * 2;\n\t\tvar stride3 = stride * 3;\n\n\t\tvar td = t1 - t0;\n\n\t\tvar p = ( t - t0 ) / td;\n\t\tvar pp = p * p;\n\t\tvar ppp = pp * p;\n\n\t\tvar offset1 = i1 * stride3;\n\t\tvar offset0 = offset1 - stride3;\n\n\t\tvar s2 = - 2 * ppp + 3 * pp;\n\t\tvar s3 = ppp - pp;\n\t\tvar s0 = 1 - s2;\n\t\tvar s1 = s3 - pp + p;\n\n\t\t// Layout of keyframe output values for CUBICSPLINE animations:\n\t\t//   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n\t\tfor ( var i = 0; i !== stride; i ++ ) {\n\n\t\t\tvar p0 = values[ offset0 + i + stride ]; // splineVertex_k\n\t\t\tvar m0 = values[ offset0 + i + stride2 ] * td; // outTangent_k * (t_k+1 - t_k)\n\t\t\tvar p1 = values[ offset1 + i + stride ]; // splineVertex_k+1\n\t\t\tvar m1 = values[ offset1 + i ] * td; // inTangent_k+1 * (t_k+1 - t_k)\n\n\t\t\tresult[ i ] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\n\n\t\t}\n\n\t\treturn result;\n\n\t};\n\n\t/*********************************/\n\t/********** INTERNALS ************/\n\t/*********************************/\n\n\t/* CONSTANTS */\n\n\tvar WEBGL_CONSTANTS = {\n\t\tFLOAT: 5126,\n\t\t//FLOAT_MAT2: 35674,\n\t\tFLOAT_MAT3: 35675,\n\t\tFLOAT_MAT4: 35676,\n\t\tFLOAT_VEC2: 35664,\n\t\tFLOAT_VEC3: 35665,\n\t\tFLOAT_VEC4: 35666,\n\t\tLINEAR: 9729,\n\t\tREPEAT: 10497,\n\t\tSAMPLER_2D: 35678,\n\t\tPOINTS: 0,\n\t\tLINES: 1,\n\t\tLINE_LOOP: 2,\n\t\tLINE_STRIP: 3,\n\t\tTRIANGLES: 4,\n\t\tTRIANGLE_STRIP: 5,\n\t\tTRIANGLE_FAN: 6,\n\t\tUNSIGNED_BYTE: 5121,\n\t\tUNSIGNED_SHORT: 5123\n\t};\n\n\tvar WEBGL_TYPE = {\n\t\t5126: Number,\n\t\t//35674: THREE.Matrix2,\n\t\t35675: THREE.Matrix3,\n\t\t35676: THREE.Matrix4,\n\t\t35664: THREE.Vector2,\n\t\t35665: THREE.Vector3,\n\t\t35666: THREE.Vector4,\n\t\t35678: THREE.Texture\n\t};\n\n\tvar WEBGL_COMPONENT_TYPES = {\n\t\t5120: Int8Array,\n\t\t5121: Uint8Array,\n\t\t5122: Int16Array,\n\t\t5123: Uint16Array,\n\t\t5125: Uint32Array,\n\t\t5126: Float32Array\n\t};\n\n\tvar WEBGL_FILTERS = {\n\t\t9728: THREE.NearestFilter,\n\t\t9729: THREE.LinearFilter,\n\t\t9984: THREE.NearestMipMapNearestFilter,\n\t\t9985: THREE.LinearMipMapNearestFilter,\n\t\t9986: THREE.NearestMipMapLinearFilter,\n\t\t9987: THREE.LinearMipMapLinearFilter\n\t};\n\n\tvar WEBGL_WRAPPINGS = {\n\t\t33071: THREE.ClampToEdgeWrapping,\n\t\t33648: THREE.MirroredRepeatWrapping,\n\t\t10497: THREE.RepeatWrapping\n\t};\n\n\tvar WEBGL_SIDES = {\n\t\t1028: THREE.BackSide, // Culling front\n\t\t1029: THREE.FrontSide // Culling back\n\t\t//1032: THREE.NoSide   // Culling front and back, what to do?\n\t};\n\n\tvar WEBGL_DEPTH_FUNCS = {\n\t\t512: THREE.NeverDepth,\n\t\t513: THREE.LessDepth,\n\t\t514: THREE.EqualDepth,\n\t\t515: THREE.LessEqualDepth,\n\t\t516: THREE.GreaterEqualDepth,\n\t\t517: THREE.NotEqualDepth,\n\t\t518: THREE.GreaterEqualDepth,\n\t\t519: THREE.AlwaysDepth\n\t};\n\n\tvar WEBGL_BLEND_EQUATIONS = {\n\t\t32774: THREE.AddEquation,\n\t\t32778: THREE.SubtractEquation,\n\t\t32779: THREE.ReverseSubtractEquation\n\t};\n\n\tvar WEBGL_BLEND_FUNCS = {\n\t\t0: THREE.ZeroFactor,\n\t\t1: THREE.OneFactor,\n\t\t768: THREE.SrcColorFactor,\n\t\t769: THREE.OneMinusSrcColorFactor,\n\t\t770: THREE.SrcAlphaFactor,\n\t\t771: THREE.OneMinusSrcAlphaFactor,\n\t\t772: THREE.DstAlphaFactor,\n\t\t773: THREE.OneMinusDstAlphaFactor,\n\t\t774: THREE.DstColorFactor,\n\t\t775: THREE.OneMinusDstColorFactor,\n\t\t776: THREE.SrcAlphaSaturateFactor\n\t\t// The followings are not supported by Three.js yet\n\t\t//32769: CONSTANT_COLOR,\n\t\t//32770: ONE_MINUS_CONSTANT_COLOR,\n\t\t//32771: CONSTANT_ALPHA,\n\t\t//32772: ONE_MINUS_CONSTANT_COLOR\n\t};\n\n\tvar WEBGL_TYPE_SIZES = {\n\t\t'SCALAR': 1,\n\t\t'VEC2': 2,\n\t\t'VEC3': 3,\n\t\t'VEC4': 4,\n\t\t'MAT2': 4,\n\t\t'MAT3': 9,\n\t\t'MAT4': 16\n\t};\n\n\tvar ATTRIBUTES = {\n\t\tPOSITION: 'position',\n\t\tNORMAL: 'normal',\n\t\tTANGENT: 'tangent',\n\t\tTEXCOORD_0: 'uv',\n\t\tTEXCOORD_1: 'uv2',\n\t\tCOLOR_0: 'color',\n\t\tWEIGHTS_0: 'skinWeight',\n\t\tJOINTS_0: 'skinIndex',\n\t};\n\n\tvar PATH_PROPERTIES = {\n\t\tscale: 'scale',\n\t\ttranslation: 'position',\n\t\trotation: 'quaternion',\n\t\tweights: 'morphTargetInfluences'\n\t};\n\n\tvar INTERPOLATION = {\n\t\tCUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n\t\t                        // keyframe track will be initialized with a default interpolation type, then modified.\n\t\tLINEAR: THREE.InterpolateLinear,\n\t\tSTEP: THREE.InterpolateDiscrete\n\t};\n\n\tvar STATES_ENABLES = {\n\t\t2884: 'CULL_FACE',\n\t\t2929: 'DEPTH_TEST',\n\t\t3042: 'BLEND',\n\t\t3089: 'SCISSOR_TEST',\n\t\t32823: 'POLYGON_OFFSET_FILL',\n\t\t32926: 'SAMPLE_ALPHA_TO_COVERAGE'\n\t};\n\n\tvar ALPHA_MODES = {\n\t\tOPAQUE: 'OPAQUE',\n\t\tMASK: 'MASK',\n\t\tBLEND: 'BLEND'\n\t};\n\n\tvar MIME_TYPE_FORMATS = {\n\t\t'image/png': THREE.RGBAFormat,\n\t\t'image/jpeg': THREE.RGBFormat\n\t};\n\n\t/* UTILITY FUNCTIONS */\n\n\tfunction resolveURL( url, path ) {\n\n\t\t// Invalid URL\n\t\tif ( typeof url !== 'string' || url === '' ) return '';\n\n\t\t// Absolute URL http://,https://,//\n\t\tif ( /^(https?:)?\\/\\//i.test( url ) ) return url;\n\n\t\t// Data URI\n\t\tif ( /^data:.*,.*$/i.test( url ) ) return url;\n\n\t\t// Blob URL\n\t\tif ( /^blob:.*$/i.test( url ) ) return url;\n\n\t\t// Relative URL\n\t\treturn path + url;\n\n\t}\n\n\tvar defaultMaterial;\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n\t */\n\tfunction createDefaultMaterial() {\n\n\t\tdefaultMaterial = defaultMaterial || new THREE.MeshStandardMaterial( {\n\t\t\tcolor: 0xFFFFFF,\n\t\t\temissive: 0x000000,\n\t\t\tmetalness: 1,\n\t\t\troughness: 1,\n\t\t\ttransparent: false,\n\t\t\tdepthTest: true,\n\t\t\tside: THREE.FrontSide\n\t\t} );\n\n\t\treturn defaultMaterial;\n\n\t}\n\n\tfunction addUnknownExtensionsToUserData( knownExtensions, object, objectDef ) {\n\n\t\t// Add unknown glTF extensions to an object's userData.\n\n\t\tfor ( var name in objectDef.extensions ) {\n\n\t\t\tif ( knownExtensions[ name ] === undefined ) {\n\n\t\t\t\tobject.userData.gltfExtensions = object.userData.gltfExtensions || {};\n\t\t\t\tobject.userData.gltfExtensions[ name ] = objectDef.extensions[ name ];\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * @param {THREE.Object3D|THREE.Material|THREE.BufferGeometry} object\n\t * @param {GLTF.definition} gltfDef\n\t */\n\tfunction assignExtrasToUserData( object, gltfDef ) {\n\n\t\tif ( gltfDef.extras !== undefined ) {\n\n\t\t\tif ( typeof gltfDef.extras === 'object' ) {\n\n\t\t\t\tobject.userData = gltfDef.extras;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n\t *\n\t * @param {THREE.BufferGeometry} geometry\n\t * @param {Array<GLTF.Target>} targets\n\t * @param {GLTFParser} parser\n\t * @return {Promise<THREE.BufferGeometry>}\n\t */\n\tfunction addMorphTargets( geometry, targets, parser ) {\n\n\t\tvar hasMorphPosition = false;\n\t\tvar hasMorphNormal = false;\n\n\t\tfor ( var i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tvar target = targets[ i ];\n\n\t\t\tif ( target.POSITION !== undefined ) hasMorphPosition = true;\n\t\t\tif ( target.NORMAL !== undefined ) hasMorphNormal = true;\n\n\t\t\tif ( hasMorphPosition && hasMorphNormal ) break;\n\n\t\t}\n\n\t\tif ( ! hasMorphPosition && ! hasMorphNormal ) return Promise.resolve( geometry );\n\n\t\tvar pendingPositionAccessors = [];\n\t\tvar pendingNormalAccessors = [];\n\n\t\tfor ( var i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tvar target = targets[ i ];\n\n\t\t\tif ( hasMorphPosition ) {\n\n\t\t\t\tvar pendingAccessor = target.POSITION !== undefined\n\t\t\t\t\t? parser.getDependency( 'accessor', target.POSITION )\n\t\t\t\t\t: geometry.attributes.position;\n\n\t\t\t\tpendingPositionAccessors.push( pendingAccessor );\n\n\t\t\t}\n\n\t\t\tif ( hasMorphNormal ) {\n\n\t\t\t\tvar pendingAccessor = target.NORMAL !== undefined\n\t\t\t\t\t? parser.getDependency( 'accessor', target.NORMAL )\n\t\t\t\t\t: geometry.attributes.normal;\n\n\t\t\t\tpendingNormalAccessors.push( pendingAccessor );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( [\n\t\t\tPromise.all( pendingPositionAccessors ),\n\t\t\tPromise.all( pendingNormalAccessors )\n\t\t] ).then( function ( accessors ) {\n\n\t\t\tvar morphPositions = accessors[ 0 ];\n\t\t\tvar morphNormals = accessors[ 1 ];\n\n\t\t\t// Clone morph target accessors before modifying them.\n\n\t\t\tfor ( var i = 0, il = morphPositions.length; i < il; i ++ ) {\n\n\t\t\t\tif ( geometry.attributes.position === morphPositions[ i ] ) continue;\n\n\t\t\t\tmorphPositions[ i ] = cloneBufferAttribute( morphPositions[ i ] );\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0, il = morphNormals.length; i < il; i ++ ) {\n\n\t\t\t\tif ( geometry.attributes.normal === morphNormals[ i ] ) continue;\n\n\t\t\t\tmorphNormals[ i ] = cloneBufferAttribute( morphNormals[ i ] );\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\t\tvar target = targets[ i ];\n\t\t\t\tvar attributeName = 'morphTarget' + i;\n\n\t\t\t\tif ( hasMorphPosition ) {\n\n\t\t\t\t\t// Three.js morph position is absolute value. The formula is\n\t\t\t\t\t//   basePosition\n\t\t\t\t\t//     + weight0 * ( morphPosition0 - basePosition )\n\t\t\t\t\t//     + weight1 * ( morphPosition1 - basePosition )\n\t\t\t\t\t//     ...\n\t\t\t\t\t// while the glTF one is relative\n\t\t\t\t\t//   basePosition\n\t\t\t\t\t//     + weight0 * glTFmorphPosition0\n\t\t\t\t\t//     + weight1 * glTFmorphPosition1\n\t\t\t\t\t//     ...\n\t\t\t\t\t// then we need to convert from relative to absolute here.\n\n\t\t\t\t\tif ( target.POSITION !== undefined ) {\n\n\t\t\t\t\t\tvar positionAttribute = morphPositions[ i ];\n\t\t\t\t\t\tpositionAttribute.name = attributeName;\n\n\t\t\t\t\t\tvar position = geometry.attributes.position;\n\n\t\t\t\t\t\tfor ( var j = 0, jl = positionAttribute.count; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tpositionAttribute.setXYZ(\n\t\t\t\t\t\t\t\tj,\n\t\t\t\t\t\t\t\tpositionAttribute.getX( j ) + position.getX( j ),\n\t\t\t\t\t\t\t\tpositionAttribute.getY( j ) + position.getY( j ),\n\t\t\t\t\t\t\t\tpositionAttribute.getZ( j ) + position.getZ( j )\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( hasMorphNormal ) {\n\n\t\t\t\t\t// see target.POSITION's comment\n\n\t\t\t\t\tif ( target.NORMAL !== undefined ) {\n\n\t\t\t\t\t\tvar normalAttribute = morphNormals[ i ];\n\t\t\t\t\t\tnormalAttribute.name = attributeName;\n\n\t\t\t\t\t\tvar normal = geometry.attributes.normal;\n\n\t\t\t\t\t\tfor ( var j = 0, jl = normalAttribute.count; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tnormalAttribute.setXYZ(\n\t\t\t\t\t\t\t\tj,\n\t\t\t\t\t\t\t\tnormalAttribute.getX( j ) + normal.getX( j ),\n\t\t\t\t\t\t\t\tnormalAttribute.getY( j ) + normal.getY( j ),\n\t\t\t\t\t\t\t\tnormalAttribute.getZ( j ) + normal.getZ( j )\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( hasMorphPosition ) geometry.morphAttributes.position = morphPositions;\n\t\t\tif ( hasMorphNormal ) geometry.morphAttributes.normal = morphNormals;\n\n\t\t\treturn geometry;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * @param {THREE.Mesh} mesh\n\t * @param {GLTF.Mesh} meshDef\n\t */\n\tfunction updateMorphTargets( mesh, meshDef ) {\n\n\t\tmesh.updateMorphTargets();\n\n\t\tif ( meshDef.weights !== undefined ) {\n\n\t\t\tfor ( var i = 0, il = meshDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\tmesh.morphTargetInfluences[ i ] = meshDef.weights[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// .extras has user-defined data, so check that .extras.targetNames is an array.\n\t\tif ( meshDef.extras && Array.isArray( meshDef.extras.targetNames ) ) {\n\n\t\t\tvar targetNames = meshDef.extras.targetNames;\n\n\t\t\tif ( mesh.morphTargetInfluences.length === targetNames.length ) {\n\n\t\t\t\tmesh.morphTargetDictionary = {};\n\n\t\t\t\tfor ( var i = 0, il = targetNames.length; i < il; i ++ ) {\n\n\t\t\t\t\tmesh.morphTargetDictionary[ targetNames[ i ] ] = i;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\tfunction isObjectEqual( a, b ) {\n\n\t\tif ( Object.keys( a ).length !== Object.keys( b ).length ) return false;\n\n\t\tfor ( var key in a ) {\n\n\t\t\tif ( a[ key ] !== b[ key ] ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tfunction createPrimitiveKey( primitiveDef ) {\n\n\t\tvar dracoExtension = primitiveDef.extensions && primitiveDef.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ];\n\t\tvar geometryKey;\n\n\t\tif ( dracoExtension ) {\n\n\t\t\tgeometryKey = 'draco:' + dracoExtension.bufferView\n\t\t\t\t+ ':' + dracoExtension.indices\n\t\t\t\t+ ':' + createAttributesKey( dracoExtension.attributes );\n\n\t\t} else {\n\n\t\t\tgeometryKey = primitiveDef.indices + ':' + createAttributesKey( primitiveDef.attributes ) + ':' + primitiveDef.mode;\n\n\t\t}\n\n\t\treturn geometryKey;\n\n\t}\n\n\tfunction createAttributesKey( attributes ) {\n\n\t\tvar attributesKey = '';\n\n\t\tvar keys = Object.keys( attributes ).sort();\n\n\t\tfor ( var i = 0, il = keys.length; i < il; i ++ ) {\n\n\t\t\tattributesKey += keys[ i ] + ':' + attributes[ keys[ i ] ] + ';';\n\n\t\t}\n\n\t\treturn attributesKey;\n\n\t}\n\n\tfunction cloneBufferAttribute( attribute ) {\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tvar count = attribute.count;\n\t\t\tvar itemSize = attribute.itemSize;\n\t\t\tvar array = attribute.array.slice( 0, count * itemSize );\n\n\t\t\tfor ( var i = 0, j = 0; i < count; ++ i ) {\n\n\t\t\t\tarray[ j ++ ] = attribute.getX( i );\n\t\t\t\tif ( itemSize >= 2 ) array[ j ++ ] = attribute.getY( i );\n\t\t\t\tif ( itemSize >= 3 ) array[ j ++ ] = attribute.getZ( i );\n\t\t\t\tif ( itemSize >= 4 ) array[ j ++ ] = attribute.getW( i );\n\n\t\t\t}\n\n\t\t\treturn new THREE.BufferAttribute( array, itemSize, attribute.normalized );\n\n\t\t}\n\n\t\treturn attribute.clone();\n\n\t}\n\n\t/* GLTF PARSER */\n\n\tfunction GLTFParser( json, extensions, options ) {\n\n\t\tthis.json = json || {};\n\t\tthis.extensions = extensions || {};\n\t\tthis.options = options || {};\n\n\t\t// loader object cache\n\t\tthis.cache = new GLTFRegistry();\n\n\t\t// BufferGeometry caching\n\t\tthis.primitiveCache = {};\n\n\t\tthis.textureLoader = new THREE.TextureLoader( this.options.manager );\n\t\tthis.textureLoader.setCrossOrigin( this.options.crossOrigin );\n\n\t\tthis.fileLoader = new THREE.FileLoader( this.options.manager );\n\t\tthis.fileLoader.setResponseType( 'arraybuffer' );\n\n\t}\n\n\tGLTFParser.prototype.parse = function ( onLoad, onError ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\t\tvar extensions = this.extensions;\n\n\t\t// Clear the loader cache\n\t\tthis.cache.removeAll();\n\n\t\t// Mark the special nodes/meshes in json for efficient parse\n\t\tthis.markDefs();\n\n\t\tPromise.all( [\n\n\t\t\tthis.getDependencies( 'scene' ),\n\t\t\tthis.getDependencies( 'animation' ),\n\t\t\tthis.getDependencies( 'camera' ),\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tvar result = {\n\t\t\t\tscene: dependencies[ 0 ][ json.scene || 0 ],\n\t\t\t\tscenes: dependencies[ 0 ],\n\t\t\t\tanimations: dependencies[ 1 ],\n\t\t\t\tcameras: dependencies[ 2 ],\n\t\t\t\tasset: json.asset,\n\t\t\t\tparser: parser,\n\t\t\t\tuserData: {}\n\t\t\t};\n\n\t\t\taddUnknownExtensionsToUserData( extensions, result, json );\n\n\t\t\tonLoad( result );\n\n\t\t} ).catch( onError );\n\n\t};\n\n\t/**\n\t * Marks the special nodes/meshes in json for efficient parse.\n\t */\n\tGLTFParser.prototype.markDefs = function () {\n\n\t\tvar nodeDefs = this.json.nodes || [];\n\t\tvar skinDefs = this.json.skins || [];\n\t\tvar meshDefs = this.json.meshes || [];\n\n\t\tvar meshReferences = {};\n\t\tvar meshUses = {};\n\n\t\t// Nothing in the node definition indicates whether it is a Bone or an\n\t\t// Object3D. Use the skins' joint references to mark bones.\n\t\tfor ( var skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex ++ ) {\n\n\t\t\tvar joints = skinDefs[ skinIndex ].joints;\n\n\t\t\tfor ( var i = 0, il = joints.length; i < il; i ++ ) {\n\n\t\t\t\tnodeDefs[ joints[ i ] ].isBone = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Meshes can (and should) be reused by multiple nodes in a glTF asset. To\n\t\t// avoid having more than one THREE.Mesh with the same name, count\n\t\t// references and rename instances below.\n\t\t//\n\t\t// Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n\t\tfor ( var nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tvar nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\tif ( meshReferences[ nodeDef.mesh ] === undefined ) {\n\n\t\t\t\t\tmeshReferences[ nodeDef.mesh ] = meshUses[ nodeDef.mesh ] = 0;\n\n\t\t\t\t}\n\n\t\t\t\tmeshReferences[ nodeDef.mesh ] ++;\n\n\t\t\t\t// Nothing in the mesh definition indicates whether it is\n\t\t\t\t// a SkinnedMesh or Mesh. Use the node's mesh reference\n\t\t\t\t// to mark SkinnedMesh if node has skin.\n\t\t\t\tif ( nodeDef.skin !== undefined ) {\n\n\t\t\t\t\tmeshDefs[ nodeDef.mesh ].isSkinnedMesh = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.json.meshReferences = meshReferences;\n\t\tthis.json.meshUses = meshUses;\n\n\t};\n\n\t/**\n\t * Requests the specified dependency asynchronously, with caching.\n\t * @param {string} type\n\t * @param {number} index\n\t * @return {Promise<THREE.Object3D|THREE.Material|THREE.Texture|THREE.AnimationClip|ArrayBuffer|Object>}\n\t */\n\tGLTFParser.prototype.getDependency = function ( type, index ) {\n\n\t\tvar cacheKey = type + ':' + index;\n\t\tvar dependency = this.cache.get( cacheKey );\n\n\t\tif ( ! dependency ) {\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'scene':\n\t\t\t\t\tdependency = this.loadScene( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'node':\n\t\t\t\t\tdependency = this.loadNode( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'mesh':\n\t\t\t\t\tdependency = this.loadMesh( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'accessor':\n\t\t\t\t\tdependency = this.loadAccessor( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bufferView':\n\t\t\t\t\tdependency = this.loadBufferView( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'buffer':\n\t\t\t\t\tdependency = this.loadBuffer( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'material':\n\t\t\t\t\tdependency = this.loadMaterial( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'texture':\n\t\t\t\t\tdependency = this.loadTexture( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'skin':\n\t\t\t\t\tdependency = this.loadSkin( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'animation':\n\t\t\t\t\tdependency = this.loadAnimation( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'camera':\n\t\t\t\t\tdependency = this.loadCamera( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'light':\n\t\t\t\t\tdependency = this.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ].loadLight( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error( 'Unknown type: ' + type );\n\n\t\t\t}\n\n\t\t\tthis.cache.add( cacheKey, dependency );\n\n\t\t}\n\n\t\treturn dependency;\n\n\t};\n\n\t/**\n\t * Requests all dependencies of the specified type asynchronously, with caching.\n\t * @param {string} type\n\t * @return {Promise<Array<Object>>}\n\t */\n\tGLTFParser.prototype.getDependencies = function ( type ) {\n\n\t\tvar dependencies = this.cache.get( type );\n\n\t\tif ( ! dependencies ) {\n\n\t\t\tvar parser = this;\n\t\t\tvar defs = this.json[ type + ( type === 'mesh' ? 'es' : 's' ) ] || [];\n\n\t\t\tdependencies = Promise.all( defs.map( function ( def, index ) {\n\n\t\t\t\treturn parser.getDependency( type, index );\n\n\t\t\t} ) );\n\n\t\t\tthis.cache.add( type, dependencies );\n\n\t\t}\n\n\t\treturn dependencies;\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tGLTFParser.prototype.loadBuffer = function ( bufferIndex ) {\n\n\t\tvar bufferDef = this.json.buffers[ bufferIndex ];\n\t\tvar loader = this.fileLoader;\n\n\t\tif ( bufferDef.type && bufferDef.type !== 'arraybuffer' ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.' );\n\n\t\t}\n\n\t\t// If present, GLB container is required to be the first buffer.\n\t\tif ( bufferDef.uri === undefined && bufferIndex === 0 ) {\n\n\t\t\treturn Promise.resolve( this.extensions[ EXTENSIONS.KHR_BINARY_GLTF ].body );\n\n\t\t}\n\n\t\tvar options = this.options;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tloader.load( resolveURL( bufferDef.uri, options.path ), resolve, undefined, function () {\n\n\t\t\t\treject( new Error( 'THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".' ) );\n\n\t\t\t} );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferViewIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tGLTFParser.prototype.loadBufferView = function ( bufferViewIndex ) {\n\n\t\tvar bufferViewDef = this.json.bufferViews[ bufferViewIndex ];\n\n\t\treturn this.getDependency( 'buffer', bufferViewDef.buffer ).then( function ( buffer ) {\n\n\t\t\tvar byteLength = bufferViewDef.byteLength || 0;\n\t\t\tvar byteOffset = bufferViewDef.byteOffset || 0;\n\t\t\treturn buffer.slice( byteOffset, byteOffset + byteLength );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n\t * @param {number} accessorIndex\n\t * @return {Promise<THREE.BufferAttribute|THREE.InterleavedBufferAttribute>}\n\t */\n\tGLTFParser.prototype.loadAccessor = function ( accessorIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\n\t\tvar accessorDef = this.json.accessors[ accessorIndex ];\n\n\t\tif ( accessorDef.bufferView === undefined && accessorDef.sparse === undefined ) {\n\n\t\t\t// Ignore empty accessors, which may be used to declare runtime\n\t\t\t// information about attributes coming from another source (e.g. Draco\n\t\t\t// compression extension).\n\t\t\treturn Promise.resolve( null );\n\n\t\t}\n\n\t\tvar pendingBufferViews = [];\n\n\t\tif ( accessorDef.bufferView !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.bufferView ) );\n\n\t\t} else {\n\n\t\t\tpendingBufferViews.push( null );\n\n\t\t}\n\n\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.indices.bufferView ) );\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.values.bufferView ) );\n\n\t\t}\n\n\t\treturn Promise.all( pendingBufferViews ).then( function ( bufferViews ) {\n\n\t\t\tvar bufferView = bufferViews[ 0 ];\n\n\t\t\tvar itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tvar TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t// For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n\t\t\tvar elementBytes = TypedArray.BYTES_PER_ELEMENT;\n\t\t\tvar itemBytes = elementBytes * itemSize;\n\t\t\tvar byteOffset = accessorDef.byteOffset || 0;\n\t\t\tvar byteStride = accessorDef.bufferView !== undefined ? json.bufferViews[ accessorDef.bufferView ].byteStride : undefined;\n\t\t\tvar normalized = accessorDef.normalized === true;\n\t\t\tvar array, bufferAttribute;\n\n\t\t\t// The buffer is not interleaved if the stride is the item size in bytes.\n\t\t\tif ( byteStride && byteStride !== itemBytes ) {\n\n\t\t\t\tvar ibCacheKey = 'InterleavedBuffer:' + accessorDef.bufferView + ':' + accessorDef.componentType;\n\t\t\t\tvar ib = parser.cache.get( ibCacheKey );\n\n\t\t\t\tif ( ! ib ) {\n\n\t\t\t\t\t// Use the full buffer if it's interleaved.\n\t\t\t\t\tarray = new TypedArray( bufferView );\n\n\t\t\t\t\t// Integer parameters to IB/IBA are in array elements, not bytes.\n\t\t\t\t\tib = new THREE.InterleavedBuffer( array, byteStride / elementBytes );\n\n\t\t\t\t\tparser.cache.add( ibCacheKey, ib );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new THREE.InterleavedBufferAttribute( ib, itemSize, byteOffset / elementBytes, normalized );\n\n\t\t\t} else {\n\n\t\t\t\tif ( bufferView === null ) {\n\n\t\t\t\t\tarray = new TypedArray( accessorDef.count * itemSize );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, byteOffset, accessorDef.count * itemSize );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new THREE.BufferAttribute( array, itemSize, normalized );\n\n\t\t\t}\n\n\t\t\t// https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n\t\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\t\tvar itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\n\t\t\t\tvar TypedArrayIndices = WEBGL_COMPONENT_TYPES[ accessorDef.sparse.indices.componentType ];\n\n\t\t\t\tvar byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\n\t\t\t\tvar byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\n\n\t\t\t\tvar sparseIndices = new TypedArrayIndices( bufferViews[ 1 ], byteOffsetIndices, accessorDef.sparse.count * itemSizeIndices );\n\t\t\t\tvar sparseValues = new TypedArray( bufferViews[ 2 ], byteOffsetValues, accessorDef.sparse.count * itemSize );\n\n\t\t\t\tif ( bufferView !== null ) {\n\n\t\t\t\t\t// Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n\t\t\t\t\tbufferAttribute.setArray( bufferAttribute.array.slice() );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var i = 0, il = sparseIndices.length; i < il; i ++ ) {\n\n\t\t\t\t\tvar index = sparseIndices[ i ];\n\n\t\t\t\t\tbufferAttribute.setX( index, sparseValues[ i * itemSize ] );\n\t\t\t\t\tif ( itemSize >= 2 ) bufferAttribute.setY( index, sparseValues[ i * itemSize + 1 ] );\n\t\t\t\t\tif ( itemSize >= 3 ) bufferAttribute.setZ( index, sparseValues[ i * itemSize + 2 ] );\n\t\t\t\t\tif ( itemSize >= 4 ) bufferAttribute.setW( index, sparseValues[ i * itemSize + 3 ] );\n\t\t\t\t\tif ( itemSize >= 5 ) throw new Error( 'THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn bufferAttribute;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n\t * @param {number} textureIndex\n\t * @return {Promise<THREE.Texture>}\n\t */\n\tGLTFParser.prototype.loadTexture = function ( textureIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\t\tvar options = this.options;\n\t\tvar textureLoader = this.textureLoader;\n\n\t\tvar URL = window.URL || window.webkitURL;\n\n\t\tvar textureDef = json.textures[ textureIndex ];\n\n\t\tvar textureExtensions = textureDef.extensions || {};\n\n\t\tvar source;\n\n\t\tif ( textureExtensions[ EXTENSIONS.MSFT_TEXTURE_DDS ] ) {\n\n\t\t\tsource = json.images[ textureExtensions[ EXTENSIONS.MSFT_TEXTURE_DDS ].source ];\n\n\t\t} else {\n\n\t\t\tsource = json.images[ textureDef.source ];\n\n\t\t}\n\n\t\tvar sourceURI = source.uri;\n\t\tvar isObjectURL = false;\n\n\t\tif ( source.bufferView !== undefined ) {\n\n\t\t\t// Load binary image data from bufferView, if provided.\n\n\t\t\tsourceURI = parser.getDependency( 'bufferView', source.bufferView ).then( function ( bufferView ) {\n\n\t\t\t\tisObjectURL = true;\n\t\t\t\tvar blob = new Blob( [ bufferView ], { type: source.mimeType } );\n\t\t\t\tsourceURI = URL.createObjectURL( blob );\n\t\t\t\treturn sourceURI;\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn Promise.resolve( sourceURI ).then( function ( sourceURI ) {\n\n\t\t\t// Load Texture resource.\n\n\t\t\tvar loader = THREE.Loader.Handlers.get( sourceURI );\n\n\t\t\tif ( ! loader ) {\n\n\t\t\t\tloader = textureExtensions[ EXTENSIONS.MSFT_TEXTURE_DDS ]\n\t\t\t\t\t? parser.extensions[ EXTENSIONS.MSFT_TEXTURE_DDS ].ddsLoader\n\t\t\t\t\t: textureLoader;\n\n\t\t\t}\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tloader.load( resolveURL( sourceURI, options.path ), resolve, undefined, reject );\n\n\t\t\t} );\n\n\t\t} ).then( function ( texture ) {\n\n\t\t\t// Clean up resources and configure Texture.\n\n\t\t\tif ( isObjectURL === true ) {\n\n\t\t\t\tURL.revokeObjectURL( sourceURI );\n\n\t\t\t}\n\n\t\t\ttexture.flipY = false;\n\n\t\t\tif ( textureDef.name !== undefined ) texture.name = textureDef.name;\n\n\t\t\t// Ignore unknown mime types, like DDS files.\n\t\t\tif ( source.mimeType in MIME_TYPE_FORMATS ) {\n\n\t\t\t\ttexture.format = MIME_TYPE_FORMATS[ source.mimeType ];\n\n\t\t\t}\n\n\t\t\tvar samplers = json.samplers || {};\n\t\t\tvar sampler = samplers[ textureDef.sampler ] || {};\n\n\t\t\ttexture.magFilter = WEBGL_FILTERS[ sampler.magFilter ] || THREE.LinearFilter;\n\t\t\ttexture.minFilter = WEBGL_FILTERS[ sampler.minFilter ] || THREE.LinearMipMapLinearFilter;\n\t\t\ttexture.wrapS = WEBGL_WRAPPINGS[ sampler.wrapS ] || THREE.RepeatWrapping;\n\t\t\ttexture.wrapT = WEBGL_WRAPPINGS[ sampler.wrapT ] || THREE.RepeatWrapping;\n\n\t\t\treturn texture;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Asynchronously assigns a texture to the given material parameters.\n\t * @param {Object} materialParams\n\t * @param {string} mapName\n\t * @param {Object} mapDef\n\t * @return {Promise}\n\t */\n\tGLTFParser.prototype.assignTexture = function ( materialParams, mapName, mapDef ) {\n\n\t\tvar parser = this;\n\n\t\treturn this.getDependency( 'texture', mapDef.index ).then( function ( texture ) {\n\n\t\t\tif ( ! texture.isCompressedTexture ) {\n\n\t\t\t\tswitch ( mapName ) {\n\n\t\t\t\t\tcase 'aoMap':\n\t\t\t\t\tcase 'emissiveMap':\n\t\t\t\t\tcase 'metalnessMap':\n\t\t\t\t\tcase 'normalMap':\n\t\t\t\t\tcase 'roughnessMap':\n\t\t\t\t\t\ttexture.format = THREE.RGBFormat;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] ) {\n\n\t\t\t\tvar transform = mapDef.extensions !== undefined ? mapDef.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] : undefined;\n\n\t\t\t\tif ( transform ) {\n\n\t\t\t\t\ttexture = parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ].extendTexture( texture, transform );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tmaterialParams[ mapName ] = texture;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Assigns final material to a Mesh, Line, or Points instance. The instance\n\t * already has a material (generated from the glTF material options alone)\n\t * but reuse of the same glTF material may require multiple threejs materials\n\t * to accomodate different primitive types, defines, etc. New materials will\n\t * be created if necessary, and reused from a cache.\n\t * @param  {THREE.Object3D} mesh Mesh, Line, or Points instance.\n\t */\n\tGLTFParser.prototype.assignFinalMaterial = function ( mesh ) {\n\n\t\tvar geometry = mesh.geometry;\n\t\tvar material = mesh.material;\n\t\tvar extensions = this.extensions;\n\n\t\tvar useVertexTangents = geometry.attributes.tangent !== undefined;\n\t\tvar useVertexColors = geometry.attributes.color !== undefined;\n\t\tvar useFlatShading = geometry.attributes.normal === undefined;\n\t\tvar useSkinning = mesh.isSkinnedMesh === true;\n\t\tvar useMorphTargets = Object.keys( geometry.morphAttributes ).length > 0;\n\t\tvar useMorphNormals = useMorphTargets && geometry.morphAttributes.normal !== undefined;\n\n\t\tif ( mesh.isPoints ) {\n\n\t\t\tvar cacheKey = 'PointsMaterial:' + material.uuid;\n\n\t\t\tvar pointsMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! pointsMaterial ) {\n\n\t\t\t\tpointsMaterial = new THREE.PointsMaterial();\n\t\t\t\tTHREE.Material.prototype.copy.call( pointsMaterial, material );\n\t\t\t\tpointsMaterial.color.copy( material.color );\n\t\t\t\tpointsMaterial.map = material.map;\n\t\t\t\tpointsMaterial.lights = false; // PointsMaterial doesn't support lights yet\n\n\t\t\t\tthis.cache.add( cacheKey, pointsMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = pointsMaterial;\n\n\t\t} else if ( mesh.isLine ) {\n\n\t\t\tvar cacheKey = 'LineBasicMaterial:' + material.uuid;\n\n\t\t\tvar lineMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! lineMaterial ) {\n\n\t\t\t\tlineMaterial = new THREE.LineBasicMaterial();\n\t\t\t\tTHREE.Material.prototype.copy.call( lineMaterial, material );\n\t\t\t\tlineMaterial.color.copy( material.color );\n\t\t\t\tlineMaterial.lights = false; // LineBasicMaterial doesn't support lights yet\n\n\t\t\t\tthis.cache.add( cacheKey, lineMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = lineMaterial;\n\n\t\t}\n\n\t\t// Clone the material if it will be modified\n\t\tif ( useVertexTangents || useVertexColors || useFlatShading || useSkinning || useMorphTargets ) {\n\n\t\t\tvar cacheKey = 'ClonedMaterial:' + material.uuid + ':';\n\n\t\t\tif ( material.isGLTFSpecularGlossinessMaterial ) cacheKey += 'specular-glossiness:';\n\t\t\tif ( useSkinning ) cacheKey += 'skinning:';\n\t\t\tif ( useVertexTangents ) cacheKey += 'vertex-tangents:';\n\t\t\tif ( useVertexColors ) cacheKey += 'vertex-colors:';\n\t\t\tif ( useFlatShading ) cacheKey += 'flat-shading:';\n\t\t\tif ( useMorphTargets ) cacheKey += 'morph-targets:';\n\t\t\tif ( useMorphNormals ) cacheKey += 'morph-normals:';\n\n\t\t\tvar cachedMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! cachedMaterial ) {\n\n\t\t\t\tcachedMaterial = material.isGLTFSpecularGlossinessMaterial\n\t\t\t\t\t? extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].cloneMaterial( material )\n\t\t\t\t\t: material.clone();\n\n\t\t\t\tif ( useSkinning ) cachedMaterial.skinning = true;\n\t\t\t\tif ( useVertexTangents ) cachedMaterial.vertexTangents = true;\n\t\t\t\tif ( useVertexColors ) cachedMaterial.vertexColors = THREE.VertexColors;\n\t\t\t\tif ( useFlatShading ) cachedMaterial.flatShading = true;\n\t\t\t\tif ( useMorphTargets ) cachedMaterial.morphTargets = true;\n\t\t\t\tif ( useMorphNormals ) cachedMaterial.morphNormals = true;\n\n\t\t\t\tthis.cache.add( cacheKey, cachedMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = cachedMaterial;\n\n\t\t}\n\n\t\t// workarounds for mesh and geometry\n\n\t\tif ( material.aoMap && geometry.attributes.uv2 === undefined && geometry.attributes.uv !== undefined ) {\n\n\t\t\tconsole.log( 'THREE.GLTFLoader: Duplicating UVs to support aoMap.' );\n\t\t\tgeometry.addAttribute( 'uv2', new THREE.BufferAttribute( geometry.attributes.uv.array, 2 ) );\n\n\t\t}\n\n\t\tif ( material.isGLTFSpecularGlossinessMaterial ) {\n\n\t\t\t// for GLTFSpecularGlossinessMaterial(ShaderMaterial) uniforms runtime update\n\t\t\tmesh.onBeforeRender = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].refreshUniforms;\n\n\t\t}\n\n\t\tmesh.material = material;\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n\t * @param {number} materialIndex\n\t * @return {Promise<THREE.Material>}\n\t */\n\tGLTFParser.prototype.loadMaterial = function ( materialIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\t\tvar extensions = this.extensions;\n\t\tvar materialDef = json.materials[ materialIndex ];\n\n\t\tvar materialType;\n\t\tvar materialParams = {};\n\t\tvar materialExtensions = materialDef.extensions || {};\n\n\t\tvar pending = [];\n\n\t\tif ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ] ) {\n\n\t\t\tvar sgExtension = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ];\n\t\t\tmaterialType = sgExtension.getMaterialType();\n\t\t\tpending.push( sgExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else if ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ] ) {\n\n\t\t\tvar kmuExtension = extensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ];\n\t\t\tmaterialType = kmuExtension.getMaterialType();\n\t\t\tpending.push( kmuExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else {\n\n\t\t\t// Specification:\n\t\t\t// https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n\t\t\tmaterialType = THREE.MeshStandardMaterial;\n\n\t\t\tvar metallicRoughness = materialDef.pbrMetallicRoughness || {};\n\n\t\t\tmaterialParams.color = new THREE.Color( 1.0, 1.0, 1.0 );\n\t\t\tmaterialParams.opacity = 1.0;\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tvar array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\n\n\t\t\t}\n\n\t\t\tmaterialParams.metalness = metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n\t\t\tmaterialParams.roughness = metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n\t\t\tif ( metallicRoughness.metallicRoughnessTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'metalnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'roughnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.doubleSided === true ) {\n\n\t\t\tmaterialParams.side = THREE.DoubleSide;\n\n\t\t}\n\n\t\tvar alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\n\n\t\tif ( alphaMode === ALPHA_MODES.BLEND ) {\n\n\t\t\tmaterialParams.transparent = true;\n\n\t\t} else {\n\n\t\t\tmaterialParams.transparent = false;\n\n\t\t\tif ( alphaMode === ALPHA_MODES.MASK ) {\n\n\t\t\t\tmaterialParams.alphaTest = materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.normalTexture !== undefined && materialType !== THREE.MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'normalMap', materialDef.normalTexture ) );\n\n\t\t\tmaterialParams.normalScale = new THREE.Vector2( 1, 1 );\n\n\t\t\tif ( materialDef.normalTexture.scale !== undefined ) {\n\n\t\t\t\tmaterialParams.normalScale.set( materialDef.normalTexture.scale, materialDef.normalTexture.scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.occlusionTexture !== undefined && materialType !== THREE.MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'aoMap', materialDef.occlusionTexture ) );\n\n\t\t\tif ( materialDef.occlusionTexture.strength !== undefined ) {\n\n\t\t\t\tmaterialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.emissiveFactor !== undefined && materialType !== THREE.MeshBasicMaterial ) {\n\n\t\t\tmaterialParams.emissive = new THREE.Color().fromArray( materialDef.emissiveFactor );\n\n\t\t}\n\n\t\tif ( materialDef.emissiveTexture !== undefined && materialType !== THREE.MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'emissiveMap', materialDef.emissiveTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\tvar material;\n\n\t\t\tif ( materialType === THREE.ShaderMaterial ) {\n\n\t\t\t\tmaterial = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].createMaterial( materialParams );\n\n\t\t\t} else {\n\n\t\t\t\tmaterial = new materialType( materialParams );\n\n\t\t\t}\n\n\t\t\tif ( materialDef.name !== undefined ) material.name = materialDef.name;\n\n\t\t\t// baseColorTexture, emissiveTexture, and specularGlossinessTexture use sRGB encoding.\n\t\t\tif ( material.map ) material.map.encoding = THREE.sRGBEncoding;\n\t\t\tif ( material.emissiveMap ) material.emissiveMap.encoding = THREE.sRGBEncoding;\n\t\t\tif ( material.specularMap ) material.specularMap.encoding = THREE.sRGBEncoding;\n\n\t\t\tassignExtrasToUserData( material, materialDef );\n\n\t\t\tif ( materialDef.extensions ) addUnknownExtensionsToUserData( extensions, material, materialDef );\n\n\t\t\treturn material;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * @param {THREE.BufferGeometry} geometry\n\t * @param {GLTF.Primitive} primitiveDef\n\t * @param {GLTFParser} parser\n\t * @return {Promise<THREE.BufferGeometry>}\n\t */\n\tfunction addPrimitiveAttributes( geometry, primitiveDef, parser ) {\n\n\t\tvar attributes = primitiveDef.attributes;\n\n\t\tvar pending = [];\n\n\t\tfunction assignAttributeAccessor( accessorIndex, attributeName ) {\n\n\t\t\treturn parser.getDependency( 'accessor', accessorIndex )\n\t\t\t\t.then( function ( accessor ) {\n\n\t\t\t\t\tgeometry.addAttribute( attributeName, accessor );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tfor ( var gltfAttributeName in attributes ) {\n\n\t\t\tvar threeAttributeName = ATTRIBUTES[ gltfAttributeName ] || gltfAttributeName.toLowerCase();\n\n\t\t\t// Skip attributes already provided by e.g. Draco extension.\n\t\t\tif ( threeAttributeName in geometry.attributes ) continue;\n\n\t\t\tpending.push( assignAttributeAccessor( attributes[ gltfAttributeName ], threeAttributeName ) );\n\n\t\t}\n\n\t\tif ( primitiveDef.indices !== undefined && ! geometry.index ) {\n\n\t\t\tvar accessor = parser.getDependency( 'accessor', primitiveDef.indices ).then( function ( accessor ) {\n\n\t\t\t\tgeometry.setIndex( accessor );\n\n\t\t\t} );\n\n\t\t\tpending.push( accessor );\n\n\t\t}\n\n\t\tassignExtrasToUserData( geometry, primitiveDef );\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\treturn primitiveDef.targets !== undefined\n\t\t\t\t? addMorphTargets( geometry, primitiveDef.targets, parser )\n\t\t\t\t: geometry;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n\t *\n\t * Creates BufferGeometries from primitives.\n\t *\n\t * @param {Array<GLTF.Primitive>} primitives\n\t * @return {Promise<Array<THREE.BufferGeometry>>}\n\t */\n\tGLTFParser.prototype.loadGeometries = function ( primitives ) {\n\n\t\tvar parser = this;\n\t\tvar extensions = this.extensions;\n\t\tvar cache = this.primitiveCache;\n\n\t\tfunction createDracoPrimitive( primitive ) {\n\n\t\t\treturn extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ]\n\t\t\t\t.decodePrimitive( primitive, parser )\n\t\t\t\t.then( function ( geometry ) {\n\n\t\t\t\t\treturn addPrimitiveAttributes( geometry, primitive, parser );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tvar pending = [];\n\n\t\tfor ( var i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tvar primitive = primitives[ i ];\n\t\t\tvar cacheKey = createPrimitiveKey( primitive );\n\n\t\t\t// See if we've already created this geometry\n\t\t\tvar cached = cache[ cacheKey ];\n\n\t\t\tif ( cached ) {\n\n\t\t\t\t// Use the cached geometry if it exists\n\t\t\t\tpending.push( cached.promise );\n\n\t\t\t} else {\n\n\t\t\t\tvar geometryPromise;\n\n\t\t\t\tif ( primitive.extensions && primitive.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] ) {\n\n\t\t\t\t\t// Use DRACO geometry if available\n\t\t\t\t\tgeometryPromise = createDracoPrimitive( primitive );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Otherwise create a new geometry\n\t\t\t\t\tgeometryPromise = addPrimitiveAttributes( new THREE.BufferGeometry(), primitive, parser );\n\n\t\t\t\t}\n\n\t\t\t\t// Cache this geometry\n\t\t\t\tcache[ cacheKey ] = { primitive: primitive, promise: geometryPromise };\n\n\t\t\t\tpending.push( geometryPromise );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n\t * @param {number} meshIndex\n\t * @return {Promise<THREE.Group|THREE.Mesh|THREE.SkinnedMesh>}\n\t */\n\tGLTFParser.prototype.loadMesh = function ( meshIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\t\tvar extensions = this.extensions;\n\n\t\tvar meshDef = json.meshes[ meshIndex ];\n\t\tvar primitives = meshDef.primitives;\n\n\t\tvar pending = [];\n\n\t\tfor ( var i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tvar material = primitives[ i ].material === undefined\n\t\t\t\t? createDefaultMaterial()\n\t\t\t\t: this.getDependency( 'material', primitives[ i ].material );\n\n\t\t\tpending.push( material );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function ( originalMaterials ) {\n\n\t\t\treturn parser.loadGeometries( primitives ).then( function ( geometries ) {\n\n\t\t\t\tvar meshes = [];\n\n\t\t\t\tfor ( var i = 0, il = geometries.length; i < il; i ++ ) {\n\n\t\t\t\t\tvar geometry = geometries[ i ];\n\t\t\t\t\tvar primitive = primitives[ i ];\n\n\t\t\t\t\t// 1. create Mesh\n\n\t\t\t\t\tvar mesh;\n\n\t\t\t\t\tvar material = originalMaterials[ i ];\n\n\t\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n\t\t\t\t\t\tprimitive.mode === undefined ) {\n\n\t\t\t\t\t\t// .isSkinnedMesh isn't in glTF spec. See .markDefs()\n\t\t\t\t\t\tmesh = meshDef.isSkinnedMesh === true\n\t\t\t\t\t\t\t? new THREE.SkinnedMesh( geometry, material )\n\t\t\t\t\t\t\t: new THREE.Mesh( geometry, material );\n\n\t\t\t\t\t\tif ( mesh.isSkinnedMesh === true ) mesh.normalizeSkinWeights(); // #15319\n\n\t\t\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ) {\n\n\t\t\t\t\t\t\tmesh.drawMode = THREE.TriangleStripDrawMode;\n\n\t\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ) {\n\n\t\t\t\t\t\t\tmesh.drawMode = THREE.TriangleFanDrawMode;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINES ) {\n\n\t\t\t\t\t\tmesh = new THREE.LineSegments( geometry, material );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_STRIP ) {\n\n\t\t\t\t\t\tmesh = new THREE.Line( geometry, material );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_LOOP ) {\n\n\t\t\t\t\t\tmesh = new THREE.LineLoop( geometry, material );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.POINTS ) {\n\n\t\t\t\t\t\tmesh = new THREE.Points( geometry, material );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( Object.keys( mesh.geometry.morphAttributes ).length > 0 ) {\n\n\t\t\t\t\t\tupdateMorphTargets( mesh, meshDef );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmesh.name = meshDef.name || ( 'mesh_' + meshIndex );\n\n\t\t\t\t\tif ( geometries.length > 1 ) mesh.name += '_' + i;\n\n\t\t\t\t\tassignExtrasToUserData( mesh, meshDef );\n\n\t\t\t\t\tparser.assignFinalMaterial( mesh );\n\n\t\t\t\t\tmeshes.push( mesh );\n\n\t\t\t\t}\n\n\t\t\t\tif ( meshes.length === 1 ) {\n\n\t\t\t\t\treturn meshes[ 0 ];\n\n\t\t\t\t}\n\n\t\t\t\tvar group = new THREE.Group();\n\n\t\t\t\tfor ( var i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\t\tgroup.add( meshes[ i ] );\n\n\t\t\t\t}\n\n\t\t\t\treturn group;\n\n\t\t\t} );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n\t * @param {number} cameraIndex\n\t * @return {Promise<THREE.Camera>}\n\t */\n\tGLTFParser.prototype.loadCamera = function ( cameraIndex ) {\n\n\t\tvar camera;\n\t\tvar cameraDef = this.json.cameras[ cameraIndex ];\n\t\tvar params = cameraDef[ cameraDef.type ];\n\n\t\tif ( ! params ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing camera parameters.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( cameraDef.type === 'perspective' ) {\n\n\t\t\tcamera = new THREE.PerspectiveCamera( THREE.Math.radToDeg( params.yfov ), params.aspectRatio || 1, params.znear || 1, params.zfar || 2e6 );\n\n\t\t} else if ( cameraDef.type === 'orthographic' ) {\n\n\t\t\tcamera = new THREE.OrthographicCamera( params.xmag / - 2, params.xmag / 2, params.ymag / 2, params.ymag / - 2, params.znear, params.zfar );\n\n\t\t}\n\n\t\tif ( cameraDef.name !== undefined ) camera.name = cameraDef.name;\n\n\t\tassignExtrasToUserData( camera, cameraDef );\n\n\t\treturn Promise.resolve( camera );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n\t * @param {number} skinIndex\n\t * @return {Promise<Object>}\n\t */\n\tGLTFParser.prototype.loadSkin = function ( skinIndex ) {\n\n\t\tvar skinDef = this.json.skins[ skinIndex ];\n\n\t\tvar skinEntry = { joints: skinDef.joints };\n\n\t\tif ( skinDef.inverseBindMatrices === undefined ) {\n\n\t\t\treturn Promise.resolve( skinEntry );\n\n\t\t}\n\n\t\treturn this.getDependency( 'accessor', skinDef.inverseBindMatrices ).then( function ( accessor ) {\n\n\t\t\tskinEntry.inverseBindMatrices = accessor;\n\n\t\t\treturn skinEntry;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n\t * @param {number} animationIndex\n\t * @return {Promise<THREE.AnimationClip>}\n\t */\n\tGLTFParser.prototype.loadAnimation = function ( animationIndex ) {\n\n\t\tvar json = this.json;\n\n\t\tvar animationDef = json.animations[ animationIndex ];\n\n\t\tvar pendingNodes = [];\n\t\tvar pendingInputAccessors = [];\n\t\tvar pendingOutputAccessors = [];\n\t\tvar pendingSamplers = [];\n\t\tvar pendingTargets = [];\n\n\t\tfor ( var i = 0, il = animationDef.channels.length; i < il; i ++ ) {\n\n\t\t\tvar channel = animationDef.channels[ i ];\n\t\t\tvar sampler = animationDef.samplers[ channel.sampler ];\n\t\t\tvar target = channel.target;\n\t\t\tvar name = target.node !== undefined ? target.node : target.id; // NOTE: target.id is deprecated.\n\t\t\tvar input = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.input ] : sampler.input;\n\t\t\tvar output = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.output ] : sampler.output;\n\n\t\t\tpendingNodes.push( this.getDependency( 'node', name ) );\n\t\t\tpendingInputAccessors.push( this.getDependency( 'accessor', input ) );\n\t\t\tpendingOutputAccessors.push( this.getDependency( 'accessor', output ) );\n\t\t\tpendingSamplers.push( sampler );\n\t\t\tpendingTargets.push( target );\n\n\t\t}\n\n\t\treturn Promise.all( [\n\n\t\t\tPromise.all( pendingNodes ),\n\t\t\tPromise.all( pendingInputAccessors ),\n\t\t\tPromise.all( pendingOutputAccessors ),\n\t\t\tPromise.all( pendingSamplers ),\n\t\t\tPromise.all( pendingTargets )\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tvar nodes = dependencies[ 0 ];\n\t\t\tvar inputAccessors = dependencies[ 1 ];\n\t\t\tvar outputAccessors = dependencies[ 2 ];\n\t\t\tvar samplers = dependencies[ 3 ];\n\t\t\tvar targets = dependencies[ 4 ];\n\n\t\t\tvar tracks = [];\n\n\t\t\tfor ( var i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tvar node = nodes[ i ];\n\t\t\t\tvar inputAccessor = inputAccessors[ i ];\n\t\t\t\tvar outputAccessor = outputAccessors[ i ];\n\t\t\t\tvar sampler = samplers[ i ];\n\t\t\t\tvar target = targets[ i ];\n\n\t\t\t\tif ( node === undefined ) continue;\n\n\t\t\t\tnode.updateMatrix();\n\t\t\t\tnode.matrixAutoUpdate = true;\n\n\t\t\t\tvar TypedKeyframeTrack;\n\n\t\t\t\tswitch ( PATH_PROPERTIES[ target.path ] ) {\n\n\t\t\t\t\tcase PATH_PROPERTIES.weights:\n\n\t\t\t\t\t\tTypedKeyframeTrack = THREE.NumberKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase PATH_PROPERTIES.rotation:\n\n\t\t\t\t\t\tTypedKeyframeTrack = THREE.QuaternionKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase PATH_PROPERTIES.position:\n\t\t\t\t\tcase PATH_PROPERTIES.scale:\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tTypedKeyframeTrack = THREE.VectorKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tvar targetName = node.name ? node.name : node.uuid;\n\n\t\t\t\tvar interpolation = sampler.interpolation !== undefined ? INTERPOLATION[ sampler.interpolation ] : THREE.InterpolateLinear;\n\n\t\t\t\tvar targetNames = [];\n\n\t\t\t\tif ( PATH_PROPERTIES[ target.path ] === PATH_PROPERTIES.weights ) {\n\n\t\t\t\t\t// Node may be a THREE.Group (glTF mesh with several primitives) or a THREE.Mesh.\n\t\t\t\t\tnode.traverse( function ( object ) {\n\n\t\t\t\t\t\tif ( object.isMesh === true && object.morphTargetInfluences ) {\n\n\t\t\t\t\t\t\ttargetNames.push( object.name ? object.name : object.uuid );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttargetNames.push( targetName );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var j = 0, jl = targetNames.length; j < jl; j ++ ) {\n\n\t\t\t\t\tvar track = new TypedKeyframeTrack(\n\t\t\t\t\t\ttargetNames[ j ] + '.' + PATH_PROPERTIES[ target.path ],\n\t\t\t\t\t\tinputAccessor.array,\n\t\t\t\t\t\toutputAccessor.array,\n\t\t\t\t\t\tinterpolation\n\t\t\t\t\t);\n\n\t\t\t\t\t// Override interpolation with custom factory method.\n\t\t\t\t\tif ( sampler.interpolation === 'CUBICSPLINE' ) {\n\n\t\t\t\t\t\ttrack.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline( result ) {\n\n\t\t\t\t\t\t\t// A CUBICSPLINE keyframe in glTF has three output values for each input value,\n\t\t\t\t\t\t\t// representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n\t\t\t\t\t\t\t// must be divided by three to get the interpolant's sampleSize argument.\n\n\t\t\t\t\t\t\treturn new GLTFCubicSplineInterpolant( this.times, this.values, this.getValueSize() / 3, result );\n\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\n\t\t\t\t\t\ttrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttracks.push( track );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar name = animationDef.name !== undefined ? animationDef.name : 'animation_' + animationIndex;\n\n\t\t\treturn new THREE.AnimationClip( name, undefined, tracks );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n\t * @param {number} nodeIndex\n\t * @return {Promise<THREE.Object3D>}\n\t */\n\tGLTFParser.prototype.loadNode = function ( nodeIndex ) {\n\n\t\tvar json = this.json;\n\t\tvar extensions = this.extensions;\n\t\tvar parser = this;\n\n\t\tvar meshReferences = json.meshReferences;\n\t\tvar meshUses = json.meshUses;\n\n\t\tvar nodeDef = json.nodes[ nodeIndex ];\n\n\t\treturn ( function () {\n\n\t\t\t// .isBone isn't in glTF spec. See .markDefs\n\t\t\tif ( nodeDef.isBone === true ) {\n\n\t\t\t\treturn Promise.resolve( new THREE.Bone() );\n\n\t\t\t} else if ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\treturn parser.getDependency( 'mesh', nodeDef.mesh ).then( function ( mesh ) {\n\n\t\t\t\t\tvar node;\n\n\t\t\t\t\tif ( meshReferences[ nodeDef.mesh ] > 1 ) {\n\n\t\t\t\t\t\tvar instanceNum = meshUses[ nodeDef.mesh ] ++;\n\n\t\t\t\t\t\tnode = mesh.clone();\n\t\t\t\t\t\tnode.name += '_instance_' + instanceNum;\n\n\t\t\t\t\t\t// onBeforeRender copy for Specular-Glossiness\n\t\t\t\t\t\tnode.onBeforeRender = mesh.onBeforeRender;\n\n\t\t\t\t\t\tfor ( var i = 0, il = node.children.length; i < il; i ++ ) {\n\n\t\t\t\t\t\t\tnode.children[ i ].name += '_instance_' + instanceNum;\n\t\t\t\t\t\t\tnode.children[ i ].onBeforeRender = mesh.children[ i ].onBeforeRender;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tnode = mesh;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// if weights are provided on the node, override weights on the mesh.\n\t\t\t\t\tif ( nodeDef.weights !== undefined ) {\n\n\t\t\t\t\t\tnode.traverse( function ( o ) {\n\n\t\t\t\t\t\t\tif ( ! o.isMesh ) return;\n\n\t\t\t\t\t\t\tfor ( var i = 0, il = nodeDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\t\t\t\t\to.morphTargetInfluences[ i ] = nodeDef.weights[ i ];\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn node;\n\n\t\t\t\t} );\n\n\t\t\t} else if ( nodeDef.camera !== undefined ) {\n\n\t\t\t\treturn parser.getDependency( 'camera', nodeDef.camera );\n\n\t\t\t} else if ( nodeDef.extensions\n\t\t\t\t&& nodeDef.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ]\n\t\t\t\t&& nodeDef.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ].light !== undefined ) {\n\n\t\t\t\treturn parser.getDependency( 'light', nodeDef.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ].light );\n\n\t\t\t} else {\n\n\t\t\t\treturn Promise.resolve( new THREE.Object3D() );\n\n\t\t\t}\n\n\t\t}() ).then( function ( node ) {\n\n\t\t\tif ( nodeDef.name !== undefined ) {\n\n\t\t\t\tnode.name = THREE.PropertyBinding.sanitizeNodeName( nodeDef.name );\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( node, nodeDef );\n\n\t\t\tif ( nodeDef.extensions ) addUnknownExtensionsToUserData( extensions, node, nodeDef );\n\n\t\t\tif ( nodeDef.matrix !== undefined ) {\n\n\t\t\t\tvar matrix = new THREE.Matrix4();\n\t\t\t\tmatrix.fromArray( nodeDef.matrix );\n\t\t\t\tnode.applyMatrix( matrix );\n\n\t\t\t} else {\n\n\t\t\t\tif ( nodeDef.translation !== undefined ) {\n\n\t\t\t\t\tnode.position.fromArray( nodeDef.translation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.rotation !== undefined ) {\n\n\t\t\t\t\tnode.quaternion.fromArray( nodeDef.rotation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.scale !== undefined ) {\n\n\t\t\t\t\tnode.scale.fromArray( nodeDef.scale );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n\t * @param {number} sceneIndex\n\t * @return {Promise<THREE.Scene>}\n\t */\n\tGLTFParser.prototype.loadScene = function () {\n\n\t\t// scene node hierachy builder\n\n\t\tfunction buildNodeHierachy( nodeId, parentObject, json, parser ) {\n\n\t\t\tvar nodeDef = json.nodes[ nodeId ];\n\n\t\t\treturn parser.getDependency( 'node', nodeId ).then( function ( node ) {\n\n\t\t\t\tif ( nodeDef.skin === undefined ) return node;\n\n\t\t\t\t// build skeleton here as well\n\n\t\t\t\tvar skinEntry;\n\n\t\t\t\treturn parser.getDependency( 'skin', nodeDef.skin ).then( function ( skin ) {\n\n\t\t\t\t\tskinEntry = skin;\n\n\t\t\t\t\tvar pendingJoints = [];\n\n\t\t\t\t\tfor ( var i = 0, il = skinEntry.joints.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tpendingJoints.push( parser.getDependency( 'node', skinEntry.joints[ i ] ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Promise.all( pendingJoints );\n\n\t\t\t\t} ).then( function ( jointNodes ) {\n\n\t\t\t\t\tvar meshes = node.isGroup === true ? node.children : [ node ];\n\n\t\t\t\t\tfor ( var i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tvar mesh = meshes[ i ];\n\n\t\t\t\t\t\tvar bones = [];\n\t\t\t\t\t\tvar boneInverses = [];\n\n\t\t\t\t\t\tfor ( var j = 0, jl = jointNodes.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tvar jointNode = jointNodes[ j ];\n\n\t\t\t\t\t\t\tif ( jointNode ) {\n\n\t\t\t\t\t\t\t\tbones.push( jointNode );\n\n\t\t\t\t\t\t\t\tvar mat = new THREE.Matrix4();\n\n\t\t\t\t\t\t\t\tif ( skinEntry.inverseBindMatrices !== undefined ) {\n\n\t\t\t\t\t\t\t\t\tmat.fromArray( skinEntry.inverseBindMatrices.array, j * 16 );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tboneInverses.push( mat );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Joint \"%s\" could not be found.', skinEntry.joints[ j ] );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmesh.bind( new THREE.Skeleton( bones, boneInverses ), mesh.matrixWorld );\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn node;\n\n\t\t\t\t} );\n\n\t\t\t} ).then( function ( node ) {\n\n\t\t\t\t// build node hierachy\n\n\t\t\t\tparentObject.add( node );\n\n\t\t\t\tvar pending = [];\n\n\t\t\t\tif ( nodeDef.children ) {\n\n\t\t\t\t\tvar children = nodeDef.children;\n\n\t\t\t\t\tfor ( var i = 0, il = children.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tvar child = children[ i ];\n\t\t\t\t\t\tpending.push( buildNodeHierachy( child, node, json, parser ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn Promise.all( pending );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn function loadScene( sceneIndex ) {\n\n\t\t\tvar json = this.json;\n\t\t\tvar extensions = this.extensions;\n\t\t\tvar sceneDef = this.json.scenes[ sceneIndex ];\n\t\t\tvar parser = this;\n\n\t\t\tvar scene = new THREE.Scene();\n\t\t\tif ( sceneDef.name !== undefined ) scene.name = sceneDef.name;\n\n\t\t\tassignExtrasToUserData( scene, sceneDef );\n\n\t\t\tif ( sceneDef.extensions ) addUnknownExtensionsToUserData( extensions, scene, sceneDef );\n\n\t\t\tvar nodeIds = sceneDef.nodes || [];\n\n\t\t\tvar pending = [];\n\n\t\t\tfor ( var i = 0, il = nodeIds.length; i < il; i ++ ) {\n\n\t\t\t\tpending.push( buildNodeHierachy( nodeIds[ i ], scene, json, parser ) );\n\n\t\t\t}\n\n\t\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\t\treturn scene;\n\n\t\t\t} );\n\n\t\t};\n\n\t}();\n\n\treturn GLTFLoader;\n\n} )();\n\n\nexport default GLTFLoader","import {OBJ_TYPES, TOTAL_OBJ_TYPES} from './Common'\nimport * as THREE from \"three\"\nimport WebLayer3D from 'three-web-layer'\nimport GPUParticles from './defs/GPUParticles'\nimport GLTFLoader from './GLTFLoader'\n\nexport class SceneGraphProvider {\n    //return the current scene. provider is in charge of tracking which scene is considered 'current'\n    //including the default scene when the project loads\n    getCurrentScene() { throw new Error(\"getCurrentScene not implemented\")}\n    getSceneObjects(scene) { throw new Error(\"getSceneObjects not implemented\")}\n    getBehaviorsForObject(obj) { throw new Error(\"getBehaviorsForObject(obj) not implemented\")}\n    //return threejs object for the id of the graph object\n    getThreeObject(id) { throw new Error(\"getThreeObject(id) not implemented\")}\n    getParsedBehaviorAsset(beh) { throw new Error(\"getParsedBehaviorAsset(behavior) not implemented\")}\n    getAllBehaviors() { throw new Error(\"getAllBehaviors() not implemented\")}\n    getAllScenes() { throw new Error(\"getAllScenes not implemented\")}\n\n    //navigate to the specified scene. id is a graph object id\n    navigateScene(id) { throw new Error(\"navigateScene(id) not implemented\")}\n\n    //media stuff\n    playMediaAsset(id) { throw new Error(\"playMediaAsset(id) not implemented\")}\n    stopMediaAsset(id) { throw new Error(\"stopMediaAsset(id) not implemented\")}\n    isMediaAssetPlaying(id) { throw new Error(\"isMediaAssetPlaying(id) not implemented\")}\n    setMediaVolume(id,vol) { throw new Error(\"setMediaVolume(asset,vol) not implemented\")}\n\n    getGraphObjectByName(name) { throw new Error(\"getGraphObjectByName(name) not implemented\")}\n    getGraphObjectById(id) { throw new Error(\"getGraphObjectById(id) not implemented\")}\n    getCamera() { throw new Error(\"getCamera() not implemented\")}\n    getTweenManager() { throw new Error(\"getTweenManager() not implemented\")}\n    getFloorNear(info) { throw new Error(\"getFloorNear not implemented\")}\n    startLocalAnchor(info) { throw new Error(\"startLocalAnchor not implemented\")}\n    stopLocalAnchor(info) { throw new Error(\"stopLocalAnchor not implemented\")}\n    startImageRecognizer(info) { throw new Error(\"startImageRecognizer not implemented\")}\n    stopImageRecognizer(info) { throw new Error(\"stopImageRecognizer not implemented\")}\n    startGeoTracker(info) { throw new Error(\"startGeoTracker not implemented\")}\n    stopGeoTracker(info) { throw new Error(\"stopGeoTracker not implemented\")}\n    startWorldInfo(info) { throw new Error(\"startWorldInformation not implemented\")}\n    stopWorldInfo(info) { throw new Error(\"stopWorldInformation not implemented\")}\n\n}\n\nclass SystemFacade {\n\n    constructor(manager, sgp, behavior) {\n        this.manager = manager\n        this.sgp = sgp\n        this.logger = this.manager.logger\n        this.tween = sgp.getTweenManager()\n        this.camera = sgp.getCamera()\n        this.globalStorage = this.manager.storage\n        this.behavior = behavior\n    }\n\n    get globals () {\n        return {\n            THREE:THREE,\n            GLTFLoader: GLTFLoader,\n            GPUParticles: GPUParticles,\n            WebLayer3D: WebLayer3D\n        }\n    }\n\n    get properties () {\n        return this.behavior.props()\n    }\n    getThreeObjectByTitle(title) {\n        const obj = this.sgp.getGraphObjectByName(title)\n        if(!obj) throw new Error(`three object '${title}' not found`)\n        return this.sgp.getThreeObject(obj)\n    }\n    getObjectByTitle(title) {\n        const obj = this.sgp.getGraphObjectByName(title)\n        if(!obj || !obj.exists()) throw new Error(`object '${title}' not found`)\n        return obj\n    }\n    getAssetByTitle(title) {\n        const obj = this.sgp.getGraphObjectByName(title)\n        if(!obj || !obj.exists()) throw new Error(`asset '${title}' not found`)\n        let trusted = this._event && this._event.data && this._event.data.event && this._event.data.event.isTrusted\n        return new AssetFacade(this.manager,obj, trusted)\n    }\n    getAssetById(id) {\n        const obj = this.getObjectById(id)\n        if(!obj || !obj.exists()) throw new Error(`asset '${id}' not found`)\n        let trusted = this._event && this._event.data && this._event.data.event && this._event.data.event.isTrusted\n        return new AssetFacade(this.manager,obj,trusted)\n    }\n    getObjectById(id) {\n        const obj = this.sgp.getGraphObjectById(id)\n        if(!obj || !obj.exists()) throw new Error(`object '${id}' not found`)\n        return obj\n    }\n    getThreeObjectById(id) {\n        return this.sgp.getThreeObject(id)\n    }\n\n    getCurrentScene() {\n        const obj = this.sgp.getCurrentScene()\n        if(!obj || !obj.exists()) throw new Error(`current scene not found`)\n        return obj\n    }\n    navigateScene(id) {\n        this.manager.fireSceneLifecycleEvent('exit',this.getCurrentScene())\n        this.sgp.navigateScene(id)\n        this.manager.fireSceneLifecycleEvent('enter',this.getCurrentScene())\n    }\n    fireEvent(type,payload,target=null) {\n        // this.manager.fireEventFromTarget(target,type,payload)\n        if (target == null) {\n            target = this.sgp.getGraphObjectById(this.behavior.parent)\n        }\n        this.manager.fireEventAtTarget(target,type,payload)\n    }\n    sendMessage(name,payload,target=null) {\n        if (target == null) {\n            target = this.sgp.getGraphObjectById(this.behavior.parent)\n        }\n        this.manager.fireMessageAtTarget(target,name,payload)\n    }\n    captureEvent() {\n        this.manager.captureEvent()\n    }\n}\n\nexport default class ScriptManager {\n    constructor(sceneGraphProvider, logger) {\n        this.sgp = sceneGraphProvider\n        this.logger = logger\n        this.running = false\n        this.storage = {}\n        this.logger = logger\n        this.logger.log(\"ScriptManager created\")\n        this.system_cache = {}\n\n        this.bubbling = true;\n\n        if (!window.THREE) window.THREE = THREE\n        if (!window.GLTFLoader) window.GLTFLoader = GLTFLoader\n        if (!window.GPUParticles) window.GPUParticles = GPUParticles\n        if (!window.WebLayer3D) window.WebLayer3D = WebLayer3D\n    }\n\n\n    fireLifecycleEvent(type) {\n        this.logger.log(`doing ${type} event`)\n        const evt = {\n            type:type\n        }\n        this.sgp.getAllScenes().forEach(scene => {\n            scene.find(child => {\n                if(child.type === TOTAL_OBJ_TYPES.BEHAVIOR) {\n                    evt.target = this.sgp.getThreeObject(child.parent)\n                    evt.graphTarget = this.sgp.getGraphObjectById(child.parent)\n                    const asset = this.sgp.getParsedBehaviorAsset(child)\n                    const system = this.getSystemFacadeFromCache(child)\n                    system.code = asset\n                    if (asset[type]) asset[type].call(system,evt)\n                } else {\n                    evt.target = this.sgp.getThreeObject(child)\n                    evt.graphTarget = child\n                    if(evt.target && evt.target[type]) evt.target[type](evt, this)\n                }\n                return true\n            })\n        })\n    }\n\n    fireSceneLifecycleEvent(type, scene, time) {\n        if(type!=='tick') this.logger.log(`doing ${type} event`)\n\n        const evt = {\n            type: type,\n            time: time ? time - this.startTime : -1,\n            deltaTime: time ? time - this.lastTime : 0,\n            session: this.session\n        }\n        if (time) {\n            this.lastTime = time\n        }\n        scene.find(child => {\n            const parentId = child.parent\n            this.fireSceneLifecycleEventAtChild(type,evt,child,parentId)\n            return true\n        })\n    }\n\n    fireSceneLifecycleEventAtChild(type,evt,child, parentId) {\n        // if(type!=='tick') this.logger.log(`calling ${type} on ${child.type} ${child.id}`)\n        if(child.type === TOTAL_OBJ_TYPES.BEHAVIOR) {\n            evt.target = this.sgp.getThreeObject(parentId)\n            evt.graphTarget = this.sgp.getGraphObjectById(parentId)\n            //evt.props = child.props()\n            const asset = this.sgp.getParsedBehaviorAsset(child)\n            const system = this.getSystemFacadeFromCache(child)\n            system.code = asset\n            if (asset[type]) asset[type].call(system,evt)\n            // if(asset[type]) asset[type](evt)\n        } else {\n            evt.target = this.sgp.getThreeObject(child)\n            evt.graphTarget = child\n            if(evt.target && evt.target[type]) evt.target[type](evt, this)\n            if(child.type === OBJ_TYPES.clone) {\n                if (type !== 'tick') console.log(`also doing ${type} event on a clone`)\n            }\n        }\n    }\n\n    tick(time, session) {\n        if(!this.running) return\n        if(this.startTime ===0) {\n            this.startTime = time\n            this.lastTime = time\n        }\n        try {\n            this.session = session\n            this.fireSceneLifecycleEvent('tick',this.sgp.getCurrentScene(),time)\n        } catch (err) {\n            this.logger.error(\"error in script\",err.message)\n            this.logger.log(err)\n            this.stopRunning()\n        }\n    }\n\n\n    startRunning() {\n        this.running = true\n        this.startTime = 0\n        this.lastTime = 0\n        this.storage = {}\n        this.logger.log(\"ScriptManager starting\")\n        try {\n            this.fireLifecycleEvent('start')\n        } catch(err) {\n            this.logger.error(\"error in script\",err.message)\n            this.logger.error(err)\n            this.stopRunning()\n        }\n    }\n\n    startFirstScene() {\n        try {\n            this.fireSceneLifecycleEvent('enter',this.sgp.getCurrentScene())\n        } catch(err) {\n            this.logger.error(\"error in script\",err.message)\n            this.logger.error(err)\n            this.stopRunning()\n        }\n    }\n    \n\n    stopRunning() {\n        try {\n            this.fireSceneLifecycleEvent('exit',this.sgp.getCurrentScene())\n            this.fireLifecycleEvent('stop')\n            this.running = false\n            this.storage = {}\n            this.destroyListeners()\n        } catch(err) {\n            this.running = false\n            this.logger.error(\"error stopping scripts\",err.message)\n            this.logger.error(err)\n        }\n        this.logger.log(\"script manager stopping\")\n    }\n    isRunning() {\n        return this.running\n    }\n\n    fireMessageAtTarget(target, name, payload) {\n        if(!this.running) return\n        try { \n            const evt = {\n                type: 'message',\n                name: name,\n                data: payload,\n                time: this.lastTime,\n                target: this.sgp.getThreeObject(target),\n                graphTarget: target,\n            }\n            const behaviors = this.sgp.getBehaviorsForObject(target)\n            behaviors.forEach(b => {\n                const system = this.getSystemFacadeFromCache(b)\n                const asset = this.sgp.getParsedBehaviorAsset(b)\n                system._event = evt   // want to be able to look for this later\n                system.code = asset\n                if (asset.message) asset.message.call(system,evt)\n                system._event = null\n            })\n        } catch (error) {\n            this.logger.error(\"error in '\" + name + \"' message\",error.message)\n            this.logger.error(error)\n            this.stopRunning()\n        }\n    }\n\n    performClickAction(target, e) {\n        this.fireEventAtTarget(target, \"click\", {event: e})\n    }\n\n    captureEvent() {\n        this.bubbling = false\n    }\n\n    fireEventAtTarget(target, type, payload) {\n        if(!this.running) return\n        try { \n            this.bubbling = true\n\n            const evt = {\n                type: type,\n                data: payload,\n                time: this.lastTime,\n                target: this.sgp.getThreeObject(target),\n                graphTarget: target,\n            }\n\n            let scene = this.sgp.getCurrentScene()\n            while (this.bubbling && target.id !== scene.id && target.type !== TOTAL_OBJ_TYPES.SCENE) {\n                //console.log(\"getting behaviors for the object\",target)\n                const behaviors = this.sgp.getBehaviorsForObject(target)\n                //this.logger.log(\"firing \" + type + \" at target \" + target.id + \", \" + behaviors.length + \" behaviors\")\n\n                behaviors.forEach(b => {\n                    const system = this.getSystemFacadeFromCache(b)\n                    const asset = this.sgp.getParsedBehaviorAsset(b)\n                    system._event = evt\n                    if (asset[type]) {\n                        system.code = asset\n                        // this.logger.log(\"found message on behavior\")\n                        asset[type].call(system,evt)\n                    } else {\n                        // this.logger.log(\"didn't find message on behavior\")\n                    }\n                    system._event = null\n                })\n                target = this.sgp.getGraphObjectById(target.parent)\n            }\n        } catch (error) {\n            this.logger.error(\"error in '\" + type + \"' event\",error.message)\n            this.logger.error(error)\n            this.stopRunning()\n        }\n    }\n\n    destroyListeners() {\n        this.listeners = {}\n    }\n\n    on(target,type,cb) {\n        if(!this.listeners) this.listeners = {}\n        if(!this.listeners[target.id]) this.listeners[target.id] = {}\n        if(!this.listeners[target.id][type]) this.listeners[target.id][type] = []\n        this.listeners[target.id][type].push(cb)\n    }\n\n    getSystemFacadeFromCache(behavior) {\n        if(!this.system_cache[behavior.id]) {\n            this.system_cache[behavior.id] = new SystemFacade(this, this.sgp, behavior)\n        }\n        return this.system_cache[behavior.id]\n    }\n}\n\n\nclass AssetFacade {\n    constructor(manager,obj, trusted) {\n        this.manager = manager\n        this.obj = obj\n        this.trusted = trusted\n    }\n    play() {\n        this.manager.sgp.playMediaAsset(this.obj, this.trusted)\n    }\n    isPlaying() {\n        return this.manager.sgp.isMediaAssetPlaying(this.obj)\n    }\n    stop() {\n        this.manager.sgp.stopMediaAsset(this.obj)\n    }\n    setVolume(vol) {\n        this.manager.sgp.setMediaVolume(this.obj, vol)\n    }\n    getType() {\n        return this.obj.subtype\n    }\n}\n","import * as THREE from 'three'\n\nclass Tween {\n    constructor() {\n        this.running = false\n    }\n    update(time) {\n        throw new Error(\"update not implemented\")\n    }\n    start() {\n        this.running = true\n    }\n    isAlive() {\n        return this.running\n    }\n    kill() {\n        this.running = false\n    }\n}\n\nclass WaitTween extends Tween {\n    constructor(dur) {\n        super()\n        this.type = 'wait'\n        this.duration = dur\n    }\n    update(time) {\n        time = time/1000\n        if(!this.startTime) this.startTime = time\n        const diff = time - this.startTime\n        let t = diff/this.duration\n        if(t >= 1) {\n            this.running = false\n        }\n    }\n}\n\nclass ActionTween extends Tween {\n    constructor(fn) {\n        super()\n        this.type = 'action'\n        this.fn = fn\n    }\n    start() {\n        const res = this.fn()\n        this.running = false\n        return res\n    }\n}\n\nclass ForeverTween extends Tween {\n    constructor(fn) {\n        super()\n        this.type = 'forever'\n        this.fn = fn\n    }\n    start() {\n        this.running = true\n        this.startTime = Date.now()/1000\n    }\n    update(time) {\n        const diff = time/1000 - this.startTime\n        this.fn(diff)\n    }\n}\n\nexport const PROP_TYPES = {\n    SINGLE:'single',\n    COMPOUND:'compound',\n}\nexport const LERP_TYPES = {\n    LINEAR:'linear',\n    ELASTIC:'elastic'\n}\n\nfunction easeOutElastic(t) {\n    var p = 0.3;\n    return Math.pow(2,-10*t) * Math.sin((t-p/4)*(2*Math.PI)/p) + 1;\n}\nfunction easeLinear(from,to,t) {\n    return (to - from) * t + from\n}\nclass PropTween extends Tween {\n    constructor(opts) {\n        super()\n        this.type = 'prop'\n        this.target = opts.target\n        this.duration = opts.duration\n        if(typeof this.duration === 'undefined') throw new Error(\"duration is missing\")\n        this.property = opts.property\n        if(typeof this.property === 'undefined') throw new Error(\"property is missing\")\n        this.propertyType = opts.propertyType || PROP_TYPES.SINGLE\n        this.from = opts.from\n        this.to = opts.to\n        this.lerp_type = opts.lerpType || LERP_TYPES.LINEAR\n\n        this.loop = opts.loop\n        if(typeof this.loop === 'undefined') this.loop = 1\n        this.loopCount = 0\n        this.reversed = false\n        this.autoReverse = opts.autoReverse\n        if(typeof this.autoReverse === 'undefined') this.autoReverse = false\n    }\n    update(time) {\n        time = time/1000\n        if(!this.startTime) this.startTime = time\n        const diff = time - this.startTime\n\n        let t = diff/this.duration\n        if(t > 1.0) {\n            t = 1.0\n        }\n        this.setPropertyValue(this.from,this.to,t)\n        if(t === 1.0) {\n            this.loopCount++\n            if(this.autoReverse) {\n                this.reversed = !this.reversed\n            }\n            if(this.loop !== -1) {\n                if(this.loopCount >= this.loop) {\n                    this.running = false\n                    return\n                }\n            }\n            this.startTime = time\n        }\n    }\n\n    setPropertyValue(from,to,t,target,name) {\n        if(this.propertyType === PROP_TYPES.SINGLE) {\n            this.target[this.property] = this.lerp(this.from, this.to, this.reversed ? (1 - t) : t)\n        }\n        if(this.propertyType === PROP_TYPES.COMPOUND) {\n            Object.keys(this.from).forEach(name => {\n                this.target[this.property][name] = this.lerp(this.from[name], this.to[name], this.reversed ? (1 - t) : t)\n            })\n        }\n    }\n\n    lerp(from,to,t) {\n        if(this.lerp_type === LERP_TYPES.LINEAR)  return easeLinear(from,to,t)\n        if(this.lerp_type === LERP_TYPES.ELASTIC) return easeLinear(from,to,easeOutElastic(t))\n        console.log(\"invalid LERP_TYPE\")\n        return from\n    }\n}\n\nclass ClipTween extends Tween {\n    constructor(opts) {\n        super()\n        this.type = 'clip'\n        this.target = opts.target\n        this.name = opts.name\n        this.loop = opts.loop\n        this.autoReverse = opts.autoReverse\n        if(typeof this.autoReverse === 'undefined') this.autoReverse = false\n        if(typeof this.loop === 'undefined') this.loop = 1\n        if(typeof this.name === 'undefined') throw new Error(\"name is missing\")\n        this.speed = opts.speed\n        if(typeof this.speed === 'undefined') this.speed = 1\n    }\n    start() {\n        this.running = true\n        this.mixer = new THREE.AnimationMixer(this.target.scene)\n        this.action = this.mixer.clipAction(THREE.AnimationClip.findByName(this.target.animations,this.name))\n        if(this.loop === 1) {\n            this.action.setLoop(THREE.LoopOnce, 1)\n        }\n        if(this.loop === -1) {\n            this.action.setLoop(this.autoReverse?THREE.LoopPingPong:THREE.LoopRepeat, Infinity)\n        }\n        if(this.loop > 1) {\n            this.action.setLoop(THREE.LoopRepeat, this.loop)\n        }\n        this.action.play()\n        this.action.setEffectiveTimeScale(this.speed)\n        this.startTime = Date.now()/1000\n        this.prevTime = this.startTime\n    }\n    update(time) {\n        const diff = time/1000 - this.prevTime\n        this.mixer.update(diff)\n        this.prevTime = time/1000\n    }\n    kill() {\n        this.action.stop()\n        this.running = false\n    }\n}\n\nclass ParallelTween extends Tween {\n    constructor() {\n        super()\n        this.subs = []\n    }\n    and(obj) {\n        if(obj instanceof Tween) {\n            this.subs.push(obj)\n        } else {\n            this.subs.push(new ActionTween(obj))\n        }\n        return this\n    }\n    start() {\n        // console.log(\"starting parallel\")\n        this.running = true\n        this.subs.forEach(s=>s.start())\n        // console.log('started')\n        // console.log(this.subs)\n        return this\n    }\n    update(time) {\n        this.subs.forEach(s => {\n            if(s.isAlive()) s.update(time)\n        })\n    }\n    isAlive() {\n        const first = this.subs.find(s => s.isAlive() === true)\n        // console.log(\"first alive is\",first)\n        return first !== undefined\n    }\n}\n\nclass SequentialTween extends Tween {\n    constructor() {\n        super()\n        this.subs = []\n        this.n = -1\n    }\n    then(obj) {\n        if(obj instanceof Tween) {\n            this.subs.push(obj)\n        } else {\n            this.subs.push(new ActionTween(obj))\n        }\n        return this\n    }\n    wait(dur) {\n        this.subs.push(new WaitTween(dur))\n        return this\n    }\n    start() {\n        this.running = true\n        this._startNext()\n        return this\n    }\n    _startNext() {\n        this.n = this.n + 1\n\n        //if at the end of everything\n        if(this.n > this.subs.length-1) {\n            this.running = false\n            this.n = -1\n            return null\n        }\n\n\n        const cur = this.subs[this.n]\n        const res = cur.start()\n        if(!cur.isAlive()) {\n            if(res) {\n                console.log(\"the next swapped itself\", res)\n                //swap in the result\n                this.subs[this.n] = res\n                //backup\n                this.n = this.n -1\n                //recurse\n                return this._startNext()\n            } else {\n                // console.log(\"the next didn't swap. just move on\")\n                return this._startNext()\n            }\n        }\n        return cur\n    }\n    update(time) {\n        // console.log('updating')\n        const cur = this.subs[this.n]\n        cur.update(time)\n        // console.log(\"updated cur\",cur, cur.isAlive())\n        if(!cur.isAlive()) this._startNext()\n\n    }\n    isAlive() {\n        const first = this.subs.find(s => s.isAlive() === true)\n        // console.log(\"first alive is\",first)\n        // console.log(this.subs)\n        return first !== undefined\n    }\n}\n\nexport class TweenManager {\n    constructor() {\n        this.subs = []\n    }\n    parallel() {\n        const t = new ParallelTween()\n        this.subs.push(t)\n        return t\n    }\n    sequence() {\n        const t =  new SequentialTween()\n        this.subs.push(t)\n        return t\n    }\n    action(fn) {\n        const t = new ActionTween(fn)\n        this.subs.push(t)\n        return t\n    }\n    prop(opts) {\n        const t = new PropTween(opts)\n        this.subs.push(t)\n        return t\n    }\n    isAlive() {\n        return this.subs.find((s => s.isAlive() === true))\n    }\n    update(time) {\n        const now = Date.now()\n        this.subs.forEach(s => {\n            if(s.isAlive()) s.update(now)\n        })\n    }\n    forever(fn) {\n        const t = new ForeverTween(fn)\n        this.subs.push(t)\n        return t\n    }\n    clip(opts) {\n        const t = new ClipTween(opts)\n        this.subs.push(t)\n        return t\n    }\n    wait(dur) {\n        const t = new WaitTween(dur)\n        this.subs.push(t)\n        return t\n    }\n}\n\n/*\n\nconst obj = { x: -1, y: -1, z: 0, w: 0}\n\nconst para = t2.parallel()\n    .and(t2.prop({ target:obj, property:'x', from:10, to:0, duration: 1}))\n    .and(()=>console.log(\"inside the parallel action\"))\n    .start()\n\nconst seq = t2.sequence()\n    .then(()=>console.log(\"first is an action\"))\n    .then(t2.prop({ target:obj, property:'y', from:10, to:0, duration: 1}))\n    .then(()=> console.log(\"inside the sequential action\"))\n    .then(t2.prop({target:obj, property:'y', from:0, to:10, duration:1 }))\n    .then(()=>{\n        console.log(\"done with part 1. calculating part 2\")\n        return t2.prop({target:obj, property:'x', from: 0, to:-8, duration:1})\n    })\n    .then(() => {\n        console.log(\"now we're going to insert a new parallel tween\")\n        return t2.parallel()\n            .and(t2.prop({target:obj, property:'z', from:-1,to:1, duration:1}))\n            .and(t2.prop({target:obj, property:'w', from:-1,to:1, duration:1}))\n    })\n    .start()\n\nfunction update() {\n    console.log(\"tick\")\n    t2.update()\n    console.log(obj)\n    if(t2.isAlive()) {\n        setTimeout(update,250)\n    } else {\n        console.log(\"done with everything. check it out!\")\n        console.log(obj.z === 1)\n    }\n}\nupdate()\n*/\n","import {toFlatString} from '../utils'\nimport * as ToasterManager from './ToasterManager'\nimport {mat4, vec3} from \"gl-matrix/dist/gl-matrix.js\"\n\nlet Cesium = window.Cesium\nlet XRGeospatialAnchor = window.XRGeospatialAnchor\n\n\nexport class XRSupport {\n    constructor() {\n        this.imageDetectorMap = {}\n        this.geoAnchorMap = {}\n        this._workingMatrix = mat4.create()\n        this._identity = mat4.create()\n        this._vec = vec3.create()\n        this.lastFrameTime = 0        \n        this.heightAboveFloor = 1.1; // for now\n    }\n    static supportsARKit() {\n        if (navigator.xr && navigator.xr._mozillaXRViewer) {\n            console.log(\"*** Found mozilla xr viewer\")\n            return true\n        }\n        console.log(\"*** Did not find WebXR\")\n        return false\n    }\n\n    getContext(canvas = 0) {\n        this.device = 0\n        this.session = 0\n        this.xrCanvas = 0\n        this.xrContext = 0\n        this.canvas = canvas\n        this.context = 0\n        this.xrCanvas = document.createElement('canvas')\n        this.xrContext = this.xrCanvas.getContext('xrpresent')\n        this._anchoredNodes = new Map() // { XRAnchorOffset, Three.js Object3D }\n        this.projectionMatrix = 0\n\n        let that = this\n        let prom = new Promise((resolve, reject) => {\n            // document.body.insertBefore(this.xrCanvas, document.body.firstChild) <- not needed?\n            navigator.xr.requestDevice().then((xrDevice) => {\n                that.device = xrDevice\n                that.device.requestSession({\n                    outputContext: that.xrContext,\n                    alignEUS: true,\n                    geolocation: true,\n                    worldSensing: true\n                }).then((xrSession) => {\n                    that.session = xrSession\n\n                    // we want to always use the estimated elevation\n                    XRGeospatialAnchor.useEstimatedElevation(true, this.heightAboveFloor)\n                    this.updateGeoElevationLoop()\n\n                    // enable smooth tracking of image targets\n                    that.session.nonStandard_setNumberOfTrackedImages(4)\n\n                    if (!that.canvas) that.canvas = document.createElement('canvas')\n                    if (!that.context) that.context = that.canvas.getContext('webgl', {compatibleXRDevice: that.device})\n                    that.session.baseLayer = new window.XRWebGLLayer(that.session, that.context)\n                    resolve(that.context)\n                }).catch(err => {\n                    console.error('Session setup error', err)\n                    reject()\n                })\n            }).catch(err => {\n                console.error('Error', err)\n                reject()\n            })\n        })\n        return prom\n    }\n\n    async updateGeoElevationLoop () {\n        let sleep = function (time) {\n            return new Promise((resolve) => setTimeout(resolve, time));\n        }\n    \n        //let deviceCarto = await XRGeospatialAnchor.getDeviceCartographic()\n        //let txt = textBox.myText + \"<p>device altitude \" + deviceCarto.height.toPrecision(6) + \"</p>\" \n        //let defElev = await XRGeospatialAnchor.getDefaultElevation(deviceCarto)\n        //txt = txt + textBox.myText + \"<p>estimated altitude \" + defElev.toPrecision(6) + \"</p>\"\n        //textBox.innerHTML = txt \n\n        await XRGeospatialAnchor.useEstimatedElevation(true, this.heightAboveFloor)\n\n        await sleep(100)\n        setTimeout(() => this.updateGeoElevationLoop(), 1)\n    }\n\n    setAnimationLoop(userAnimationCallback) {\n\n        if (!userAnimationCallback) {\n            console.error(\"Supply a callback\")\n            return\n        }\n\n        // head-model is the coordinate system that tracks the position of the display\n        this.session.requestFrameOfReference('head-model').then(frameOfReference => {\n            this.headFrameOfReference = frameOfReference\n        }).catch(err => {\n            console.error('Error finding head frame of reference', err)\n        })\n\n        // get eye level which is somehow different from head level?\n        this.session.requestFrameOfReference('eye-level').then(frameOfReference => {\n            this.eyeLevelFrameOfReference = frameOfReference\n        }).catch(err => {\n            console.error('Error finding eye frame of reference', err)\n        })\n\n        // setup callback\n        this.userAnimationCallback = userAnimationCallback\n        this.__handleAnimationFrame = this._handleAnimationFrame.bind(this)\n        this.session.requestAnimationFrame(this.__handleAnimationFrame)\n    }\n\n    _handleAnimationFrame(time = 0, frame = 0) {\n        this.lastFrameTime = time\n        if (!this.session || this.session.ended) return\n\n        this.session.requestAnimationFrame(this.__handleAnimationFrame)\n\n        if (!this.headFrameOfReference || !this.eyeLevelFrameOfReference) return\n\n        let pose = frame.getDevicePose(this.eyeLevelFrameOfReference)\n        if (!pose) {\n            console.log('No pose')\n            return\n        }\n\n        for (let view of frame.views) {\n            // let higher level update itself\n            this.userAnimationCallback(\n                this.session.baseLayer.getViewport(view),\n                view.projectionMatrix,\n                pose.getViewMatrix(view),\n                time,frame,\n            )\n            this.projectionMatrix = view.projectionMatrix\n            break\n        }\n    }\n\n    getTime() { return this.lastFrameTime }\n\n    addAnchoredNode(anchor, node, logger) {\n        if (!anchor || !anchor.uid) {\n            console.error(\"not a valid anchor\", anchor)\n            logger.error(`not a valid anchor ${toFlatString(anchor)}`)\n            return\n        }\n        this._anchoredNodes.set(anchor.uid, {\n            anchor: anchor,\n            node: node\n        })\n        node.anchor = anchor\n        node.matrixAutoUpdate = false\n        node.matrix.fromArray(anchor.modelMatrix)\n        node.updateMatrixWorld(true)\n        //this._scene.add(node) -> presumably this is already done\n\n        anchor._handleAnchorUpdateCallback = this._handleAnchorUpdate.bind(this, logger)\n        anchor._handleAnchorDeleteCallback = this._handleAnchorDelete.bind(this, logger)\n\n        anchor.addEventListener(\"update\", anchor._handleAnchorUpdateCallback)\n        anchor.addEventListener(\"removed\", anchor._handleAnchorDeleteCallback)\n        logger.log(\"done adding anchored node\")\n        return node\n    }\n\n    async createSceneAnchor(sceneNode, logger) {\n        logger.log(\"Creating Scene Anchor\")\n\n        if (!this.session) {\n            logger.log(\"no session\")\n            return\n        }\n        let eyeLevel = await this.session.requestFrameOfReference('eye-level')\n        let headLevel = await this.session.requestFrameOfReference('head-model')\n\n        // get the pose of the camera in the world\n        headLevel.getTransformTo(eyeLevel, this._workingMatrix)\n\n        // get just the position\n        mat4.getTranslation(this._vec, this._workingMatrix) \n\n        // set the matrix to just the position, which means the orientation is EUS\n        mat4.fromTranslation(this._workingMatrix, this._vec)\n\n        // create that anchor\n        let newAnchor = await this.session.addAnchor(this._workingMatrix, eyeLevel)\n\n        this.addAnchoredNode(newAnchor, sceneNode, logger)\n        return newAnchor\n    }\n\n    updateAnchoredSceneNode(sceneAnchor, sceneNode, logger) {\n        logger.log(\"Replacing the scene node on the existing scene anchor\")\n        this._removeAnchorFromNode(sceneAnchor)\n        this.addAnchoredNode(sceneAnchor, sceneNode, logger)\n    }\n\n    removeSceneAnchor(sceneAnchor, logger) {\n        logger.log(\"Removing Scene Anchor\")\n        this.session.removeAnchor(sceneAnchor)\n        this._removeAnchorFromNode(sceneAnchor)\n    }\n\n    updateRayAnchor(info,logger) {\n\n        if(!this.projectionMatrix) {\n            logger.error(\"No projection matrix\")\n            return\n        }\n        if(!this.canvas || !this.canvas.width || !this.canvas.height) {\n            logger.error(\"No canvas or canvas size\")\n            return\n        }\n\n        // normalize screen coords\n        let x = this.screenx || 0\n        let y = this.screeny || 0\n        let normalizedX = x / this.canvas.width * 2 - 1;\n        let normalizedY = y / this.canvas.height * 2;\n\n        // get a ray\n        var rayorigin = vec3.create();\n        mat4.invert(this._workingMatrix, this.projectionMatrix );\n        var raydir = vec3.fromValues(normalizedX, normalizedY, 0.5);\n        vec3.transformMat4(raydir,raydir,this._workingMatrix);\n        vec3.normalize(raydir, raydir);\n\n        this.session.requestFrameOfReference('head-model').then((headLevel)=>{\n            this.session.requestFrameOfReference('eye-level').then((eyeLevel)=>{\n\n                // get collidants\n                this.session.requestHitTest(rayorigin, raydir, headLevel ).then((xrhitresults)=>{\n\n                    if (xrhitresults.length < 1) {\n                        logger.error(\"No hit returned from hit test\")\n                        return\n                    }\n\n                    this.session.addAnchor(xrhitresults[0], headLevel ).then((newAnchor)=> {\n\n                        // remove previous if any\n                        this._removeAnchorForNode(info.node)\n                 \n                        // add new\n                        this.addAnchoredNode(newAnchor,info.node,logger)\n\n                        logger.log(\"made anchor in local coords: \" + info.node.position.x + \" \" + info.node.position.y + \" \" + info.node.position.z )\n                    })\n                })\n            })\n        })\n    }\n\n    updatePointAnchor(info,logger) {\n\n        let point = info.point\n\n        this.session.requestFrameOfReference('head-model').then((headLevel)=>{\n            this.session.requestFrameOfReference('eye-level').then((eyeLevel)=>{\n                headLevel.getTransformTo(eyeLevel, this._workingMatrix)\n                mat4.fromTranslation(this._workingMatrix,point)\n\nlogger.log(this._workingMatrix)\n\n                this.session.addAnchor(this._workingMatrix,eyeLevel).then((newAnchor)=>{\n                    // remove previous if any\n                    this._removeAnchorForNode(info.node)\n             \n                    // add new\n                    this.addAnchoredNode(newAnchor,info.node,logger)\n\n                    // done\n                    logger.log(\"updated anchor in local coords: \" + info.node.position.x + \" \" + info.node.position.y + \" \" + info.node.position.z )\n                    logger.log(point)\n                })\n            })\n        })\n    }\n\n    stopAnchor(info, logger) {\n        console.log(\"Stopping anchor of various flavors\")\n        if(!this._anchoredNodes) return\n        if (!info.node) {\n            logger.error(\"missing threejs node\")\n            return\n        }\n        this._removeAnchorFromNode(info.node)\n    }\n\n    sleeper(time) {\n        return new Promise((resolve) => setTimeout(resolve, time))\n    }\n\n    _fetchImage(info,logger) {\n        return new Promise((res,rej) => {\n            const img = new Image()\n            img.crossOrigin = \"Anonymous\"\n            img.src = info.image.src\n            logger.log(\"Loading image\",img.src)\n            img.onload = () => {\n                res(img)\n            }\n        })\n    }\n\n    createDetectionImage(info, logger) {\n        logger.log(\"creating/find an image recognizer\")\n        return new Promise((res,rej) => {            \n            if (!info.image || !info.node) {\n                logger.log(\"createDetectionImage: missing image or threejs node\")\n                rej(\"createDetectionImage: missing image or threejs node\")\n                return\n            }\n\n            if (!this.session) {\n                logger.log(\"no session\")\n                rej(\"no session\")\n                return\n            }\n\n            let imageRealworldWidth = info.imageRealworldWidth || 1\n\n            if (this.imageDetectorMap[info.image.src]) {\n                let det = this.imageDetectorMap[info.image.src]\n                if (imageRealworldWidth !== det.realWorldWidth) {\n                    logger.log(\"can't create the same image with different real world width\")\n                    rej(\"can't create the same image with different real world width\")\n                    return\n                }\n                logger.log(\"createDetectionImage: already created, returning it\")\n                res(det.name)\n                return\n            }\n\n            this._fetchImage(info,logger).then(image => {\n                logger.log(\"got the image\",toFlatString(image))\n    \n                //info contains\n                // * callback: to call when the image is found\n                // * image: info about the image to recognize. src is at image.src\n                // * imageRealworldWidth: width of the image in meters\n                // * object: the anchor object\n                // * node: the ThreeJS group which represents the anchor. It should be updated as the scene changes\n                // * recType: current set to SCENE_START, meaning we should recognize as soon as the scene starts up\n    \n        \n                // random name from https://gist.github.com/6174/6062387\n                let name = [...Array(10)].map(i => (~~(Math.random() * 36)).toString(36)).join('')\n        \n                // Get ImageData\n                let canvas = document.createElement('canvas')\n                let context = canvas.getContext('2d')\n                canvas.width = image.width\n                canvas.height = image.height\n        \n                context.drawImage(image, 0, 0)\n                let idata\n                try {\n                    idata = context.getImageData(0, 0, image.width, image.height)\n                } catch (e) {\n                    logger.log(`error drawing image ${toFlatString(e)}`)\n                    logger.log(`name ${e.name}`)\n                    logger.log(`name ${e.message}`)\n                    logger.log(\"local url is \" + document.documentURI)\n                    logger.log(\"image url from \" + image.src)\n                    ToasterManager.add(\"error drawing image\", e.toString())\n                    rej( new Error(\"foo\"))\n                }\n                logger.log(`calling createDetectionImage with image width and height ${image.width} ${image.height}`)\n        \n                // Attach image observer handler\n                this.session.nonStandard_createDetectionImage(name, idata.data, image.width, image.height, imageRealworldWidth).then(() => {\n                    this.imageDetectorMap[info.image.src] = {\n                        name: name,\n                        realWorldWidth: imageRealworldWidth,\n                        anchor: null\n                    }\n                    res(name)\n                }).catch(error => {\n                    logger.error(`error creating detection image: ${error}`)\n                    rej(error)\n                })\n            }).catch(error => {\n                logger.error(`error creating detection image: ${error}`)\n                rej(error)\n            })\n        })\n    }\n\n    startImageRecognizer(info, name, logger) {\n        logger.log(\"starting Image Recognizer\")\n\n        if (!info.image || !info.node) {\n            logger.log(\"missing image or threejs node\")\n            return\n        }\n\n        if (!this.session) {\n            logger.log(\"no session\")\n            return\n        }\n\n        //info contains\n        // * callback: to call when the image is found\n        // * image: info about the image to recognize. src is at image.src\n        // * imageRealworldWidth: width of the image in meters\n        // * object: the anchor object\n        // * node: the ThreeJS group which represents the anchor. It should be updated as the scene changes\n        // * recType: current set to SCENE_START, meaning we should recognize as soon as the scene starts up\n\n        let callback = info.callback\n\n        let node = info.node\n        //let recType = 0 // unused. currently set to SCENE_START -> meaning we should recognize as soon as the scene starts up\n\n        if (!this.imageDetectorMap[info.image.src]) {\n            logger.error(\"not detection object for image\", info.image.src)\n            return\n        }\n\n        let det = this.imageDetectorMap[info.image.src]\n\n        // there is already an anchor tracking this image, either from this\n        // scene or another\n        if (det.anchor) {\n            if (info.reactivate) {\n                logger.log(\"Found existing anchor: reactivate\")\n                // we want to reactivate.  So destroy the anchor, remove it from\n                // the node it was tracking, and continue below to reactivate\n                this.session.removeAnchor(det.anchor)\n                logger.log(\"remove from previous node\")\n                this._removeAnchorFromNode(det.anchor)\n                det.anchor = null\n            } else {\n                logger.log(\"Found existing anchor: use it\")\n                // we want to reuse, likely from some previous scene.\n                // So, remove the relationship to whatever node is in the \n                // anchor map, and reset it to this node.   \n                logger.log(\"remove from previous node\")\n                this._removeAnchorFromNode(det.anchor)\n                logger.log(\"add our node\")\n                this.addAnchoredNode(det.anchor, node, logger)\n                if (callback) {\n                    callback(info)\n                }\n                return\n            }\n        } \n\n        node.anchorName = null\n        logger.log(\"activate detection image\")\n        this.session.nonStandard_activateDetectionImage(det.name).then(anchor => {\n            logger.log(\"found detection image\")\n            // this gets invoked after the image is seen for the first time\n            node.anchorName = name\n            node.anchorStyle = \"image\"\n            this.addAnchoredNode(anchor, node, logger)\n            if (callback) {\n                callback(info)\n            }\n        }).catch(error => {\n            logger.error(`error activating detection image: ${error}`)\n        })\n    }\n\n    stopImageRecognizer(info, logger) {\n        console.log(\"Stopping image recognizer\")\n        if(!this._anchoredNodes) return\n\n        if (!this.imageDetectorMap[info.image.src]) {\n            logger.error(\"no detection object for image\", info.image.src)\n            return\n        }\n\n        let det = this.imageDetectorMap[info.image.src]\n\n        if (det.anchor) {\n            console.log(\"already found the image, removing it\")\n            this._removeAnchorFromNode(det.anchor)\n            det.anchor = null\n        }\n\n        console.log(\"deactivating the image\")\n        this.session.nonStandard_deactivateDetectionImage(det.name).then(() => {\n        }).catch(error => {\n            logger.error(`error deactivating detection image: ${error}`)\n        })\n    }\n\n\n    createGeoAnchor(info, logger) {        \n        logger.log(\"creating or reusing a geospatial anchor\")\n        return new Promise((res,rej) => {            \n            if (!info.node) {\n                logger.log(\"Missing threejs node\")\n                rej(\"Missing threejs node\")\n                return\n            }\n\n            if (!info.location || !info.location.id) {\n                logger.log(\"User must attach a geo location first\")\n                rej(\"Missing geo location\")\n                return\n            }\n\n            if (!this.session) {\n                logger.log(\"no session\")\n                rej(\"no session\")\n                return\n            }\n\n            if (this.geoAnchorMap[info.location.id]) {\n                //let det = this.geoAnchorMap[info.location.id]\n                logger.log(\"found geoanchor: already created, returning it\")\n                res()\n                return\n            }\n\n            /*\n            info contains\n            location:  a geo location asset, has properties for latitude, longitude, altitude, useAltitude\n            recType: the recognition type. for now always SCENE_START\n            object: the anchor object. It reresents the anchor in the 3D scene. has tx,ty,tz, rotation, etc.\n            node: the actual ThreeJS object that mirrors the propertites of the `object` above\n            callback: a function to be called once the geo anchor is recognized. By default this callback will fire a 'recognized' event and make the anchor visible in the scene\n            */\n\n            let location = info.location\n            //let object = info.object // object that represents anchor variables that users can edit in general-editor\n            //let node = info.node\n            //let recType = 0 // unused. currently set to SCENE_START -> meaning we should recognize as soon as the scene starts up\n\n            // As a slight hack, look for any non zero value in latitude or longitude as a hint to not use your current location\n\n            // these values are 0 by default, we need to change at least one of them by a bit!\n            if (location.latitude !== 0 || location.longitude !== 0) {\n                // use supplied altitude?\n\n                let lla = new Cesium.Cartographic(location.longitude * Math.PI / 180, location.latitude * Math.PI / 180, location.altitude)\n\n                if (location.useAltitude) {\n                    logger.log(\"XRGeoAnchor: Placing an object at specified lla and specified altitude\")\n                    logger.log(toFlatString(lla))\n                    XRGeospatialAnchor.createGeoAnchor(lla).then(anchor => {\n                        this.geoAnchorMap[info.location.id] = {\n                            anchor: anchor\n                        }\n                        res()\n                        return;\n                    }).catch(error => {\n                        logger.error(`error creating geospatial anchor: ${error}`)\n                        rej(error)\n                    })\n                } else {\n                    XRGeospatialAnchor.getDefaultElevation(lla).then(altitude => {\n                        lla.height = altitude\n                        logger.log(\"XRGeoAnchor: Placing an object at specified lla and estimated altitude\")\n                        logger.log(toFlatString(lla))\n                        XRGeospatialAnchor.createGeoAnchor(lla).then(anchor => {\n                            this.geoAnchorMap[info.location.id] = {\n                                anchor: anchor\n                            }\n                            res()\n                            return;\n                        }).catch(error => {\n                            logger.error(`error creating geospatial anchor: ${error}`)\n                            rej(error)\n                        })\n                    }).catch(error => {\n                        logger.error(`error getting default elevation: ${error}`)\n                        rej(error)\n                    })\n                }\n            }\n\n            // else find current position and altitude\n            else {\n                XRGeospatialAnchor.getDeviceCartographic().then(cartographic => {\n                    // probably don't need to explicitly do this, but to be safe ...\n                    XRGeospatialAnchor.getDefaultElevation().then(altitude => {\n                        let lla = new Cesium.Cartographic(cartographic.longitude, cartographic.latitude, altitude)\n                        logger.log(\"XRGeoAnchor: Placing an object at your lla\")\n                        logger.log(toFlatString(lla))\n                        XRGeospatialAnchor.createGeoAnchor(lla).then(anchor => {\n                            this.geoAnchorMap[info.location.id] = {\n                                anchor: anchor\n                            }\n                            res()\n                            return;\n                        }).catch(error => {\n                            logger.error(`error creating geospatial anchor: ${error}`)\n                            rej(error)\n                        })\n                    }).catch(error => {\n                        logger.error(`error getting default elevation: ${error}`)\n                        rej(error)\n                    })\n                }).catch(error => {\n                    logger.error(`error getting device cartographic location: ${error}`)\n                    rej(error)\n                })\n            }\n        })\n    }\n\n\n    addGeoAnchoredNode(info, logger) {\n        logger.log(\"adding a geotracked node\")\n\n        if (!info.node) {\n            logger.log(\"Missing threejs node\")\n            return\n        }\n\n        if (!this.session) {\n            logger.log(\"no session\")\n            return\n        }\n\n        if (!this.geoAnchorMap[info.location.id]) {\n            logger.error(\"not geolocation anchor for object\", info.location.id)\n            return\n        }\n\n        let det = this.geoAnchorMap[info.location.id]\n\n        /*\n        info contains\n         location:  a geo location asset, has properties for latitude, longitude, altitude, useAltitude\n         recType: the recognition type. for now always SCENE_START\n         object: the anchor object. It reresents the anchor in the 3D scene. has tx,ty,tz, rotation, etc.\n         node: the actual ThreeJS object that mirrors the propertites of the `object` above\n         callback: a function to be called once the geo anchor is recognized. By default this callback will fire a 'recognized' event and make the anchor visible in the scene\n         */\n\n        let callback = info.callback\n        let node = info.node\n        //let recType = 0 // unused. currently set to SCENE_START -> meaning we should recognize as soon as the scene starts up\n\n\n        this._removeAnchorFromNode(det.anchor)\n        logger.log(\"add our node\")\n        this.addAnchoredNode(det.anchor, node, logger)\n        if (callback) {\n            callback(info)\n        }\n    }\n\n    /// BLAIR:  Need a way to destroy geo Anchors!\n    stopGeoTracker(info, logger) {\n        // info.node may be destroyed before we get here\n        if (info && info.node) {\n            this._removeAnchorForNode(info.node)\n        }\n    }\n\n    _handleAnchorDelete(logger, details) {\n        logger.log(\"delete anchor\")\n        let anchor = details.source\n        this._removeAnchorFromNode(anchor)\n    }\n\n    _removeAnchorForNode(node) {\n        this._anchoredNodes.forEach( (value) => {\n            if(value.node === node) {\n                this._removeAnchorFromNode(node.anchor)\n            }\n        })\n    }\n\n    _removeAnchorFromNode(anchor) {\n        const anchoredNode = this._anchoredNodes.get(anchor.uid)\n        if (anchoredNode) {\n            const node = anchoredNode.node\n            node.anchor = null\n\n            anchor.removeEventListener(\"update\", anchor._handleAnchorUpdateCallback)\n            anchor.removeEventListener(\"removed\", anchor._handleAnchorDeleteCallback)\n            anchor._handleAnchorUpdateCallback = null\n            anchor._handleAnchorDeleteCallback = null\n\n            this._anchoredNodes.delete(anchor.uid)\n        }\n    }\n\n    _handleAnchorUpdate(logger, details) {\n        const anchor = details.source\n        const anchoredNode = this._anchoredNodes.get(anchor.uid)\n        if (anchoredNode) {\n            const node = anchoredNode.node\n            node.matrixAutoUpdate = false\n            node.matrix.fromArray(anchor.modelMatrix)\n            node.updateMatrixWorld(true)\n        }\n    }\n}","const THREE = require('three');//requireimport * as THREE from 'three'\n\n/**\n * @author qiao / https://github.com/qiao\n * @author mrdoob / http://mrdoob.com\n * @author alteredq / http://alteredqualia.com/\n * @author WestLangley / http://github.com/WestLangley\n * @author erich666 / http://erichaines.com\n */\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one finger move\n//    Zoom - middle mouse, or mousewheel / touch: two finger spread or squish\n//    Pan - right mouse, or arrow keys / touch: three finger swipe\n\nconst OrbitControls = function ( object, domElement ) {\n\n    this.object = object;\n\n    this.domElement = ( domElement !== undefined ) ? domElement : document;\n\n    // Set to false to disable this control\n    this.enabled = true;\n\n    // \"target\" sets the location of focus, where the object orbits around\n    this.target = new THREE.Vector3();\n\n    // How far you can dolly in and out ( PerspectiveCamera only )\n    this.minDistance = 0;\n    this.maxDistance = Infinity;\n\n    // How far you can zoom in and out ( OrthographicCamera only )\n    this.minZoom = 0;\n    this.maxZoom = Infinity;\n\n    // How far you can orbit vertically, upper and lower limits.\n    // Range is 0 to Math.PI radians.\n    this.minPolarAngle = 0; // radians\n    this.maxPolarAngle = Math.PI; // radians\n\n    // How far you can orbit horizontally, upper and lower limits.\n    // If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\n    this.minAzimuthAngle = - Infinity; // radians\n    this.maxAzimuthAngle = Infinity; // radians\n\n    // Set to true to enable damping (inertia)\n    // If damping is enabled, you must call controls.update() in your animation loop\n    this.enableDamping = false;\n    this.dampingFactor = 0.25;\n\n    // This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n    // Set to false to disable zooming\n    this.enableZoom = true;\n    this.zoomSpeed = 1.0;\n\n    // Set to false to disable rotating\n    this.enableRotate = true;\n    this.rotateSpeed = 1.0;\n\n    // Set to false to disable panning\n    this.enablePan = true;\n    this.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n    // Set to true to automatically rotate around the target\n    // If auto-rotate is enabled, you must call controls.update() in your animation loop\n    this.autoRotate = false;\n    this.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n    // Set to false to disable use of the keys\n    this.enableKeys = true;\n\n    // The four arrow keys\n    this.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n    // Mouse buttons\n    this.mouseButtons = { ORBIT: THREE.MOUSE.LEFT, ZOOM: THREE.MOUSE.MIDDLE, PAN: THREE.MOUSE.RIGHT };\n\n    // for reset\n    this.target0 = this.target.clone();\n    this.position0 = this.object.position.clone();\n    this.zoom0 = this.object.zoom;\n\n    //\n    // public methods\n    //\n\n    this.getPolarAngle = function () {\n\n        return spherical.phi;\n\n    };\n\n    this.getAzimuthalAngle = function () {\n\n        return spherical.theta;\n\n    };\n\n    this.saveState = function () {\n\n        scope.target0.copy( scope.target );\n        scope.position0.copy( scope.object.position );\n        scope.zoom0 = scope.object.zoom;\n\n    };\n\n    this.reset = function () {\n\n        scope.target.copy( scope.target0 );\n        scope.object.position.copy( scope.position0 );\n        scope.object.zoom = scope.zoom0;\n\n        scope.object.updateProjectionMatrix();\n        scope.dispatchEvent( changeEvent );\n\n        scope.update();\n\n        state = STATE.NONE;\n\n    };\n\n    // this method is exposed, but perhaps it would be better if we can make it private...\n    this.update = function () {\n\n        var offset = new THREE.Vector3();\n\n        // so camera.up is the orbit axis\n        var quat = new THREE.Quaternion().setFromUnitVectors( object.up, new THREE.Vector3( 0, 1, 0 ) );\n        var quatInverse = quat.clone().inverse();\n\n        var lastPosition = new THREE.Vector3();\n        var lastQuaternion = new THREE.Quaternion();\n\n        return function update() {\n\n            var position = scope.object.position;\n\n            offset.copy( position ).sub( scope.target );\n\n            // rotate offset to \"y-axis-is-up\" space\n            offset.applyQuaternion( quat );\n\n            // angle from z-axis around y-axis\n            spherical.setFromVector3( offset );\n\n            if ( scope.autoRotate && state === STATE.NONE ) {\n\n                rotateLeft( getAutoRotationAngle() );\n\n            }\n\n            spherical.theta += sphericalDelta.theta;\n            spherical.phi += sphericalDelta.phi;\n\n            // restrict theta to be between desired limits\n            spherical.theta = Math.max( scope.minAzimuthAngle, Math.min( scope.maxAzimuthAngle, spherical.theta ) );\n\n            // restrict phi to be between desired limits\n            spherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\n\n            spherical.makeSafe();\n\n\n            spherical.radius *= scale;\n\n            // restrict radius to be between desired limits\n            spherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\n\n            // move target to panned location\n            scope.target.add( panOffset );\n\n            offset.setFromSpherical( spherical );\n\n            // rotate offset back to \"camera-up-vector-is-up\" space\n            offset.applyQuaternion( quatInverse );\n\n            position.copy( scope.target ).add( offset );\n\n            scope.object.lookAt( scope.target );\n\n            if ( scope.enableDamping === true ) {\n\n                sphericalDelta.theta *= ( 1 - scope.dampingFactor );\n                sphericalDelta.phi *= ( 1 - scope.dampingFactor );\n\n            } else {\n\n                sphericalDelta.set( 0, 0, 0 );\n\n            }\n\n            scale = 1;\n            panOffset.set( 0, 0, 0 );\n\n            // update condition is:\n            // min(camera displacement, camera rotation in radians)^2 > EPS\n            // using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n            if ( zoomChanged ||\n                lastPosition.distanceToSquared( scope.object.position ) > EPS ||\n                8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\n\n                scope.dispatchEvent( changeEvent );\n                lastPosition.copy( scope.object.position );\n                lastQuaternion.copy( scope.object.quaternion );\n                zoomChanged = false;\n\n                return true;\n\n            }\n\n            return false;\n\n        };\n\n    }();\n\n    this.dispose = function () {\n\n        scope.domElement.removeEventListener( 'contextmenu', onContextMenu, false );\n        scope.domElement.removeEventListener( 'mousedown', onMouseDown, false );\n        scope.domElement.removeEventListener( 'wheel', onMouseWheel, false );\n\n        scope.domElement.removeEventListener( 'touchstart', onTouchStart, false );\n        scope.domElement.removeEventListener( 'touchend', onTouchEnd, false );\n        scope.domElement.removeEventListener( 'touchmove', onTouchMove, false );\n\n        document.removeEventListener( 'mousemove', onMouseMove, false );\n        document.removeEventListener( 'mouseup', onMouseUp, false );\n\n        window.removeEventListener( 'keydown', onKeyDown, false );\n\n        //scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\n    };\n\n    //\n    // internals\n    //\n\n    var scope = this;\n\n    var changeEvent = { type: 'change' };\n    var startEvent = { type: 'start' };\n    var endEvent = { type: 'end' };\n\n    var STATE = { NONE: - 1, ROTATE: 0, DOLLY: 1, PAN: 2, TOUCH_ROTATE: 3, TOUCH_DOLLY: 4, TOUCH_PAN: 5 };\n\n    var state = STATE.NONE;\n\n    var EPS = 0.000001;\n\n    // current position in spherical coordinates\n    var spherical = new THREE.Spherical();\n    var sphericalDelta = new THREE.Spherical();\n\n    var scale = 1;\n    var panOffset = new THREE.Vector3();\n    var zoomChanged = false;\n\n    var rotateStart = new THREE.Vector2();\n    var rotateEnd = new THREE.Vector2();\n    var rotateDelta = new THREE.Vector2();\n\n    var panStart = new THREE.Vector2();\n    var panEnd = new THREE.Vector2();\n    var panDelta = new THREE.Vector2();\n\n    var dollyStart = new THREE.Vector2();\n    var dollyEnd = new THREE.Vector2();\n    var dollyDelta = new THREE.Vector2();\n\n    function getAutoRotationAngle() {\n\n        return 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n    }\n\n    function getZoomScale() {\n\n        return Math.pow( 0.95, scope.zoomSpeed );\n\n    }\n\n    function rotateLeft( angle ) {\n\n        sphericalDelta.theta -= angle;\n\n    }\n\n    function rotateUp( angle ) {\n\n        sphericalDelta.phi -= angle;\n\n    }\n\n    var panLeft = function () {\n\n        var v = new THREE.Vector3();\n\n        return function panLeft( distance, objectMatrix ) {\n\n            v.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n            v.multiplyScalar( - distance );\n\n            panOffset.add( v );\n\n        };\n\n    }();\n\n    var panUp = function () {\n\n        var v = new THREE.Vector3();\n\n        return function panUp( distance, objectMatrix ) {\n\n            v.setFromMatrixColumn( objectMatrix, 1 ); // get Y column of objectMatrix\n            v.multiplyScalar( distance );\n\n            panOffset.add( v );\n\n        };\n\n    }();\n\n    // deltaX and deltaY are in pixels; right and down are positive\n    var pan = function () {\n\n        var offset = new THREE.Vector3();\n\n        return function pan( deltaX, deltaY ) {\n\n            var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n            if ( scope.object.isPerspectiveCamera ) {\n\n                // perspective\n                var position = scope.object.position;\n                offset.copy( position ).sub( scope.target );\n                var targetDistance = offset.length();\n\n                // half of the fov is center to top of screen\n                targetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n                // we actually don't use screenWidth, since perspective camera is fixed to screen height\n                panLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\n                panUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\n\n            } else if ( scope.object.isOrthographicCamera ) {\n\n                // orthographic\n                panLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\n                panUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\n\n            } else {\n\n                // camera neither orthographic nor perspective\n                console.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n                scope.enablePan = false;\n\n            }\n\n        };\n\n    }();\n\n    function dollyIn( dollyScale ) {\n\n        if ( scope.object.isPerspectiveCamera ) {\n\n            scale /= dollyScale;\n\n        } else if ( scope.object.isOrthographicCamera ) {\n\n            scope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\n            scope.object.updateProjectionMatrix();\n            zoomChanged = true;\n\n        } else {\n\n            console.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n            scope.enableZoom = false;\n\n        }\n\n    }\n\n    function dollyOut( dollyScale ) {\n\n        if ( scope.object.isPerspectiveCamera ) {\n\n            scale *= dollyScale;\n\n        } else if ( scope.object.isOrthographicCamera ) {\n\n            scope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\n            scope.object.updateProjectionMatrix();\n            zoomChanged = true;\n\n        } else {\n\n            console.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n            scope.enableZoom = false;\n\n        }\n\n    }\n\n    //\n    // event callbacks - update the object state\n    //\n\n    function handleMouseDownRotate( event ) {\n\n        //console.log( 'handleMouseDownRotate' );\n\n        rotateStart.set( event.clientX, event.clientY );\n\n    }\n\n    function handleMouseDownDolly( event ) {\n\n        //console.log( 'handleMouseDownDolly' );\n\n        dollyStart.set( event.clientX, event.clientY );\n\n    }\n\n    function handleMouseDownPan( event ) {\n\n        //console.log( 'handleMouseDownPan' );\n\n        panStart.set( event.clientX, event.clientY );\n\n    }\n\n    function handleMouseMoveRotate( event ) {\n\n        //console.log( 'handleMouseMoveRotate' );\n\n        rotateEnd.set( event.clientX, event.clientY );\n        rotateDelta.subVectors( rotateEnd, rotateStart );\n\n        var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n        // rotating across whole screen goes 360 degrees around\n        rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\n\n        // rotating up and down along whole screen attempts to go 360, but limited to 180\n        rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\n\n        rotateStart.copy( rotateEnd );\n\n        scope.update();\n\n    }\n\n    function handleMouseMoveDolly( event ) {\n\n        //console.log( 'handleMouseMoveDolly' );\n\n        dollyEnd.set( event.clientX, event.clientY );\n\n        dollyDelta.subVectors( dollyEnd, dollyStart );\n\n        if ( dollyDelta.y > 0 ) {\n\n            dollyIn( getZoomScale() );\n\n        } else if ( dollyDelta.y < 0 ) {\n\n            dollyOut( getZoomScale() );\n\n        }\n\n        dollyStart.copy( dollyEnd );\n\n        scope.update();\n\n    }\n\n    function handleMouseMovePan( event ) {\n\n        //console.log( 'handleMouseMovePan' );\n\n        panEnd.set( event.clientX, event.clientY );\n\n        panDelta.subVectors( panEnd, panStart );\n\n        pan( panDelta.x, panDelta.y );\n\n        panStart.copy( panEnd );\n\n        scope.update();\n\n    }\n\n    function handleMouseUp( event ) {\n\n        // console.log( 'handleMouseUp' );\n\n    }\n\n    function handleMouseWheel( event ) {\n\n        // console.log( 'handleMouseWheel' );\n\n        if ( event.deltaY < 0 ) {\n\n            dollyOut( getZoomScale() );\n\n        } else if ( event.deltaY > 0 ) {\n\n            dollyIn( getZoomScale() );\n\n        }\n\n        scope.update();\n\n    }\n\n    function handleKeyDown( event ) {\n\n        //console.log( 'handleKeyDown' );\n\n        switch ( event.keyCode ) {\n\n            case scope.keys.UP:\n                pan( 0, scope.keyPanSpeed );\n                scope.update();\n                break;\n\n            case scope.keys.BOTTOM:\n                pan( 0, - scope.keyPanSpeed );\n                scope.update();\n                break;\n\n            case scope.keys.LEFT:\n                pan( scope.keyPanSpeed, 0 );\n                scope.update();\n                break;\n\n            case scope.keys.RIGHT:\n                pan( - scope.keyPanSpeed, 0 );\n                scope.update();\n                break;\n\n            default:\n                break;\n        }\n\n    }\n\n    function handleTouchStartRotate( event ) {\n\n        //console.log( 'handleTouchStartRotate' );\n\n        rotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n    }\n\n    function handleTouchStartDolly( event ) {\n\n        //console.log( 'handleTouchStartDolly' );\n\n        var dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n        var dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n        var distance = Math.sqrt( dx * dx + dy * dy );\n\n        dollyStart.set( 0, distance );\n\n    }\n\n    function handleTouchStartPan( event ) {\n\n        //console.log( 'handleTouchStartPan' );\n\n        panStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n    }\n\n    function handleTouchMoveRotate( event ) {\n\n        //console.log( 'handleTouchMoveRotate' );\n\n        rotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n        rotateDelta.subVectors( rotateEnd, rotateStart );\n\n        var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n        // rotating across whole screen goes 360 degrees around\n        rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\n\n        // rotating up and down along whole screen attempts to go 360, but limited to 180\n        rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\n\n        rotateStart.copy( rotateEnd );\n\n        scope.update();\n\n    }\n\n    function handleTouchMoveDolly( event ) {\n\n        //console.log( 'handleTouchMoveDolly' );\n\n        var dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n        var dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n        var distance = Math.sqrt( dx * dx + dy * dy );\n\n        dollyEnd.set( 0, distance );\n\n        dollyDelta.subVectors( dollyEnd, dollyStart );\n\n        if ( dollyDelta.y > 0 ) {\n\n            dollyOut( getZoomScale() );\n\n        } else if ( dollyDelta.y < 0 ) {\n\n            dollyIn( getZoomScale() );\n\n        }\n\n        dollyStart.copy( dollyEnd );\n\n        scope.update();\n\n    }\n\n    function handleTouchMovePan( event ) {\n\n        //console.log( 'handleTouchMovePan' );\n\n        panEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n        panDelta.subVectors( panEnd, panStart );\n\n        pan( panDelta.x, panDelta.y );\n\n        panStart.copy( panEnd );\n\n        scope.update();\n\n    }\n\n    function handleTouchEnd( event ) {\n\n        //console.log( 'handleTouchEnd' );\n\n    }\n\n    //\n    // event handlers - FSM: listen for events and reset state\n    //\n\n    function onMouseDown( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        event.preventDefault();\n\n        switch ( event.button ) {\n\n            case scope.mouseButtons.ORBIT:\n\n                if ( scope.enableRotate === false ) return;\n\n                handleMouseDownRotate( event );\n\n                state = STATE.ROTATE;\n\n                break;\n\n            case scope.mouseButtons.ZOOM:\n\n                if ( scope.enableZoom === false ) return;\n\n                handleMouseDownDolly( event );\n\n                state = STATE.DOLLY;\n\n                break;\n\n            case scope.mouseButtons.PAN:\n\n                if ( scope.enablePan === false ) return;\n\n                handleMouseDownPan( event );\n\n                state = STATE.PAN;\n\n                break;\n            default:\n                break;\n\n        }\n\n        if ( state !== STATE.NONE ) {\n\n            document.addEventListener( 'mousemove', onMouseMove, false );\n            document.addEventListener( 'mouseup', onMouseUp, false );\n\n            scope.dispatchEvent( startEvent );\n\n        }\n\n    }\n\n    function onMouseMove( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        event.preventDefault();\n\n        switch ( state ) {\n\n            case STATE.ROTATE:\n\n                if ( scope.enableRotate === false ) return;\n\n                handleMouseMoveRotate( event );\n\n                break;\n\n            case STATE.DOLLY:\n\n                if ( scope.enableZoom === false ) return;\n\n                handleMouseMoveDolly( event );\n\n                break;\n\n            case STATE.PAN:\n\n                if ( scope.enablePan === false ) return;\n\n                handleMouseMovePan( event );\n\n                break;\n            default:\n                break;\n\n        }\n\n    }\n\n    function onMouseUp( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        handleMouseUp( event );\n\n        document.removeEventListener( 'mousemove', onMouseMove, false );\n        document.removeEventListener( 'mouseup', onMouseUp, false );\n\n        scope.dispatchEvent( endEvent );\n\n        state = STATE.NONE;\n\n    }\n\n    function onMouseWheel( event ) {\n\n        if ( scope.enabled === false || scope.enableZoom === false || ( state !== STATE.NONE && state !== STATE.ROTATE ) ) return;\n\n        event.preventDefault();\n        event.stopPropagation();\n\n        handleMouseWheel( event );\n\n        scope.dispatchEvent( startEvent ); // not sure why these are here...\n        scope.dispatchEvent( endEvent );\n\n    }\n\n    function onKeyDown( event ) {\n\n        if ( scope.enabled === false || scope.enableKeys === false || scope.enablePan === false ) return;\n\n        handleKeyDown( event );\n\n    }\n\n    function onTouchStart( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        switch ( event.touches.length ) {\n\n            case 1:\t// one-fingered touch: rotate\n\n                if ( scope.enableRotate === false ) return;\n\n                handleTouchStartRotate( event );\n\n                state = STATE.TOUCH_ROTATE;\n\n                break;\n\n            case 2:\t// two-fingered touch: dolly\n\n                if ( scope.enableZoom === false ) return;\n\n                handleTouchStartDolly( event );\n\n                state = STATE.TOUCH_DOLLY;\n\n                break;\n\n            case 3: // three-fingered touch: pan\n\n                if ( scope.enablePan === false ) return;\n\n                handleTouchStartPan( event );\n\n                state = STATE.TOUCH_PAN;\n\n                break;\n\n            default:\n\n                state = STATE.NONE;\n\n        }\n\n        if ( state !== STATE.NONE ) {\n\n            scope.dispatchEvent( startEvent );\n\n        }\n\n    }\n\n    function onTouchMove( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        event.preventDefault();\n        event.stopPropagation();\n\n        switch ( event.touches.length ) {\n\n            case 1: // one-fingered touch: rotate\n\n                if ( scope.enableRotate === false ) return;\n                if ( state !== STATE.TOUCH_ROTATE ) return; // is this needed?...\n\n                handleTouchMoveRotate( event );\n\n                break;\n\n            case 2: // two-fingered touch: dolly\n\n                if ( scope.enableZoom === false ) return;\n                if ( state !== STATE.TOUCH_DOLLY ) return; // is this needed?...\n\n                handleTouchMoveDolly( event );\n\n                break;\n\n            case 3: // three-fingered touch: pan\n\n                if ( scope.enablePan === false ) return;\n                if ( state !== STATE.TOUCH_PAN ) return; // is this needed?...\n\n                handleTouchMovePan( event );\n\n                break;\n\n            default:\n\n                state = STATE.NONE;\n\n        }\n\n    }\n\n    function onTouchEnd( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        handleTouchEnd( event );\n\n        scope.dispatchEvent( endEvent );\n\n        state = STATE.NONE;\n\n    }\n\n    function onContextMenu( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        event.preventDefault();\n\n    }\n\n    //\n\n    scope.domElement.addEventListener( 'contextmenu', onContextMenu, false );\n\n    scope.domElement.addEventListener( 'mousedown', onMouseDown, false );\n    scope.domElement.addEventListener( 'wheel', onMouseWheel, false );\n\n    scope.domElement.addEventListener( 'touchstart', onTouchStart, false );\n    scope.domElement.addEventListener( 'touchend', onTouchEnd, false );\n    scope.domElement.addEventListener( 'touchmove', onTouchMove, false );\n\n    // window.addEventListener( 'keydown', onKeyDown, false );\n\n    // force an update at start\n\n    this.update();\n\n};\n\nOrbitControls.prototype = Object.create( THREE.EventDispatcher.prototype );\nOrbitControls.prototype.constructor = THREE.OrbitControls;\n\nObject.defineProperties( OrbitControls.prototype, {\n\n    center: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .center has been renamed to .target' );\n            return this.target;\n\n        }\n\n    },\n\n    // backward compatibility\n\n    noZoom: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.' );\n            return ! this.enableZoom;\n\n        },\n\n        set: function ( value ) {\n\n            console.warn( 'THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.' );\n            this.enableZoom = ! value;\n\n        }\n\n    },\n\n    noRotate: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.' );\n            return ! this.enableRotate;\n\n        },\n\n        set: function ( value ) {\n\n            console.warn( 'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.' );\n            this.enableRotate = ! value;\n\n        }\n\n    },\n\n    noPan: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.' );\n            return ! this.enablePan;\n\n        },\n\n        set: function ( value ) {\n\n            console.warn( 'THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.' );\n            this.enablePan = ! value;\n\n        }\n\n    },\n\n    noKeys: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.' );\n            return ! this.enableKeys;\n\n        },\n\n        set: function ( value ) {\n\n            console.warn( 'THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.' );\n            this.enableKeys = ! value;\n\n        }\n\n    },\n\n    staticMoving: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.' );\n            return ! this.enableDamping;\n\n        },\n\n        set: function ( value ) {\n\n            console.warn( 'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.' );\n            this.enableDamping = ! value;\n\n        }\n\n    },\n\n    dynamicDampingFactor: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );\n            return this.dampingFactor;\n\n        },\n\n        set: function ( value ) {\n\n            console.warn( 'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );\n            this.dampingFactor = value;\n\n        }\n\n    }\n\n} );\n\n\nexport default OrbitControls","import React, {Component} from 'react'\nimport * as THREE from 'three'\nimport {TREE_ITEM_PROVIDER} from '../TreeItemProvider'\nimport SelectionManager, {SELECTION_MANAGER} from '../SelectionManager'\nimport TransformControls from './TransformControls.js'\nimport SceneDef from \"./defs/SceneDef\"\nimport {get3DObjectDef, is3DObjectType, OBJ_TYPES, TOTAL_OBJ_TYPES} from './Common'\nimport ScriptManager, {SceneGraphProvider} from './ScriptManager'\nimport {TweenManager} from '../common/tween'\nimport {XRSupport} from './XRSupport'\nimport OrbitControls from './OrbitControls'\n\nconst {SET_PROPERTY, INSERT_ELEMENT, DELETE_ELEMENT} = require(\"syncing_protocol\");\n\n\n// ================  SGP implementation =====================\nclass Adapter extends SceneGraphProvider {\n    constructor(canvas) {\n        super()\n        this.canvas = canvas\n    }\n    logger() {\n        return this.canvas.props.provider.getLogger()\n    }\n\n    getCurrentScene() {\n        const scene = this.canvas.props.provider.getSelectedSceneObject()\n        if(!scene || !scene.exists()) {\n            this.logger.error(\"the current scene is null\")\n            return null\n        }\n        return scene\n    }\n    getSceneObjects(scene) {\n        return scene.getChildren().filter(ch => is3DObjectType(ch.type))\n    }\n    getBehaviorsForObject(scene) {\n        return scene.getChildren().filter(ch => ch.type === TOTAL_OBJ_TYPES.BEHAVIOR)\n    }\n    getThreeObject(obj) {\n        if(obj.id) return this.canvas.findNode(obj.id)\n        return this.canvas.findNode(obj)\n    }\n    getParsedBehaviorAsset(beh) {\n        const prov = this.canvas.props.provider\n        const asset = prov.accessObject(beh.behavior)\n        return prov.getCachedBehaviorAsset(asset.id)\n    }\n\n    getAllBehaviors() {\n        return this.canvas.props.provider.accessObject(this.canvas.props.provider.getSceneRoot())\n            .find((obj)=> obj.type === TOTAL_OBJ_TYPES.BEHAVIOR)\n    }\n    getAllScenes() {\n        return this.canvas.props.provider.accessObject(this.canvas.props.provider.getSceneRoot())\n            .find((obj)=>obj.type === TOTAL_OBJ_TYPES.SCENE)\n    }\n\n    navigateScene(id) {\n        const obj = this.canvas.props.provider.accessObject(id)\n        if(obj.exists()) {\n            SelectionManager.setSelection(id)\n        } else {\n            const logger = this.canvas.props.provider.getLogger()\n            logger.error(\"cannot navigate to a scene that doesn't exist\",id)\n        }\n    }\n\n\n    playMediaAsset(asset, trusted=false) {\n        this.canvas.props.provider.assetsManager.playMediaAsset(asset, trusted)\n    }\n\n    stopMediaAsset(asset) {\n        this.canvas.props.provider.assetsManager.stopMediaAsset(asset)\n    }\n    setMediaVolume(asset,vol) {\n        this.canvas.props.provider.assetsManager.setMediaVolume(asset,vol)\n    }\n    isMediaAssetPlaying(asset) {\n        return this.canvas.props.provider.assetsManager.isMediaAssetPlaying(asset)\n    }\n    getGraphObjectByName(title) {\n        const list = this.canvas.props.provider.accessObject(this.canvas.props.provider.getSceneRoot()).find((o)=>o.title === title)\n        if(!list || list.length<1) return null\n        return list[0]\n    }\n\n    getGraphObjectById(id) {\n        return this.canvas.props.provider.accessObject(id)\n    }\n\n\n    getCamera() {\n        return this.canvas.camera\n    }\n    \n    getTweenManager() {\n        return this.canvas.tweenManager\n    }\n    getFloorNear(info) {\n        return this.canvas.getFloorNear(info)\n    }\n    startLocalAnchor(info) {\n        return this.canvas.startLocalAnchor(info)\n    }\n    stopLocalAnchor(info) {\n        return this.canvas.stopLocalAnchor(info)\n    }\n    startImageRecognizer(info) {\n        return this.canvas.startImageRecognizer(info)\n    }\n    stopImageRecognizer(info) {\n        return this.canvas.stopImageRecognizer(info)\n    }\n    startGeoTracker(info) {\n        return this.canvas.startGeoTracker(info)\n    }\n    stopGeoTracker(info) {\n        return this.canvas.stopGeoTracker(info)\n    }\n}\n\n\nconst MOVE_SPEED = 0.1\nexport class VRCanvas extends Component {\n    moveCameraForward = () => {\n        this.camera.position.z += -MOVE_SPEED\n    }\n    moveCameraBackward = () => {\n        this.camera.position.z += MOVE_SPEED\n    }\n    handleKeyPress = (e) => {\n        if(e.key === 'ArrowUp') {\n            this.camera.position.z -= MOVE_SPEED\n        }\n        if(e.key === 'ArrowDown') {\n            this.camera.position.z += MOVE_SPEED\n        }\n        if(e.key === 'a') {\n            this.camera.position.x -= MOVE_SPEED\n        }\n        if(e.key === 'd') {\n            this.camera.position.x += MOVE_SPEED\n        }\n        if(e.key === 'ArrowLeft') {\n            this.camera.rotation.y += 0.1\n        }\n        if(e.key === 'ArrowRight') {\n            this.camera.rotation.y -= 0.1\n        }\n    }\n    recenterOnSelection = () => {\n        const sel = SelectionManager.getSelection()\n        if(!sel) return\n        const obj = this.props.provider.accessObject(sel)\n        if(is3DObjectType(obj.type)) {\n            const node = this.findNode(sel)\n            if(!node) return\n            this.orbitControls.target0.copy(node.position)\n            const cam = node.position.clone().sub(new THREE.Vector3(0,0,-2))\n            this.orbitControls.position0.copy(cam)\n            this.orbitControls.reset()\n        }\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) {\n            this.orbitControls.saveState()\n            this.orbitControls.target0.set(0,0,0)\n            this.orbitControls.position0.set(1,6,6)\n            this.orbitControls.reset()\n        }\n    }\n\n    constructor(props) {\n        super(props)\n        this.obj_node_map = {}\n        this.previewUpdateNodes = []\n        this.scenes = []\n        this.state = {\n            scene: -1,\n            running:props.running\n        }\n        this.current_scene_wrapper = null\n        this.scriptManager = new ScriptManager(new Adapter(this),this.props.provider.getLogger())\n    }\n\n    pauseQueue = (e) => {\n        this.props.provider.pauseQueue()\n    }\n    unpauseQueue = (e) => {\n        this.props.provider.unpauseQueue()\n    }\n    transformChanged = (e) => {\n        const sel = SelectionManager.getSelection()\n        if(sel) {\n            const obj = this.props.provider.accessObject(sel)\n            if(!is3DObjectType(obj.type)) return\n            if(obj.type === OBJ_TYPES.bg360) return\n            const node = this.findNode(sel)\n            if(!node) return\n            const prov = this.props.provider\n            prov.quick_setPropertyValue(sel,'tx',node.position.x)\n            prov.quick_setPropertyValue(sel,'ty',node.position.y)\n            prov.quick_setPropertyValue(sel,'tz',node.position.z)\n        }\n    }\n    transformDraggingChanged = (e) => {\n        this.orbitControls.enabled = ! e.value\n    }\n\n    docSwapped = (e) => {\n        //nuke all the old stuff\n        this.scenes.forEach(sc => this.scene.remove(sc))\n        this.scenes = []\n        this.obj_node_map = {}\n        this.setState({scene: -1})\n        //make new stuff\n        const graph = this.props.provider.getDocGraph()\n        this.rebuildNode(graph,\"\")\n\n        const sceneObj = this.props.provider.getSelectedSceneObject()\n        if(!sceneObj.exists()) return this.props.provider.getLogger().error(\"no selected scene found\")\n        const sceneNode = this.findNode(sceneObj.id)\n        this.setCurrentSceneWrapper(sceneNode, false)\n    }\n    rebuildNode(obj, inset) {\n        // console.log(inset,\"rebuilding\",obj.type)\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) {\n            const node = new SceneDef().makeNode(obj,this.props.provider)\n            this.insertNodeMapping(obj.id,node)\n            this.addSceneWrapper(node)\n        }\n        if(is3DObjectType(obj.type)) {\n            const node = get3DObjectDef(obj.type).makeNode(obj,this.props.provider)\n            this.insertNodeMapping(obj.id,node)\n            const parent = this.findNode(obj.parent)\n            parent.add(node)\n        }\n        if(obj.children) {\n            obj.children.forEach(ch => {\n                this.rebuildNode(ch,inset+\"   \")\n            })\n        }\n    }\n    selectionChanged = () => {\n        this.transformControls.detach()\n        const sel = SelectionManager.getSelection()\n        if(!sel) return\n        const obj = this.props.provider.accessObject(sel)\n\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) return this.setCurrentSceneWrapper(this.findNode(sel),true)\n\n        if(is3DObjectType(obj.type)) {\n            const sc = this.props.provider.findSceneObjectParent(obj)\n            this.setCurrentSceneWrapper(this.findNode(sc.id),true)\n            const node = this.findNode(sel)\n            if (!node) return\n            this.transformControls.attach(node)\n            return\n        }\n        console.log(\"selected something not an object or scene\")\n    }\n\n    checkAspectRatio() {\n        if(!this.canvas) return\n        const w = this.wrapper.clientWidth\n        const h = this.wrapper.clientHeight\n        const aspect = w/h\n        if(Math.abs(this.camera.aspect - aspect) > 0.001 ) {\n            this.camera.aspect = aspect\n            this.camera.updateProjectionMatrix()\n            this.renderer.setSize(w-4,h-4)\n        }\n    }\n\n    componentDidMount() {\n        const canvas = this.canvas\n        const logger = this.props.provider.getLogger()\n        logger.log(\"mounting VRCanvas\")\n        if(XRSupport.supportsARKit()) {\n            this.xr = new XRSupport()\n            this.xr.getContext(canvas).then((context) => {\n                this.setupRenderer(canvas,context)\n                this.xr.setAnimationLoop( this.animationLoopWithCamera.bind(this) )\n            }).catch(err => {\n                console.error('Error', err)\n            })\n        } else {\n            this.setupRenderer(canvas,0)\n            this.renderer.setAnimationLoop( this.animationLoop.bind(this) )\n        }\n    }\n\n    componentWillUnmount() {\n        this.saveOrbitControlsState()\n        this.transformControls.removeEventListener('change',this.transformChanged)\n        this.transformControls.removeEventListener('mouseDown',this.pauseQueue)\n        this.transformControls.removeEventListener('mouseUp',this.unpauseQueue)\n        this.props.provider.off(TREE_ITEM_PROVIDER.DOCUMENT_SWAPPED,this.docSwapped)\n        SelectionManager.off(SELECTION_MANAGER.CHANGED,this.selectionChanged)\n    }\n\n    setupRenderer(canvas,context) {\n        this.scene = new THREE.Scene();\n        this.camera = new THREE.PerspectiveCamera(50, canvas.width / canvas.height, 0.1, 1000);\n        this.renderer = new THREE.WebGLRenderer({antialias: false, canvas: canvas, context:context});\n        this.renderer.setPixelRatio( window.devicePixelRatio );\n        this.renderer.gammaOutput = true\n        this.audioListener = new THREE.AudioListener()\n        this.props.provider.setAudioListener(this.audioListener)\n        this.camera.add(this.audioListener)\n        //only set a background if there is no XR active\n        if(!this.xr) this.scene.background = new THREE.Color(0x000000);\n        // this.camera.matrixAutoUpdate = false\n        this.scene.add(this.camera)\n        this.camera.position.set(1,6,6)\n\n        this.transformControls = new TransformControls(this.camera, this.renderer.domElement)\n        this.transformControls.addEventListener('change',this.transformChanged)\n        this.transformControls.addEventListener('dragging-changed', this.transformDraggingChanged)\n        this.transformControls.addEventListener('mouseDown',this.pauseQueue)\n        this.transformControls.addEventListener('mouseUp',this.unpauseQueue)\n        this.scene.add(this.transformControls)\n\n        this.orbitControls = new OrbitControls(this.camera,this.renderer.domElement)\n        this.orbitControls.update()\n        // this.orbitControls.autoRotate = true\n        this.raycaster = new THREE.Raycaster();\n\n        const light = new THREE.DirectionalLight(0xffffff, 1.0);\n        light.position.set(1, 1, 1).normalize();\n        this.scene.add(light);\n\n        this.scene.add(new THREE.AmbientLight(0xffffff,0.4))\n        \n        this.tweenManager = new TweenManager()\n\n        this.props.provider.onRawChange(op => this.updateScene(op))\n        this.props.provider.on(TREE_ITEM_PROVIDER.DOCUMENT_SWAPPED, this.docSwapped)\n        SelectionManager.on(SELECTION_MANAGER.CHANGED, this.selectionChanged)\n\n        this.docSwapped()\n    }\n\n    animationLoop(time, frame) {\n        this.checkAspectRatio()\n        let session = null\n        if(this.xr) session = this.xr.session\n        if(this.state.running) this.scriptManager.tick(time, session)\n        if(this.tweenManager) this.tweenManager.update(time)\n        if(this.orbitControls) this.orbitControls.update()\n        this.previewUpdateNodes.forEach(n => n.previewUpdate())\n        this.renderer.render(this.scene, this.camera)\n    }\n\n    animationLoopWithCamera(bounds,projectionMatrix,viewMatrix, time,frame) {\n        if(!this.scene || !this.camera) return\n        this.camera.matrix.fromArray(viewMatrix)\n        this.camera.matrixWorldNeedsUpdate = true\n        this.camera.updateMatrixWorld()\n        this.camera.projectionMatrix.fromArray(projectionMatrix)\n        this.animationLoop(time,frame)\n    }\n\n    insertNodeMapping(id, node) {\n        if (typeof id !== 'string') throw new Error(\"cannot map an object to an object. invalid call in insertNodeMapping\")\n        this.obj_node_map[id] = node\n        node.userData.graphid = id\n        if(node.previewUpdate) this.previewUpdateNodes.push(node)\n    }\n    removeNodeMapping(id,node) {\n        delete this.obj_node_map[id]\n        delete node.userData.graphid\n        this.previewUpdateNodes = this.previewUpdateNodes.filter(n => n !== node)\n    }\n\n\n    findNode(id) {\n        if (!this.obj_node_map[id]) console.warn(\"could not find node for id\", id)\n        return this.obj_node_map[id]\n    }\n\n    updateScene(op) {\n        const prov = this.props.provider\n        if (op.type === INSERT_ELEMENT) {\n            const objid = op.value\n            const obj = prov.accessObject(op.value)\n            if(obj.type === TOTAL_OBJ_TYPES.SCENE) return this.populateNode(objid)\n            if (is3DObjectType(obj.type)) return this.populateNode(objid)\n            if(obj.type === TOTAL_OBJ_TYPES.ASSET) return\n            if(obj.type === TOTAL_OBJ_TYPES.ASSETS_LIST) return\n            if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) return\n            if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR) return\n            if(obj.type === TOTAL_OBJ_TYPES.BEHAVIORS_LIST) return\n            console.warn(\"unknown object type\", obj)\n            return\n        }\n        if (op.type === SET_PROPERTY) {\n            //skip setting parents. done through insert_element\n            if(op.name === 'parent') return\n            const node = this.findNode(op.object)\n            if (node) {\n                const obj = prov.accessObject(op.object)\n                if(obj.type === 'scene') {\n                    new SceneDef().updateProperty(node,obj,op,this.props.provider)\n                    return\n                }\n                if(is3DObjectType(obj.type)) return get3DObjectDef(obj.type).updateProperty(node,obj,op, this.props.provider)\n            } else {\n                console.log(\"could not find the node for object id:\", op)\n            }\n            return\n        }\n        if (op.type === DELETE_ELEMENT) {\n            this.transformControls.detach()\n            const node = this.findNode(op.value)\n            if(node) {\n                this.removeNodeMapping(op.value,node)\n                const obj = prov.accessObject(op.value)\n                if(is3DObjectType(obj.type)) node.parent.remove(node)\n            }\n            return\n        }\n        // console.log('skipping', op.type)\n    }\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\n        if('running' in nextProps) {\n            if(nextProps.running !== this.props.running) {\n                this.setState({running:nextProps.running})\n                if(nextProps.running === false) {\n                    this.scriptManager.stopRunning()\n                    this.stopAllMedia()\n                    this.resetSceneGraph()\n                    this.stopRecognizers()\n                } else {\n                    //start the script manager\n                    this.startRecognizers()\n                    this.scriptManager.startRunning()\n                    this.scriptManager.startFirstScene();\n                }\n                return false\n            }\n        }\n        return false\n    }\n\n    render() {\n        return <div style={{\n            borderWidth:0,\n            boxSizing:'border-box',\n            height:'100%',\n            display:'flex',\n            flexDirection:'column'\n        }}>\n            <button onClick={this.recenterOnSelection}>recenter on selection</button>\n            <div style={{\n                boxSizing:'border-box',\n                borderWidth:0,\n                margin:0,\n                padding:0,\n                flex:1.0,\n                overflow:'auto',\n            }}\n                 ref={c => this.wrapper = c}\n            >\n                <canvas ref={c => this.canvas = c}\n                        style={{\n                            boxSizing:'border-box',\n                            margin:0,\n                            padding:0,\n                            width:'100px',\n                            height:'100px',\n                            borderWidth:0,\n                        }}\n                        onClick={this.clickedCanvas}\n                        className=\"editable-canvas\"\n                        onKeyDown={this.handleKeyPress}\n                        tabIndex={0}\n                />\n            </div>\n        </div>\n    }\n\n    populateNode(nodeid) {\n        const obj = this.props.provider.accessObject(nodeid)\n        if (is3DObjectType(obj.type)) {\n            const obj3d = get3DObjectDef(obj.type).makeNode(obj,this.props.provider)\n            this.insertNodeMapping(nodeid, obj3d)\n            const parent = this.findNode(obj.parent)\n            if(!parent) {\n                //this must be a nested pasted child. we can fix the parent links later\n                return null\n            }\n            parent.add(obj3d)\n            this.rebuildParentLink(obj)\n            return obj3d\n        }\n        if (obj.type === TOTAL_OBJ_TYPES.SCENE) {\n            const scene = new SceneDef().makeNode(obj,this.props.provider)\n            this.insertNodeMapping(nodeid, scene)\n            this.addSceneWrapper(scene)\n            this.setCurrentSceneWrapper(scene,true)\n            return scene\n        }\n\n        console.warn(\"cannot populate node for type\", obj.type)\n    }\n\n    rebuildParentLink(obj) {\n        obj.getChildren().forEach((ch)=>{\n            const ch3 = this.findNode(ch.id)\n            if(!ch3.parent) this.findNode(obj.id).add(ch3)\n            this.rebuildParentLink(ch)\n        })\n    }\n\n    addSceneWrapper(scene) {\n        this.scenes.push(scene)\n        this.scene.add(scene)\n    }\n\n    saveOrbitControlsState() {\n        const scene = this.scenes.find(sc => sc.visible)\n        this.orbitControls.saveState()\n        const id = scene.userData.graphid\n        this.props.provider.orbit_state[id] = {\n            target: this.orbitControls.target0.clone(),\n            position:this.orbitControls.position0.clone(),\n        }\n    }\n    restoreOrbitControlsState(scene) {\n        const id = scene.userData.graphid\n        if(this.props.provider.orbit_state[id]) {\n            const state = this.props.provider.orbit_state[id]\n            this.orbitControls.target0.copy(state.target)\n            this.orbitControls.position0.copy(state.position)\n            this.orbitControls.reset()\n        }\n    }\n    setCurrentSceneWrapper(scene, saveState) {\n        if(!scene) return this.props.provider.getLogger().error(\"invalid scene. cannot setCurrentSceneWrapper\")\n        const cur = this.getCurrentSceneWrapper()\n        const changed = (scene !== cur)\n        if(changed && saveState) this.saveOrbitControlsState()\n        this.current_scene_wrapper = scene\n        this.scenes.forEach(sc => {\n            if(sc === scene) {\n                sc.visible = true\n            } else {\n                sc.visible = false\n            }\n        })\n        if(changed) this.restoreOrbitControlsState(scene)\n    }\n\n    dumpScenes() {\n        this.scenes.forEach(sc => {\n            console.log(\"scene\")\n            this.dump(sc,'')\n        })\n    }\n    dump(sc,inset) {\n        console.log(inset+\"\",sc.type,sc.id,  'vis', sc.visible)\n        if(sc.type === 'Mesh') console.log(inset+'  ',sc.geometry.type)\n        // console.log(sc)\n        if(sc.children) {\n            sc.children.forEach((ch) => this.dump(ch, inset + '  '))\n        }\n    }\n\n    getCurrentSceneWrapper() {\n        return this.current_scene_wrapper\n    }\n\n    clickedCanvas = (e) => {\n        this.canvas.focus()\n        const rect = this.canvas.getBoundingClientRect();\n        const pointer = {\n            x: ( e.clientX - rect.left ) / rect.width * 2 - 1,\n            y: - ( e.clientY - rect.top ) / rect.height * 2 + 1,\n        }\n\n        function findKnownParent(node) {\n            if(!node) return null\n            if(node.userData.graphid) return node\n            return findKnownParent(node.parent)\n        }\n\n        this.raycaster.setFromCamera(pointer, this.camera);\n        const intersect = this.raycaster.intersectObjects(this.getCurrentSceneWrapper().children, true)\n        if(intersect && intersect.length >= 1) {\n            let obj = findKnownParent(intersect[0].object)\n            if(this.state.running) {\n                this.scriptManager.performClickAction(this.props.provider.accessObject(obj.userData.graphid), e)\n            } else {\n                SelectionManager.setSelection(obj.userData.graphid)\n            }\n        } else {\n            SelectionManager.clearSelection()\n        }\n    }\n\n\n    resetSceneGraph() {\n        Object.keys(this.obj_node_map).forEach(id => {\n            const graphObj = this.props.provider.accessObject(id)\n            const threeObj = this.obj_node_map[id]\n            if(graphObj.type === 'scene') {\n                // new SceneDef().updateProperty(node,obj,op,this.props.provider)\n                return\n            }\n            if(is3DObjectType(graphObj.type)) {\n                const def = get3DObjectDef(graphObj.type)\n                if(def.reset) {\n                    def.reset(threeObj,graphObj,this.props.provider.getDataGraph())\n                }\n            }\n        })\n    }\n\n    stopAllMedia() {\n        this.props.provider.assetsManager.stopAllMedia()\n    }\n\n    startRecognizers() {\n        //called when script running is started\n    }\n\n    stopRecognizers() {\n        //called when script running is started\n    }\n\n    getFloorNear(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO get floor near\")\n    }\n\n    startLocalAnchor(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO start local anchor\")\n    }\n\n    stopLocalAnchor(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO stop local anchor\")\n    }\n\n    startImageRecognizer(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO start image recognizer\")\n    }\n\n    stopImageRecognizer(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO stop image recognizer\")\n    }\n\n    startGeoTracker(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO start geo recognizer\")\n    }\n\n    stopGeoTracker(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO stop geo recognizer\")\n    }\n\n    startWorldInfo(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO start world info\")\n    }\n\n    stopWorldInfo(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO stop world info\")\n    }\n\n}\n","import * as THREE from 'three'\nimport {POINTER_ENTER, POINTER_EXIT, POINTER_MOVE, POINTER_PRESS, POINTER_RELEASE} from 'webxr-boilerplate'\n\n\n\nconst on = (elem,type,cb) => elem.addEventListener(type,cb)\nconst off = (elem,type,cb) => elem.removeEventListener(type,cb)\nconst toRad = (degrees) => degrees*Math.PI/180\n\nexport default class TranslationArrow extends THREE.Group {\n    constructor(axis, control) {\n        super()\n        this.axis = axis\n        this.control = control\n        this.makePlane()\n        this.makeArrow()\n        this.makeInputGrabber()\n    }\n\n    makePlane() {\n        this.plane = new THREE.Mesh(\n            new THREE.PlaneBufferGeometry(100, 100, 100, 100),\n            new THREE.MeshBasicMaterial({visible: true, wireframe: true, side: THREE.DoubleSide})\n        )\n        if (this.axis === 'Z') this.plane.rotation.y = toRad(90)\n        this.plane.userData.draggable = true\n        this.plane.visible = false\n        this.add(this.plane)\n    }\n\n    makeArrow() {\n        this.arrow = new THREE.Mesh(\n            new THREE.CylinderBufferGeometry(0.02, 0.02, 4),\n            new THREE.MeshLambertMaterial({color: 'yellow'})\n        )\n        if (this.axis === 'X') this.arrow.rotation.z = toRad(90)\n        if (this.axis === 'Y') this.arrow.rotation.z = toRad(180)\n        if (this.axis === 'Z') this.arrow.rotation.x = toRad(90)\n        this.add(this.arrow)\n    }\n\n    makeInputGrabber() {\n        this.input = new THREE.Mesh(\n            new THREE.CylinderBufferGeometry(0.1, 0.1, 4),\n            new THREE.MeshLambertMaterial({color: 'green', visible: false})\n        )\n        if (this.axis === 'X') this.input.rotation.z = toRad(90)\n        if (this.axis === 'Y') this.input.rotation.z = toRad(180)\n        if (this.axis === 'Z') this.input.rotation.x = toRad(90)\n        this.input.userData.clickable = true\n        this.add(this.input)\n    }\n\n    attach() {\n        on(this.input, POINTER_ENTER, this.startHover)\n        on(this.input, POINTER_EXIT, this.endHover)\n        on(this.input, POINTER_PRESS, this.beginDrag)\n    }\n\n    detach() {\n        off(this.input, POINTER_ENTER, this.startHover)\n        off(this.input, POINTER_EXIT, this.endHover)\n        off(this.input, POINTER_PRESS, this.beginDrag)\n    }\n\n    startHover = () => this.arrow.material.color.set(0xffffff)\n    endHover = () => this.arrow.material.color.set(0xffff00)\n\n    beginDrag = (e) => {\n        this.startPoint = this.parent.position.clone()\n        this.startPoint.copy(e.intersection.point)\n        this.parent.target.parent.worldToLocal(this.startPoint)\n        this.oldFilter = this.parent.pointer.intersectionFilter\n        this.parent.pointer.intersectionFilter = (obj) => obj.userData.draggable\n        this.startPosition = this.parent.target.position.clone()\n        this.plane.visible = true\n        on(this.plane, POINTER_MOVE, this.updateDrag)\n        on(this.plane, POINTER_RELEASE, this.endDrag)\n    }\n    updateDrag = (e) => {\n        this.endPoint = e.intersection.point.clone()\n        this.parent.target.parent.worldToLocal(this.endPoint)\n        //neutralize y and z\n        if (this.axis === 'X') {\n            this.endPoint.y = this.startPoint.y\n            this.endPoint.z = this.startPoint.z\n        }\n        if (this.axis === 'Y') {\n            this.endPoint.x = this.startPoint.x\n            this.endPoint.z = this.startPoint.z\n        }\n        if (this.axis === 'Z') {\n            this.endPoint.x = this.startPoint.x\n            this.endPoint.y = this.startPoint.y\n        }\n        const diff = this.endPoint.clone().sub(this.startPoint)\n        const finalPoint = this.startPosition.clone().add(diff)\n        this.parent.target.position.copy(finalPoint)\n        this.parent.position.copy(finalPoint)\n    }\n    endDrag = (e) => {\n        off(this.plane, POINTER_MOVE, this.updateDrag)\n        off(this.plane, POINTER_RELEASE, this.endDrag)\n        this.parent.pointer.intersectionFilter = this.oldFilter\n        this.plane.visible = false\n        this.parent.dispatchEvent({\n            type: 'change',\n            start: this.startPosition.clone(),\n            end: this.parent.position.clone()\n        })\n    }\n}\n","import * as THREE from 'three'\nimport TranslationArrow from './TranslationArrow'\n\nexport class TranslateControl extends THREE.Group {\n    constructor() {\n        super()\n        this.handles = []\n        this.handles.push(new TranslationArrow('X', this))\n        this.handles.push(new TranslationArrow('Y', this))\n        this.handles.push(new TranslationArrow('Z', this))\n        this.handles.forEach(h => this.add(h))\n        this.visible = false\n    }\n\n    attach(target, pointer) {\n        this.target = target\n        this.pointer = pointer\n        this.position.copy(target.position)\n        this.visible = true\n        this.handles.forEach(h => h.attach())\n    }\n\n    detach() {\n        this.target = null\n        this.pointer = null\n        this.visible = false\n        this.handles.forEach(h => h.attach())\n    }\n}\n","import * as THREE from 'three'\n\nimport {POINTER_RELEASE, POINTER_CLICK, POINTER_ENTER, POINTER_EXIT, POINTER_PRESS, POINTER_MOVE} from 'webxr-boilerplate'\n\n// const $ = (sel) => document.querySelector(sel)\nconst on = (elem, type, cb) => elem.addEventListener(type,cb)\n// const toRad = (deg) => deg * Math.PI/180\n\nexport default class Panel2D extends THREE.Object3D {\n    constructor(scene,camera) {\n        super()\n\n        if(!scene) throw new Error(\"cannot pass empty scene to Panel2D()\")\n        if(!camera) throw new Error(\"cannot pass empty camera to Panel2D()\")\n        this.type = 'panel2d'\n        this.listeners = {}\n        this.scene = scene\n        this.camera = camera\n        this.canvas = document.createElement('canvas')\n        this.canvas.width = 256\n        this.canvas.height = 512\n        this.canvasTexture = new THREE.CanvasTexture(this.canvas)\n        this.redrawHandler = (e) => this.redraw()\n\n        const c = this.canvas.getContext('2d')\n        c.fillStyle = 'red'\n        c.fillRect(0,0,this.canvas.width,this.canvas.height)\n\n        this.mesh = new THREE.Mesh(\n            new THREE.PlaneGeometry(1,2),\n            new THREE.MeshBasicMaterial({color:'white',map:this.canvasTexture})\n        )\n        this.mesh.userData.clickable = true\n        this.comps = []\n\n        this.add(this.mesh)\n\n        let inside = null\n        on(this.mesh,POINTER_MOVE,(e)=>{\n            const uv = e.intersection.uv\n            const fpt = new THREE.Vector2(uv.x*256, 512-uv.y*512)\n            if(inside && !inside.contains(fpt)) {\n                inside.fire(POINTER_EXIT)\n                inside = null\n            }\n            const comp = this.findAt(fpt)\n            // for(let i=0; i<this.comps.length; i++) {\n            //     const comp = this.comps[i]\n            //     if(comp.contains(fpt)) {\n            if(inside !== comp){\n                if(inside) inside.fire(POINTER_EXIT)\n                inside = null\n            }\n            if(comp) comp.fire(POINTER_ENTER)\n            inside = comp\n            // }\n            // }\n        })\n        on(this.mesh,POINTER_CLICK,(e)=>{\n            const uv = e.intersection.uv\n            const fpt = new THREE.Vector2(uv.x*256, 512-uv.y*512)\n            const comp = this.findAt(fpt)\n            if(comp) comp.fire(POINTER_CLICK)\n            // for(let i=0; i<this.comps.length; i++) {\n            //     const comp = this.comps[i]\n            //     if(comp.contains(fpt)) {\n            //         comp.fire(POINTER_CLICK)\n            //     }\n            // }\n        })\n\n        this.header = new THREE.Mesh(\n            new THREE.BoxGeometry(1.0,0.1,0.1),\n            new THREE.MeshBasicMaterial({color:'goldenrod'})\n        )\n        this.header.userData.clickable = true\n        this.header.position.set(0,1.1,0)\n        this.add(this.header)\n\n        on(this.header,POINTER_ENTER, e => this.header.material.color.set('yellow'))\n        on(this.header,POINTER_EXIT,  e => this.header.material.color.set('goldenrod'))\n        on(this.header,POINTER_PRESS, e => this.startDrag())\n    }\n\n    fire(type,payload) {\n        if(!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].forEach(cb => cb(payload))\n    }\n\n    findAt(pt) {\n        for(let i=0; i<this.comps.length; i++) {\n            const comp = this.comps[i]\n            const res = comp.findAt({x:pt.x-comp.x,y:pt.y-comp.y})\n            if(res) return res\n        }\n        return null\n    }\n\n    add(comp) {\n        if(comp instanceof THREE.Object3D) {\n            super.add(comp)\n        } else {\n            this.comps.push(comp)\n            on(comp, 'changed', this.redrawHandler)\n        }\n    }\n\n    redraw() {\n        const ctx = this.canvas.getContext('2d')\n        ctx.fillStyle = 'white'\n        ctx.fillRect(0,0,this.canvas.width,this.canvas.height)\n        this.comps.forEach(comp => comp.draw(ctx))\n        this.canvasTexture.needsUpdate = true\n    }\n\n    startDrag() {\n        this.header.userData.clickable = false\n        this.mesh.userData.clickable = false\n\n        this.dragSphere = new THREE.Mesh(\n            new THREE.SphereGeometry(4,32,32),\n            new THREE.MeshLambertMaterial({\n                color:'green',\n                wireframe:true,\n                side: THREE.BackSide\n            })\n        )\n        this.dragSphere.userData.clickable = true\n        this.scene.add(this.dragSphere)\n\n        on(this.dragSphere,POINTER_MOVE,(e)=> this.moveDrag(e))\n        on(this.dragSphere,POINTER_RELEASE,(e)=> this.endDrag(e))\n\n    }\n    endDrag() {\n        this.scene.remove(this.dragSphere)\n        this.dragSphere.userData.clickable = false\n        this.header.userData.clickable = true\n        this.mesh.userData.clickable = true\n    }\n\n\n    moveDrag(e) {\n        this.position.copy(e.point)\n        this.position.add(new THREE.Vector3(0,-1,0))\n        this.lookAt(this.camera.position)\n    }\n}\n","export default class Component2D {\n    constructor() {\n        this.listeners = {}\n    }\n    set(key,value) {\n        this[key] = value\n        this.fire('changed',{type:'changed',target:this})\n        return this\n    }\n    get(key) {\n        return this[key]\n    }\n    addEventListener(type,cb) {\n        if(!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].push(cb)\n        return this\n    }\n    on(type,cb) {\n        this.addEventListener(type,cb)\n        return this\n    }\n    setAll(props) {\n        Object.keys(props).forEach(key => this.set(key, props[key]))\n        return this\n    }\n    fire(type,payload) {\n        if(!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].forEach(cb => cb(payload))\n    }\n\n}","import {POINTER_ENTER, POINTER_EXIT} from 'webxr-boilerplate'\nimport Component2D from \"./component2d\";\n\n\nexport default class Button2D extends Component2D {\n    constructor() {\n        super()\n        this.type = 'button'\n        this.text = 'foo'\n        this.x = 0\n        this.y = 0\n        this.fsize = 20\n        this.w = this.text.length * this.fsize\n        this.h = 20\n        this.normalBg = 'white'\n        this.hoverBg = 'red'\n        this.bg = this.normalBg\n        this.on(POINTER_ENTER, () => {\n            this.bg = this.hoverBg\n            this.fire('changed', {type: 'changed', target: this})\n        })\n        this.on(POINTER_EXIT, () => {\n            this.bg = this.normalBg\n            this.fire('changed', {type: 'changed', target: this})\n        })\n    }\n\n    draw(ctx) {\n        ctx.font = `${this.fsize}px sans-serif`\n        const metrics = ctx.measureText(this.text)\n        this.w = 5 + metrics.width + 5\n        this.h = 0 + this.fsize + 4\n        ctx.fillStyle = this.bg\n        ctx.fillRect(this.x, this.y, this.w, this.h)\n        ctx.fillStyle = 'black'\n        ctx.fillText(this.text, this.x + 3, this.y + this.fsize - 2)\n        ctx.strokeStyle = 'black'\n        ctx.strokeRect(this.x, this.y, this.w, this.h)\n    }\n\n    contains(pt) {\n        if (pt.x < this.x) return false\n        if (pt.x > this.x + this.w) return false\n        if (pt.y < this.y) return false\n        if (pt.y > this.y + this.h) return false\n        return true\n    }\n\n    findAt(pt) {\n        if (pt.x < 0) return null\n        if (pt.x > 0 + this.w) return null\n        if (pt.y < 0) return null\n        if (pt.y > 0 + this.h) return null\n        return this\n    }\n\n    set(key, value) {\n        super.set(key, value)\n        if (key === 'normalBg') this.bg = this.normalBg\n    }\n}\n","import Component2D from \"./component2d\";\n\nexport default class Group2D extends Component2D {\n    constructor() {\n        super()\n        this.type = 'group'\n        this.x = 0\n        this.y = 0\n        this.w = 100\n        this.h = 100\n        this.bg = 'gray'\n        this.visible = true\n        this.comps = []\n        this.padding = 5\n        this.border = 1\n\n        this.layout = (comp) => {\n            console.log(\"not laying out anything\")\n        }\n    }\n    draw(ctx) {\n        if(!this.visible) return\n        this.layout(this)\n        ctx.fillStyle = this.bg\n        ctx.fillRect(this.x,this.y,this.w,this.h)\n        if(this.border > 0) {\n            ctx.strokeStyle = 'black'\n            ctx.strokeRect(this.x, this.y, this.w, this.h)\n        }\n        ctx.save()\n        ctx.translate(this.x+this.padding,this.y+this.padding)\n        this.comps.forEach(comp => comp.draw(ctx))\n        ctx.restore()\n    }\n\n    contains(pt) {\n        if(pt.x < this.x) return false\n        if(pt.x > this.x + this.w) return false\n        if(pt.y < this.y) return false\n        if(pt.y > this.y + this.h) return false\n        return true\n    }\n    findAt(pt) {\n        if(!this.visible) return null\n        for(let i=0; i<this.comps.length; i++) {\n            const comp = this.comps[i]\n            const res = comp.findAt({x:pt.x-comp.x-5,y:pt.y-comp.y-5})\n            if(res) return res\n        }\n        return null\n    }\n\n    childSet(key,value) {\n        this.childProps[key] = value\n        this.comps.forEach(ch=>ch.set(key,value))\n        return this\n    }\n\n    add(comp) {\n        this.comps.push(comp)\n        this.fire('changed',{type:'changed',target:this})\n        return this\n    }\n}\n","import * as THREE from 'three'\n\nconst toRad = (deg) => Math.PI/180*deg\nconst YAXIS = new THREE.Vector3(0,1,0)\n\n\nexport default class ThreeDOFController {\n\n\n    constructor(stagePos, stageRot) {\n        this.stagePos = stagePos\n        this.stageRot = stageRot\n        this.states = { touchpad: false}\n        this.listeners = {}\n        this.keystates = {\n            ArrowLeft:{current:false, previous:false},\n            ArrowRight:{current:false, previous:false},\n            ArrowUp:{current:false, previous:false},\n            ArrowDown:{current:false, previous:false}\n        }\n        this.dir = new THREE.Vector3(0,0,1)\n\n\n        document.addEventListener('keydown',(e)=>{\n            if(this.keystates[e.key]) {\n                this.keystates[e.key].current = true\n            }\n        })\n        document.addEventListener('keyup',(e)=>{\n            if(this.keystates[e.key]) {\n                this.keystates[e.key].current = false\n            }\n        })\n\n    }\n\n    addEventListener(type, cb) {\n        if (!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].push(cb)\n    }\n\n    _fire(type,payload) {\n        if (!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].forEach(cb => cb(payload))\n    }\n\n\n\n\n    updateKeys() {\n        if(this.keystates.ArrowLeft.current === false && this.keystates.ArrowLeft.previous === true) {\n            this.rotateLeft()\n        }\n        if(this.keystates.ArrowRight.current === false && this.keystates.ArrowRight.previous === true) {\n            this.rotateRight()\n        }\n        if(this.keystates.ArrowUp.current === false && this.keystates.ArrowUp.previous === true) {\n            this.moveForward()\n        }\n        if(this.keystates.ArrowDown.current === false && this.keystates.ArrowDown.previous === true) {\n            this.moveBackward()\n        }\n\n        Object.keys(this.keystates).forEach(key => {\n            this.keystates[key].previous = this.keystates[key].current\n        })\n    }\n\n    rotateLeft() {\n        this.dir.applyAxisAngle(YAXIS,toRad(30))\n        this.stageRot.rotation.y -= toRad(30)\n    }\n\n    rotateRight() {\n        this.dir.applyAxisAngle(YAXIS,-toRad(30))\n        this.stageRot.rotation.y += toRad(30)\n    }\n\n    moveForward() {\n        this.stagePos.position.add(this.dir)\n        this._fire('move',this.stagePos.position)\n    }\n\n    moveBackward() {\n        this.stagePos.position.sub(this.dir)\n        this._fire('move',this.stagePos.position)\n    }\n\n    update() {\n        this.scanGamepads()\n        this.updateKeys()\n    }\n\n    scanGamepads() {\n        // console.log(\"gamepads\",navigator.getGamepads())\n        const gamepads = navigator.getGamepads()\n        for(let i=0; i<gamepads.length; i++) {\n            const gamepad = gamepads[i]\n            if ( gamepad && ( gamepad.id === 'Daydream Controller' ||\n                gamepad.id === 'Gear VR Controller' || gamepad.id === 'Oculus Go Controller' ||\n                gamepad.id === 'OpenVR Gamepad' || gamepad.id.startsWith( 'Oculus Touch' ) ||\n                gamepad.id.startsWith( 'Spatial Controller' ) ) ) {\n                //we should have at least two buttons\n                if(gamepad.buttons.length < 2) return\n\n                const touchpad = gamepad.buttons[0]\n                if(touchpad.pressed && gamepad.axes && gamepad.axes.length === 2) {\n                    const left = gamepad.axes[0] < -0.5\n                    const right = gamepad.axes[0] > 0.5\n                    const down = gamepad.axes[1] < -0.5\n                    const up = (gamepad.axes[1] > 0.5)\n\n\n                    if (down && this.states.touchpad === false && touchpad.pressed === true) {\n                        this.moveForward()\n                    }\n                    if (up && this.states.touchpad === false && touchpad.pressed === true) {\n                        this.moveBackward()\n                    }\n                    if (left && this.states.touchpad === false && touchpad.pressed === true) {\n                        this.rotateLeft()\n                    }\n                    if (right && this.states.touchpad === false && touchpad.pressed === true) {\n                        this.rotateRight()\n                    }\n                }\n\n                const trigger = gamepad.buttons[1]\n                if(trigger.pressed) console.log(\"trigger\")\n                if(this.states.touchpad === false && touchpad.pressed === true) {\n                    console.log(\"pressed\")\n                }\n                if(this.states.touchpad === true && touchpad.pressed === false) {\n                    console.log(\"released\")\n                }\n                this.states.touchpad = touchpad.pressed\n            }\n\n        }\n    }\n\n}\n","import SceneDef from './defs/SceneDef'\nimport SelectionManager from '../SelectionManager'\nimport {toQueryString} from '../utils'\nimport {ITEM_ICONS, OBJ_TYPES, TOTAL_OBJ_TYPES} from './Common'\nimport {PopupManager} from 'appy-comps'\nimport {MenuPopup} from '../common/GridEditorApp'\nimport React from 'react'\nimport {AuthModule} from './AuthModule'\n\nexport function addScene(provider) {\n    const root = provider.accessObject(provider.getSceneRoot())\n    const scenes = root.getChildren().filter(ch => ch.type === TOTAL_OBJ_TYPES.SCENE)\n    let prev = null\n    if(scenes.length >= 1) prev = scenes[scenes.length-1]\n    const scene = new SceneDef().make(provider.getDataGraph(),root)\n    if(prev) {\n        root.insertChildAfter(scene,prev)\n    } else {\n        root.insertFirstChild(scene)\n    }\n    SelectionManager.setSelection(scene.id)\n}\n\n\nexport function deleteObject(provider) {\n    if(SelectionManager.isEmpty()) return\n    provider.accessObject(SelectionManager.getSelection()).removeFromParent()\n    SelectionManager.clearSelection()\n}\n\nexport function newDoc(provider) {\n    const opts = Object.assign({},provider.options,\n        {mode:'edit', switcher:false, doc:provider.genID('doc')})\n    document.location =  `./?${toQueryString(opts)}`\n}\n\n\nexport function showAddPopup (e, provider) {\n    let item = provider.getSelectedSceneObject()\n    const acts = Object.keys(OBJ_TYPES).map(type => {\n        return {\n            title: type,\n            icon: ITEM_ICONS[type],\n            fun: () => provider.add3DObject(type,item)\n        }\n    })\n    PopupManager.show(<MenuPopup actions={acts}/>, e.target)\n}\n\nexport function showAddAssetPopup(e, provider) {\n    const acts = generateAddAssetPopup(provider)\n    PopupManager.show(<MenuPopup actions={acts}/>, e.target)\n}\n\nexport function generateAddAssetPopup(provider) {\n    let acts = []\n    // console.log(\"Auth mod\",AuthModule.supportsAssetUpload())\n    if(AuthModule.supportsAssetUpload()) {\n        acts = acts.concat([\n            {\n                title: 'image',\n                enabled: AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.image,\n                fun: () => provider.showAddImageAssetDialog()\n            },\n            {\n                title: 'server image',\n                enabled: AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.image,\n                fun: () => provider.showAddServerImageDialog()\n            },\n            {divider: true},\n            {\n                title: 'GLTF model',\n                enabled: AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.model,\n                fun: () => provider.showAddGLTFAssetDialog()\n            },\n            {\n                title: 'GLB model',\n                enabled: AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.model,\n                fun: () => provider.showAddGLBAssetDialog()\n            },\n            {divider: true},\n            {\n                title: 'audio file',\n                enabled: AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.audio,\n                fun: () => provider.showAddAudioAssetDialog()\n            },\n            {\n                title: 'existing asset on server',\n                enabled: AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.assets,\n                fun: () => provider.showOpenAssetDialog()\n            }])\n    } else {\n        acts.push({\n            title: 'add asset from glitch',\n            icon: ITEM_ICONS.assets,\n            fun: () => provider.showOpenAssetDialog()\n        })\n    }\n\n    acts.push({\n        title:'geo location',\n        icon: ITEM_ICONS.geoanchor,\n        fun: () => provider.showAddGeoLocationAssetDialog()\n    })\n\n    return acts\n}\n\nexport function showAddBehaviorPopup (e, provider) {\n    const acts = [\n        {\n            title:'Add Behavior from Server',\n            enabled: AuthModule.isLoggedIn(),\n            icon: ITEM_ICONS.behavior_script,\n            fun: () => provider.showOpenBehaviorDialog()\n        },\n    ]\n    if(AuthModule.supportsScriptEdit()) {\n        acts.push({\n            title: 'custom behavior',\n            enabled: AuthModule.isLoggedIn(),\n            icon: ITEM_ICONS.behavior_script,\n            fun: () => provider.addCustomBehaviorAsset()\n        })\n    }\n    PopupManager.show(<MenuPopup actions={acts}/>, e.target)\n}\n","import React, {Component} from 'react'\nimport {\n    AmbientLight,\n    AudioListener,\n    Color,\n    CylinderBufferGeometry,\n    DirectionalLight,\n    Group,\n    Mesh,\n    MeshLambertMaterial,\n    PerspectiveCamera,\n    Scene,\n    WebGLRenderer\n} from 'three'\n\n// import './VREditor.css'\n\nimport {Pointer, POINTER_CLICK, VR_DETECTED, VRManager, VRStats} from \"webxr-boilerplate\"\n\nimport {TREE_ITEM_PROVIDER} from '../TreeItemProvider'\nimport SelectionManager, {SELECTION_MANAGER} from '../SelectionManager'\nimport {TranslateControl} from './TranslateControl'\nimport panel2d from \"./panel2d/panel2d\"\nimport button2d from \"./panel2d/button2d\"\nimport group2d from \"./panel2d/group2d\"\nimport SceneDef from \"./defs/SceneDef\"\nimport {on, parseOptions} from \"../utils\"\nimport {TweenManager} from \"../common/tween\"\nimport {get3DObjectDef, is3DObjectType, OBJ_TYPES, SIMPLE_COLORS, toRad, TOTAL_OBJ_TYPES} from './Common'\n//use the oculus go controller\nimport ThreeDOFController from \"./3dof.js\"\nimport ScriptManager, {SceneGraphProvider} from './ScriptManager'\nimport {deleteObject} from './Actions'\nimport {DialogContainer} from 'appy-comps'\nimport {PubnubLogger} from '../syncgraph/PubnubSyncWrapper'\n\nconst {SET_PROPERTY, CREATE_OBJECT, INSERT_ELEMENT, DELETE_ELEMENT} = require(\"syncing_protocol\");\n\nclass Adapter extends SceneGraphProvider {\n    constructor(editor, provider) {\n        super()\n        this.editor = editor\n        this.provider = provider\n    }\n    getCurrentScene ()  {\n        return this.provider.accessObject(this.editor.currentScene)\n    }\n    getSceneObjects (scene)  {\n        return scene.getChildren().filter(ch => is3DObjectType(ch.type))\n    }\n    getBehaviorsForObject (obj)  {\n        return obj.getChildren().filter(ch => ch.type === TOTAL_OBJ_TYPES.BEHAVIOR)\n    }\n    getThreeObject(id) {\n        return this.editor.findNode(id)\n    }\n    getParsedBehaviorAsset (beh) {\n        const asset = this.provider.accessObject(beh.behavior)\n        return this.provider.getCachedBehaviorAsset(asset.id)\n    }\n    getAllBehaviors ()  {\n        return this.provider.accessObject(this.provider.getSceneRoot())\n            .find((obj)=> obj.type === TOTAL_OBJ_TYPES.BEHAVIOR)\n    }\n\n    getAllScenes() {\n        return this.provider.accessObject(this.provider.getSceneRoot())\n            .find((obj)=>obj.type === TOTAL_OBJ_TYPES.SCENE)\n    }\n\n    navigateScene(id) {\n        const obj = this.provider.accessObject(id)\n        if(obj.exists()) {\n            return this.editor.swapScene(id)\n        } else {\n            const logger = this.provider.getLogger()\n            logger.error(\"cannot navigate to scene that does not exist\",id)\n        }\n    }\n    playMediaAsset(asset, trusted) {\n        this.provider.assetsManager.playMediaAsset(asset, trusted)\n    }\n\n    stopMediaAsset(asset) {\n        this.provider.assetsManager.stopMediaAsset(asset)\n    }\n\n    getGraphObjectByName(title) {\n        const list = this.provider.accessObject(this.provider.getSceneRoot()).find((o)=>o.title === title)\n        if(!list || list.length<1) return null\n        return list[0]\n    }\n    getGraphObjectById(id) {\n        return this.provider.accessObject(id)\n    }\n\n    getCamera() {\n        return this.editor.camera\n    }\n    \n\n    getTweenManager() {\n        return this.editor.tweenManager\n    }\n\n    getFloorNear(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO get floor near\")\n    }\n\n    startLocalAnchor(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO start local anchor\")\n    }\n\n    stopLocalAnchor(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO stop local anchor\")\n    }\n\n    startImageRecognizer(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO start image recognizer\")\n    }\n\n    stopImageRecognizer(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO stop image recognizer\")\n    }\n\n    startGeoTracker(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO start geo recognizer\")\n    }\n\n    stopGeoTracker(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO stop geo recognizer\")\n    }\n\n    startWorldInformation(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO start world information\")\n        return 0\n    }\n\n    stopWorldInformation(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO stop world information\")\n        return 0\n    }\n\n}\n\nexport default class ImmersiveVREditor extends Component {\n    constructor(props) {\n        super(props)\n        this.obj_node_map = {}\n        this.previewUpdateNodes = []\n        const opts = parseOptions({})\n        if(!opts.doc) throw new Error(\"doc not specified\")\n        this.logger = new PubnubLogger(opts.doc)\n        this.scriptManager = new ScriptManager(new Adapter(this, this.props.provider), this.logger)\n    }\n\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\n        return false\n    }\n\n\n    render() {\n        return <div>\n            <div id=\"overlay\">\n                <div id=\"inner\">\n                    <h1>Application Name</h1>\n                    <div id=\"loading-indicator\">\n                        <label>loading...</label><br></br>\n                        <progress max=\"100\" value=\"0\" id=\"progress\"></progress>\n                    </div>\n                    <button id=\"enter-button\" disabled>VR not supported, play anyway</button>\n                </div>\n            </div>\n            <div ref={c => this.wrapper = c}></div>\n            <DialogContainer/>\n        </div>\n    }\n\n\n    componentDidMount() {\n        this.sceneWrappers = {}\n        this.initScene()\n        this.renderer.setAnimationLoop(this.render3.bind(this))\n    }\n\n    render3(time) {\n        //update the pointer and stats, if configured\n        if(this.tweenManager) this.tweenManager.update(time)\n        this.previewUpdateNodes.forEach(n => n.previewUpdate())\n        if(this.pointer) this.pointer.tick(time)\n        if(this.stats) this.stats.update(time)\n        if(this.controller) this.controller.update(time)\n        if(this.scriptManager.isRunning()) this.scriptManager.tick(time)\n        this.renderer.render( this.scene, this.camera );\n    }\n\n    initScene() {\n\n        const $ = (sel) => document.querySelector(sel)\n        const on = (elem, type, cb) => elem.addEventListener(type,cb)\n\n        const container = this.wrapper\n        this.tweenManager = new TweenManager()\n        this.scene = new Scene();\n        this.stageRot = new Group()\n        this.scene.add(this.stageRot)\n        this.stagePos = new Group()\n        this.stageRot.add(this.stagePos)\n        this.camera = new PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 0.1, 50 );\n        this.renderer = new WebGLRenderer( { antialias: true } );\n        const renderer = this.renderer\n        renderer.setPixelRatio( window.devicePixelRatio );\n        renderer.setSize( window.innerWidth, window.innerHeight );\n        renderer.gammaOutput = true\n        renderer.vr.enabled = true;\n        container.appendChild( renderer.domElement );\n        this.vrmanager = new VRManager(renderer)\n\n        this.audioListener = new AudioListener()\n        this.props.provider.setAudioListener(this.audioListener)\n        this.camera.add(this.audioListener)\n\n        this.initContent()\n\n        window.addEventListener( 'resize', ()=>{\n            this.camera.aspect = window.innerWidth / window.innerHeight;\n            this.camera.updateProjectionMatrix();\n            this.renderer.setSize( window.innerWidth, window.innerHeight );\n        }, false );\n\n\n        on($(\"#enter-button\"),'click',()=>{\n            $(\"#overlay\").style.display = 'none'\n            //we can start playing sound now\n        })\n\n        this.vrmanager.addEventListener(VR_DETECTED,()=>{\n            console.log(\"VR detected\")\n            $(\"#enter-button\").removeAttribute('disabled',false)\n            $(\"#enter-button\").innerText = \"enter vr\"\n            on($(\"#enter-button\"),'click',()=> this.vrmanager.enterVR())\n        })\n\n        const WAIT_FOR_LOAD = false\n\n        if(!WAIT_FOR_LOAD) {\n            $(\"#loading-indicator\").style.display = 'none'\n            $(\"#enter-button\").style.display = 'block'\n            $(\"#enter-button\").removeAttribute('disabled')\n        }\n\n        this.props.provider.onRawChange(this.updateSceneOp.bind(this))\n        this.props.provider.on(TREE_ITEM_PROVIDER.DOCUMENT_SWAPPED, this.documentSwapped.bind(this))\n        SelectionManager.on(SELECTION_MANAGER.CHANGED, this.selectionChanged.bind(this))\n        //clear selection when click on the bg\n        on(this.pointer,POINTER_CLICK,()=> SelectionManager.clearSelection())\n\n        this.controller = new ThreeDOFController(this.stagePos, this.stageRot)\n        // on(this.controller,'move', this.standardProximityHandler)\n\n        this.loadScene()\n    }\n\n    selectionChanged() {\n        const sel = SelectionManager.getSelection()\n        if (sel === null && this.controls) return this.controls.detach(this.selectedNode)\n        const node = this.findNode(sel)\n        if(this.selectedNode !== node && this.controls) this.controls.detach(this.selectedNode)\n        this.selectedNode = node\n        if (this.selectedNode && this.controls) this.controls.attach(this.selectedNode, this.pointer)\n    }\n\n    standardViewClickHandler = (e)  => {\n        if(this.scriptManager.isRunning()) {\n            this.scriptManager.performClickAction(this.props.provider.accessObject(e.target.userData.graphid), e)\n        } else {\n            SelectionManager.setSelection(e.target.userData.graphid)\n        }\n    }\n\n\n    initContent() {\n        if(!this.xr) this.scene.background = new Color(0x000000);\n        const light = new DirectionalLight( 0xffffff, 1.0 );\n        light.position.set( 1, 1, 1 ).normalize();\n        this.scene.add( light );\n        this.scene.add(new AmbientLight(0xffffff,0.2))\n\n        // enable stats visible inside VR\n        this.stats = new VRStats({renderer:this.renderer})\n        if(this.props.editable) {\n            this.camera.add(this.stats)\n        }\n        this.scene.add(this.camera)\n        this.camera.matrixAutoUpdate = false\n\n        //class which handles mouse and VR controller \n        this.pointer = new Pointer(this, {\n            intersectionFilter: ((o) => o.userData.clickable),\n            cameraFollowMouse:false,\n            mouseSimulatesController:false,\n            enableLaser: true,\n            laserLength: 20,\n        })\n\n\n        const STICK_HEIGHT = 1.0\n        const stick = new Mesh(\n            new CylinderBufferGeometry(0.1,0.1,STICK_HEIGHT),\n            new MeshLambertMaterial({color:'aqua'})\n        )\n        stick.position.z = -STICK_HEIGHT/2;\n        stick.rotation.x = toRad(-90)\n        this.pointer.controller1.add(stick)\n\n\n        if(this.props.editable) {\n            this.controls = new TranslateControl()\n            this.controls.name = 'Controls'\n            on(this.controls, 'change', (e) => {\n                const sel = SelectionManager.getSelection()\n                if (sel) {\n                    const node = this.findNode(sel)\n                    const prov = this.props.provider\n                    prov.quick_setPropertyValue(sel, 'tx', node.position.x)\n                    prov.quick_setPropertyValue(sel, 'ty', node.position.y)\n                    prov.quick_setPropertyValue(sel, 'tz', node.position.z)\n                }\n            })\n        }\n\n        if(this.props.editable) {\n            this.tools = new panel2d(this.scene, this.camera)\n            this.tools.position.set(-1, 0, -3)\n            this.scene.add(this.tools)\n\n\n            this.tools.add(new button2d()\n                .setAll({x: 5, y: 5, text: 'add box'})\n                .on(POINTER_CLICK, () => {\n                    const scene = this.props.provider.accessObject(this.currentScene)\n                    this.props.provider.add3DObject(OBJ_TYPES.cube,scene)\n                }))\n            this.tools.add(new button2d()\n                .setAll({x: 5, y: 5 + 30, text: 'add sphere'})\n                .on(POINTER_CLICK, () => {\n                    const scene = this.props.provider.accessObject(this.currentScene)\n                    this.props.provider.add3DObject(OBJ_TYPES.sphere,scene)\n                }))\n            this.tools.add(new button2d()\n                .setAll({x: 5, y: 5 + 30 + 30, text: 'delete'})\n                .on(POINTER_CLICK, ()=>{\n                    deleteObject(this.props.provider)\n                }))\n            this.tools.add(new button2d()\n                .setAll({x: 5, y: 5 + 30 + 30 + 30, text: 'save'})\n                .on(POINTER_CLICK, this.props.provider.save))\n            const runButton = new button2d()\n                .setAll({x:5, y: 5+30*4, text:'run'})\n                .on(POINTER_CLICK,() => {\n                    if(this.scriptManager.isRunning()) {\n                        runButton.set('text','run')\n                        this.scriptManager.stopRunning()\n                    } else {\n                        runButton.set('text','stop')\n                        this.scriptManager.startRunning()\n                        this.scriptManager.startFirstScene()\n                    }\n                })\n            this.tools.add(runButton)\n\n            const rowLayout = (panel) => {\n                let x = 0\n                panel.comps.forEach((c) => {\n                    c.x = x\n                    c.y = 0\n                    x += c.w + panel.padding\n                })\n            }\n\n            const color_group = new group2d().setAll({x: 5, y: 5 + 30 * 5, w: 235, h: 35, layout: rowLayout})\n            SIMPLE_COLORS.forEach(c => {\n                color_group.add(new button2d()\n                    .setAll({text: ' ', normalBg: c})\n                    .on(POINTER_CLICK, () => this.props.provider.setColor(c))\n                )\n            })\n\n            this.tools.add(color_group)\n\n            this.tools.redraw()\n        }\n\n    }\n\n\n    updateSceneOp(op) {\n        //only do scenes with create_object\n        if (op.type === CREATE_OBJECT) {\n            if(op.defaults) {\n                //console.log(\"creating object with defaults\",op.defaults)\n                if(op.defaults.type === 'scene') {\n                    let node =  this.findNode(op.id)\n                    if(node) {\n                        // console.log(\"scene already exists. skipping\", node.name)\n                    } else {\n                        // console.log(\"Making a real scene\", op)\n                        const obj = this.props.provider.accessObject(op.id)\n                        node = new SceneDef().makeNode(obj, this.props.provider)\n                        this.insertNodeMapping(op.id,node)\n                        this.sceneWrappers[op.id] = node\n                        this.stagePos.add(node)\n                        // this.scene.add(node)\n                        this.swapScene(op.id)\n                    }\n                }\n            }\n        }\n        // other objects are done with insert_element\n        if (op.type === INSERT_ELEMENT) {\n            const obj = this.props.provider.accessObject(op.value)\n            if (obj.type === 'scene') return // console.log(\"skipping insert scene\")\n            if(is3DObjectType(obj.type)) {\n                const nodeObj = get3DObjectDef(obj.type).makeNode(obj, this.props.provider)\n                on(nodeObj, POINTER_CLICK, this.standardViewClickHandler)\n                this.insertNodeMapping(obj.id, nodeObj)\n                this.findNode(obj.parent).add(nodeObj)\n                return\n            }\n            if(obj.type === TOTAL_OBJ_TYPES.ASSETS_LIST) return\n            if(obj.type === TOTAL_OBJ_TYPES.ASSET) return\n            if(obj.type === TOTAL_OBJ_TYPES.BEHAVIORS_LIST) return\n            if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR) return\n            if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) return\n            console.warn(\"unknown object type\", obj)\n            return\n        }\n        if (op.type === SET_PROPERTY) {\n            const obj = this.props.provider.accessObject(op.object)\n            if(obj.type === 'asset') return\n            if(obj.type === 'assets') return\n            const node = this.findNode(op.object)\n            if (node) {\n                if(op.name === 'parent') return\n                if(obj.type === 'scene') return new SceneDef().updateProperty(node,obj,op,this.props.provider)\n                if(is3DObjectType(obj.type)) return get3DObjectDef(obj.type).updateProperty(node,obj,op, this.props.provider)\n            } else {\n                console.log(\"could not find the node for object id:\", op)\n                //console.log(\"objects are\",this.obj_node_map)\n            }\n            return\n        }\n        if(op.type === DELETE_ELEMENT) {\n            const obj = this.props.provider.accessObject(op.value)\n            if(is3DObjectType(obj.type)) {\n                const node = this.findNode(obj.id)\n                this.findNode(obj.parent).remove(node)\n            }\n        }\n        // console.log('skipping', op.type)\n    }\n    documentSwapped() {\n        console.log(\"totally new document!\")\n        //nuke all the old stuff\n        Object.keys(this.sceneWrappers).forEach(key => {\n            const scene = this.sceneWrappers[key]\n            if(this.controls) scene.remove(this.controls)\n            this.stagePos.remove(scene)\n        })\n        this.sceneWrappers = {}\n        this.obj_node_map = {}\n        // this.setState({scene: -1})\n        //make new stuff\n        const graph = this.props.provider.getDocGraph()\n        console.log(\"we are building the graph\")\n        //console.log(\"we are rebuilding using this graph\",graph)\n        this.rebuildNode(graph,\"\")\n    }\n\n    rebuildNode(obj, inset) {\n        console.log(inset,\"rebuilding\",obj.type)\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) {\n            const node = new SceneDef().makeNode(obj, this.props.provider)\n            this.insertNodeMapping(obj.id,node)\n            this.sceneWrappers[obj.id] = node\n            this.stagePos.add(node)\n            this.swapScene(obj.id)\n        }\n        if(is3DObjectType(obj.type)) {\n            const node = get3DObjectDef(obj.type).makeNode(obj, this.props.provider)\n            on(node, POINTER_CLICK, this.standardViewClickHandler)\n            this.insertNodeMapping(obj.id, node)\n            this.findNode(obj.parent).add(node)\n        }\n        if(obj.children) {\n            obj.children.forEach(ch => {\n                this.rebuildNode(ch,inset+\"   \")\n            })\n        }\n    }\n\n    swapScene(id) {\n        this.currentScene = id\n        console.log(\"swapping to the scene\",id)\n        //make all scenes invisible except the right one\n        Object.keys(this.sceneWrappers).forEach(key => {\n            const scene = this.sceneWrappers[key]\n            scene.visible = (key === id)\n            if(this.controls) scene.remove(this.controls)\n        })\n        if(this.controls) this.sceneWrappers[id].add(this.controls)\n        this.sceneWrappers[id].position.x = 0\n        this.sceneWrappers[id].position.z = 0\n    }\n\n\n    loadScene() {\n    }\n\n    insertNodeMapping(id, node) {\n        if (typeof id !== 'string') throw new Error(\"cannot map an object to an object. invalid call in insertNodeMapping\")\n        this.obj_node_map[id] = node\n        if(node.previewUpdate) this.previewUpdateNodes.push(node)\n        node.userData.graphid = id\n    }\n\n    findNode(id) {\n        if (!this.obj_node_map[id]) console.warn(\"could not find node for id\", id)\n        return this.obj_node_map[id]\n    }\n\n\n}\n\n\n","\nexport default class InputManager {\n    static KEYS = {\n        S:83,\n        Z:90,\n        C:67,\n        V:86,\n        X:88,\n        LEFT_ARROW:37,\n        RIGHT_ARROW:39,\n    }\n    static MODIFIERS = {\n        COMMAND:'COMMAND',\n        SHIFT:'SHIFT'\n    }\n\n    constructor() {\n        this.bindings = []\n        this.listeners = {}\n    }\n\n    addKeyBinding(binding) {\n        this.bindings.push(binding)\n    }\n    addListener(name,cb) {\n        if(!this.listeners[name]) {\n            this.listeners[name] = []\n        }\n        this.listeners[name].push(cb)\n    }\n\n    attachKeyEvents(document) {\n        document.addEventListener('keydown',this.keyDown)\n    }\n\n    keyDown = (e)=>{\n        // console.log(\"-------------\")\n        // console.log(\"got a key press\",e.shiftKey, e.metaKey, e.key, e.keyCode)\n        const matches = this.bindings.filter((b)=>b.key === e.keyCode)\n        // console.log(\"got the bindings\",matches)\n        const m2 = matches.filter((b)=>{\n            let valid = true\n            b.modifiers.forEach((mod)=>{\n                if(mod === InputManager.MODIFIERS.COMMAND && !e.metaKey) {\n                    // console.log(\"missing the meta key\");\n                    valid = false\n                }\n                if(mod === InputManager.MODIFIERS.SHIFT && !e.shiftKey) {\n                    // console.log(\"missing the shift key\");\n                    valid = false\n                }\n            })\n            if(e.shiftKey && !b.modifiers.some(mod=>mod === InputManager.MODIFIERS.SHIFT)) {\n                // console.log(\"shift is down, but missing shift in the def\")\n                valid = false\n            }\n            // console.log(\"still valid\",valid)\n            return valid\n        })\n        // console.log(\"final list is\",m2.length)\n        if(m2.length > 0) {\n            // console.log(\"something matched\")\n            // e.preventDefault()\n            this.dispatchEvents(m2,e)\n        }\n    }\n    dispatchEvents(matches,e) {\n        matches.forEach((bind)=>{\n            if(this.listeners[bind.id]) this.listeners[bind.id].forEach((cb)=>cb?cb(e):null)\n        })\n    }\n}\n","import * as ToasterManager from './ToasterManager'\nimport {getAssetsURL} from '../TreeItemProvider'\nimport {ASSET_TYPES, MIME_TYPES, TOTAL_OBJ_TYPES} from './Common'\nimport {fetchGraphObject} from '../syncgraph/utils'\nimport {AuthModule} from './AuthModule'\n\nexport function addImageAssetFromExpandedURL(assetId, url,format,title, prov) {\n    if(!AuthModule.supportsAssetUpload()) assetId = title\n\n    const asset = prov.accessObject(prov.getDataGraph().createObject({\n        type:TOTAL_OBJ_TYPES.ASSET,\n        subtype:ASSET_TYPES.IMAGE,\n        assetId:assetId,\n        format:format,\n        src:url,\n        width:100,\n        height:100,\n        title:title,\n        parent:0\n    }))\n    prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n    prov.requestImageCache(prov.assetsManager.getAssetURL(asset)).then(img => {\n        asset.set('width',img.width)\n        asset.set('height',img.height)\n    })\n}\n\nexport function addGeoAnchorAsset(info,title,prov) {\n    const asset = prov.accessObject(prov.getDataGraph().createObject({\n        type:TOTAL_OBJ_TYPES.ASSET,\n        subtype:ASSET_TYPES.GEOLOCATION,\n        title:title,\n        latitude:info.latitude,\n        longitude:info.longitude,\n        altitude:info.altitude,\n        useAltitude:info.useAltitude,\n        parent:0\n    }))\n    prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n}\n\nexport function addImageAssetFromFile (file, prov) {\n    ToasterManager.add('uploading ' + file.name)\n    AuthModule.uploadFile(file).then((ans)=>{\n        ToasterManager.add('uploaded')\n        if(ans.success === false) return console.log(\"there was an error uploading! :(\")\n        return addImageAssetFromExpandedURL(null,getAssetsURL()+ans.asset.id, ans.asset.mimeType, file.name, prov)\n    })\n}\nexport function addImageAssetFromURL  (url, prov) {\n    //TODO: make this format detection code more robust\n    const name = url.substring(url.lastIndexOf('/') + 1)\n    const type = name.substring(name.lastIndexOf(\".\") + 1)\n    let fileType = \"image/unknown\"\n    if (type.toLowerCase() === 'png') fileType = MIME_TYPES.PNG\n    if (type.toLowerCase() === 'jpg') fileType = MIME_TYPES.JPEG\n    if (type.toLowerCase() === 'jpeg') fileType = MIME_TYPES.JPEG\n    return addImageAssetFromExpandedURL(null,url, fileType, name, prov)\n}\nexport function addGLBAssetFromFile (file, prov) {\n    ToasterManager.add('uploading '+ file.name)\n    prov.uploadFile(file).then((ans)=>{\n        ToasterManager.add('uploaded')\n        if(ans.success === false) return console.log(\"there was an error uploading! :(\")\n        const url = getAssetsURL()+ans.asset.id\n        const graph = prov.getDataGraph()\n        const asset = fetchGraphObject(graph,graph.createObject({\n            type:TOTAL_OBJ_TYPES.ASSET,\n            subtype:ASSET_TYPES.GLTF,\n            format:MIME_TYPES.GLB,\n            src:url,\n            title:file.name,\n            parent:0\n        }))\n        prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n    })\n}\n\nexport function addAudioAssetFromFile (file, prov) {\n    ToasterManager.add('uploading')\n    prov.uploadFile(file).then((ans)=>{\n        ToasterManager.add('uploaded')\n        console.log(\"uploaded file with answer\",ans)\n        if(ans.success === false) return console.log(\"there was an error uploading! :(\")\n        const url = getAssetsURL()+ans.asset.id\n        const graph = prov.getDataGraph()\n        const asset = fetchGraphObject(graph,graph.createObject({\n            type:TOTAL_OBJ_TYPES.ASSET,\n            subtype:ASSET_TYPES.AUDIO,\n            format:ans.asset.mimeType,\n            src:url,\n            title:file.name,\n            parent:0\n        }))\n        prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n    })\n}\nexport function addAudioAssetFromURL (assetId, url, fileType, name, prov) {\n    //TODO: make this format detection code more robust\n    if(!name) {\n        name = url.substring(url.lastIndexOf('/') + 1)\n    }\n    if(!fileType) {\n        const type = name.substring(name.lastIndexOf(\".\") + 1)\n        fileType = \"audio/unknown\"\n        if(type.toLowerCase() === 'mp3') fileType = MIME_TYPES.MP3\n        if(type.toLowerCase() === 'aac') fileType = MIME_TYPES.AAC\n    }\n    if(!AuthModule.supportsAssetUpload()) assetId = name\n\n    const graph = prov.getDataGraph()\n    const asset = fetchGraphObject(graph,graph.createObject({\n        type: TOTAL_OBJ_TYPES.ASSET,\n        subtype:ASSET_TYPES.AUDIO,\n        assetId:assetId,\n        format:fileType,\n        src:url,\n        title:name,\n        parent:0\n    }))\n    prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n}\n\nexport function addVideoAssetFromURL (assetId, url, fileType, title, prov) {\n    if(!title) title = url.substring(url.lastIndexOf('/') + 1)\n    if(!AuthModule.supportsAssetUpload()) assetId = title\n    const asset = prov.accessObject(prov.getDataGraph().createObject({\n        type: TOTAL_OBJ_TYPES.ASSET,\n        subtype:ASSET_TYPES.VIDEO,\n        assetId:assetId,\n        format:fileType,\n        src:url,\n        title:title,\n        parent:0\n    }))\n    prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n}\n\n\nexport function addGLBAssetFromURL(assetId, url, fileType, title, prov) {\n    if(!title) title = url.substring(url.lastIndexOf('/') + 1)\n    if(!AuthModule.supportsAssetUpload()) assetId = title\n    const asset = prov.accessObject(prov.getDataGraph().createObject({\n        type: TOTAL_OBJ_TYPES.ASSET,\n        subtype:ASSET_TYPES.GLTF,\n        assetId:assetId,\n        format:fileType,\n        src:url,\n        title:title,\n        parent:0\n    }))\n    prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n}","import React, {Component} from 'react'\nimport {DialogManager, HBox} from 'appy-comps'\nimport {listToArray} from '../../syncgraph/utils'\nimport {ToggleButton} from '../../common/GridEditorApp'\nimport {addImageAssetFromFile, addImageAssetFromURL} from '../AssetActions'\nimport {Dialog} from '../../common/Dialog'\n\nexport class AddImageAssetDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            view:'local',\n            url:\"\",\n        }\n        this.fileInput = React.createRef();\n    }\n\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        if(this.state.view === 'remote') {\n            console.log(\"adding the url\",this.state.url)\n            addImageAssetFromURL(this.state.url, this.props.provider)\n        } else {\n            console.log(\"the file input is\",this.fileInput)\n            listToArray(this.fileInput.current.files).forEach(file => {\n                addImageAssetFromFile(file, this.props.provider)\n            })\n        }\n    }\n    switchLocal = () => this.setState({view:'local'})\n    switchRemote = () => this.setState({view:'remote'})\n\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n            <header>add image to assets</header>\n            <section>\n                <HBox>\n                    <ToggleButton onClick={this.switchLocal} selected={this.state.view==='local'}>local</ToggleButton>\n                    <ToggleButton onClick={this.switchRemote} selected={this.state.view==='remote'}>remote</ToggleButton>\n                </HBox>\n                {this.renderSelectedPanel()}\n            </section>\n            <footer>\n                <button onClick={this.cancel}>cancel</button>\n                <button onClick={this.okay}>okay</button>\n            </footer>\n        </Dialog>\n    }\n\n    selectedFile = (e) => {\n        this.setState({fileInput:e.target.value})\n    }\n\n    typedURL = (e) => {\n        this.setState({url:e.target.value})\n    }\n\n    renderSelectedPanel() {\n        if(this.state.view === 'local') {\n            return <HBox>\n                <label>File\n                    <input key=\"f1\" type=\"file\" onChange={this.selectedFile} ref={this.fileInput}/>\n                </label>\n            </HBox>\n        } else {\n            return <HBox>\n                <label>URL\n                    <input key=\"f2\" value={this.state.url} type=\"input\" onChange={this.typedURL}/>\n                </label>\n            </HBox>\n        }\n    }\n}\n","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {listToArray} from '../../syncgraph/utils'\nimport {Dialog} from '../../common/Dialog'\n\nexport class AddGLTFAssetDialog extends Component {\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        listToArray(this.fileinput.files).forEach(file => {\n            console.log(\"got the file\", file)\n        })\n    }\n\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n            <header>add GLTF file assets</header>\n            <section>\n                <p>\n                    chose <b>the directory</b> containing the GLTF file\n                </p>\n                <input type=\"file\" ref={(obj) => this.fileinput = obj} onChange={this.selectedFile} multiple={true}\n                       webkitdirectory=\"true\"/>\n            </section>\n            <footer>\n                <button onClick={this.cancel}>cancel</button>\n                <button onClick={this.okay}>okay</button>\n            </footer>\n        </Dialog>\n    }\n\n    selectedFile = (e) => {\n        console.log(\"selected a file\", e.target)\n    }\n}\n","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {listToArray} from '../../syncgraph/utils'\nimport {addGLBAssetFromFile} from '../AssetActions'\nimport {Dialog} from '../../common/Dialog'\n\nexport class AddGLBAssetDialog extends Component {\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        listToArray(this.fileinput.files).forEach(file => {\n            addGLBAssetFromFile(file, this.props.provider)\n        })\n    }\n\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n            <header>add GLB to assets</header>\n            <section>\n                <p>choose a local GLB file</p>\n                <input type=\"file\" ref={(obj) => this.fileinput = obj} onChange={this.selectedFile} multiple={true}/>\n            </section>\n            <footer>\n                <button onClick={this.cancel}>cancel</button>\n                <button onClick={this.okay}>okay</button>\n            </footer>\n        </Dialog>\n    }\n\n    selectedFile = (e) => {\n        console.log(\"selected a file\", e.target)\n    }\n}\n","import React, {Component} from 'react'\nimport {DialogManager, HBox} from 'appy-comps'\nimport {listToArray} from '../../syncgraph/utils'\nimport {ToggleButton} from '../../common/GridEditorApp'\nimport {addAudioAssetFromFile, addAudioAssetFromURL} from '../AssetActions'\nimport {Dialog} from '../../common/Dialog'\n\nexport class AddAudioAssetDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            view:'local',\n            url:\"\",\n        }\n        this.fileInput = React.createRef();\n    }\n\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        if(this.state.view === 'remote') {\n            console.log(\"adding the url\",this.state.url)\n            addAudioAssetFromURL(null,this.state.url, this.props.provider)\n        } else {\n            console.log(\"the file input is\",this.fileInput)\n            listToArray(this.fileInput.current.files).forEach(file => {\n                addAudioAssetFromFile(file, this.props.provider)\n            })\n        }\n    }\n    switchLocal = () => this.setState({view:'local'})\n    switchRemote = () => this.setState({view:'remote'})\n\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n                <header>add audio to assets</header>\n                <section>\n                    <HBox>\n                        <ToggleButton onClick={this.switchLocal} selected={this.state.view==='local'}>local</ToggleButton>\n                        <ToggleButton onClick={this.switchRemote} selected={this.state.view==='remote'}>remote</ToggleButton>\n                    </HBox>\n                    {this.renderSelectedPanel()}\n                </section>\n                <footer>\n                    <button onClick={this.cancel}>cancel</button>\n                    <button onClick={this.okay}>okay</button>\n                </footer>\n        </Dialog>\n    }\n\n    selectedFile = (e) => {\n        //console.log(\"selected a file\", e.target)\n        this.setState({fileInput:e.target.value})\n    }\n\n    typedURL = (e) => {\n        this.setState({url:e.target.value})\n    }\n\n    renderSelectedPanel() {\n        if(this.state.view === 'local') {\n            return <HBox>\n                <label>File\n                    <input key=\"f1\" type=\"file\" onChange={this.selectedFile} ref={this.fileInput}/>\n                </label>\n            </HBox>\n        } else {\n            return <HBox>\n                <label>URL\n                    <input key=\"f2\" value={this.state.url} type=\"input\" onChange={this.typedURL}/>\n                </label>\n            </HBox>\n        }\n    }\n}\n","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {Dialog} from '../../common/Dialog'\n\nexport class UnsavedDocumentDialog extends Component {\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        this.props.onAnyway()\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel} width=\"600px\" height=\"auto\">\n            <header>Warning. Your document has unsaved changes.</header>\n            <section>\n            <p>Press cancel to go back</p>\n            <p>Press continue to continue anyway and lose the unsaved changes</p>\n            </section>\n            <footer>\n                <button onClick={this.cancel}>cancel</button>\n                <button onClick={this.okay}>continue!</button>\n            </footer>\n        </Dialog>\n    }\n}\n\n","/* eslint-disable */\nconst THREE = require('three'); //requireimport * as THREE from 'three'\n\n// Copyright 2016 The Draco Authors.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n\n/**\n * @param {THREE.LoadingManager} manager\n */\n\nconst DRACOLoader = ( function () { \n\n    function DRACOLoader (manager) {\n        this.timeLoaded = 0;\n        this.manager = manager || THREE.DefaultLoadingManager;\n        this.materials = null;\n        this.verbosity = 0;\n        this.attributeOptions = {};\n        this.drawMode = THREE.TrianglesDrawMode;\n        // Native Draco attribute type to Three.JS attribute type.\n        this.nativeAttributeMap = {\n            'position' : 'POSITION',\n            'normal' : 'NORMAL',\n            'color' : 'COLOR',\n            'uv' : 'TEX_COORD'\n        };\n    }\n\n    DRACOLoader.prototype = {\n\n        constructor: DRACOLoader,\n\n        load: function(url, onLoad, onProgress, onError) {\n            var scope = this;\n            var loader = new THREE.FileLoader(scope.manager);\n            loader.setPath(this.path);\n            loader.setResponseType('arraybuffer');\n            loader.load(url, function(blob) {\n                scope.decodeDracoFile(blob, onLoad);\n            }, onProgress, onError);\n        },\n\n        setPath: function(value) {\n            this.path = value;\n            return this;\n        },\n\n        setVerbosity: function(level) {\n            this.verbosity = level;\n            return this;\n        },\n\n        /**\n         *  Sets desired mode for generated geometry indices.\n         *  Can be either:\n         *      THREE.TrianglesDrawMode\n         *      THREE.TriangleStripDrawMode\n         */\n        setDrawMode: function(drawMode) {\n            this.drawMode = drawMode;\n            return this;\n        },\n\n        /**\n         * Skips dequantization for a specific attribute.\n         * |attributeName| is the THREE.js name of the given attribute type.\n         * The only currently supported |attributeName| is 'position', more may be\n         * added in future.\n         */\n        setSkipDequantization: function(attributeName, skip) {\n            var skipDequantization = true;\n            if (typeof skip !== 'undefined')\n            skipDequantization = skip;\n            this.getAttributeOptions(attributeName).skipDequantization =\n                skipDequantization;\n            return this;\n        },\n\n        /**\n         * Decompresses a Draco buffer. Names of attributes (for ID and type maps)\n         * must be one of the supported three.js types, including: position, color,\n         * normal, uv, uv2, skinIndex, skinWeight.\n         *\n         * @param {ArrayBuffer} rawBuffer\n         * @param {Function} callback\n         * @param {Object|undefined} attributeUniqueIdMap Provides a pre-defined ID\n         *     for each attribute in the geometry to be decoded. If given,\n         *     `attributeTypeMap` is required and `nativeAttributeMap` will be\n         *     ignored.\n         * @param {Object|undefined} attributeTypeMap Provides a predefined data\n         *     type (as a typed array constructor) for each attribute in the\n         *     geometry to be decoded.\n         */\n        decodeDracoFile: function(rawBuffer, callback, attributeUniqueIdMap,\n                                attributeTypeMap) {\n        var scope = this;\n        DRACOLoader.getDecoderModule()\n            .then( function ( module ) {\n                scope.decodeDracoFileInternal( rawBuffer, module.decoder, callback,\n                attributeUniqueIdMap, attributeTypeMap);\n            });\n        },\n\n        decodeDracoFileInternal: function(rawBuffer, dracoDecoder, callback,\n                                        attributeUniqueIdMap, attributeTypeMap) {\n            /*\n            * Here is how to use Draco Javascript decoder and get the geometry.\n            */\n            var buffer = new dracoDecoder.DecoderBuffer();\n            buffer.Init(new Int8Array(rawBuffer), rawBuffer.byteLength);\n            var decoder = new dracoDecoder.Decoder();\n\n            /*\n            * Determine what type is this file: mesh or point cloud.\n            */\n            var geometryType = decoder.GetEncodedGeometryType(buffer);\n            if (geometryType == dracoDecoder.TRIANGULAR_MESH) {\n                if (this.verbosity > 0) {\n                console.log('Loaded a mesh.');\n                }\n            } else if (geometryType == dracoDecoder.POINT_CLOUD) {\n                if (this.verbosity > 0) {\n                console.log('Loaded a point cloud.');\n                }\n            } else {\n                var errorMsg = 'THREE.DRACOLoader: Unknown geometry type.';\n                console.error(errorMsg);\n                throw new Error(errorMsg);\n            }\n            callback(this.convertDracoGeometryTo3JS(dracoDecoder, decoder,\n                geometryType, buffer, attributeUniqueIdMap, attributeTypeMap));\n        },\n\n        addAttributeToGeometry: function(dracoDecoder, decoder, dracoGeometry,\n                                            attributeName, attributeType, attribute,\n                                            geometry, geometryBuffer) {\n            if (attribute.ptr === 0) {\n                var errorMsg = 'THREE.DRACOLoader: No attribute ' + attributeName;\n                console.error(errorMsg);\n                throw new Error(errorMsg);\n            }\n\n            var numComponents = attribute.num_components();\n            var numPoints = dracoGeometry.num_points();\n            var numValues = numPoints * numComponents;\n            var attributeData;\n            var TypedBufferAttribute;\n\n            switch ( attributeType ) {\n\n                case Float32Array:\n                attributeData = new dracoDecoder.DracoFloat32Array();\n                decoder.GetAttributeFloatForAllPoints(\n                    dracoGeometry, attribute, attributeData);\n                geometryBuffer[ attributeName ] = new Float32Array( numValues );\n                TypedBufferAttribute = THREE.Float32BufferAttribute;\n                break;\n\n                case Int8Array:\n                attributeData = new dracoDecoder.DracoInt8Array();\n                decoder.GetAttributeInt8ForAllPoints(\n                    dracoGeometry, attribute, attributeData );\n                geometryBuffer[ attributeName ] = new Int8Array( numValues );\n                TypedBufferAttribute = THREE.Int8BufferAttribute;\n                break;\n\n                case Int16Array:\n                attributeData = new dracoDecoder.DracoInt16Array();\n                decoder.GetAttributeInt16ForAllPoints(\n                    dracoGeometry, attribute, attributeData);\n                geometryBuffer[ attributeName ] = new Int16Array( numValues );\n                TypedBufferAttribute = THREE.Int16BufferAttribute;\n                break;\n\n                case Int32Array:\n                attributeData = new dracoDecoder.DracoInt32Array();\n                decoder.GetAttributeInt32ForAllPoints(\n                    dracoGeometry, attribute, attributeData);\n                geometryBuffer[ attributeName ] = new Int32Array( numValues );\n                TypedBufferAttribute = THREE.Int32BufferAttribute;\n                break;\n\n                case Uint8Array:\n                attributeData = new dracoDecoder.DracoUInt8Array();\n                decoder.GetAttributeUInt8ForAllPoints(\n                    dracoGeometry, attribute, attributeData);\n                geometryBuffer[ attributeName ] = new Uint8Array( numValues );\n                TypedBufferAttribute = THREE.Uint8BufferAttribute;\n                break;\n\n                case Uint16Array:\n                attributeData = new dracoDecoder.DracoUInt16Array();\n                decoder.GetAttributeUInt16ForAllPoints(\n                    dracoGeometry, attribute, attributeData);\n                geometryBuffer[ attributeName ] = new Uint16Array( numValues );\n                TypedBufferAttribute = THREE.Uint16BufferAttribute;\n                break;\n\n                case Uint32Array:\n                attributeData = new dracoDecoder.DracoUInt32Array();\n                decoder.GetAttributeUInt32ForAllPoints(\n                    dracoGeometry, attribute, attributeData);\n                geometryBuffer[ attributeName ] = new Uint32Array( numValues );\n                TypedBufferAttribute = THREE.Uint32BufferAttribute;\n                break;\n\n                default:\n                var errorMsg = 'THREE.DRACOLoader: Unexpected attribute type.';\n                console.error( errorMsg );\n                throw new Error( errorMsg );\n\n            }\n\n            // Copy data from decoder.\n            for (var i = 0; i < numValues; i++) {\n                geometryBuffer[attributeName][i] = attributeData.GetValue(i);\n            }\n            // Add attribute to THREEJS geometry for rendering.\n            geometry.addAttribute(attributeName,\n                new TypedBufferAttribute(geometryBuffer[attributeName],\n                    numComponents));\n            dracoDecoder.destroy(attributeData);\n        },\n\n        convertDracoGeometryTo3JS: function(dracoDecoder, decoder, geometryType,\n                                            buffer, attributeUniqueIdMap,\n                                            attributeTypeMap) {\n            // TODO: Should not assume native Draco attribute IDs apply.\n            if (this.getAttributeOptions('position').skipDequantization === true) {\n                 decoder.SkipAttributeTransform(dracoDecoder.POSITION);\n            }\n            var dracoGeometry;\n            var decodingStatus;\n            var start_time = performance.now();\n            if (geometryType === dracoDecoder.TRIANGULAR_MESH) {\n                dracoGeometry = new dracoDecoder.Mesh();\n                decodingStatus = decoder.DecodeBufferToMesh(buffer, dracoGeometry);\n            } else {\n                dracoGeometry = new dracoDecoder.PointCloud();\n                decodingStatus =\n                    decoder.DecodeBufferToPointCloud(buffer, dracoGeometry);\n            }\n            if (!decodingStatus.ok() || dracoGeometry.ptr == 0) {\n                var errorMsg = 'THREE.DRACOLoader: Decoding failed: ';\n                errorMsg += decodingStatus.error_msg();\n                console.error(errorMsg);\n                dracoDecoder.destroy(decoder);\n                dracoDecoder.destroy(dracoGeometry);\n                throw new Error(errorMsg);\n            }\n\n            var decode_end = performance.now();\n            dracoDecoder.destroy(buffer);\n            /*\n            * Example on how to retrieve mesh and attributes.\n            */\n            var numFaces;\n            if (geometryType == dracoDecoder.TRIANGULAR_MESH) {\n                numFaces = dracoGeometry.num_faces();\n                if (this.verbosity > 0) {\n                    console.log('Number of faces loaded: ' + numFaces.toString());\n                }\n            } else {\n               numFaces = 0;\n            }\n\n            var numPoints = dracoGeometry.num_points();\n            var numAttributes = dracoGeometry.num_attributes();\n            if (this.verbosity > 0) {\n                console.log('Number of points loaded: ' + numPoints.toString());\n                console.log('Number of attributes loaded: ' +\n                    numAttributes.toString());\n            }\n\n            // Verify if there is position attribute.\n            // TODO: Should not assume native Draco attribute IDs apply.\n            var posAttId = decoder.GetAttributeId(dracoGeometry,\n                                                dracoDecoder.POSITION);\n            if (posAttId == -1) {\n                var errorMsg = 'THREE.DRACOLoader: No position attribute found.';\n                console.error(errorMsg);\n                dracoDecoder.destroy(decoder);\n                dracoDecoder.destroy(dracoGeometry);\n                throw new Error(errorMsg);\n            }\n            var posAttribute = decoder.GetAttribute(dracoGeometry, posAttId);\n\n            // Structure for converting to THREEJS geometry later.\n            var geometryBuffer = {};\n            // Import data to Three JS geometry.\n            var geometry = new THREE.BufferGeometry();\n\n            // Do not use both the native attribute map and a provided (e.g. glTF) map.\n            if ( attributeUniqueIdMap ) {\n\n                // Add attributes of user specified unique id. E.g. GLTF models.\n                for (var attributeName in attributeUniqueIdMap) {\n                    var attributeType = attributeTypeMap[attributeName];\n                    var attributeId = attributeUniqueIdMap[attributeName];\n                    var attribute = decoder.GetAttributeByUniqueId(dracoGeometry,\n                                                                attributeId);\n                    this.addAttributeToGeometry(dracoDecoder, decoder, dracoGeometry,\n                        attributeName, attributeType, attribute, geometry, geometryBuffer);\n                }\n\n            } else {\n\n                // Add native Draco attribute type to geometry.\n                for (var attributeName in this.nativeAttributeMap) {\n                    var attId = decoder.GetAttributeId(dracoGeometry,\n                        dracoDecoder[this.nativeAttributeMap[attributeName]]);\n                    if (attId !== -1) {\n                    if (this.verbosity > 0) {\n                        console.log('Loaded ' + attributeName + ' attribute.');\n                    }\n                    var attribute = decoder.GetAttribute(dracoGeometry, attId);\n                    this.addAttributeToGeometry(dracoDecoder, decoder, dracoGeometry,\n                        attributeName, Float32Array, attribute, geometry, geometryBuffer);\n                    }\n                }\n\n            }\n\n            // For mesh, we need to generate the faces.\n            if (geometryType == dracoDecoder.TRIANGULAR_MESH) {\n                if (this.drawMode === THREE.TriangleStripDrawMode) {\n                    var stripsArray = new dracoDecoder.DracoInt32Array();\n                    var numStrips = decoder.GetTriangleStripsFromMesh(\n                        dracoGeometry, stripsArray);\n                    geometryBuffer.indices = new Uint32Array(stripsArray.size());\n                    for (var i = 0; i < stripsArray.size(); ++i) {\n                         geometryBuffer.indices[i] = stripsArray.GetValue(i);\n                    }\n                    dracoDecoder.destroy(stripsArray);\n                } else {\n                    var numIndices = numFaces * 3;\n                    geometryBuffer.indices = new Uint32Array(numIndices);\n                    var ia = new dracoDecoder.DracoInt32Array();\n                    for (var i = 0; i < numFaces; ++i) {\n                        decoder.GetFaceFromMesh(dracoGeometry, i, ia);\n                        var index = i * 3;\n                        geometryBuffer.indices[index] = ia.GetValue(0);\n                        geometryBuffer.indices[index + 1] = ia.GetValue(1);\n                        geometryBuffer.indices[index + 2] = ia.GetValue(2);\n                    }\n                    dracoDecoder.destroy(ia);\n                }\n            }\n\n            geometry.drawMode = this.drawMode;\n            if (geometryType == dracoDecoder.TRIANGULAR_MESH) {\n            geometry.setIndex(new(geometryBuffer.indices.length > 65535 ?\n                    THREE.Uint32BufferAttribute : THREE.Uint16BufferAttribute)\n                (geometryBuffer.indices, 1));\n            }\n\n            // TODO: Should not assume native Draco attribute IDs apply.\n            // TODO: Can other attribute types be quantized?\n            var posTransform = new dracoDecoder.AttributeQuantizationTransform();\n            if (posTransform.InitFromAttribute(posAttribute)) {\n                // Quantized attribute. Store the quantization parameters into the\n                // THREE.js attribute.\n                geometry.attributes['position'].isQuantized = true;\n                geometry.attributes['position'].maxRange = posTransform.range();\n                geometry.attributes['position'].numQuantizationBits =\n                    posTransform.quantization_bits();\n                geometry.attributes['position'].minValues = new Float32Array(3);\n                for (var i = 0; i < 3; ++i) {\n                    geometry.attributes['position'].minValues[i] =\n                        posTransform.min_value(i);\n                }\n            }\n            dracoDecoder.destroy(posTransform);\n            dracoDecoder.destroy(decoder);\n            dracoDecoder.destroy(dracoGeometry);\n\n            this.decode_time = decode_end - start_time;\n            this.import_time = performance.now() - decode_end;\n\n            if (this.verbosity > 0) {\n            console.log('Decode time: ' + this.decode_time);\n            console.log('Import time: ' + this.import_time);\n            }\n            return geometry;\n        },\n\n        isVersionSupported: function(version, callback) {\n            DRACOLoader.getDecoderModule()\n                .then( function ( module ) {\n                callback( module.decoder.isVersionSupported( version ) );\n                });\n        },\n\n        getAttributeOptions: function(attributeName) {\n            if (typeof this.attributeOptions[attributeName] === 'undefined')\n            this.attributeOptions[attributeName] = {};\n            return this.attributeOptions[attributeName];\n        }\n    };\n\n    DRACOLoader.decoderPath = './';\n    DRACOLoader.decoderConfig = {};\n    DRACOLoader.decoderModulePromise = null;\n\n    /**\n     * Sets the base path for decoder source files.\n     * @param {string} path\n     */\n    DRACOLoader.setDecoderPath = function ( path ) {\n       DRACOLoader.decoderPath = path;\n    };\n\n    /**\n     * Sets decoder configuration and releases singleton decoder module. Module\n     * will be recreated with the next decoding call.\n     * @param {Object} config\n     */\n    DRACOLoader.setDecoderConfig = function ( config ) {\n        var wasmBinary = THREE.DRACOLoader.decoderConfig.wasmBinary;\n        DRACOLoader.decoderConfig = config || {};\n        DRACOLoader.releaseDecoderModule();\n\n        // Reuse WASM binary.\n        if ( wasmBinary ) DRACOLoader.decoderConfig.wasmBinary = wasmBinary;\n    };\n\n    /**\n     * Releases the singleton DracoDecoderModule instance. Module will be recreated\n     * with the next decoding call.\n     */\n    DRACOLoader.releaseDecoderModule = function () {\n    DRACOLoader.decoderModulePromise = null;\n    };\n\n    /**\n     * Gets WebAssembly or asm.js singleton instance of DracoDecoderModule\n     * after testing for browser support. Returns Promise that resolves when\n     * module is available.\n     * @return {Promise<{decoder: DracoDecoderModule}>}\n     */\n    DRACOLoader.getDecoderModule = function () {\n        var scope = this;\n        var path = DRACOLoader.decoderPath;\n        var config = DRACOLoader.decoderConfig;\n        var promise = DRACOLoader.decoderModulePromise;\n\n        if ( promise ) return promise;\n\n        // Load source files.\n        if ( typeof DracoDecoderModule !== 'undefined' ) {\n            // Loaded externally.\n            promise = Promise.resolve();\n        } else if ( typeof WebAssembly !== 'object' || config.type === 'js' ) {\n            // Load with asm.js.\n            promise = DRACOLoader._loadScript( path + 'draco_decoder.js' );\n        } else {\n            // Load with WebAssembly.\n            config.wasmBinaryFile = path + 'draco_decoder.wasm';\n            promise = DRACOLoader._loadScript( path + 'draco_wasm_wrapper.js' )\n                .then( function () {\n                return DRACOLoader._loadArrayBuffer( config.wasmBinaryFile );\n                } )\n                .then( function ( wasmBinary ) {\n                config.wasmBinary = wasmBinary;\n                } );\n        }\n\n        // Wait for source files, then create and return a decoder.\n        promise = promise.then( function () {\n            return new Promise( function ( resolve ) {\n            config.onModuleLoaded = function ( decoder ) {\n                scope.timeLoaded = performance.now();\n                // Module is Promise-like. Wrap before resolving to avoid loop.\n                resolve( { decoder: decoder } );\n            };\n            DracoDecoderModule( config );\n            } );\n        } );\n\n        DRACOLoader.decoderModulePromise = promise;\n        return promise;\n    };\n\n    /**\n     * @param {string} src\n     * @return {Promise}\n     */\n    DRACOLoader._loadScript = function ( src ) {\n        var prevScript = document.getElementById( 'decoder_script' );\n        if ( prevScript !== null ) {\n            prevScript.parentNode.removeChild( prevScript );\n        }\n        var head = document.getElementsByTagName( 'head' )[ 0 ];\n        var script = document.createElement( 'script' );\n        script.id = 'decoder_script';\n        script.type = 'text/javascript';\n        script.src = src;\n        return new Promise( function ( resolve ) {\n            script.onload = resolve;\n            head.appendChild( script );\n        });\n    };\n\n    /**\n     * @param {string} src\n     * @return {Promise}\n     */\n    DRACOLoader._loadArrayBuffer = function ( src ) {\n        var loader = new THREE.FileLoader();\n        loader.setResponseType( 'arraybuffer' );\n        return new Promise( function( resolve, reject ) {\n            loader.load( src, resolve, undefined, reject );\n        });\n    };\n\n    return DRACOLoader;\n\n} )();\n\nexport default DRACOLoader","import * as THREE from 'three'\nimport React, {Component} from \"react\"\nimport GLTFLoader from './GLTFLoader'\nimport DRACOLoader from './DRACOLoader'\nimport SkeletonUtils from './SkeletonUtils'\nimport OrbitControls from './OrbitControls'\n\nexport default class GLTFAssetView extends Component {\n    componentDidMount() {\n        this.initThreeJS()\n    }\n    componentWillReceiveProps(nextProps, nextContext) {\n        if(this.props.asset && nextProps.asset.id !== this.props.asset.id) {\n            this.swapModel(nextProps.asset)\n        }\n    }\n\n    swapModel(asset) {\n        if(this.model) {\n            this.scene.remove(this.model)\n        }\n\n\n        const url = this.props.provider.assetsManager.getAssetURL(asset)\n\n        this.props.provider.getLogger().log(\"GLTFAssetView loading the url\",url)\n        if(!url) {\n            this.props.provider.getLogger().error(\"GLTFAssetView url is empty!\")\n            return\n        }\n\n\n        const loader = new GLTFLoader()\n        loader.setCrossOrigin('anonymous');\n        const draco = new DRACOLoader()\n        DRACOLoader.setDecoderPath( './draco/' );\n        loader.setDRACOLoader( draco );\n\n        loader.load(url, (gltf)=> {\n            console.log(\"loaded\", url)\n\n            let model = gltf.scene || gltf.scenes[0]\n\n            // clone it, in case the loader is returning the same cached version?\n            this.model = SkeletonUtils.clone( model  );\n            model = this.model\n            model.updateMatrixWorld();\n\n            let clips = gltf.animations || [];\n            this.setClips(clips)\n\n            let boundingBox = new THREE.Box3().setFromObject(model);\n            let boundingBoxSize = boundingBox.getSize(new THREE.Vector3()).length();\n            let BoundingBoxCenter = boundingBox.getCenter(new THREE.Vector3());\n\n            this.controls.reset();\n\n            // this.setClips(node.userData)\n            model.position.x += model.position.x -BoundingBoxCenter.x\n            model.position.y += model.position.y -BoundingBoxCenter.y\n            model.position.z += model.position.z -BoundingBoxCenter.z\n\n            this.controls.maxDistance = boundingBoxSize * 10;\n            this.camera.near = boundingBoxSize / 100;\n            this.camera.far = boundingBoxSize * 100;\n            this.camera.updateProjectionMatrix();\n\n            this.camera.position.copy(BoundingBoxCenter);\n            this.camera.position.x += boundingBoxSize / 2.0;\n            this.camera.position.y += boundingBoxSize / 5.0;\n            this.camera.position.z += boundingBoxSize / 2.0;\n            this.camera.lookAt(BoundingBoxCenter);\n\n            this.controls.enabled = true;\n            this.playAllClips()\n            this.scene.add(model)\n        })\n\n    }\n\n    render() {\n        return <div id={\"gltf-viewer\"} ref={c => this.sceneContainer = c}/>\n    }\n    initThreeJS() {\n        this.scene = new THREE.Scene();\n        this.scene.background = new THREE.Color( 0x000000 );\n        this.camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 0.1, 1000 );\n        this.scene.add(this.camera)\n        this.renderer = new THREE.WebGLRenderer( { antialias: true } );\n        this.renderer.setPixelRatio( window.devicePixelRatio );\n        this.renderer.setSize( window.innerWidth, window.innerHeight );\n        this.renderer.gammaOutput = true\n        this.sceneContainer.appendChild( this.renderer.domElement );\n        this.clips = []\n        this.mixer = null\n        this.model = null\n\n        this.controls = new OrbitControls( this.camera, this.renderer.domElement );\n        this.controls.screenSpacePanning = true;\n\n        this.renderer.setAnimationLoop(this.renderThree)\n\n        const light = new THREE.DirectionalLight( 0xffffff, 1.0 );\n        light.position.set( 1, 1, 1 ).normalize();\n        this.scene.add( light );\n        this.scene.add(new THREE.AmbientLight(0xffffff,0.2))\n        //console.log(\"rendering the asset\",asset)\n\n        this.swapModel(this.props.asset)\n    }\n\n    playAllClips () {\n        this.clips.forEach((clip) => {\n          this.mixer.clipAction(clip).reset().play();\n        });\n    }\n    \n    setClips ( clips ) {\n        if (this.mixer) {\n          this.mixer.stopAllAction();\n          this.mixer.uncacheRoot(this.mixer.getRoot());\n          this.mixer = null;\n        }\n    \n        clips.forEach((clip) => {\n          if (clip.validate()) clip.optimize();\n        });\n    \n        if (!clips.length) return;\n        this.clips = clips\n        this.mixer = new THREE.AnimationMixer( this.model );\n    }\n\n    checkAspectRatio() {\n        if(!this.renderer\n            || !this.renderer.domElement\n            || !this.sceneContainer\n        ) return\n        const w = this.sceneContainer.clientWidth\n        const h = this.sceneContainer.clientHeight\n        const aspect = w/h\n        if(Math.abs(this.camera.aspect - aspect) > 0.001 ) {\n            this.camera.aspect = aspect\n            this.camera.updateProjectionMatrix()\n            this.renderer.setSize(w-4,h-4)\n        }\n    }\n\n    renderThree = (time) => {\n        const dt = (time - this.prevTime) / 1000;\n        this.checkAspectRatio()\n\n        this.controls.update();\n        this.mixer && this.mixer.update(dt);\n\n        this.renderer.render( this.scene, this.camera );\n        this.prevTime = time;\n\n    }\n\n}\n","import React, {Component} from \"react\"\nimport {map, tileLayer, marker, divIcon, latLng} from \"leaflet/dist/leaflet-src.js\"\nimport \"leaflet/dist/leaflet.css\"\nimport {TREE_ITEM_PROVIDER} from '../TreeItemProvider'\nimport {HBox} from 'appy-comps'\n\nexport default class GeoAssetView extends Component {\n\n\n    constructor(props, context) {\n        super(props, context)\n        this.updateLocation = (e) => {\n            const obj = this.props.provider.accessObject(this.props.asset.id)\n            const ll = latLng({\n                lat: obj.latitude,\n                lon: obj.longitude\n            })\n            if(this.marker) this.marker.setLatLng(ll)\n            if(this.mymap)  this.mymap.panTo(ll)\n        }\n    }\n\n    loadCurrentLocation = () => {\n        navigator.geolocation.getCurrentPosition((success)=>{\n            console.log(\"success\",success)\n            const coords = success.coords\n            this.props.provider.quick_setPropertyValue(this.props.asset.id,'latitude',coords.latitude)\n            this.props.provider.quick_setPropertyValue(this.props.asset.id,'longitude',coords.longitude)\n        },(error)=>{\n            console.log(\"error\",error)\n        })\n    }\n\n    onMapClick = (e) => {\n        this.props.provider.quick_setPropertyValue(this.props.asset.id,'latitude',e.latlng.lat)\n        this.props.provider.quick_setPropertyValue(this.props.asset.id,'longitude',e.latlng.lng)\n    }\n\n    render() {\n        const style = {\n            width: '400px',\n            height: '400px',\n            border: '1px solid black',\n        }\n        this.updateLocation()\n        return <div>\n            <HBox>\n                <button onClick={this.loadCurrentLocation}>set to current location</button>\n            </HBox>\n            <div id=\"mapid\" ref={d => this.div = d} style={style}></div>\n        </div>\n    }\n\n    componentDidMount() {\n        this.mymap = map('mapid').setView([this.props.asset.longitude, this.props.asset.latitude], 18);\n        tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {\n            maxZoom: 18,\n            attribution: 'Map data &copy; <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors, ' +\n                '<a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, ' +\n                'Imagery  <a href=\"https://www.mapbox.com/\">Mapbox</a>',\n            id: 'mapbox.streets'\n        }).addTo(this.mymap);\n        this.mymap.on('click',this.onMapClick)\n\n        const customIcon = divIcon({className:'map-icon'})\n        this.marker = marker([this.props.asset.longitude, this.props.asset.latitude],{\n            title:'this is the geo location',\n            icon: customIcon\n        }).addTo(this.mymap)\n\n        this.props.provider.on(TREE_ITEM_PROVIDER.PROPERTY_CHANGED, this.updateLocation)\n        this.updateLocation()\n    }\n    componentWillUnmount() {\n        this.props.provider.off(TREE_ITEM_PROVIDER.PROPERTY_CHANGED, this.updateLocation)\n    }\n}\n\n\n\n","import React, {Component} from \"react\"\nimport {fetchGraphObject} from '../syncgraph/utils'\nimport {ASSET_TYPES} from '../vr/Common'\nimport GLTFAssetView from '../vr/GLTFAssetView'\nimport GeoAssetView from '../vr/GeoAssetView'\n\nexport default class AssetView extends Component {\n    render() {\n        const prov = this.props.provider\n        const asset = fetchGraphObject(prov.getDataGraph(),this.props.asset)\n        return <div id={\"asset-view\"}>\n            <h3>{asset.subtype} : <b>{asset.title}</b></h3>\n            {this.renderAsset(asset)}\n        </div>\n    }\n\n    renderAsset(asset) {\n        const url = this.props.provider.assetsManager.getAssetURL(asset)\n        if(asset.subtype === ASSET_TYPES.IMAGE) return <img src={url} alt={asset.title}/>\n        if(asset.subtype === ASSET_TYPES.AUDIO) return <audio src={url} controls/>\n        // added playsinline so video shows in editor on ipad \n        if(asset.subtype === ASSET_TYPES.VIDEO) return <video src={url} controls playsInline crossOrigin=\"anonymous\"/>\n        if(asset.subtype === ASSET_TYPES.BEHAVIOR) return <div>{url}</div>\n        if(asset.subtype === ASSET_TYPES.GLTF) return <GLTFAssetView asset={asset} provider={this.props.provider}/>\n        if(asset.subtype === ASSET_TYPES.GEOLOCATION) return <GeoAssetView asset={asset} provider={this.props.provider}/>\n        return <div>unknown type</div>\n    }\n}\n","function cloneObjectDeep(shapeid, graph, newParent) {\n    const id = shapeid\n    const id2 = graph.createObject()\n    const props = graph.getPropertiesForObject(id)\n    props.forEach(key => {\n        if(key === 'children') {\n            const children = graph.getPropertyValue(id, key)\n            const children2 = cloneArrayDeep(children, graph, id2)\n            graph.createProperty(id2, key, children2)\n        } else {\n            let value = graph.getPropertyValue(id, key)\n            if(key === 'parent') value = newParent\n            graph.createProperty(id2, key, value)\n        }\n    })\n    return id2\n}\n\nfunction cloneArrayDeep(arr,graph,newParent) {\n    const arr2 = graph.createArray()\n    const len = graph.getArrayLength(arr)\n    for (let i = 0; i < len; i++) {\n        const ch = graph.getElementAt(arr,i)\n        const ch2 = cloneObjectDeep(ch,graph,newParent)\n        graph.insertElement(arr2,i,ch2)\n    }\n    return arr2\n}\n\nexport default class GraphAccessor {\n    constructor(graph) {\n        this.graph = graph\n    }\n    object(id) {\n        if(id && id.id && id.exists && id.exists()) {\n            console.log(\"someone created a graphaccessor on an existing object\")\n            return id\n        }\n        if(this.graph.hasObject(id)) {\n            const obj = {}\n            this.graph.getPropertiesForObject(id).forEach(key => {\n                obj[key] = this.graph.getPropertyValue(id, key)\n            })\n            obj.id = id\n            obj.exists = function() { return true }\n            obj.set = (key, value) => {\n                this.graph.setProperty(id,key,value)\n                return obj\n            }\n            obj.props = () => {\n                const o = {}\n                this.graph.getPropertiesForObject(id).forEach(key => {\n                    o[key] = this.graph.getPropertyValue(id, key)\n                })\n                return o\n            }\n            obj.array = (key) => {\n                // console.log(\"looking at key\",key)\n                // console.log(\"self is\",obj)\n                const CH = obj[key]\n                // console.log(\"children id is\",CH)\n                const len = this.graph.getArrayLength(CH)\n                const ch = []\n                for (let i = 0; i < len; i++) {\n                    ch.push(this.graph.getElementAt(CH, i))\n                }\n                return ch\n            }\n            obj.getChildren = () => {\n                if(obj.children) return obj.array('children').map(id => this.object(id))\n                return []\n            }\n            obj.insertChildLast = (child) => {\n                this.graph.setProperty(child.id,'parent',obj.id)\n                const CH = this.graph.getPropertyValue(obj.id,'children')\n                const len = this.graph.getArrayLength(CH)\n                const prev = this.graph.getElementAt(CH,len-1)\n                this.graph.insertAfter(CH,prev,child.id)\n            }\n            obj.insertFirstChild = (child) => {\n                this.graph.setProperty(child.id,'parent',obj.id)\n                const ch = this.graph.getPropertyValue(obj.id,'children')\n                this.graph.insertAfter(ch,null,child.id)\n            }\n            obj.insertChildAfter = (child, prev) => {\n                this.graph.setProperty(child.id,'parent',obj.id)\n                const ch = this.graph.getPropertyValue(obj.id,'children')\n                this.graph.insertAfter(ch,prev.id,child.id)\n            }\n            obj.child = (index) => this.object(obj.array('children')[index])\n            obj.removeFromParent = () => {\n                const parent = this.object(obj.parent)\n                const n = parent.array('children').findIndex(ch => ch === obj.id)\n                // const n = indexOf(graph, parent.children, obj.id)\n                if (n >= 0) {\n                    this.graph.removeElement(parent.children, n)\n                } else {\n                    console.error(\"could not find index for child\", obj, 'in children', parent.children)\n                }\n            }\n            obj.getParent = () => {\n                return this.object(obj.parent)\n            }\n            obj.clone = () => {\n                const id2 = cloneObjectDeep(obj.id,this.graph,obj.parent)\n                return this.object(id2)\n            }\n            obj.find = (match,list) => {\n                if(!list) list = []\n                if(match(obj)) list.push(obj)\n                if(obj.children) obj.getChildren().forEach(ch => {\n                    ch.find(match,list)\n                })\n                return list\n            }\n            return obj\n        } else {\n            return {\n                exists: function() { return false }\n            }\n        }\n    }\n}\n","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {toQueryString} from '../../utils'\nimport {AuthModule} from '../AuthModule'\nimport {Dialog} from '../../common/Dialog'\n\n\nexport class OpenFileDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            docList:[]\n        }\n    }\n    refreshList = () => {\n        this.props.provider.loadDocList().then((docs) => this.setState({docList:docs}))\n    }\n    componentDidMount() {\n        this.refreshList()\n    }\n    generateDocUrl(doc) {\n        const opts = Object.assign({},this.props.provider.options,{\n            mode:'edit',\n            switcher:false,\n            doc:doc.id\n        })\n        const url = `./?${toQueryString(opts)}`\n        return url\n    }\n    deleteDoc(info) {\n        return this.props.provider.removeDoc(info).then((res)=>{\n            console.log('removed?',res)\n            this.refreshList()\n        })\n    }\n\n    dismiss = () => {\n        DialogManager.hide()\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.dismiss}>\n            <header>Open document</header>\n            <section>\n                <ul>{this.state.docList.map((doc, i) => {\n\n                    return <li key={i}>\n                        <b>{doc.title}</b>\n                        <a className={\"button\"} href={this.generateDocUrl(doc)}>open</a>\n                        {this.renderDeleteButton(doc)}\n                    </li>\n                })}\n                </ul>\n            </section>\n            <footer>\n                <button onClick={this.dismiss}>dismiss</button>\n            </footer>\n        </Dialog>\n    }\n\n    renderDeleteButton(doc) {\n        if(!AuthModule.supportsDocDelete()) return \"\"\n        return <button onClick={()=>this.deleteDoc(doc)}>delete</button>\n\n    }\n\n}\n","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {isAudioType, isGLTFType, isImageType, isVideoType} from '../Common'\nimport {AuthModule} from '../AuthModule'\nimport {\n    addAudioAssetFromURL,\n    addGLBAssetFromURL,\n    addImageAssetFromExpandedURL,\n    addVideoAssetFromURL\n} from '../AssetActions'\nimport {Dialog} from '../../common/Dialog'\n\nexport class OpenAssetDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            assetList:[]\n        }\n    }\n    refreshList = () => {\n        this.props.provider.loadAssetList()\n            .then((assets) => {\n                if(this.props.filter) assets = assets.filter(this.props.filter)\n                this.setState({assetList:assets})\n            })\n    }\n    componentDidMount() {\n        this.refreshList()\n    }\n    addAsset(info) {\n        DialogManager.hide()\n        if(isImageType(info.mimeType)) {\n            return addImageAssetFromExpandedURL(info.id, info.url,info.mimeType, info.title, this.props.provider)\n        }\n        if(isAudioType(info.mimeType)) {\n            return addAudioAssetFromURL(info.id, info.url, info.mimeType, info.title, this.props.provider)\n        }\n        if(isVideoType(info.mimeType)) {\n            return addVideoAssetFromURL(info.id, info.url, info.mimeType, info.title, this.props.provider)\n        }\n        if(isGLTFType(info.mimeType)) {\n            return addGLBAssetFromURL(info.id, info.url, info.mimeType, info.title, this.props.provider)\n        }\n        console.log(\"can't add this type\",info.mimeType)\n    }\n    deleteAsset(info) {\n        return this.props.provider.removeAssetSource(info).then((res)=>{\n            console.log('removed?',res)\n            this.refreshList()\n        })\n    }\n\n    okay = () => {\n        DialogManager.hide()\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.okay}>\n            <header>Add Asset</header>\n            <section>\n                <ul>{this.state.assetList.map((doc, i) => {\n                    return <li key={i}>\n                        <b>{doc.title} </b>\n                        <i> {doc.mimeType}</i>\n                        <button onClick={()=>this.addAsset(doc)}>add</button>\n                        {this.renderDeleteButton(doc)}\n                    </li>\n                })}\n                </ul>\n            </section>\n            <footer>\n                <button onClick={this.okay}>close</button>\n            </footer>\n        </Dialog>\n    }\n\n    renderDeleteButton(doc) {\n        if(!AuthModule.supportsAssetUpload()) return \"\"\n        return <button onClick={()=>this.deleteAsset(doc)}>delete</button>\n\n    }\n}\n","import React, {Component} from \"react\"\nimport {TREE_ITEM_PROVIDER} from '../TreeItemProvider'\nimport selMan, {SELECTION_MANAGER} from '../SelectionManager'\nimport {TOTAL_OBJ_TYPES} from './Common'\nimport AceEditor from 'react-ace'\nimport 'brace/mode/javascript'\nimport 'brace/theme/github'\nimport * as ToasterManager from '../vr/ToasterManager'\n\nexport default class ScriptEditor extends Component {\n    constructor(props) {\n        super(props)\n        this.refresh = () => {\n            const id = selMan.getSelection()\n            const obj = this.props.provider.accessObject(id)\n            if(obj.exists() && obj.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) {\n                this.props.provider.fetchBehaviorAssetContents(id).then(text => {\n                    this.setState({id:id, text:text})\n                })\n            } else {\n            }\n        }\n        this.state = {\n            id:null,\n            text:'empty',\n        }\n    }\n    componentDidMount() {\n        this.refresh()\n        this.props.provider.on(TREE_ITEM_PROVIDER.PROPERTY_CHANGED,this.refresh)\n        selMan.on(SELECTION_MANAGER.CHANGED,this.swap)\n    }\n\n    componentWillUnmount() {\n        this.props.provider.off(TREE_ITEM_PROVIDER.PROPERTY_CHANGED,this.refresh)\n        selMan.off(SELECTION_MANAGER.CHANGED,this.swap)\n    }\n    swap = () => {\n        const obj = this.props.provider.accessObject(selMan.getSelection())\n        if(obj.exists()  && obj.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) {\n            this.refresh()\n        }\n    }\n    changeText = (value) => this.setState({text:value})\n    save = (e) => {\n        const ann = this.editor.editor.getSession().getAnnotations()\n        const errors = ann.filter(a => a.type === 'error')\n        if(errors.length > 0) {\n            ToasterManager.add(\"errors in behavior\")\n        } else {\n            ToasterManager.add(\"saved behavior\")\n            this.props.provider.updateBehaviorAssetContents(this.state.id,this.state.text)\n        }\n    }\n    render() {\n        if(this.state.id === null) return <div>loading</div>\n        return <AceEditor mode=\"javascript\"\n                          theme=\"github\"\n                          name=\"script-editor\"\n                          value={this.state.text}\n                          onChange={this.changeText}\n                          onBlur={this.save}\n                          showGutter={true}\n                          width={'100%'}\n                          height={'100%'}\n                          ref={ed => this.editor = ed}\n        />\n    }\n\n}","import React, {Component} from 'react'\nimport {DialogManager, HBox, VBox} from 'appy-comps'\nimport {Spacer} from '../../common/GridEditorApp'\nimport {AuthModule} from '../AuthModule'\nimport {Dialog} from '../../common/Dialog'\n\nexport class OpenScriptDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            scripts:[]\n        }\n    }\n    refreshList = () => {\n        this.props.provider.loadScriptList()\n            .then((scripts) => this.setState({scripts:scripts}))\n    }\n    componentDidMount() {\n        this.refreshList()\n    }\n    addScript(info) {\n        DialogManager.hide()\n        console.log(\"URL is\",info.url)\n        info.url = info.name\n        console.log(\"Now URL is\",info.url)\n        const beh = this.props.provider.addBehaviorAssetFromURL(info)\n        if(this.props.onAdd) this.props.onAdd(beh)\n    }\n    deleteScript(info) {\n        return this.props.provider.removeBehaviorAssetSource(info.name)\n            .then(()=> this.refreshList())\n    }\n\n    okay = () => DialogManager.hide()\n\n    render() {\n        return <Dialog visible={true} onScrimClick={this.okay}>\n            <header>Choose Behavior Script</header>\n            <section>\n                <ul className=\"behaviors-list\">{this.state.scripts.map((doc, i) => {\n                    return <HBox key={doc.name}>\n                        <VBox>\n                            <div>\n                                <i>{doc.name}</i> -  <b>{doc.title}</b>\n                            </div>\n\n                            <p>{doc.description}</p>\n                        </VBox>\n                        <Spacer/>\n                        <button onClick={()=>this.addScript(doc)}>add</button>\n                        {this.renderDeleteButton(doc)}\n                    </HBox>\n                })}\n                </ul>\n            </section>\n            <footer>\n                <button onClick={this.okay}>close</button>\n            </footer>\n        </Dialog>\n    }\n\n    renderDeleteButton(doc) {\n        if(!AuthModule.supportsScriptEdit()) return \"\"\n        return <button onClick={()=>this.deleteScript(doc)}>delete</button>\n    }\n\n}\n","export const CUSTOM_BEHAVIOR_SCRIPT = `\n/*\n #title untitled behavior\n #description does something\n*/\n({\n  // defines a target property. must be a scene\n    properties: {\n        scene: { \n            type:'enum', \n            title: 'target scene', \n            value:null, \n            hints: {\n                type:'node',\n                nodeType:'scene'\n            }\n        },\n    },\n    start: function(evt) {\n        //called when the program starts\n    },\n    click: function(evt) {\n        //called when object is clicked on\n        //this.navigateScene(this.properties.scene)\n    }\n})\n`\n\n\n\nexport const CUSTOM_SCENE_SCRIPT = `\n/*\n #title scene script\n #description does something\n*/\n({\n    // defines a target property. must be a scene\n    properties: {\n        scene: { \n            type:'enum', \n            title: 'target scene', \n            value:null, \n            hints: {\n                type:'node',\n                nodeType:'scene'\n            }\n        },\n    },\n    start: function(evt) {\n        //called when the program starts\n    },\n    enter: function(evt) {\n        //called when entering a scene\n    },\n    tick: function(evt) {\n        //called on every frame\n    },\n    exit: function(evt) {\n        //called when exiting a scene\n    },\n    stop: function(evt) {\n        //called when the program stops\n    },\n})\n`","import React, {Component} from 'react'\nimport QRCode from 'qrcode'\n\nexport default class QRCanvas extends Component {\n    componentDidMount() {\n        if (this.canvas) this.redraw()\n    }\n\n    componentWillReceiveProps(newProps) {\n        if (this.canvas) this.redraw()\n    }\n\n    redraw() {\n        QRCode.toCanvas(this.canvas, this.props.url, {width: this.props.width, height: this.props.height})\n    }\n\n    render() {\n        let style = {}\n        if (this.props.style) Object.assign(style, this.props.style)\n        return <canvas width={this.props.width} height={this.props.height} ref={(canvas) => this.canvas = canvas} style={style}/>\n    }\n}","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport QRCanvas from '../../common/QRCanvas'\nimport {Dialog} from '../../common/Dialog'\n\nexport class QRDialog extends Component {\n\n    okay = () => {\n        DialogManager.hide()\n    }\n\n    render() {\n        let url = null\n        if(this.props.url) url = this.props.url\n        let wurl = url.replace(\"https\",\"wxrv\")\n        wurl = wurl.replace(\"http\",\"wxrv\")\n        return <Dialog visible={true} onScrimClick={this.okay}>\n                <header>{this.props.text?this.props.text:'Scan'}</header>\n                <section>\n                    <label><a href={url}>{url}</a></label>\n                    <QRCanvas url={wurl} width={160} height={160}/>\n                </section>\n                <footer>\n                    <button onClick={this.okay}>dismiss</button>\n                </footer>\n        </Dialog>\n    }\n\n}\n","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {AuthModule} from '../AuthModule'\nimport {Dialog} from '../../common/Dialog'\n\nexport class PasswordDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            field:\"\"\n        }\n    }\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        AuthModule.doPasswordLogin(this.state.field)\n    }\n    keyDown = (e) => {\n        if(e.key === 'Enter') this.okay()\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel} width=\"600px\" height=\"auto\">\n            <header>login with the password from your env file</header>\n            <section>\n                <label>password</label>\n                <input type={\"password\"} value={this.state.field}\n                       onKeyDown={this.keyDown}\n                       onChange={(e)=>{\n                    this.setState({field:e.target.value})\n                }}/>\n            </section>\n            <footer>\n                <button onClick={this.cancel}>cancel</button>\n                <button onClick={this.okay}>okay</button>\n            </footer>\n        </Dialog>\n    }\n}\n\n","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {AuthModule} from '../AuthModule'\nimport {getLoginURL} from '../../TreeItemProvider'\nimport {Dialog} from '../../common/Dialog'\n\nexport class GithubAuthDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            data:null\n        }\n    }\n    componentDidMount() {\n        console.log(\"opening dialog\")\n        AuthModule.getJSON(getLoginURL()).then(data => {\n            console.log(\"got the data\",data)\n            this.setState({data:data})\n        })\n    }\n\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        console.log(\"opening window with the data\",this.state.data)\n        AuthModule.login(this.state.data)\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n            <header>Github Auth</header>\n            <section>\n                <p>To log into MrEd you need a github account. Press the button\n                below to log into github and approve MrEd's access. The app will only use\n                Github for authentication. It does not have access to any of your projects or code.\n                </p>\n                <button onClick={this.okay}>Open Github</button>\n            </section>\n            <footer>\n                <button onClick={this.cancel}>cancel</button>\n            </footer>\n        </Dialog>\n    }\n}\n\n","import React, {Component} from 'react'\n\nexport class ErrorCatcher extends Component {\n\n\n    constructor(props, context) {\n        super(props, context)\n        this.state = {error:false }\n    }\n\n    componentDidCatch(error, errorInfo) {\n        this.setState({error:true})\n        const logger = this.props.logger\n        if(!logger) {\n            console.log(\"NO LOGGER!\")\n            return\n        }\n        logger.error(\"an error occurred at the react level\")\n        logger.error(error)\n        logger.error(errorInfo)\n    }\n\n    render() {\n        if(this.state.error === true) {\n            return <div><h1>An error happened. Please look at the console</h1></div>\n        }\n\n        return this.props.children\n    }\n\n}","import {LinearFilter, NearestFilter, sRGBEncoding, Texture} from 'three'\n\n/**\n *\n * Gif parser by @gtk2k\n * https://github.com/gtk2k/gtk2k.github.io/tree/master/animation_gif\n *\n */\n\nconst parseGIF = function(gif) {\n    console.log(\"parsing\",gif)\n    let pos = 0;\n    const delayTimes = [];\n    let graphicControl = null;\n    const frames = [];\n    const disposals = [];\n    const transparencies = [];\n    const transparentColors= [];\n    let loopCnt = 0;\n    if (\n        gif[0] === 0x47 &&\n        gif[1] === 0x49 &&\n        gif[2] === 0x46 && // 'GIF'\n        gif[3] === 0x38 &&\n        (gif[4] === 0x39 || gif[4] === 0x37) && \n        gif[5] === 0x61\n    ) {\n        // '89a'\n        pos += 13 + +!!(gif[10] & 0x80) * Math.pow(2, (gif[10] & 0x07) + 1) * 3;\n        const gifHeader = gif.subarray(0, pos);\n        while (gif[pos] && gif[pos] !== 0x3b) {\n            const offset = pos,\n                blockId = gif[pos];\n            if (blockId === 0x21) {\n                const label = gif[++pos];\n                if ([0x01, 0xfe, 0xf9, 0xff].indexOf(label) !== -1) {\n                    label === 0xf9 && delayTimes.push((gif[pos + 3] + (gif[pos + 4] << 8)) * 10);\n                    label === 0xff && (loopCnt = gif[pos + 15] + (gif[pos + 16] << 8));\n                    while (gif[++pos]) pos += gif[pos];\n                    if (label === 0xf9) {\n                        graphicControl = gif.subarray(offset, pos + 1);\n                        disposals.push((graphicControl[3] >> 2) & 0x07);\n                        transparencies.push((graphicControl[3]) & 0x01);\n                        transparentColors.push(graphicControl[6]);\n                    }\n                } else {\n                    throw new Error(\"parseGIF: unknown label\");\n                }\n            } else if (blockId === 0x2c) {\n                pos += 9;\n                pos += 1 + +!!(gif[pos] & 0x80) * (Math.pow(2, (gif[pos] & 0x07) + 1) * 3);\n                while (gif[++pos]) pos += gif[pos];\n                const imageData = gif.subarray(offset, pos + 1);\n                frames.push(URL.createObjectURL(new Blob([gifHeader, graphicControl, imageData])));\n            } else {\n                throw new Error(\"parseGIF: unknown blockId\");\n            }\n            pos++;\n        }\n    } else {\n        throw new Error(\"parseGIF: no GIF89a\");\n    }\n    return { delayTimes, loopCnt, frames, disposals, transparencies, transparentColors };\n};\n\n//\n// self.onmessage = msg => {\n//     try {\n//         const result = parseGIF(new Uint8Array(msg.data.payload));\n//         self.postMessage({ id: msg.data.id, result });\n//     } catch (e) {\n//         self.postMessage({ id: msg.data.id, err: e.message });\n//     }\n// };\n//\n\nclass GIFTexture extends Texture {\n    constructor(frames, delays, disposals, transparencies, transparentColors) {\n        super(document.createElement(\"canvas\"));\n        this.image.width = frames[0].width;\n        this.image.height = frames[0].height;\n\n        this._ctx = this.image.getContext(\"2d\");\n\n        this.generateMipmaps = false;\n        this.isVideoTexture = true;\n        this.minFilter = NearestFilter;\n\n        this.frames = frames;\n        this.delays = delays;\n        this.disposals = disposals;\n        this.transparencies = transparencies // is each frame transparent or not\n\n        this.transparent = false\n        this.transparencies.forEach( (value) => {\n            if (value) this.transparent = true\n        })\n \n        this.transparentColors = transparentColors // the color index for transparent colors\n        this.frame = 0;\n        this.frameStartTime = Date.now();\n        this.firstDrawCount = 0\n        this.playing = true\n    }\n\n    update() {\n        if (!this.frames || !this.delays || !this.disposals) return;\n        if(this.firstDrawCount > this.frames.length && !this.playing) return;\n        const now = Date.now();\n        if (now - this.frameStartTime > this.delays[this.frame]) {\n            if (this.disposals[this.frame] === 2) {\n                this._ctx.clearRect(0, 0, this.image.width, this.image.width);\n            }\n            this.frame = (this.frame + 1) % this.frames.length;\n            this.frameStartTime = now;\n            this._ctx.drawImage(this.frames[this.frame], 0, 0, this.image.width, this.image.height);\n            this.needsUpdate = true;\n            this.firstDrawCount+=1\n        }\n    }\n}\n\n\nexport function createGIFTexture(url, prov) {\n    return new Promise((resolve, reject) => {\n        fetch(url,{ mode: \"cors\" })\n            .then(r => r.arrayBuffer())\n            .then(r => new Uint8Array(r))\n            .then(r => {\n                if(prov) {\n                    if(r.length < 100) {\n                        prov.getLogger().log(\"array length is too short\", String.fromCharCode(115))\n                        let str = \"\"\n                        for(let i=0; i<r.length; i++) {\n                            str += String.fromCharCode(r[i])\n                        }\n                        prov.getLogger().log(str)\n                    }\n                }\n                return r\n            })\n            .then(rawImageData => parseGIF(rawImageData, [rawImageData]))\n            .then(result => {\n                console.log(\"result of gif parsing is\",result)\n                const { frames, delayTimes, disposals, transparencies, transparentColors } = result;\n                let loadCnt = 0;\n                for (let i = 0; i < frames.length; i++) {\n                    const img = new Image();\n                    img.crossOrigin = \"anonymous\"\n                    // eslint-disable-next-line\n                    img.onload = e => {\n                        loadCnt++;\n                        frames[i] = e.target;\n                        if (loadCnt === frames.length) {\n                            const texture = new GIFTexture(frames, delayTimes, disposals, transparencies, transparentColors);\n                            texture.image.src = url;\n                            texture.encoding = sRGBEncoding;\n                            texture.minFilter = LinearFilter;\n                            resolve(texture);\n                        }\n                    };\n                    img.src = frames[i];\n                }\n            })\n            .catch(reject);\n    });\n}","import {ASSET_TYPES} from './Common'\nimport {TextureLoader, VideoTexture, Audio, AudioLoader} from 'three'\nimport {AuthModule} from './AuthModule'\nimport {getAssetsURL} from '../TreeItemProvider'\nimport {createGIFTexture} from './GifSupport'\nimport GLTFLoader from './GLTFLoader'\nimport DRACOLoader from './DRACOLoader'\n\nexport class AssetsManager {\n    constructor(provider) {\n        this.provider = provider\n        this.assets_url_map = {}\n        this.videocache = {}\n        this.audiocache = {}\n    }\n\n    cacheAssetsList() {\n        return AuthModule.getJSON(`${getAssetsURL()}list`).then(assets => {\n            if(!assets || !assets.forEach) return\n            if(AuthModule.supportsAssetUpload()) {\n                //doc server version\n                assets.forEach(asset => {\n                    this.assets_url_map[asset.id] = getAssetsURL()+asset.id\n                })\n            } else {\n                //glitch server version\n                assets.forEach(asset => {\n                    this.assets_url_map[asset.title] = asset.url\n                })\n                console.log(\"cached the assets\",this.assets_url_map)\n            }\n        })\n    }\n\n    getAssetURL(asset) {\n        if(AuthModule.supportsAssetUpload() && !AuthModule.isLoggedIn()) {\n            //TODO: Josh hack to work around listing assets when not logged in on docserver\n            return getAssetsURL()+asset.assetId\n        }\n        if(asset.assetId) {\n            return this.assets_url_map[asset.assetId]\n        } else {\n            return asset.src\n        }\n    }\n\n\n    playMediaAsset(asset, trusted=false) {\n        const lg = this.provider.getLogger()\n        if(asset.subtype === ASSET_TYPES.AUDIO) {\n            lg.log(\"playing the audio asset\",asset)\n            const url = this.getAssetURL(asset)\n            if(!url) {\n                lg.error('could not find the url for the asset',asset)\n                return\n            }\n            lg.log(\"playing the audio from the url\",url)\n            if(this.audiocache[asset.id]) {\n                //already loaded\n                const sound = this.audiocache[asset.id]\n                if(sound.isPlaying) sound.stop()\n                sound.play()\n            } else {\n                const sound = new Audio(this.provider.getAudioListener())\n                const audioLoader = new AudioLoader()\n                audioLoader.load(url, function (buffer) {\n                    sound.setBuffer(buffer);\n                    sound.setLoop(false);\n                    sound.setVolume(0.5);\n                    sound.play();\n                });\n                this.audiocache[asset.id] = sound\n            }\n        }\n        if(asset.subtype === ASSET_TYPES.VIDEO) {\n            const url = this.getAssetURL(asset)\n            const video = this.videocache[url]\n            if (video) {\n                if(trusted) video.muted = false\n                video.play()\n            }\n        }\n\n    }\n\n    stopMediaAsset(asset) {\n        if(asset.subtype === ASSET_TYPES.AUDIO) {\n            if(this.audiocache[asset.id]) {\n                this.audiocache[asset.id].stop()\n                delete this.audiocache[asset.id]\n                this.audiocache[asset.id] = null\n            }\n        }\n        if(asset.subtype === ASSET_TYPES.VIDEO) {\n            const url = this.getAssetURL(asset)\n            const video = this.videocache[url]\n            if (video) {\n                video.pause()\n            }\n        }\n    }\n\n    isMediaAssetPlaying(asset) {\n        if(asset.subtype === ASSET_TYPES.AUDIO) {\n            if(this.audiocache[asset.id]) {\n                return this.audiocache[asset.id].isPlaying\n            }\n        }\n        if(asset.subtype === ASSET_TYPES.VIDEO) {\n            const url = this.getAssetURL(asset)\n            const video = this.videocache[url]\n            if(video) {\n                //TODO: @josh this probably isn't right.\n                //TODO: instead we should listen for media events and track the status\n                const val = !(video.paused)\n                return val\n            }\n        }\n        return false\n    }\n\n    setMediaVolume(asset, vol) {\n        if(asset.subtype === ASSET_TYPES.AUDIO) {\n            if(this.audiocache[asset.id]) {\n                this.audiocache[asset.id].setVolume(vol)\n            }\n        }\n        if(asset.subtype === ASSET_TYPES.VIDEO) {\n            const url = this.getAssetURL(asset)\n            const video = this.videocache[url]\n            if (video) {\n                video.volume = vol\n            }\n        }\n    }\n\n    stopAllMedia() {\n        const cache = this.videocache\n        Object.keys(cache).forEach(key => {\n            const item = cache[key]\n            if(item.pause) {\n                item.pause()\n            }\n        })\n        Object.keys(this.audiocache).forEach(key => {\n            if(this.audiocache[key] && this.audiocache[key].stop) {\n                this.audiocache[key].stop()\n            }\n        })\n\n    }\n\n\n    getTexture(id) {\n        const asset = this.provider.accessObject(id)\n        if(!asset.exists()) {\n            this.provider.getLogger().error(\"==== invalid asset reference\",id)\n            return Promise.resolve(null)\n        }\n        const url = this.getAssetURL(asset)\n        if(!url) {\n            this.provider.getLogger().error(\"==== null url from asset\",asset)\n            return Promise.resolve(null)\n        }\n        this.provider.getLogger().log(\"loading asset url\",url)\n        if(asset.subtype === ASSET_TYPES.IMAGE) {\n            this.provider.getLogger().log(\"asset info\",asset)\n            if(asset.format === 'image/gif') {\n                return createGIFTexture(url,this.provider)\n            } else {\n                return new Promise((res,rej)=>{\n                    new TextureLoader().load(url,\n                        (tex)=>res(tex),\n                        (p)=>console.log(\"Progress\",p),\n                        (e)=>{\n                            this.provider.getLogger().error(\"error loading texture\",e)\n                            rej(e)\n                        })\n                    })\n            }\n        }\n        if(asset.subtype === ASSET_TYPES.VIDEO) {\n            let video\n            if(!this.videocache[url]) {\n                video = document.createElement('video')\n                video.crossOrigin = 'anonymous'\n                video.preload = \"auto\"\n                // video will only play inline on mobile devices if it's muted\n                // we will loop video\n                video.muted = true;\n                //video.loop = true;\n                video.setAttribute( 'playsinline', '' );\n\n                video.src = url\n                this.videocache[url] = video\n            } else {\n                video = this.videocache[url]\n            }\n            return Promise.resolve(new VideoTexture(video))\n        }\n        return Promise.resolve(null)\n    }\n\n    getGLTF(id) {\n        const asset = this.provider.accessObject(id)\n        if(!asset.exists()) {\n            this.provider.getLogger().error(\"==== invalid asset reference\",id)\n            return Promise.resolve(null)\n        }\n\n        const url = this.getAssetURL(asset)\n        if(!url) {\n            this.provider.getLogger().error(\"==== null url from asset\",asset)\n            return Promise.resolve(null)\n        }\n        this.provider.getLogger().log(\"ModelDef loading the model asset url\",url)\n\n        const loader = new GLTFLoader()\n        loader.setCrossOrigin('anonymous');\n        const draco = new DRACOLoader()\n        DRACOLoader.setDecoderPath( './draco/' );\n        loader.setDRACOLoader( draco );\n        return new Promise((res,rej)=>{\n            loader.load(url, (gltf)=> res(gltf),\n                (xhr)=> console.log('Progress',xhr),\n                (error)=>{\n                    this.provider.getLogger().error(\"error loading texture\",error)\n                    rej(error)\n                })\n        })\n\n    }\n}","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {Dialog} from '../../common/Dialog'\nimport {Spacer} from '../../common/GridEditorApp'\n\n\nexport class SaveDocumentAsDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            newTitle:\"Copy of \" + props.provider.getDocTitle()\n        }\n    }\n    edited = (e) => {\n        this.setState({newTitle:e.target.value})\n    }\n    dismiss = () => {\n        DialogManager.hide()\n    }\n    saveAs = () => {\n        DialogManager.hide()\n        this.props.provider.duplicateDocument(this.state.newTitle)\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.dismiss} width=\"600px\" height=\"auto\">\n            <header>Save Document As</header>\n            <section>\n                <label>title</label>\n                <input type=\"text\" value={this.state.newTitle} onChange={this.edited} style={{flex:1.0}}/>\n            </section>\n            <footer>\n                <Spacer/>\n                <button onClick={this.dismiss}>cancel</button>\n                <button onClick={this.saveAs}>save as</button>\n            </footer>\n        </Dialog>\n    }\n\n}\n","import React, {Component} from 'react'\nimport {DialogManager} from 'appy-comps'\nimport {Dialog} from '../../common/Dialog'\n\nexport class BadAssetsDialog extends Component {\n    dismiss = () => {\n        DialogManager.hide()\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n            <header>Warning. There were errors loading some assets</header>\n            <section>\n                <ul>\n                    {this.props.provider.badAssets.map((asset,i) => {\n                        return <li key={i}><b>{asset.title}</b>\n                            <br/>{asset.src}\n                        </li>\n                    })}\n                </ul>\n            </section>\n            <footer>\n                <button onClick={this.dismiss}>keep going anyway</button>\n            </footer>\n        </Dialog>\n    }\n}\n\n","import React, {Component} from 'react'\nimport * as ToasterManager from './ToasterManager'\n\nexport class ToasterNotification extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            notification:'saved',\n            visible:false\n        }\n    }\n\n    add = (payload) => {\n        this.setState({notification:payload, visible:true})\n        setTimeout(this.hide,2000)\n    }\n\n    hide = () => this.setState({visible:false})\n\n    componentWillMount() {\n        ToasterManager.onAdd(this.add)\n    }\n    componentWillUnmount() {\n        ToasterManager.offAdd(this.add)\n    }\n\n    render() {\n        return <div style={{\n            position:'absolute',\n            bottom:'10px',\n            left:'10px',\n            backgroundColor:'rgba(0,0,0,0.6)',\n            borderRadius:'1em',\n            color:'white',\n            fontSize:'24pt',\n            padding:'1em',\n            display:this.state.visible?'block':'none'\n        }}>{this.state.notification}</div>\n    }\n}\n","import React, {Component} from 'react'\nimport inspect from \"util-inspect\"\n\nexport class ConsoleView extends Component {\n    clearLog = () => {\n        this.setState({messages:[]})\n    }\n\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            messages:[]\n        }\n    }\n    componentDidMount() {\n        this.props.logger.addEventListener(\"log\",(e)=>{\n            this.state.messages.push(e)\n            this.setState({messages:this.state.messages})\n        })\n        this.props.logger.addEventListener(\"error\",(e)=>{\n            this.state.messages.push(e)\n            this.setState({messages:this.state.messages})\n        })\n    }\n\n    render() {\n        return <div className=\"console wide\">\n            <div className=\"toolbar gray\">\n                <button className=\"action gray fa fa-trash borderless\" onClick={this.clearLog}/>\n                <button className=\"action gray fa fa-exclamation-triangle borderless\"/>\n                <input type=\"text\" placeholder=\"filter messages\" className=\"spacer\"/>\n            </div>\n            <ul className={\"message-log\"}>\n                {this.state.messages.map((msg,i) => {\n                    return <li key={i}>\n                        <b className={msg.type}>{msg.type}</b>\n                        <i>{msg.count}</i>\n                        {this.formatMessage(msg)}\n                    </li>\n                })}\n\n            </ul>\n        </div>\n    }\n\n    formatMessage(msg) {\n        // console.log(\"formatting\",msg.data)\n        const msgs =  msg.data.map((str,i) => {\n            if(typeof str === 'string' || str instanceof String) {\n                return <b key={i}>{str}</b>\n            }\n            return <b key={i}>{inspect(str,{depth: 2})}</b>\n        })\n        return <span>{msgs}</span>\n    }\n}\n","import '../grid.css'\nimport '../components.css'\nimport \"./dialogs.css\"\nimport SyncGraphProvider from '../syncgraph/SyncGraphProvider'\nimport React, {Component} from 'react'\nimport {Spacer} from '../common/GridEditorApp'\nimport TreeTable from '../common/TreeTable'\nimport PropSheet, {TYPES} from '../common/PropSheet'\nimport SelectionManager, {SELECTION_MANAGER} from '../SelectionManager'\nimport {VRCanvas} from './VRCanvas'\nimport {getAssetsURL, getDocsURL, getScriptsURL, TREE_ITEM_PROVIDER} from '../TreeItemProvider'\nimport ImmersiveVREditor from './ImmersiveVREditor'\nimport {fetchGraphObject, insertAsFirstChild, insertAsLastChild, listToArray} from '../syncgraph/utils'\nimport CubeDef from \"./defs/CubeDef\"\nimport SceneDef from \"./defs/SceneDef\"\nimport InputManager from \"../common/InputManager\"\nimport {DialogContainer, DialogManager, HBox, PopupContainer, PopupManager, VBox} from \"appy-comps\"\nimport {\n    ASSET_TYPES,\n    canBeDeleted,\n    canHaveBehavior,\n    canHaveScene,\n    canHaveShape,\n    get3DObjectDef,\n    HORIZONTAL_ALIGNMENT,\n    is3DObjectType,\n    isGLTFFile,\n    isImageType,\n    ITEM_ICONS,\n    NONE_ASSET,\n    OBJ_TYPES,\n    parseBehaviorScript,\n    PROP_DEFS,\n    REC_TYPES,\n    SIMPLE_COLORS,\n    TOTAL_OBJ_TYPES\n} from './Common'\nimport {AddImageAssetDialog} from './dialogs/AddImageAssetDialog'\nimport {AddGLTFAssetDialog} from './dialogs/AddGLTFAssetDialog'\nimport {AddGLBAssetDialog} from './dialogs/AddGLBAssetDialog'\nimport {AddAudioAssetDialog} from './dialogs/AddAudioAssetDialog'\nimport {UnsavedDocumentDialog} from \"./dialogs/UnsavedDocumentDialog\"\nimport AssetView from '../metadoc/AssetView'\nimport * as ToasterMananager from './ToasterManager'\nimport GraphAccessor from \"../syncgraph/GraphAccessor\"\nimport {toQueryString} from '../utils'\nimport {OpenFileDialog} from './dialogs/OpenFileDialog'\nimport {AuthModule, CONNECTED, USER_CHANGE} from './AuthModule'\nimport {OpenAssetDialog} from './dialogs/OpenAssetDialog'\nimport ScriptEditor from './ScriptEditor'\nimport {OpenScriptDialog} from './dialogs/OpenScriptDialog'\nimport {CUSTOM_BEHAVIOR_SCRIPT, CUSTOM_SCENE_SCRIPT} from './Templates'\nimport {\n    addScene,\n    deleteObject,\n    generateAddAssetPopup,\n    newDoc,\n    showAddAssetPopup,\n    showAddBehaviorPopup,\n    showAddPopup\n} from './Actions'\nimport {addGeoAnchorAsset, addGLBAssetFromFile, addImageAssetFromFile} from './AssetActions'\nimport {QRDialog} from './dialogs/QRDialog'\nimport {PasswordDialog} from './dialogs/PasswordDialog'\nimport {GithubAuthDialog} from './dialogs/GithubAuthDialog'\nimport {ErrorCatcher} from './ErrorCatcher'\nimport {AssetsManager} from './AssetsManager'\nimport {ConsoleLogger} from '../syncgraph/PubnubSyncWrapper'\nimport {SaveDocumentAsDialog} from './dialogs/SaveDocumentAsDialog'\nimport {BadAssetsDialog} from './dialogs/BadAssetsDialog'\nimport {ToasterNotification} from './ToasterNotification'\nimport preval from \"preval.macro\"\nimport {ConsoleView} from './ConsoleView'\n\nexport default class VREditor extends SyncGraphProvider {\n    constructor(options) {\n        super(options)\n        this.imagecache = {}\n        this.behaviorCache = {}\n        this.orbit_state = {}\n        this.badAssets = []\n        this.assetsManager = new AssetsManager(this)\n    }\n    getDocType() { return \"vr\" }\n    getApp = () => {\n        if(this.mode === 'edit') return <VREditorApp provider={this}/>\n        if(this.mode === 'vredit') return <ImmersiveVREditor provider={this} editable={true}/>\n        if(this.mode === 'embed-view') return <ImmersiveVREditor provider={this} editable={false}/>\n        if(this.mode === 'vrview') return <ImmersiveVREditor provider={this} editable={false}/>\n        console.log(\"no mode!\")\n    }\n    getTitle = () => \"MrEd\"\n    getDocTitle = () => this.accessObject(this.getSceneRoot()).title\n    setDocTitle = (title) => this.accessObject(this.getSceneRoot()).set('title',title)\n    getLogger = () => {\n        if(this.pubnub) return this.pubnub.getLogger()\n        if(!this.consoleLogger)  this.consoleLogger = new ConsoleLogger()\n        return this.consoleLogger\n    }\n\n    makeEmptyRoot(doc) {\n        //make root\n        const root = fetchGraphObject(doc,doc.createObject({\n            type:TOTAL_OBJ_TYPES.ROOT,\n            title:'Untitled Project',\n            splashImage:NONE_ASSET.id,\n            defaultScene:NONE_ASSET.id,\n            children:doc.createArray()\n        }))\n        const rootObj = new GraphAccessor(doc).object(root.id)\n        //make scene\n        const scene1 = new SceneDef().make(doc,rootObj)\n        //make cube\n        const obj = new CubeDef().make(doc,scene1)\n        //make assets\n        const assets = fetchGraphObject(doc,doc.createObject({type:TOTAL_OBJ_TYPES.ASSETS_LIST,\n            title:'Assets', children: doc.createArray(), parent:0}))\n        //make behaviors\n        const behaviors = fetchGraphObject(doc,doc.createObject({type:TOTAL_OBJ_TYPES.BEHAVIORS_LIST,\n            title:'Behaviors', children: doc.createArray(), parent:0}))\n        //tie it all together\n        insertAsFirstChild(doc,root,scene1)\n        insertAsFirstChild(doc,scene1,obj)\n        insertAsLastChild(doc,root,behaviors)\n        insertAsLastChild(doc,root,assets)\n    }\n    docLoaded = () => {\n        //pre-cache all of the behaviors\n        this.accessObject(this.getBehaviorsObject()).getChildren()\n            .filter(a => a.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT)\n            .forEach((b)=>{\n                this.fetchBehaviorAssetContents(b.id).then((contents)=> {\n                    try {\n                        const info = parseBehaviorScript(contents)\n                        info.text = contents\n                        this.setCachedBehaviorAsset(b.id, info)\n                    } catch (e) {\n                        console.error(e)\n                    }\n                })\n            })\n        // if(this.syncdoc.getHistory().length > 300) {\n        //     throw new Error(\"pretending to crash loading the doc \" + this.syncdoc.getHistory().length)\n        // }\n        //get a list of assets for calculating the correct URLS.\n        return this.assetsManager.cacheAssetsList()\n            .then(()=>{\n                Promise.all(this.accessObject(this.getAssetsObject()).getChildren()\n                    .map(asset => {\n                        // this.getLogger().log(\"checking asset\",asset)\n                        if(asset.subtype === ASSET_TYPES.VIDEO) {\n                            return this.assetsManager.getTexture(asset.id).then(tex => {\n                                if (!tex) {\n                                    this.getLogger().error(\"error loading a texture\", asset)\n                                    this.addAssetLoadingError(asset)\n                                }\n                            })\n                        }\n                        if(asset.subtype === ASSET_TYPES.IMAGE) {\n                            return this.assetsManager.getTexture(asset.id).then(tex => {\n                                if (!tex) {\n                                    this.getLogger().error(\"error loading a texture\", asset)\n                                    this.addAssetLoadingError(asset)\n                                }\n                            })\n                        }\n                        if(asset.subtype === ASSET_TYPES.GLTF) {\n                            return this.assetsManager.getGLTF(asset.id).then(model => {\n                                if (!model) {\n                                    this.getLogger().error(\"error loading a model\", asset)\n                                    this.addAssetLoadingError(asset)\n                                }\n                            })\n                        }\n                        return Promise.resolve(\"all good\")\n                    })).then((answers)=>{\n                        console.log(\"fully loaded all assets now\")\n                        console.log(\"error count is\",this.badAssets.length)\n                    if(this.badAssets.length > 0) {\n                        this.showBadAssetsDialog()\n                    }\n                })\n            })\n    }\n\n    addAssetLoadingError(asset) {\n        this.badAssets.push(asset)\n    }\n\n    getRendererForItem = (item) => {\n        const obj = this.accessObject(item)\n        if(!obj.exists()) return <div>???</div>\n        console.log(\"subtype\",obj.subtype)\n        if(obj.type === TOTAL_OBJ_TYPES.ASSET) return <div><i className={ITEM_ICONS[obj.subtype]}/> {obj.title}</div>\n        if(ITEM_ICONS[obj.type]) return <div><i className={ITEM_ICONS[obj.type]}/> {obj.title}</div>\n        return <div>{obj.title}</div>\n    }\n\n    getProperties(item) {\n        function copyPropDef(def,value) {\n            const out = {};\n            Object.keys(def).forEach((key) => out[key] = def[key])\n            out.value = value\n            return out;\n        }\n        let defs = []\n        if(!item) return defs\n\n        //show the ID for all objects\n        defs.push({\n            key:'id',\n            name:\"ID\",\n            type:TYPES.STRING,\n            value:item,\n            locked:true\n        })\n\n        const obj = this.accessObject(item)\n        //if a behavior object is selected, get the defs from the root behavior asset\n        if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR) {\n            const behaviorProps = this.getCachedBehaviorPropDefs(obj.behavior)\n            if(behaviorProps) {\n                Object.keys(behaviorProps).forEach(pname => {\n                    const propdef = behaviorProps[pname]\n                    const ndef = {\n                        key: pname,\n                        name: pname,\n                        type: propdef.type,\n                        value: obj[pname]\n                    }\n                    if(propdef.hints) ndef.hints = propdef.hints\n                    defs.push(ndef)\n                })\n            } else {\n                console.warn(\"Missing prop defs for behavior object\")\n            }\n            defs.push({\n                key:'behavior',\n                name:\"Script\",\n                type:TYPES.STRING,\n                value:obj.behavior,\n                locked:true,\n                custom:true,\n            })\n        }\n\n        const props = this.syncdoc.getPropertiesForObject(item)\n        if(props) {\n            props.forEach(key => {\n                if(key === 'type') return\n                if(key === 'children') return\n                if(key === 'parent') return\n                const value = this.syncdoc.getPropertyValue(item,key)\n                if(PROP_DEFS[key]) {\n                    const def = copyPropDef(PROP_DEFS[key],value)\n                    if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) {\n                        if(key === 'title' || key === 'description') def.locked = true\n                    }\n                    if(obj.type === TOTAL_OBJ_TYPES.ASSET && obj.subtype === ASSET_TYPES.IMAGE) {\n                        if(key === 'width' || key === 'height') def.locked = true\n                    }\n                    return defs.push(def)\n                }\n                // console.log(\"unknown property\",key)\n            })\n        }\n\n\n\n        if(is3DObjectType(obj.type)) {\n            defs.push({\n                key: 'scale',\n                name: 'Scale',\n                type: TYPES.GROUP,\n                group: ['sx','sy','sz'],\n                custom:true,\n            })\n            defs.push({\n                key: 'translation',\n                name: 'Translation',\n                type: TYPES.GROUP,\n                group: ['tx','ty','tz'],\n                custom:true,\n            })\n            defs.push({\n                key: 'rotation',\n                name: 'Rotation',\n                type: TYPES.GROUP,\n                group: ['rx','ry','rz'],\n                custom:true,\n            })\n        }\n\n        return defs\n    }\n    setPropertyValue(item, def, value) {\n        if(def.key === 'scale' || def.key === 'translation' || def.key === 'rotation') {\n            def.group.forEach(key => super.setPropertyValue(item,{key:key}, value[key]))\n            return\n        }\n        super.setPropertyValue(item,def,value)\n        //size the plane to match the aspect ratio of the asset\n        if(def.key === PROP_DEFS.asset.key) {\n            const asset = this.accessObject(value)\n            if(asset.subtype === ASSET_TYPES.IMAGE) {\n                let height = (asset.height / asset.width) * this.accessObject(item).width\n                super.setPropertyValue(item, {key: 'height'}, height)\n            }\n            if(asset.subtype === ASSET_TYPES.GLTF) {\n                console.log(\"adjusting to a gtlf\")\n            }\n        }\n    }\n    getValuesForEnum(key,obj,def) {\n        const realobj = this.accessObject(obj)\n        //if this is a property on a behavior, then use the hints to generate a target list\n        if(realobj.exists() && realobj.type === TOTAL_OBJ_TYPES.BEHAVIOR) {\n            if(def.hasHints()) {\n                const hints = def.getHints()\n                if(hints.type === 'node') {\n                    return this.accessObject(this.getSceneRoot())\n                        .find(obj => obj.type === hints.nodeType)\n                        .map(ch => ch.id)\n                }\n                if(hints.type === 'audio') {\n                    return this.accessObject(this.getAssetsObject()).getChildren().filter(a => a.subtype === ASSET_TYPES.AUDIO).map(a => a.id)\n                }\n                if(hints.type === 'video') {\n                    return this.accessObject(this.getAssetsObject()).getChildren().filter(a => a.subtype === ASSET_TYPES.VIDEO).map(a => a.id)\n                }\n                if(hints.type === 'media') {\n                    return this.accessObject(this.getAssetsObject()).getChildren().filter(a => a.subtype === ASSET_TYPES.AUDIO || a.subtype === ASSET_TYPES.VIDEO).map(a => a.id)\n                }\n            }\n        }\n\n        if (key === PROP_DEFS.asset.key) {\n            const assets = this.accessObject(this.getAssetsObject()).getChildren()\n            if(acceptsImageAsset(realobj.type) && acceptsVideoAsset(realobj.type)) return withNone(assets.filter(a => a.subtype === ASSET_TYPES.VIDEO || a.subtype === ASSET_TYPES.IMAGE).map(a => a.id))\n            if(acceptsVideoAsset(realobj.type)) return withNone(assets.filter(a => a.subtype === ASSET_TYPES.VIDEO).map(a => a.id))\n            if(acceptsModelAsset(realobj.type)) return withNone(assets.filter(a => a.subtype === ASSET_TYPES.GLTF).map(a => a.id))\n            if(acceptsImageAsset(realobj.type)) return withNone(assets.filter(a => a.subtype === ASSET_TYPES.IMAGE).map(a => a.id))\n        }\n        if(key === PROP_DEFS.horizontalAlign.key) {\n            return Object.keys(HORIZONTAL_ALIGNMENT).map(key => HORIZONTAL_ALIGNMENT[key])\n        }\n        if(key === PROP_DEFS.defaultScene.key) {\n            return withNone(this.accessObject(this.getSceneRoot()).getChildren()\n                .filter(ch => ch.type === TOTAL_OBJ_TYPES.SCENE)\n                .map(ch => ch.id))\n        }\n        if(key === PROP_DEFS.texture.key) {\n            let assets = this.accessObject(this.getAssetsObject()).getChildren()\n            assets = assets.filter(a => a.subtype === ASSET_TYPES.IMAGE).map(a => a.id)\n            return withNone(assets)\n        }\n        if(key === PROP_DEFS.targetImage.key) {\n            let assets = this.accessObject(this.getAssetsObject()).getChildren()\n            assets = assets.filter(a => a.subtype === ASSET_TYPES.IMAGE).map(a => a.id)\n            return assets\n        }\n        if(key === PROP_DEFS.targetGeoLocation.key) {\n            let assets = this.accessObject(this.getAssetsObject()).getChildren()\n            assets = assets.filter(a => a.subtype === ASSET_TYPES.GEOLOCATION).map(a => a.id)\n            return assets\n        }\n        if(key === PROP_DEFS.recType.key) {\n            return Object.keys(REC_TYPES)\n        }\n        if(key === PROP_DEFS.splashImage.key) {\n            let assets = this.accessObject(this.getAssetsObject())\n                .getChildren()\n                .filter(a => a.subtype === ASSET_TYPES.IMAGE)\n                .map(a => a.id)\n            return withNone(assets)\n        }\n        if(key === PROP_DEFS.cloneTarget.key) {\n            let nodes = this.accessObject(this.getSceneRoot()).find(ch => is3DObjectType(ch.type)).map(a => a.id)\n            return withNone(nodes)\n        }\n    }\n    getRendererForEnum(key,obj) {\n        const realobj = this.accessObject(obj)\n        if(realobj.exists() && realobj.type === TOTAL_OBJ_TYPES.BEHAVIOR) return EnumTitleRenderer\n        switch(key) {\n            case PROP_DEFS.asset.key: return EnumTitleRenderer\n            case PROP_DEFS.defaultScene.key: return EnumTitleRenderer\n            case PROP_DEFS.texture.key: return EnumTitleRenderer\n            case PROP_DEFS.targetImage.key: return EnumTitleRenderer\n            case PROP_DEFS.targetGeoLocation.key: return EnumTitleRenderer\n            case PROP_DEFS.splashImage.key: return EnumTitleRenderer\n            case PROP_DEFS.cloneTarget.key: return EnumTitleRenderer\n            default: return null\n        }\n    }\n\n    getSelectedSceneObject() {\n        const sel = SelectionManager.getSelection()\n        if(sel === null) return this.getFirstSceneObject()\n        const selected = this.accessObject(sel)\n        if(!selected.exists()) return selected\n        if(selected.type === TOTAL_OBJ_TYPES.SCENE) return selected\n        if(is3DObjectType(selected.type))  return this.findSceneObjectParent(selected)\n        if(selected.type === TOTAL_OBJ_TYPES.BEHAVIOR) return this.findSceneObjectParent(selected)\n        this.getLogger().error(\"We shouldn't ever get here\")\n        return this.accessObject(0)\n    }\n    getFirstSceneObject() {\n        return this.accessObject(this.getSceneRoot()).getChildren()[0]\n    }\n    findSceneObjectParent(obj) {\n        if(obj === null) return null\n        if(!obj.exists()) return null\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) return obj\n        obj = this.accessObject(obj.parent)\n        return this.findSceneObjectParent(obj)\n    }\n\n    getAssetsObject = () => this.getDataGraph().getObjectByProperty('type',TOTAL_OBJ_TYPES.ASSETS_LIST)\n    getBehaviorsObject = () => this.getDataGraph().getObjectByProperty('type',TOTAL_OBJ_TYPES.BEHAVIORS_LIST)\n\n    quick_setPropertyValue(item, key, value) {\n        const ov = this.getDataGraph().getPropertyValue(item,key)\n        const op = this.cmd.setProperty(item,key,value)\n        op.prevValue = ov\n        if(op.value === op.prevValue) return\n        this.getRawGraph().process(op)\n        //TODO: this should be fired through the graph already. I shouldn't need to fire this\n        this.fire(TREE_ITEM_PROVIDER.PROPERTY_CHANGED,{\n            provider: this,\n            child:item,\n            propKey:key,\n            oldValue:ov,\n            newValue:value\n        })\n    }\n\n    editIn2D = () => {\n        this.save().then(()=>{\n            const opts = Object.assign({},this.options,{mode:'edit', switcher:false, doc:this.getDocId()})\n            const loc = document.location\n            const url = `${loc.protocol}//${loc.host}${loc.pathname}?${toQueryString(opts)}`\n            DialogManager.show(<QRDialog text={\"Edit in 2D\"} url={url}/>)\n        })\n    }\n\n    editInVR = () => {\n        this.save().then(()=>{\n            const opts = Object.assign({},this.options,{mode:'vredit', switcher:false, doc:this.getDocId()})\n            const loc = document.location\n            const url = `${loc.protocol}//${loc.host}${loc.pathname}?${toQueryString(opts)}`\n            DialogManager.show(<QRDialog text={\"Edit in AR/VR\"} url={url}/>)\n        })\n    }\n\n    viewInVR = () => {\n        this.save().then(()=> {\n            const opts = Object.assign({}, this.options, {mode: 'play', switcher: false, doc:this.getDocId()})\n            const loc = document.location\n            const url = `${loc.protocol}//${loc.host}${loc.pathname}?${toQueryString(opts)}`\n            DialogManager.show(<QRDialog text={\"View in AR/VR\"} url={url}/>)\n        })\n    }\n\n\n    add3DObject = (type, parent) => {\n        const obj = get3DObjectDef(type).make(this.getDataGraph(),parent)\n        parent.insertFirstChild(obj)\n        SelectionManager.setSelection(obj.id)\n        ToasterMananager.add('added '+type)\n    }\n\n    calculateContextMenu(item) {\n        const cmds = []\n        const obj = this.accessObject(item)\n        if(canBeDeleted(obj.type)) {\n            cmds.push({title: 'delete', icon: ITEM_ICONS.delete, fun: () => deleteObject(this)});\n        }\n        if(obj.type === TOTAL_OBJ_TYPES.ASSETS_LIST) {\n            return generateAddAssetPopup(this)\n        }\n        if(obj.type === TOTAL_OBJ_TYPES.BEHAVIORS_LIST) {\n            cmds.push({\n                title:'Add Behavior from Server',\n                enabled:AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.behavior_script,\n                fun: () => this.showOpenBehaviorDialog()\n            })\n        }\n        if(canHaveShape(obj.type)) {\n            cmds.push({ divider:true })\n            Object.keys(OBJ_TYPES).forEach(type => cmds.push({\n                title: type,\n                icon: ITEM_ICONS[type],\n                fun: () => this.add3DObject(type,obj)\n            }))\n        }\n        if(canHaveScene(obj.type)) {\n            cmds.push({title: 'scene', icon: ITEM_ICONS.scene, fun: ()=>addScene(this)})\n        }\n\n        if(canHaveBehavior(obj.type)) {\n            cmds.push({ divider:true })\n            this.accessObject(this.getBehaviorsObject()).getChildren()\n                .filter(a => a.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT)\n                .forEach((b) => {\n                    cmds.push({\n                        title: b.title,\n                        icon: ITEM_ICONS.behavior_script,\n                        fun: () => this.addBehaviorToObject(b, item)\n                    })\n                })\n                cmds.push({\n                    title: 'Add Behavior from server',\n                    icon: ITEM_ICONS.behavior_script,\n                    enabled:AuthModule.isLoggedIn(),\n                    fun: () => {\n                        DialogManager.show(<OpenScriptDialog provider={this} onAdd={(beh)=>{\n                            this.addBehaviorToObject(beh,item).then(b=>{\n                                SelectionManager.setSelection(b.id)\n                            })\n                        }}/>)\n                    }\n                })\n        }\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) {\n            cmds.push({ divider:true })\n            if(AuthModule.scriptEditingSupported) {\n                cmds.push({title: 'Add Scene script', icon: ITEM_ICONS.behavior, fun: () => this.addSceneScript(item)})\n            }\n        }\n\n\n        if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR) {\n            cmds.push({ divider:true })\n            cmds.push({title:'view code', icon: ITEM_ICONS.behavior, fun: ()=>SelectionManager.setSelection(obj.behavior)})\n        }\n\n        if(canBeDeleted(obj.type)) {\n            cmds.push({divider: true})\n            cmds.push({title: 'cut', icon: ITEM_ICONS.cut, fun: this.cutSelection})\n            cmds.push({title: 'copy', icon: ITEM_ICONS.copy, fun: this.copySelection})\n            cmds.push({title: 'paste', icon: ITEM_ICONS.paste, fun: this.pasteSelection})\n        }\n        return cmds\n    }\n\n    cutSelection = (e) => {\n        if(e && e.target) {\n            if (e.target.getAttribute('type') === 'input') return\n            if (e.target.nodeName === 'INPUT') return\n            if (e.target.nodeName === 'TEXTAREA') return\n        }\n        if(SelectionManager.isEmpty()) return\n        const obj = this.accessObject(SelectionManager.getSelection())\n        SelectionManager.setClipboard(obj.id)\n        obj.removeFromParent()\n        SelectionManager.clearSelection()\n    }\n    copySelection = (e) => {\n        if(e && e.target) {\n            if (e.target.getAttribute('type') === 'input') return\n            if (e.target.nodeName === 'INPUT') return\n            if (e.target.nodeName === 'TEXTAREA') return\n        }\n        if(SelectionManager.isEmpty()) return\n        const obj = this.accessObject(SelectionManager.getSelection())\n        SelectionManager.setClipboard(obj.id)\n    }\n    pasteSelection = (e) => {\n        //don't intercept if this is a paste into a text field\n        if(e && e.target) {\n            if (e.target.getAttribute('type') === 'input') return\n            if (e.target.nodeName === 'INPUT') return\n            if (e.target.nodeName === 'TEXTAREA') return\n        }\n        const obj1 = this.accessObject(SelectionManager.getClipboard())\n        let parent = null\n        if(is3DObjectType(obj1.type)) parent = this.getSelectedSceneObject()\n        if(obj1.type === 'scene') parent = this.accessObject(this.getSceneRoot())\n        if (!parent) return console.error(\"no parent to ad too! bad obj type?\",obj1.type)\n        parent.insertChildLast(obj1.clone())\n    }\n\n    // ============ drag and drop ============\n    canBeMoved(node) {\n        const p = this.accessObject(node)\n        if(p.type === TOTAL_OBJ_TYPES.ROOT) return false\n        if(p.type === TOTAL_OBJ_TYPES.BEHAVIORS_LIST) return false\n        if(p.type === TOTAL_OBJ_TYPES.ASSETS_LIST) return false\n        return true\n    }\n    canAddChild(parent,child) {\n        const p = this.accessObject(parent)\n        const c = this.accessObject(child)\n        if(p.type === TOTAL_OBJ_TYPES.ROOT && c.type === TOTAL_OBJ_TYPES.SCENE) return true\n        if(p.type === TOTAL_OBJ_TYPES.SCENE && is3DObjectType(c.type)) return true\n        if(is3DObjectType(p.type) && c.type === TOTAL_OBJ_TYPES.BEHAVIOR) return true\n        if(canHaveShape(p.type) && is3DObjectType(c.type)) return true\n        return false\n    }\n    canBeSibling(src,tgt) {\n        const s = this.accessObject(src)\n        const t = this.accessObject(tgt)\n        if(s.type === TOTAL_OBJ_TYPES.SCENE && t.type === TOTAL_OBJ_TYPES.SCENE) return true\n        if(is3DObjectType(s.type) && is3DObjectType(t.type)) return true\n        return false\n    }\n    canAddExternalChild(parent,child) {\n        const obj = this.accessObject(parent)\n        if(obj.type === TOTAL_OBJ_TYPES.ASSETS_LIST) return true\n        return false\n    }\n    acceptDrop(e,tgt) {\n        const obj = this.accessObject(tgt)\n        if(obj.type === TOTAL_OBJ_TYPES.ASSETS_LIST) {\n            listToArray(e.dataTransfer.files).forEach(file => {\n                if(isImageType(file.type)) return addImageAssetFromFile(file,this)\n                if(isGLTFFile(file)) return addGLBAssetFromFile(file,this)\n            })\n        }\n    }\n    requestImageCache(src) {\n        const img = new Image()\n        img.crossOrigin = \"anonymous\"\n        this.imagecache[src] = img\n        return new Promise((res,rej) => {\n            img.src = src\n            img.onload = () => {\n                this.fire(TREE_ITEM_PROVIDER.STRUCTURE_CHANGED,{ provider: this })\n                res(img)\n            }\n        })\n    }\n\n    createCustomEditor(item,def,provider, value, onChange) {\n        if(def.key === PROP_DEFS.color.key\n            || def.key === PROP_DEFS.backgroundColor.key\n            || def.key === PROP_DEFS.borderColor.key\n            || def.key === PROP_DEFS.textColor.key\n            || def.key === PROP_DEFS.startColor.key\n            || def.key === PROP_DEFS.endColor.key\n        ) return <ColorEditor def={def} item={item} onChange={onChange} value={value}/>\n\n        if(def.key === 'scale') return <GroupPropertyEditor def={def} item={item} onChange={onChange} provider={this}/>\n        if(def.key === 'translation') return <GroupPropertyEditor def={def} item={item} onChange={onChange} provider={this}/>\n        if(def.key === 'rotation') return <GroupPropertyEditor def={def} item={item} onChange={onChange} provider={this}/>\n        if(def.key === 'behavior') return <button onClick={()=>SelectionManager.setSelection(value)}>view code</button>\n        return <i>no custom editor for {def.key}</i>\n    }\n\n    setColor = (color) => {\n        if(SelectionManager.isEmpty()) return\n        this.accessObject(SelectionManager.getSelection()).set('color',color)\n    }\n\n    showAddImageAssetDialog = () => DialogManager.show(<AddImageAssetDialog provider={this}/>)\n    showAddAudioAssetDialog = () => DialogManager.show(<AddAudioAssetDialog provider={this}/>)\n    showAddGLTFAssetDialog  = () => DialogManager.show(<AddGLTFAssetDialog provider={this}/>)\n    showAddGLBAssetDialog   = () => DialogManager.show(<AddGLBAssetDialog provider={this}/>)\n    showOpenDocumentDialog  = () => DialogManager.show(<OpenFileDialog provider={this}/>)\n    showOpenAssetDialog     = () => DialogManager.show(<OpenAssetDialog provider={this}/>)\n    showAddServerImageDialog= () => DialogManager.show(<OpenAssetDialog provider={this} filter={a => isImageType(a.mimeType)}/>)\n    showOpenBehaviorDialog  = () => DialogManager.show(<OpenScriptDialog provider={this}/>)\n    showAddGeoLocationAssetDialog = () => {\n        addGeoAnchorAsset({\n            latitude:0,\n            longitude:0,\n            altitude:0,\n            useAltitude:false,\n        },\"new geo location\",this)\n    }\n    showPasswordDialog = () => DialogManager.show(<PasswordDialog provider={this}/>)\n    showGithubDialog = () => DialogManager.show(<GithubAuthDialog provider={this}/>)\n\n    accessObject = (id) => {\n        return new GraphAccessor(this.getDataGraph()).object(id)\n    }\n\n    loadDocList() {\n        return AuthModule.getJSON(`${getDocsURL()}list`)\n    }\n    removeDoc(doc) {\n        return AuthModule.fetch(`${getDocsURL()}delete/${doc.id}`,{\n            method:'POST',\n            body:doc.id,\n        }).then(res => res.json())\n    }\n    loadAssetList() {\n        return AuthModule.getJSON(`${getAssetsURL()}list`)\n    }\n    removeAssetSource(info) {\n        return AuthModule.fetch(`${getAssetsURL()}delete/${info.id}`,{\n            method:'POST',\n            body:info.id,\n        }).then(res => res.json())\n    }\n    loadScriptList() {\n        return AuthModule.getJSON(`${getScriptsURL()}list`)\n    }\n\n\n    // ======== behaviors ===============\n    addBehaviorAssetFromURL = (info) => {\n        const graph = this.getDataGraph()\n        const behavior = fetchGraphObject(graph,graph.createObject({\n            type:TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT,\n            title:info.title,\n            description:info.description,\n            src:info.url,\n            parent:0\n        }))\n        this.accessObject(this.getBehaviorsObject()).insertChildLast(behavior)\n        SelectionManager.setSelection(behavior.id)\n        return behavior\n    }\n    removeBehaviorAssetSource(name) {\n        const url = `${getScriptsURL()}delete/${name}`\n        console.log(\"removing\",url)\n        return AuthModule.fetch(url,{\n            method:'POST',\n            body:name,\n        }).then(res => res.json())\n    }\n    addCustomBehaviorAsset = (TEMPLATE) => {\n        const randi = (Math.floor(Math.random()*100000000))\n        const fname =`behavior_${randi}.js`\n        const url = `${getScriptsURL()}${fname}`;\n        const contents = TEMPLATE?TEMPLATE:CUSTOM_BEHAVIOR_SCRIPT\n        console.log(\"posting it to\",url)\n        return AuthModule.fetch(url,{\n            method:'POST',\n            body:contents,\n        })\n            .then(res => res.json())\n            .then(ans => {\n                console.log(\"got back the answer\",ans)\n                const graph = this.getDataGraph()\n                const behavior = fetchGraphObject(graph,graph.createObject({\n                    type:TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT,\n                    title:ans.script.title,\n                    description:ans.script.description,\n                    src:fname,\n                    parent:0\n                }))\n                this.accessObject(this.getBehaviorsObject()).insertChildLast(behavior)\n                SelectionManager.setSelection(behavior.id)\n                return behavior\n\n            })\n            .catch(err => console.error(err))\n    }\n    addSceneScript = (obj) => {\n        this.addCustomBehaviorAsset(CUSTOM_SCENE_SCRIPT)\n            .then((b)=>this.addBehaviorToObject(b,obj))\n    }\n    addBehaviorToObject = (b,item) => {\n        return this.fetchBehaviorAssetContents(b.id).then((contents)=>{\n            try {\n                const def = {\n                    type: TOTAL_OBJ_TYPES.BEHAVIOR,\n                    title: b.title,\n                    description: b.description,\n                    parent: 0,\n                    behavior:b.id,\n                }\n                const obj = parseBehaviorScript(contents)\n                this.setCachedBehaviorAsset(b.id,obj)\n                //copy properties to the behavior def\n                if(obj.properties) {\n                    Object.keys(obj.properties).forEach(name => {\n                        def[name] = obj.properties[name].value\n                    })\n                }\n                const graph = this.getDataGraph()\n                const behavior = fetchGraphObject(graph, graph.createObject(def))\n                this.accessObject(item).insertChildLast(behavior)\n                return behavior\n            } catch (e) {\n                console.error(e)\n            }\n        })\n    }\n    fetchBehaviorAssetContents(id) {\n        const obj = this.accessObject(id)\n        const url = getScriptsURL()+obj.src\n        return AuthModule.fetch(url,{\n            method:'GET',\n        }).then(res => res.text())\n    }\n    updateBehaviorAssetContents(id,text) {\n        if(!AuthModule.supportsScriptEdit()) return\n        //update the cache first\n        try {\n            const info = parseBehaviorScript(text)\n            info.text = text\n            this.setCachedBehaviorAsset(id, info)\n\n            const obj = this.accessObject(id)\n            const url = getScriptsURL() + obj.src\n            return AuthModule.fetch(url, {\n                method: 'POST',\n                body: text,\n            }).then(res => res.json())\n                .then(ans => {\n                    obj.set('title', ans.script.title)\n                    obj.set('description', ans.script.description)\n                })\n        } catch(e) {\n            console.error(\"error parsing the script\",e)\n            ToasterMananager.add('error parsing')\n        }\n    }\n    getCachedBehaviorPropDefs(behavior) {\n        if(!this.behaviorCache[behavior]) {\n            console.error(\"no parsed behavior in the cache\",behavior)\n            return null\n        }\n        return this.behaviorCache[behavior].properties;\n    }\n    getCachedBehaviorAsset(id) {\n        return this.behaviorCache[id]\n    }\n    setCachedBehaviorAsset(id, asset) {\n        this.behaviorCache[id] = asset\n    }\n\n    setAudioListener(al) {\n        this.audioListener = al\n    }\n    getAudioListener() {\n        return this.audioListener\n    }\n\n    showBadAssetsDialog() {\n        DialogManager.show(<BadAssetsDialog provider={this}/>)\n    }\n}\n\nclass VREditorApp extends Component {\n    showSaveAsDialog = () => {\n        DialogManager.show(<SaveDocumentAsDialog provider={this.props.provider}/>)\n    }\n    resizeLeft = (e) => {\n        window.addEventListener('mousemove',this.resizeLeftWindow)\n        window.addEventListener('mouseup', this.endResizeLeftWindow)\n    }\n    resizeLeftWindow =(e) => {\n        this.setState({leftDivider:e.clientX+'px'})\n    }\n    endResizeLeftWindow = (e) => {\n        window.removeEventListener('mousemove', this.resizeLeftWindow)\n        window.removeEventListener('mouseup', this.endResizeLeftWindow)\n    }\n\n    resizeRight = (e) => {\n        window.addEventListener('mousemove', this.resizeRightWindow)\n        window.addEventListener('mouseup', this.endResizeRightWindow)\n    }\n    resizeRightWindow = (e)=>{\n        const size = document.querySelector('.grid').getBoundingClientRect()\n        this.setState({rightDivider:(size.width-e.clientX)+'px'})\n    }\n    endResizeRightWindow = (e) => {\n        window.removeEventListener('mousemove', this.resizeRightWindow)\n        window.removeEventListener('mouseup', this.endResizeRightWindow)\n    }\n\n    resizeBottom = (e) => {\n        window.addEventListener('mousemove', this.resizeBottomWindow)\n        window.addEventListener('mouseup', this.endResizeBottomWindow)\n    }\n    resizeBottomWindow = (e) => {\n        const size = document.querySelector('.grid').getBoundingClientRect()\n        this.setState({bottomDivider:(size.height-e.clientY)+'px'})\n    }\n    endResizeBottomWindow = (e) => {\n        window.removeEventListener('mousemove', this.resizeBottomWindow)\n        window.removeEventListener('mouseup', this.endResizeBottomWindow)\n    }\n\n    toggleLeftPane = (e) => {\n        if(this.state.leftDivider === '0px') {\n            this.setState({leftDivider:'250px'})\n        } else {\n            this.setState({leftDivider:'0px'})\n        }\n    }\n    toggleRightPane = (e) => {\n        if(this.state.rightDivider === '0px') {\n            this.setState({rightDivider:'250px'})\n        } else {\n            this.setState({rightDivider:'0px'})\n        }\n    }\n    toggleBottomPane = (e) => {\n        if(this.state.bottomDivider === '0px') {\n            this.setState({bottomDivider:'250px'})\n        } else {\n            this.setState({bottomDivider:'0px'})\n        }\n    }\n\n\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            mode:'canvas',\n            user:null,\n            running:false,\n            connected:false,\n            dirty:true,\n            leftDivider: '250px',\n            rightDivider: '250px',\n            bottomDivider:'250px',\n        }\n\n        this.im = new InputManager()\n        this.im.addKeyBinding({id: 'save', key: InputManager.KEYS.S, modifiers: [InputManager.MODIFIERS.COMMAND]})\n        this.im.addKeyBinding({id: 'undo', key: InputManager.KEYS.Z, modifiers: [InputManager.MODIFIERS.COMMAND]})\n        this.im.addKeyBinding({\n            id: 'redo',\n            key: InputManager.KEYS.Z,\n            modifiers: [InputManager.MODIFIERS.COMMAND, InputManager.MODIFIERS.SHIFT]\n        })\n        this.im.addListener('save', this.props.provider.save)\n        this.im.addListener('undo', this.props.provider.performUndo)\n        this.im.addListener('redo', this.props.provider.performRedo)\n\n        this.im.addKeyBinding({id: 'cut', key: InputManager.KEYS.X, modifiers: [InputManager.MODIFIERS.COMMAND]})\n        this.im.addKeyBinding({id: 'copy', key: InputManager.KEYS.C, modifiers: [InputManager.MODIFIERS.COMMAND]})\n        this.im.addKeyBinding({id: 'paste', key: InputManager.KEYS.V, modifiers: [InputManager.MODIFIERS.COMMAND]})\n\n        this.im.addListener('cut', this.props.provider.cutSelection)\n        this.im.addListener('copy', this.props.provider.copySelection)\n        this.im.addListener('paste', this.props.provider.pasteSelection)\n\n    }\n\n    componentDidMount() {\n        this.im.attachKeyEvents(document)\n        SelectionManager.on(SELECTION_MANAGER.CHANGED,this.selectionChanged)\n        AuthModule.on(USER_CHANGE,()=>this.setState({user:AuthModule.getUsername()}))\n        AuthModule.on(CONNECTED,()=>this.setState({connected:true}))\n        if(AuthModule.isConnected()) this.setState({connected:true})\n        this.props.provider.on(TREE_ITEM_PROVIDER.CLEAR_DIRTY,()=>{\n            this.setState({dirty:false})\n        })\n        this.props.provider.on(TREE_ITEM_PROVIDER.PROPERTY_CHANGED, () => {\n            this.setState({dirty:true})\n        })\n        this.props.provider.on(TREE_ITEM_PROVIDER.SAVED, () => {\n            this.setState({dirty:false})\n        })\n    }\n    componentWillUnmount() {\n        SelectionManager.off(SELECTION_MANAGER.CHANGED,this.selectionChanged)\n    }\n\n    selectionChanged = () => {\n        if(!SelectionManager.isEmpty()) {\n            const item = this.props.provider.accessObject(SelectionManager.getSelection())\n            if(item.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) return this.setState({mode:'script'})\n            if(item.type === PROP_DEFS.asset.key) return this.setState({mode:'asset'})\n        }\n        this.setState({mode:'canvas'})\n    }\n\n    toggleRunning = () => {\n        this.setState({running:!this.state.running})\n    }\n\n    newDoc = () => {\n        if(this.state.dirty) {\n            console.log(\"can't create new becausue dirty\")\n            DialogManager.show(<UnsavedDocumentDialog onAnyway={()=>{\n                console.log(\"we are doing it anyway\")\n                newDoc(this.props.provider)\n            }}/>)\n\n        } else {\n            newDoc(this.props.provider)\n        }\n    }\n\n    showOpenDocumentDialog = () => {\n        if(this.state.dirty) {\n            DialogManager.show(<UnsavedDocumentDialog onAnyway={()=>{\n                console.log(\"we are doing it anyway\")\n                this.props.provider.showOpenDocumentDialog()\n            }}/>)\n        } else {\n            this.props.provider.showOpenDocumentDialog()\n        }\n    }\n\n    render() {\n        if(this.state.connected === false) {\n            return <div>\n                <h1>connecting to server</h1>\n                <DialogContainer/>\n            </div>\n        }\n        const prov = this.props.provider\n        let logger = null\n        if(prov.pubnub) logger = prov.getLogger()\n        if(!prov.getDataGraph()) {\n            return <div>\n                <h1>connecting to server</h1>\n                <DialogContainer/>\n            </div>\n        }\n        const dateTimeStamp = preval`module.exports = new Date().toLocaleString();`\n        const gridStyle = {\n            gridTemplateColumns: `${this.state.leftDivider} 0px 1fr 0px ${this.state.rightDivider}`,\n            gridTemplateRows: `2rem 1fr 2rem 0px ${this.state.bottomDivider}`,\n        }\n\n        return <ErrorCatcher logger={logger}>\n            <div className=\"grid\" style={gridStyle}>\n\n\n                <div className=\"toolbar gray\">\n                    {this.renderLoginButton()}\n                    <Spacer/>\n                    <button className=\"fa fa-file green\" onClick={this.newDoc} title={'new project'}/>\n                    <button className=\"fa fa-save green\" onClick={() => prov.save()} title={'save project'}/>\n                    <button className=\"fa fa-clone green\" onClick={this.showSaveAsDialog} title={\"duplicate project\"}/>\n                </div>\n                <Resizer onMouseDown={this.resizeLeft}/>\n                <div className=\"toolbar gray\">\n                    <button className=\"fa fa-cube yellow\"        onClick={(e)=>showAddPopup(e,prov)}/>\n                    {/*<button className=\"fa fa-globe\"       onClick={(e)=>addScene(prov)}/>*/}\n                    <button className=\"fa fa-archive yellow\"     onClick={(e)=>showAddAssetPopup(e,prov)}/>\n                    <button className=\"fab fa-superpowers yellow\" onClick={(e)=>showAddBehaviorPopup(e,prov)}/>\n                    {/*<button onClick={() => prov.editIn2D()}>2D Edit</button>*/}\n                    {/*<button onClick={() => prov.editInVR()}>AR Edit</button>*/}\n                    {/*<button onClick={() => prov.viewInVR()}>XR View</button>*/}\n                    <Spacer/>\n                    <RunButton onClick={this.toggleRunning} active={this.state.running}/>\n                    <Spacer/>\n                    <button className=\"fa fa-cut purple\" onClick={prov.cutSelection}/>\n                    <button className=\"fa fa-copy purple\" onClick={prov.copySelection}/>\n                    <button className=\"fa fa-paste purple\" onClick={prov.pasteSelection}/>\n                    <button className=\"fas fa-undo purple\" onClick={prov.performUndo}/>\n                    <button className=\"fas fa-redo purple\" onClick={prov.performRedo}/>\n                </div>\n                <Resizer onMouseDown={this.resizeRight}/>\n                <div className=\"toolbar gray\">\n                    <i className=\"fa fa-horse-head\" title={dateTimeStamp}/>\n                    <label>MrEd</label>\n                </div>\n\n                <div className={'panel high-2'}>\n                    <TreeTable root={prov.getSceneRoot()} provider={prov}/>\n                </div>\n                <Resizer onMouseDown={this.resizeLeft}/>\n                <div className=\"panel\">\n                    {this.renderCenterPane(this.state.mode)}\n                </div>\n                <Resizer onMouseDown={this.resizeRight}/>\n                <div className={'panel high-2'} style={{ backgroundColor: '#ecf0f1'}}>\n                    <PropSheet provider={prov}/>\n                </div>\n\n                <Resizer onMouseDown={this.resizeLeft}/>\n                <div className=\"toolbar borderless\">\n                    <button className={'borderless gray far' + ((this.state.leftDivider !== '0px') ? ' fa-caret-square-left' : ' fa-caret-square-right')}\n                            onClick={this.toggleLeftPane}/>\n                    <button className={'borderless gray far' + ((this.state.bottomDivider !== '0px') ? ' fa-caret-square-down' : ' fa-caret-square-up')}\n                            onClick={this.toggleBottomPane}/>\n\n                    <Spacer/>\n                    <span className=\"button blue\" onClick={() => prov.viewInVR()}>\n                        <i className=\"fas fa-external-link-alt\"/>\n                        <b>Phone View</b>\n                    </span>\n                    {this.props.bottomText}\n                    <Spacer/>\n                    <button className={'borderless gray far' + ((this.state.rightDivider !== '0px') ? ' fa-caret-square-right' : ' fa-caret-square-left')}\n                            onClick={this.toggleRightPane}/>\n                </div>\n                <Resizer onMouseDown={this.resizeRight}/>\n\n\n                <ResizerH onMouseDown={this.resizeBottom}/>\n                <ConsoleView logger={this.props.provider.getLogger()}/>\n                <ToasterNotification/>\n                <DialogContainer/>\n                <PopupContainer/>\n\n                {/*<div className=\"glitchButton\" style={{position:'fixed',top:'4px',right:'4px'}}/>*/}\n                {/*<script src=\"https://button.glitch.me/button.js\"/>*/}\n            </div>\n        </ErrorCatcher>\n    }\n    renderCenterPane(mode) {\n        if (mode === 'script') return <ScriptEditor provider={this.props.provider}/>\n        if (mode === 'canvas') return <VRCanvas provider={this.props.provider} running={this.state.running}/>\n        return <AssetView provider={this.props.provider} asset={SelectionManager.getSelection()}/>\n    }\n\n    renderLoginButton() {\n        const buttons = []\n\n        if(AuthModule.supportsAuth()) {\n            if(AuthModule.isLoggedIn()) {\n                buttons.push(<span key=\"logout\" className=\"blue button\" onClick={AuthModule.logout}><i className=\"fa fa-user\"/><b>logout</b></span>)\n            } else {\n                buttons.push(<span key=\"login\" className=\"blue button\" onClick={()=>{\n                    if(AuthModule.supportsPassword()) {\n                        this.props.provider.showPasswordDialog()\n                    } else {\n                        this.props.provider.showGithubDialog()\n//                        AuthModule.login()\n                    }\n                }}><i className=\"fa fa-user\"></i><b>login</b></span>)\n            }\n        }\n        if(AuthModule.supportsDocList()) {\n            buttons.push(<button key=\"open\" className=\"fa fa-folder-open blue\" onClick={this.showOpenDocumentDialog} title={\"open\"}/>)\n        }\n        return buttons\n    }\n}\n\nconst Resizer = (props) => {\n    return <div className=\"resizer\" {...props}/>\n}\nconst ResizerH = (props) => {\n    return <div className=\"resizer-h\" {...props}/>\n}\nconst EnumTitleRenderer = (props) => {\n    let value = \"---\"\n    if(props.value && props.provider)  value = props.provider.accessObject(props.value).title\n    if(props.value === NONE_ASSET.id)  value = NONE_ASSET.title\n    return <b>{value}</b>\n}\n\nclass GroupPropertyEditor extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            sync:false,\n        }\n    }\n    syncChanged = (e) => this.setState({sync: !this.state.sync})\n    changed = (e, key) =>{\n        const obj = this.props.provider.accessObject(this.props.item)\n        const keys = this.props.def.getGroupKeys()\n        const newvals = {}\n        keys.forEach(key=> newvals[key] = obj[key])\n        const val = parseFloat(e.target.value)\n        newvals[key] = val\n        if(this.state.sync) {\n            keys.forEach(key => newvals[key] = val)\n        }\n        this.props.onChange(newvals)\n    }\n    render() {\n        const obj = this.props.provider.accessObject(this.props.item)\n        const keys = this.props.def.getGroupKeys()\n        const boxes = keys.map(key => {\n            return <input key={key}\n                          type=\"number\"\n                          value={obj[key]}\n                          onChange={(e)=>{ this.changed(e,key)}}\n                          step={0.1}/>\n        })\n        return <HBox className=\"combined\">\n            <input type=\"checkbox\" checked={this.state.sync} onChange={this.syncChanged}/>\n            {boxes}\n        </HBox>\n    }\n}\n\nfunction acceptsModelAsset(type) {\n    if(type=== OBJ_TYPES.model) return true\n    return false\n}\nfunction acceptsImageAsset(type) {\n    if(type === OBJ_TYPES.plane\n        || type === OBJ_TYPES.bg360\n        || type === OBJ_TYPES.img2d\n        || type === OBJ_TYPES.cube\n        || type === OBJ_TYPES.sphere\n    ) return true\n    return false\n}\nfunction acceptsVideoAsset(type) {\n    if(type === OBJ_TYPES.plane\n        || type === OBJ_TYPES.bg360\n        || type === OBJ_TYPES.img2d\n    ) return true\n    return false\n}\n\nconst RunButton = (props) => {\n    const clss = props.active?\"run-button active fa fa-stop\":\"run-button fa fa-play\"\n    return <button onClick={props.onClick} className={clss + \" blue\"}/>\n}\n\nfunction withNone(array) {\n    array.push(NONE_ASSET.id)\n    return array\n}\n\nclass ColorEditor extends Component {\n    showPopup = (e) =>{\n        PopupManager.show(<ColorPopup onChange={this.props.onChange} value={this.props.value}/>, e.target)\n    }\n    render() {\n        return <button\n            style={{backgroundColor:this.props.value}}\n            onClick={this.showPopup}\n        >{this.props.value}</button>\n\n    }\n}\n\nclass ColorPopup extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            value:props.value\n        }\n    }\n    onChange = (e) => {\n        this.setState({value:e.target.value})\n        const v = e.target.value\n        if(v.indexOf('#')>=0 && v.length === 7) this.props.onChange(v)\n    }\n    done = () => {\n        this.props.onChange(this.state.value)\n        PopupManager.hide()\n    }\n    render() {\n        return <VBox style={{\n            width: '130px',\n            height: '100px',\n            backgroundColor: 'white'\n        }}>\n            <HBox>\n                {\n                    SIMPLE_COLORS\n                        .map(c => <button\n                            key={c}\n                            onClick={() => {\n                                this.props.onChange(c)\n                            }}\n                            style={{color: c, padding: '1px', margin: 0, borderWidth: 0,}}\n                            className={\"fa fa-square\"}/>)\n                }\n            </HBox>\n            <input type=\"text\" value={this.state.value}\n                   onChange={this.onChange}/>\n            <button onClick={this.done}>done</button>\n        </VBox>\n    }\n}\n","import * as THREE from 'three'\n\nimport {mat4, vec3} from \"gl-matrix/dist/gl-matrix.js\"\n\nvar meshMap = new Map()\n\nconst workingMatrix = mat4.create()\nvar savedOrigin = [0,0,0]\nvar savedDirection = [0,0,-1]\nvar reticleParent = null\nvar reticle = null\n            \nvar reticleTrackedColor = new THREE.Color( 0xDDFFDD );\nvar reticleNotTrackedColor = new THREE.Color( 0xFF6666 );\nvar reticleMaterial = new THREE.MeshStandardMaterial({ color: reticleTrackedColor })\nvar requestNextHit = true\nlet singleton = 0\n\nexport class XRWorldInfo extends THREE.Group {\n\n    constructor(engine,logger) {\n\n        super()\n\n        // run as a singleton\n        if(singleton) {\n            logger.error(\"XRWorldInfo called more than once - very bad\")\n            return singleton\n        }\n        singleton = this\n\n        this.engine = engine\n        this.session = engine.session\n        this.logger = logger\n        this.visible = false\n\n        this._floorPos = vec3.create()\n\n        // enable extended world sensing\n        this.session.updateWorldSensingState({\n            illuminationDetectionState : {\n                enabled : true\n            },\n            meshDetectionState : {\n                enabled : true,\n                normals: true\n            }\n        })\n\n        // don't waste time remaking this every frame\n        this._handleHitResults = this.handleHitResults.bind(this)\n\n        // a reticule\n        reticle = new THREE.Mesh( new THREE.RingGeometry(0.04, 0.05, 36, 64), reticleMaterial)\n        reticle.geometry.applyMatrix(new THREE.Matrix4().makeRotationX(THREE.Math.degToRad(-90)))\n        reticleParent = new THREE.Object3D()\n        reticleParent.add(reticle)\n        reticleParent.matrixAutoUpdate = false\n        reticleParent.visible = false\n\n    }\n\n    setVisible(status) {\n        this.visible = status\n        reticleParent.visible = status\n        meshMap.forEach(object => { object.node.visible = object.mesh.visible = status })\n    }\n\n    refreshWorldInfo(frame) {\n\n        let worldInfo = frame.worldInformation\n        if(!worldInfo || !worldInfo.meshes) {\n            return\n        }\n\n        // mark\n        meshMap.forEach(object => { object.seen = false })\n\n        // update meshes\n        worldInfo.meshes.forEach(worldMesh => {\n            var object = meshMap.get(worldMesh.uid);\n            if (object) {\n                this.handleUpdateNode(worldMesh, object)\n            } else {\n                this.handleNewNode(worldMesh)\n            }\n        })\n\n        // sweep\n        meshMap.forEach(object => { \n            if (!object.seen) {\n                this.handleRemoveNode(object)\n            } \n        })\n\n        // update frame of reference when ready to do so\n        if (requestNextHit) {\n            requestNextHit = false\n            this.session.requestFrameOfReference('head-model').then(headFrameOfReference => {\n                this.session.requestFrameOfReference('eye-level').then((eyeLevelFrameOfReference)=>{\n\n                    // update floor at player\n                    if(true) {\n                        // get player position\n                        let targetPos = vec3.create()\n                        headFrameOfReference.getTransformTo(eyeLevelFrameOfReference, workingMatrix)\n                        mat4.getTranslation(targetPos, workingMatrix)\n\n                        // find floor at player\n                        if( this.findFloorNear(targetPos) ) {\n\n                            // has floor moved significantly?\n                            if( vec3.squaredDistance(targetPos,this._floorPos) > 0.01) {\n                                vec3.copy(this._floorPos,targetPos)\n                                this.logger.log(\"************** floor is at \" + this._floorPos[1] )\n                            }\n\n                        }\n                    }\n\n                    // update reticule\n                    this.session.requestHitTest(savedOrigin, savedDirection, headFrameOfReference)\n                        .then(this._handleHitResults)\n                        .catch(err => {\n                            this.logger.error('Error testing hits', err)\n                        })\n\n                    //(TODO done elsewhere because I am unsure about asyncronity of handleHitResults)\n                    //requestNextHit = true\n                })\n            })\n        }\n    }\n\n    // handle hit testing slightly differently than other samples, since we're doing\n    // it per frame.  The \"boiler plate\" code below is slightly different, setting \n    // requestNextHit on tap instead of executing the hit test.  The custom XREngineHits\n    // does a hit test each frame if the previous one has resolved\n    // TODO unsure why this has to request these frames of reference again\n    handleHitResults(hits) {\n        if (hits && hits.length > 0) {\n            let hit = hits[0]\n            this.session.requestFrameOfReference('head-model').then(headFrameOfReference => {\n                this.session.requestFrameOfReference('eye-level').then((eyeLevelFrameOfReference)=>{\n                    // convert hit matrices from head to eye level coordinate systems\n                    headFrameOfReference.getTransformTo(eyeLevelFrameOfReference, workingMatrix)\n                    mat4.multiply(workingMatrix, workingMatrix, hit.hitMatrix)\n                    const node = reticleParent\n                    node.matrix.fromArray(workingMatrix)\n                    reticleParent.visible = this.visible   // it starts invisible\n                    reticle.material.color = reticleTrackedColor\n                    node.updateMatrixWorld(true)\n                })\n            })\n        } else {\n            reticle.material.color = reticleNotTrackedColor\n        }\n        requestNextHit = true\n    }\n\n    handleUpdateNode(worldMesh, object) {\n        object.seen = true\n        // we don't need to do anything if the timestamp isn't updated\n        if (worldMesh.timeStamp <= object.ts) {\n            return;\n        }\n        if (worldMesh.vertexCountChanged) {\n            let newMesh = this.newMeshNode(worldMesh)\n            object.threeMesh.geometry.dispose()\n            object.node.remove(object.threeMesh)\n            object.node.add(newMesh)\n            object.threeMesh = newMesh\n        } else {\n            if (worldMesh.vertexPositionsChanged) {\n                let position = object.threeMesh.geometry.attributes.position\n                if (position.array.length !== worldMesh.vertexPositions.length) {\n                    this.logger.error(\"position and vertex arrays are different sizes\", position, worldMesh)\n                }\n                position.setArray(worldMesh.vertexPositions);\n                position.needsUpdate = true;\n            }\n            if (worldMesh.textureCoordinatesChanged) {\n                let uv = object.threeMesh.geometry.attributes.uv\n                if (uv.array.length !== worldMesh.textureCoordinates.length) {\n                    this.logger.error(\"uv and vertex arrays are different sizes\", uv, worldMesh)\n                }\n                uv.setArray(worldMesh.textureCoordinates);\n                uv.needsUpdate = true;\n            }\n            if (worldMesh.triangleIndicesChanged) {\n                let index = object.threeMesh.geometry.index\n                if (index.array.length !== worldMesh.triangleIndices) {\n                    this.logger.error(\"uv and vertex arrays are different sizes\", index, worldMesh)\n                }\n                index.setArray(worldMesh.triangleIndices);\n                index.needsUpdate = true;\n            }\n            if (worldMesh.vertexNormalsChanged && worldMesh.vertexNormals.length > 0) {\n                // normals are optional\n                let normals = object.threeMesh.geometry.attributes.normals\n                if (normals.array.length !== worldMesh.vertexNormals) {\n                    this.logger.error(\"uv and vertex arrays are different sizes\", normals, worldMesh)\n                }\n                normals.setArray(worldMesh.vertexNormals);\n                normals.needsUpdate = true;\n            }\n        }\n        object.threeMesh.visible = this.visible\n    }\n\n    handleRemoveNode(object) {\n        this.remove(object.node)\n        object.threeMesh.geometry.dispose()\n        this.engine._removeAnchorForNode(object.node,this.logger)\n        meshMap.delete(object.worldMesh.uid)\n    }\n\n    handleNewNode(worldMesh) {\n        let worldMeshGroup = new THREE.Group();\n        var mesh = this.newMeshNode(worldMesh)\n        worldMeshGroup.add(mesh)\n        this.add(worldMeshGroup)\n        worldMeshGroup.visible = mesh.visible = this.visible\n        this.engine.addAnchoredNode(worldMesh, worldMeshGroup,this.logger)\n        meshMap.set(worldMesh.uid, {\n            ts: worldMesh.timeStamp, \n            worldMesh: worldMesh, \n            node: worldMeshGroup, \n            seen: true, \n            threeMesh: mesh\n        })\n    }\n\n    newMeshNode(worldMesh) {\n        let edgeColor, polyColor\n//        if (worldMesh instanceof XRFaceMesh) {\n//            edgeColor = '#999999'\n//           polyColor = '#999900'\n//        } else\n\n        edgeColor = '#11FF11'\n        polyColor = '#009900'\n\n        let mesh = new THREE.Group();\n        let geometry = new THREE.BufferGeometry()\n        let indices = new THREE.BufferAttribute(worldMesh.triangleIndices, 1)\n        indices.dynamic = true\n        geometry.setIndex(indices)\n\n        let verticesBufferAttribute = new THREE.BufferAttribute( worldMesh.vertexPositions, 3 )\n        verticesBufferAttribute.dynamic = true\n        geometry.addAttribute( 'position', verticesBufferAttribute );\n        let uvBufferAttribute = new THREE.BufferAttribute( worldMesh.textureCoordinates, 2 )\n        uvBufferAttribute.dynamic = true\n        geometry.addAttribute( 'uv', uvBufferAttribute );\n        if (worldMesh.vertexNormals.length > 0) {\n            let normalsBufferAttribute = new THREE.BufferAttribute( worldMesh.vertexNormals, 3 )\n            normalsBufferAttribute.dynamic = true\n            geometry.addAttribute( 'normal', normalsBufferAttribute );\n        } else {\n            geometry.computeVertexNormals()\n        }\n        // transparent mesh\n        var wireMaterial = new THREE.MeshPhongMaterial({color: edgeColor, wireframe: true})\n        var material = new THREE.MeshPhongMaterial({color: polyColor, transparent: true, opacity: 0.25})\n        mesh.add(new THREE.Mesh(geometry, material))\n        mesh.add(new THREE.Mesh(geometry, wireMaterial))\n        mesh.geometry = geometry;  // for later use\n        return mesh\n    }\n\n    ///\n    /// Given a point of interest in local coordinates (targetPos)\n    /// And a radius of consideration - sqrt(targetRadiusSq)\n    /// And a height below the target that is the acceptable highest point (targetTop)\n    /// And a height below the target that is the acceptable lowest point (targetBottom)\n    /// Find a point on the floor if any and update supplied input (targetPos)\n    /// May return false if fails to find a point\n    ///\n\n    findFloorNear(targetPos,targetRadiusSq=9,targetTop=-0.5,targetBottom=-2) {\n\n        // scratch variables\n        let meshPos = vec3.create()\n        let bestPos = vec3.create()\n        let bestY = 0\n\n        // visit all candidate meshes\n        meshMap.forEach(object => {\n\n            let worldMesh = object.worldMesh\n\n            // skip non horizontal features\n            //if(worldMesh.alignment()) return\n\n            // where is mesh center point in world coords?\n            vec3.set(meshPos, worldMesh._center.x, worldMesh._center.y, worldMesh._center.z)\n            vec3.transformMat4(meshPos,meshPos,worldMesh.modelMatrix)\n\n            // a number expressing the distance below the target Y\n            let distanceY = meshPos[1] - targetPos[1]\n\n            // candidate mesh is vertically to high?\n            if(distanceY > targetTop) return\n\n            // candidate mesh is vertically too low?\n            if(distanceY < targetBottom) return\n\n            // how far is a rough mesh extent from target in 2d in distance squared?\n            let distSq = (targetPos[0]-meshPos[0])*(targetPos[0]-meshPos[0])\n                       + (targetPos[2]-meshPos[2])*(targetPos[2]-meshPos[2])\n                       - worldMesh._extent[0] * worldMesh._extent[0]\n                       - worldMesh._extent[1] * worldMesh._extent[1]\n                       - targetRadiusSq;\n\n            // is too far away to be of interest?\n            if(distSq > 0) return\n\n            // distanceY fails to be the lowest acceptable candidate?\n            if(bestY < distanceY) return\n\n            // remember lowest area so far\n            bestY = distanceY\n            vec3.set(bestPos,targetPos[0],meshPos[1],targetPos[2])\n\n        })\n\n        // found nothing\n        if(!bestY) return false\n\n        // get local coordinates floor elevation\n        vec3.copy(targetPos,bestPos)\n\n        return true\n    }\n\n    get floorPos() {\n        return this._floorPos\n    }\n\n}\n\n","import React, {Component} from 'react'\nimport ScriptManager, {SceneGraphProvider} from './ScriptManager'\nimport TreeItemProvider, {getDocsURL, getScriptsURL} from '../TreeItemProvider'\nimport {on, parseOptions} from '../utils'\nimport {TweenManager} from '../common/tween'\nimport * as THREE from 'three'\nimport {Group} from 'three'\nimport {VRManager} from 'webxr-boilerplate'\nimport SceneDef from './defs/SceneDef'\nimport {ASSET_TYPES, get3DObjectDef, is3DObjectType, NONE_ASSET, parseBehaviorScript, TOTAL_OBJ_TYPES} from './Common'\nimport {AuthModule} from './AuthModule'\nimport {XRSupport} from './XRSupport'\nimport {XRWorldInfo} from './XRWorldInfo'\nimport {PubnubLogger} from '../syncgraph/PubnubSyncWrapper'\nimport {ErrorCatcher} from './ErrorCatcher'\nimport {AssetsManager} from './AssetsManager'\n\nimport {vec3} from \"gl-matrix/dist/gl-matrix.js\"\n\nimport startupsound from \"./startup-sound.m4a\"\n\nconst $ = (sel) => document.querySelector(sel)\n\n\nfunction attachUtilFunctions(obj, obj_map) {\n    obj.find = (match,list) => {\n        if(!list) list = []\n        if(match(obj)) list.push(obj)\n        if(obj.children) obj.children.forEach(ch => {\n            ch.find(match,list)\n        })\n        return list\n    }\n    obj.exists = ()=>true\n    obj.getParent = () => {\n        return obj_map[obj.parent]\n    }\n}\n\nexport class ImmersivePlayer extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            docLoaded:false,\n            title:'Loading...',\n            showErrors:false,\n            splashImage:null\n        }\n        const opts = parseOptions({})\n        if(!opts.doc) throw new Error(\"doc not specified\")\n        new TreeItemProvider(props.options)\n        this.obj_map = {}\n        this.three_map = {}\n        this.title_map = {}\n        this.previewUpdateNodes = []\n        this.current_scene = null\n        this.root = null\n        this.behavior_map = {}\n        this.behavior_assets = {}\n        this.assets_url_map = {}\n        this.pendingAssets = []\n        this.badAssets = []\n\n        this.sceneAnchor = null\n\n        this.logger = new PubnubLogger(opts.doc)\n        this.scriptManager = new ScriptManager(new Adapter(this),this.logger)\n        this.provider = {\n            accessObject:(id)=>{\n                if(!this.obj_map[id]) return {\n                    exists:()=>false,\n                }\n                return this.obj_map[id]\n            },\n            getLogger:() => this.logger,\n            getAudioListener:() => this.audioListener,\n        }\n        this.assetsManager = new AssetsManager(this.provider)\n        this.provider.assetsManager = this.assetsManager\n    }\n    getLogger() {\n        return this.logger\n    }\n\n    componentDidMount() {\n        this.logger.log(\"mounted ImmersivePlayer\")\n        this.loadDocument()\n        $(\"#progress\").value = 0\n    }\n\n    loadDocument() {\n        const opts = parseOptions({})\n        this.logger.log(\"loading assets\")\n        this.assetsManager.cacheAssetsList().then(()=> {\n            this.logger.log(\"loading document\")\n            AuthModule.getJSON(getDocsURL() + opts.doc).then((payload) => {\n                this.logger.log(\"loaded payload\", this.root)\n                this.root = payload.graph\n                this.root.children.forEach(ch => {\n                    if(ch.type === TOTAL_OBJ_TYPES.ASSETS_LIST) return this.initAssets(ch)\n                })\n\n                this.logger.log(\"the title is\",this.root.title)\n                if(this.root.splashImage && this.root.splashImage !== NONE_ASSET.id) {\n                    this.logger.log(\"the splash image is\",this.root.splashImage)\n                    const asset = this.provider.accessObject(this.root.splashImage)\n                    this.logger.log(\"the asset is\",asset)\n                    const url = this.assetsManager.getAssetURL(asset)\n                    this.logger.log(\"the url is\",url)\n                    this.setState({\n                        splashImage:url\n                    })\n                }\n\n                this.setState({\n                    title:this.root.title,\n                })\n\n                const assetsRoot = this.root.children.find(ch => ch.type === TOTAL_OBJ_TYPES.ASSETS_LIST)\n                this.validateAssets(assetsRoot).then(()=>{\n                    console.log(\"fully validated!\")\n                    $(\"#progress\").value = 100\n                    $(\"#loading-indicator\").style.display = 'none'\n                    this.setState({\n                        docLoaded:true,\n                    })\n                })\n            })\n        })\n    }\n\n    startScene() {\n        this.buildRoot(this.root)\n        this.logger.log(this.root)\n        Promise.all(this.pendingAssets).then(() => {\n            this.logger.log(\"all assets loaded now. starting script manager\")\n            this.scriptManager.startRunning()\n            if (this.root.defaultScene && this.root.defaultScene !== NONE_ASSET.id) {\n                const sc = this.root.children.find(ch => ch.id === this.root.defaultScene)\n                if(!sc) return this.logger.error(\"cannot find the default scene\")\n                this.setCurrentScene(sc)\n            } else {\n                const sc = this.root.children[0]\n                this.setCurrentScene(sc)\n            }\n            this.scriptManager.startFirstScene()\n        })\n    }\n\n    clickedStart = () => {\n        console.log(\"clicked. play the sample audio\")\n        $(\"#overlay\").style.display = 'none'\n        $(\"#test-audio\").play()\n\n        const canvas = this.canvas\n        if(XRSupport.supportsARKit()) {\n            this.xr = new XRSupport()\n            this.xr.getContext(canvas).then((context) => {\n                this.initThreeJS(canvas,context)\n                this.xr.setAnimationLoop( this.renderThreeWithCamera.bind(this))\n                this.xrWorldInfo = new XRWorldInfo(this.xr,this.logger)\n                this.scene.add(this.xrWorldInfo)\n                this.startScene()\n            }).catch(err => {\n                console.error('Error', err)\n            })\n        } else {\n            this.initThreeJS(canvas,0)\n            this.renderer.setAnimationLoop(this.renderThree.bind(this))\n            this.startScene()\n        }\n\n    }\n\n    // start-sound is from https://freesound.org/people/soneproject/sounds/244356/\n    // old one: https://vr.josh.earth/assets/sounds/clang.mp3\n    render() {\n        return <div>\n            <audio id={\"test-audio\"} src={startupsound}/>\n            <div id=\"overlay\">\n                <div id=\"inner\">\n                    <h1 id=\"title\">{this.state.title}</h1>\n                    <h2><button onClick={this.clickedStart} disabled={!this.state.docLoaded}>click to start</button></h2>\n                    \n                    <div id=\"loading-indicator\">\n                        <label>loading...</label><br></br>\n                        <progress max=\"100\" value=\"0\" id=\"progress\"/>\n                    </div>\n                    {this.renderSplashImage()}\n                </div>\n                {this.renderErrors()}\n            </div>\n            <ErrorCatcher logger={this.logger}>\n                <canvas ref={c => this.canvas = c} width={600} height={400}\n                    onClick={this.clickedCanvas}\n                />\n            </ErrorCatcher>\n        </div>\n    }\n\n    clickedCanvas = (e) => {\n        function findKnownParent(node) {\n            if(!node) return null\n            if(node.userData.graphid) return node\n            return findKnownParent(node.parent)\n        }\n\n        this.logger.log(\"clicked on the canvas\")\n        this.canvas.focus()\n        const rect = this.canvas.getBoundingClientRect();\n        const pointer = {\n            x: ( e.clientX - rect.left ) / rect.width * 2 - 1,\n            y: - ( e.clientY - rect.top ) / rect.height * 2 + 1,\n        }\n        this.raycaster.setFromCamera(pointer, this.camera);\n        const scene = this.three_map[this.current_scene.id]\n        const intersect = this.raycaster.intersectObjects(scene.children, true)\n        if(intersect && intersect.length >= 1) {\n            const inter = intersect.find(inter => inter.distance > 0)\n            if(inter) {\n                //this.logger.log(\"found the interesction\", inter)\n                //this.logger.log(\"intersections\", intersect)\n                // let obj = inter.object\n                let obj = findKnownParent(inter.object)\n\n                //this.logger.log(\"obj\", obj)\n               // if (obj.userData && obj.userData.graphid) { \n                    const gobj = this.obj_map[obj.userData.graphid]\n                    //this.logger.log(\"jobj\", gobj)\n                 //   if (gobj) {\n                        this.scriptManager.performClickAction(gobj, e)\n                  // }\n               // }\n            }\n        }\n    }\n\n    buildRoot(graph) {\n        //init assets first\n        graph.children.forEach(ch => {\n            attachUtilFunctions(ch, this.obj_map)\n            if(ch.type === TOTAL_OBJ_TYPES.SCENE) return this.initObject(ch)\n            if(ch.type === TOTAL_OBJ_TYPES.BEHAVIORS_LIST) return this.initBehaviors(ch)\n        })\n    }\n\n    initObject(obj) {\n        attachUtilFunctions(obj, this.obj_map)\n        this.obj_map[obj.id] = obj\n        if(obj.title) this.title_map[obj.title] = obj\n        let node = null\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) {\n            const scene = new SceneDef().makeNode(obj, this.provider)\n            this.three_map[obj.id] = scene\n            scene.userData.graphid = obj.id\n            this.scenes.add(scene)\n            scene.visible = false\n            node = scene\n        }\n        obj.props = () => obj\n\n        if(is3DObjectType(obj.type)) {\n            node = get3DObjectDef(obj.type).makeNode(obj, this.provider)\n            if(node.previewUpdate) this.previewUpdateNodes.push(node)\n            this.three_map[obj.id] = node\n            node.userData.graphid = obj.id\n            on(node, 'click', (e) => {\n                this.scriptManager.performClickAction(obj, e)\n            })\n        }\n        if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR) {\n            this.behavior_map[obj.id] = obj\n        }\n\n        if(obj.children) {\n            obj.children.forEach(ch => {\n                const chnode = this.initObject(ch)\n                if(chnode) node.add(chnode)\n            })\n        }\n\n        return node\n    }\n\n    initThreeJS(canvas, context) {\n        this.tweenManager = new TweenManager()\n        this.scene = new THREE.Scene();\n        this.camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 0.1, 50 );\n        this.renderer = new THREE.WebGLRenderer( { antialias: true, canvas:canvas, context:context } );\n        this.renderer.setPixelRatio( window.devicePixelRatio );\n        this.renderer.setSize( window.innerWidth, window.innerHeight );\n        this.renderer.gammaOutput = true\n        this.renderer.vr.enabled = true;\n        // this.sceneContainer.appendChild( this.renderer.domElement );\n        this.vrmanager = new VRManager(this.renderer)\n        this.audioListener = new THREE.AudioListener()\n        this.camera.add(this.audioListener)\n        if(!this.xr) this.scene.background = new THREE.Color(0x000000);\n        this.camera.matrixAutoUpdate = false\n        this.scene.add(this.camera)\n        window.addEventListener( 'resize', ()=>{\n            const body = document.documentElement\n            this.camera.aspect = body.clientWidth / body.clientHeight;\n            this.camera.updateProjectionMatrix();\n            this.renderer.setSize( body.clientWidth, body.clientHeight);\n        }, false );\n        const light = new THREE.DirectionalLight( 0xffffff, 1.0 );\n        light.position.set( 1, 1, 1 ).normalize();\n        this.scene.add( light );\n        this.scene.add(new THREE.AmbientLight(0xffffff,0.2))\n\n        this.scenes = new Group()\n        this.scene.add(this.scenes)\n\n        this.raycaster = new THREE.Raycaster();\n    }\n\n    renderThreeWithCamera = (bounds,projectionMatrix,viewMatrix, time,frame) => {\n        if(!this.scene || !this.camera) return\n        this.camera.matrix.fromArray(viewMatrix)\n        this.camera.matrixWorldNeedsUpdate = true\n        this.camera.updateMatrixWorld()\n        this.camera.projectionMatrix.fromArray(projectionMatrix)\n        if(this.xrWorldInfo) {\n            this.xrWorldInfo.refreshWorldInfo(frame)\n        }\n        this.renderThree(time,frame)\n    }\n\n    renderThree = (time, frame) => {\n        if(this.tweenManager) this.tweenManager.update(time)\n        this.previewUpdateNodes.forEach(n => n.previewUpdate())\n        if(this.pointer) this.pointer.tick(time)\n        if(this.stats) this.stats.update(time)\n        if(this.controller) this.controller.update(time)\n        let session = null\n        if(this.xr) session = this.xr.session\n        this.scriptManager.tick(time, session)\n        this.renderer.render( this.scene, this.camera );\n    }\n\n    initAssets(assets) {\n        assets.children.forEach(obj => {\n            this.logger.log(\"initing asset\",obj)\n            attachUtilFunctions(obj, this.obj_map)\n            this.obj_map[obj.id] =  obj\n            if(obj.title) this.title_map[obj.title] = obj\n            this.assets_url_map[obj.id] = obj.url\n        })\n    }\n\n    initBehaviors(behaviors) {\n        behaviors.children.forEach(ch => {\n            attachUtilFunctions(ch, this.obj_map)\n            this.obj_map[ch.id] =  ch\n            if(ch.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) {\n                const url = getScriptsURL()+ch.src\n                this.logger.log(\"loading behavior\",ch,'from',url)\n                const prom = AuthModule.fetch(url,{ method:'GET' })\n                    .then(res => res.text())\n                    .then(text => {\n                        const info = parseBehaviorScript(text)\n                        info.text = text\n                        this.behavior_assets[ch.id] = info\n                        return text\n                    }).catch((e)=>{\n                        this.logger.error(\"error loading behavior\",e)\n                    })\n                this.pendingAssets.push(prom)\n            }\n        })\n    }\n\n    setCurrentScene(scene) {\n        // @blair\n        const sceneNode = this.three_map[scene.id]\n        // this.logger.log(\"the scene node is\",sceneNode)\n        // this.logger.log(\"if it exists, scene anchor is\", sceneNode.userData.sceneAnchor)\n        if (sceneNode  && this.xr) {\n            const sceneAnchorNode = sceneNode.userData.sceneAnchor\n            if (!sceneAnchorNode) {\n                this.logger.error(\"no sceneNode? so no children?\")\n            } else {\n                if (sceneAnchorNode.children) {\n                    this.logger.log(\"scene has children: \", sceneNode.children.length)\n                    this.logger.log(\"scene anchor has children: \", sceneAnchorNode.children.length)\n                } else {\n                    this.logger.log(\"no sceneNode children?\")\n                }\n\n                if (!this.sceneAnchor || (this.sceneAnchor && scene.autoRecenter)) {\n                    // create a new scene anchor\n                    if (this.sceneAnchor) {\n                        this.xr.removeSceneAnchor(this.sceneAnchor, this.logger)\n                        this.sceneAnchor = null\n                    }\n                    this.xr.createSceneAnchor(sceneAnchorNode, this.logger).then(anchor => {\n                        this.sceneAnchor = anchor\n                    }).catch(error => {\n                        this.logger.error(`error creating new scene anchor: ${error}`)\n                    })\n                } else {\n                    this.xr.updateAnchoredSceneNode(this.sceneAnchor, sceneAnchorNode, this.logger)\n                }\n            }\n        }\n        this.scenes.children.forEach(sc => sc.visible = false)\n        if(this.three_map[scene.id]) this.three_map[scene.id].visible = true\n        this.current_scene = scene\n    }\n\n    renderSplashImage() {\n        if(this.state.splashImage) {\n            return <img src={this.state.splashImage} width=\"80%\" height=\"auto\" alt={\"splash screen\"}/>\n        } else {\n            return \"\"\n        }\n    }\n\n    validateAssets(assetsList) {\n        return Promise.all(assetsList.children.map(asset => {\n                // this.getLogger().log(\"checking asset\",asset)\n                if(asset.subtype === ASSET_TYPES.VIDEO) {\n                    return this.assetsManager.getTexture(asset.id).then(tex => {\n                        if (!tex) {\n                            this.getLogger().error(\"error loading a texture\", asset)\n                            this.addAssetLoadingError(asset)\n                        }\n                    })\n                }\n                if(asset.subtype === ASSET_TYPES.IMAGE) {\n                    return this.assetsManager.getTexture(asset.id).then(tex => {\n                        if (!tex) {\n                            this.getLogger().error(\"error loading a texture\", asset)\n                            this.addAssetLoadingError(asset)\n                        }\n                    })\n                }\n                if(asset.subtype === ASSET_TYPES.GLTF) {\n                    return this.assetsManager.getGLTF(asset.id).then(model => {\n                        if (!model) {\n                            this.getLogger().error(\"error loading a model\", asset)\n                            this.addAssetLoadingError(asset)\n                        }\n                    })\n                }\n                return Promise.resolve(\"all good\")\n            })).then((answers)=>{\n            console.log(\"fully loaded all assets now\")\n            console.log(\"error count is\",this.badAssets.length)\n            if(this.badAssets.length > 0) {\n                this.showBadAssetsDialog()\n            }\n        })\n    }\n\n    showBadAssetsDialog() {\n        this.logger.log(\"showing a bad assets dialog\")\n        this.setState({\n            showErrors:true\n        })\n    }\n    addAssetLoadingError(asset) {\n        this.badAssets.push(asset)\n    }\n    renderErrors() {\n        if(this.state.showErrors) {\n            return <div id=\"errors-dialog\">\n                <h3>Bad or Missing Assets</h3>\n                <ul>\n                {this.badAssets.map((asset,i) => {\n                    return <li key={i}><b>{asset.title}</b> <i>{asset.src}</i></li>\n                })}\n                </ul>\n                <button onClick={()=>this.setState({showErrors:false})}>dismiss</button>\n                </div>\n        }\n        return \"\"\n    }\n}\n\n// ================  SGP implementation =====================\n\nclass Adapter extends SceneGraphProvider {\n    constructor(player) {\n        super()\n        this.player = player\n        this.logger = this.player.logger\n    }\n\n    getCurrentScene() {\n        if(!this.player.current_scene) this.logger.error(\"the current scene is null\")\n        return this.player.current_scene\n    }\n    getSceneObjects(sc) {\n        return sc.children.filter(ch => is3DObjectType(ch.type))\n    }\n    getBehaviorsForObject (obj) {\n        if(!obj.children) return []\n        return obj.children.filter(ch => ch.type === TOTAL_OBJ_TYPES.BEHAVIOR)\n    }\n    getThreeObject (obj)  {\n        if (!obj) {\n            this.logger.error(\"getThreeObject got invalid obj\")\n        } else {\n            if(obj.id) return this.player.three_map[obj.id]\n        }\n        return this.player.three_map[obj]\n    }\n    getParsedBehaviorAsset (b) {\n        return this.player.behavior_assets[b.behavior]\n    }\n    getAllBehaviors () {\n        return Object.keys(this.player.behavior_map).map(key => this.player.behavior_map[key])\n    }\n    getAllScenes() {\n        return Object.keys(this.player.obj_map)\n            .map(key => this.player.obj_map[key])\n            .filter(obj => obj.type === TOTAL_OBJ_TYPES.SCENE)\n    }\n\n    navigateScene (sceneid) {\n        this.logger.log(\"navigating to \",sceneid)\n        const scene = this.player.obj_map[sceneid]\n        if(!scene) return this.logger.error(\"couldn't find scene for\",sceneid)\n        this.player.setCurrentScene(scene)\n    }\n    playMediaAsset (asset, trusted=false)  {\n        this.player.assetsManager.playMediaAsset(asset,trusted)\n    }\n\n    stopMediaAsset(asset) {\n        this.player.assetsManager.stopMediaAsset(asset)\n    }\n\n\n    getGraphObjectByName(title) {\n        return this.player.title_map[title]\n    }\n    getGraphObjectById (id) {\n        return this.player.obj_map[id]\n    }\n    getCamera() {\n        return this.player.camera\n    }\n\n    getTweenManager() {\n        return this.player.tweenManager\n    }\n\n    getFloorNear(info) {\n        if(!this.player.xr || !this.player.xr.session || !this.player.xrWorldInfo) {\n            this.logger.log(\"XR is not active?\")\n            return\n        }\n\n        let targetPos = vec3.fromValues(info.point.x,info.point.y,info.point.z)\n        let targetRadiusSq = info.targetRadiusSq || 9\n        let targetTop = info.targetTop || -0.5\n        let targetBottom = info.targetBottom || -2\n\n        if(this.player.xrWorldInfo.findFloorNear(targetPos,targetRadiusSq,targetTop,targetBottom)) {\n            return new THREE.Vector3(targetPos[0],targetPos[1],targetPos[2])\n        }\n        return 0\n    }\n\n    startLocalAnchor(info) {\n        this.logger.log(\"start or update anchor of various flavors\")\n        if(!this.player.xr || !this.player.xr.session || !this.player.xrWorldInfo) {\n            this.logger.log(\"XR is not active?\")\n            return\n        }\n        if(!info.node || !info.node.position) {\n            this.logger.log(\"Node is not present or wrong type?\")\n        }\n        switch(info.style) {\n            case \"ray\":\n                this.player.xr.updateRayAnchor(info,this.logger)\n                break\n            case \"floor\":\n            default:\n                {\n                    let point = vec3.fromValues(info.node.position.x, info.node.position.y, info.node.position.z )\n                    if(this.player.xrWorldInfo.findFloorNear(point)) {\n                        this.logger.log(\"Found a floor at \" + point[1])\n                        info.point = point\n                        // this.player.xr.updatePointAnchor(info,this.logger)\n                        // just force it there ... do not bother placing an anchor\n                        info.node.position.y = point[1]\n                    }\n                }\n                break\n        }\n    }\n\n    stopLocalAnchor(info) {\n        this.logger.log(\"stopping vanilla anchor\")\n        if(!this.player.xr || !this.player.xr.session) {\n            this.logger.log(\"XR is not active?\")\n            return\n        }\n        this.player.xr.stopAnchor(info,this.logger)\n    }\n\n    startImageRecognizer(info) {\n        this.logger.log(\"starting the image recognizer\")\n        return new Promise((res,rej) => {\n            //called when an anchor is started that wants to recognize an image\n            // WebXR loaded?\n            if(!this.player.xr || !this.player.xr.session) {\n                this.logger.log(\"XR is not active?\")\n                return\n            }\n\n            this.player.xr.createDetectionImage(info,this.logger).then((name) => {\n                // decorate the info.node with an xr anchor\n                this.player.xr.startImageRecognizer(info, name, this.logger)\n            })\n        })\n    }\n\n    stopImageRecognizer(info) {\n        this.logger.log(\"stopping the image recognizer\")\n\n        if(!this.player.xr || !this.player.xr.session) {\n            this.logger.log(\"XR is not active?\")\n            return\n        }\n\n        this.player.xr.stopImageRecognizer(info, this.logger)\n    }\n\n    startGeoTracker(info) {\n        // WebXR loaded?\n        return new Promise((res, rej) => {\n            if(!this.player.xr || !this.player.xr.session) {\n                this.logger.log(\"XR is not active?\")\n                return\n            }\n\n            this.player.xr.createGeoAnchor(info, this.logger).then(() => {\n                // decorate the info.node with an xr anchor\n                this.player.xr.addGeoAnchoredNode(info, this.logger)\n            })\n        })\n    }\n\n    stopGeoTracker(info) {\n        // WebXR loaded?\n        if(!this.player.xr || !this.player.xr.session) {\n            this.logger.log(\"XR is not active?\")\n            return\n        }\n\n        // decorate the info.node with an xr anchor\n        this.player.xr.stopGeoTracker(info, this.logger)\n    }\n\n    startWorldInfo(info) {\n        if(!this.player.xrWorldInfo) {\n            this.logger.log(\"World Info is not active?\")\n            return\n        }\n        this.player.xrWorldInfo.setVisible(true)\n    }\n\n    stopWorldInfo(info) {\n        if(!this.player.xrWorldInfo) {\n            this.logger.log(\"World Info is not active?\")\n            return\n        }\n        this.player.xrWorldInfo.setVisible(false)\n    }\n\n}\n","import React, {Component} from 'react'\n// import './App.css'\nimport VREditor from './vr/VREditor'\nimport {ImmersivePlayer} from './vr/ImmersivePlayer'\n\nexport default class App extends Component {\n    getApp() {\n            if(this.props.options.mode === 'play') {\n                return <ImmersivePlayer options={this.props.options}/>\n            }\n            this.provider = new VREditor(this.props.options)\n            return this.provider.getApp()\n        }\n\n    render() {\n        return this.getApp()\n    }\n}\n\n\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport '@fortawesome/fontawesome-free/css/all.css'\nimport App from './App';\nimport {parseOptions} from './utils'\n\nconst default_options = {\n    mode: 'edit',\n}\nconst options = parseOptions(default_options)\nconsole.log(\"options is\",options);\n\nfunction init() {\n    return <App options={options}/>;\n}\n\nReactDOM.render(init(), document.getElementById(\"root\"));\n\n","/**\n * Created by josh on 11/29/16.\n */\nmodule.exports = {\n    adds: [],\n    add: function add(note) {\n        this.adds.forEach(cb => cb(note))\n    },\n    onAdd: function onAdd(cb) {\n        this.adds.push(cb);\n    },\n    offAdd: function offAdd(cb) {\n        this.adds = this.adds.filter(n => n !== cb)\n    }\n}\n","module.exports = __webpack_public_path__ + \"static/media/startup-sound.8786b4e1.m4a\";"],"sourceRoot":""}