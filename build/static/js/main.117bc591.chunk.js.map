{"version":3,"sources":["vr/ToasterManager.js","vr/startup-sound.m4a","utils.js","common/GridEditorApp.js","SelectionManager.js","common/HSLUVColorPicker.js","vr/AuthModule.js","TreeItemProvider.js","common/StringEditor.js","common/EnumEditor.js","common/ArrayEditor.js","common/PropSheet.js","syncgraph/utils.js","common/TreeTable.js","metadoc/Dimension.js","metadoc/MetadocCanvas.js","syncgraph/UndoQueue.js","metadoc/EventCoalescer.js","syncgraph/PubnubSyncWrapper.js","common/Dialog.js","syncgraph/MissingDocDialog.js","syncgraph/SyncGraphProvider.js","common/InputManager.js","metadoc/RectDef.js","metadoc/CircleDef.js","metadoc/TextDef.js","metadoc/ImageDef.js","metadoc/Common.js","vr/SkeletonUtils.js","vr/defs/ObjectDef.js","vr/defs/CubeDef.js","vr/defs/SphereDef.js","vr/defs/PlaneDef.js","vr/GLTFLoader.js","vr/DRACOLoader.js","vr/defs/ModelDef.js","vr/defs/BG360Def.js","vr/defs/TextDef.js","vr/defs/Image2DDef.js","vr/defs/GroupDef.js","vr/defs/GPUParticles.js","vr/defs/ParticlesDef.js","vr/defs/LocalAnchorDef.js","vr/defs/ImageAnchorDef.js","vr/defs/GeoAnchorDef.js","vr/defs/HudAnchorDef.js","vr/Common.js","vr/OrbitControls.js","vr/GLTFAssetView.js","vr/GeoAssetView.js","metadoc/AssetView.js","vr/AssetActions.js","vr/dialogs/AddImageAssetDialog.js","metadoc/PageCanvasView.js","metadoc/PresentationApp.js","syncgraph/GraphAccessor.js","metadoc/Editor1.js","vr/TransformControls.js","vr/defs/SceneDef.js","vr/ToasterNotification.js","vr/ScriptManager.js","common/tween.js","vr/XRWorldInfo.js","vr/XRSupport.js","vr/VRCanvas.js","vr/TranslationArrow.js","vr/TranslateControl.js","vr/panel2d/panel2d.js","vr/panel2d/component2d.js","vr/panel2d/button2d.js","vr/panel2d/group2d.js","vr/3dof.js","vr/Actions.js","vr/ImmersiveVREditor.js","vr/dialogs/AddGLTFAssetDialog.js","vr/dialogs/AddGLBAssetDialog.js","vr/dialogs/AddAudioAssetDialog.js","vr/dialogs/UnsavedDocumentDialog.js","vr/dialogs/OpenFileDialog.js","vr/dialogs/OpenAssetDialog.js","vr/ScriptEditor.js","vr/dialogs/OpenScriptDialog.js","vr/Templates.js","common/QRCanvas.js","vr/dialogs/QRDialog.js","vr/dialogs/PasswordDialog.js","vr/dialogs/GithubAuthDialog.js","vr/ErrorCatcher.js","vr/GifSupport.js","vr/AssetsManager.js","vr/dialogs/SaveDocumentAsDialog.js","vr/dialogs/BadAssetsDialog.js","vr/VREditor.js","vr/ImmersivePlayer.js","App.js","index.js"],"names":["module","exports","adds","add","note","this","forEach","cb","onAdd","push","offAdd","filter","n","__webpack_require__","p","parseOptions","opts","loc","document","location","search","substring","split","part","keyval","on","elem","type","addEventListener","toFlatString","obj","JSON","stringify","makePoint","x","y","minus","pt","divide","v","multiply","idivide","Math","floor","distance","dx","dy","sqrt","equals","toString","concat","setQuery","oldOpts","final","Object","keys","key","query","map","join","window","history","pushState","toQueryString","GridLayout","props","clss","leftWidth","rightWidth","showLeft","showRight","style","gridTemplateColumns","react_default","a","createElement","className","children","Toolbar","cls","left","right","bottom","top","center","middle","scroll","Panel","transparent","Spacer","ToggleButton","selected","rest","objectWithoutProperties","assign","MenuPopup","es","actions","act","i","divider","enabled","disabled","onClick","PopupManager","hide","fun","icon","title","GridEditorApp","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","toggleLeftPane","e","setState","state","toggleRightPane","onMouseDownLeft","preventDefault","stopPropagation","dragSide","onMouseMove","onMouseUp","onMouseDownRight","cursor","clientX","clientY","innerWidth","removeEventListener","GridEditorApp_GridLayout","GridEditorApp_Toolbar","GridEditorApp_Spacer","bottomText","onMouseDown","Component","SELECTION_MANAGER","src_SelectionManager","SelectionManager","listeners","dropTarget","clip","index","indexOf","splice","value","node","fire","length","dropType","HSLUVColorPicker","mousePress","canvasToPoint","lightness","redraw","pressed","mouseMove","mouseUp","drawPicker","drawSlider","drawIndicator","livalToCanvas","l","mouseToCanvas","bounds","target","getBoundingClientRect","mousePressSlider","sliderPressed","hue","canvasToHue","setTimeout","mouseMoveSlider","mouseUpSlider","close","color","hsluv","hsluvToHex","onSelect","comps","hexToHsluv","console","log","canvasBounds","canvas","h","height","w","width","c","getContext","j","fillStyle","fillRect","g","cp","strokeStyle","strokeRect","lineWidth","slider","hueToCanvas","indicator","_this2","display","flexDirection","alignItems","ref","can","USER_CHANGE","AuthModule","AuthModuleSingleton","login","res","win","open","url","authCallback","focus","logout","localStorage","clear","doclistSupported","msg","setUserData","data","payload","ToasterMananager","supported","docDeleteSupported","assetUploadSupported","scriptEditingSupported","passwordSupported","connected","serverID","random","isLoggedIn","fetch","getInfoURL","then","json","info","authentication","assetUpload","scriptEditing","replace","getJSON","getUserURL","success","getItem","password","_this3","setItem","accessToken","getAccessToken","options","mode","cache","headers","status","Error","statusText","method","Content-Type","file","getAssetsURL","name","body","TREE_ITEM_PROVIDER","EXPANDED_CHANGED","STRUCTURE_CHANGED","STRUCTURE_ADDED","STRUCTURE_REMOVED","PROPERTY_CHANGED","CLEAR_DIRTY","SAVED","DOCUMENT_SWAPPED","URLS","BASE","getDocsURL","getScriptsURL","AUTO_DETECT_GLITCH","TreeItemProvider","genID","prefix","save","getSceneRoot","payload_obj","doc","getDocType","id","getDocId","payload_string","docid","doctype","catch","hasChildren","item","getChildren","expanded_map","SERVER_URL","host","endsWith","calculateServerUrl","init","list","current","isExpanded","def","root","provider","setDocument","warn","makeEmptyRoot","spath","generateSelectionPath","Selection","getSelection","newsel","findNodeFromSelectionPath","setSelection","Promise","rej","FormData","append","size","xml","XMLHttpRequest","onreadystatechange","readyState","response","responseType","setRequestHeader","send","child","parent","sibling","StringEditor","_Component","_getPrototypeOf2","_len","arguments","args","Array","_key","apply","keypressed","charCode","onCommit","inherits","createClass","prop","hasHints","getHints","multiline","onChange","onBlur","onKeyPress","EnumPicker","Rend","renderer","items","values","val","DefaultEnumRenderer","EnumEditor","show","EnumEditor_EnumPicker","calculateValues","calculateRenderer","selectValue","renderValue","proxy","getRendererForEnum","getKey","vals","getValuesForEnum","ArrayEditor","addValue","showEditor","enumChanged","arr","slice","renderValues","renderEditor","Renderer","deleteItem","EnumEditor_EnumEditor","TYPES","STRING","NUMBER","BOOLEAN","ENUM","COLOR","GROUP","PropEditor","changed","isType","isLive","setValue","updateNum","checked","customChanged","colorChanged","commit","hasOwnProperty","min","max","isNaN","parseFloat","numberKeyDown","shiftKey","booleanChanged","arrayChanged","openColorEditor","HSLUVColorPicker_HSLUVColorPicker","getValue","nextProps","nextState","getType","selMan","isCustom","createCustomEditor","isLocked","StringEditor_StringEditor","step","hints","incrementValue","onKeyDown","backgroundColor","ArrayEditor_ArrayEditor","PropSheet","selection","h2","hand","s","off","_this4","calculateGroups","calculateProps","getName","renderIndeterminate","PropSheet_PropEditor","isIndeterminate","getFullSelection","first","prov","getProperties","A","B","pa","find","pb","multi","MultiPropProxy","match","addSubProxy","PropProxy","group_keys","getGroupKeys","subs","sub","same","custom","locked","live","setPropertyValue","group","listToArray","prototype","createGraphObjectFromObject","graph","createObject","fetchGraphObject","objid","getPropertiesForObject","getPropertyValue","propToArray","CH","len","getArrayLength","ch","getElementAt","insertAsFirstChild","setProperty","insertAfter","insertAsLastChild","prev","removeFromParent","array","findIndex","removeElement","error","ContextMenu","menu","TreeTableItem","addToSelection","onContextMenu","calculateContextMenu","TreeTable_ContextMenu","toggleItemCollapsed","onDragStart","onDragOver","onDragEnd","onDrop","isSelected","getDropTarget","getDropType","arrow","data-nodeid","depth","getRendererForItem","renderDragBars","canBeMoved","draggable","TreeTable","dataTransfer","effectAllowed","setData","parentNode","setDragImage","dropEffect","dragTarget","internalDrag","canAddExternalChild","setDropTarget","setDropType","canAddChild","canBeSibling","getDataGraph","src","dst","parent2","acceptDrop","generateChildren","chs","listener","other_listener","sel","newProps","TreeTable_TreeTableItem","UNITS","PIXEL","matches","short","MILLIMETER","DEFAULT_DPI","Dimension","unit","scale","dpi","px_per_in","MetadocCanvas","selectionChanged","getPageSize","getSelectedPage","as","getRawGraph","page","drawPage","hsnap","vsnap","restore","toCanvas","shape","findShape","mouseDown","pauseQueue","shapeid","shapeobj","initial","start","layer","getSelectedLayer","snap","process","cmd","unpauseQueue","onRawChange","rect","prevProps","drawLayer","drawShape","getShapeDef","draw","isInside","reverse","_this5","border","EDGES","LEFT","RIGHT","CENTER","TOP","MIDDLE","BOTTOM","NONE","snaps","SNAP_THRESHOLD","isNearH","abs","isNearV","getBounds","nearH","nearV","require","SET_PROPERTY","CREATE_PROPERTY","DELETE_PROPERTY","CREATE_OBJECT","DELETE_OBJECT","INSERT_ELEMENT","DELETE_ELEMENT","UndoQueue","op","last","getHostId","seq","nextSeq","timestamp","Date","now","entry","entryid","object","prevValue","makeGUID","EventCoalescer","rawlisteners","fireRaw","paused","buffer","bufferOp","settings","publishKey","subscribeKey","PubnubSyncWrapper","handleGraphChange","pubnub","PubNub","getServerID","addListener","operation","category","sendHistoryRequest","message","m","handleMessage","subscribe","channels","calculateChannelName","calculateLoggerChannelName","sendMessage","unsubscribe","stop","str","uuid","publish","channel","hist","getHistory","count","chunk","evt","handleGetHistory","handleReceiveHistory","_console","publisher","getUUID","toConsumableArray","PubnubLogger","_console2","from","_console3","ConsoleLogger","_console4","_console5","Dialog","clickedScrim","scrim","onScrimClick","visible","bodyStyle","MissingDocDialog","cancel","DialogManager","okay","createNewDocument","Dialog_Dialog","grow","DocGraph","CommandGenerator","toDocGraphFromObjectGraph","toObjectGraphFromDocGraph","SyncGraphProvider","getDocTitle","getDocHistory","getDocGraph","getObjectByProperty","coalescer","syncdoc","hasPropertyValue","expanded","docLoaded","resolve","toggleConnected","unpause","pause","isConnected","performUndo","undoqueue","canUndo","undo","performRedo","canRedo","redo","datalisteners","loadDoc","propKey","oldValue","newValue","showMissingDocDialog","makeDocFromServerHistory","setupDocFlow","makeDocFromServerGraph","shutdown","submit","clearSelection","newDocId","setDocTitle","new_doc","MissingDocDialog_MissingDocDialog","InputManager","keyDown","m2","bindings","b","keyCode","valid","modifiers","mod","MODIFIERS","COMMAND","metaKey","SHIFT","some","dispatchEvents","binding","bind","KEYS","S","Z","C","V","X","LEFT_ARROW","RIGHT_ARROW","RectDef","rx","ry","fillColor","c0","c1","c2","c3","beginPath","moveTo","lineTo","quadraticCurveTo","closePath","fill","newOrigin","CircleDef","radius","arc","PI","pow","TextDef","text","horizontalAlign","HORIZONTAL_ALIGNMENT","verticalAlign","VERTICAL_ALIGNMENT","BASELINE","autoFit","fontSize","fontFamily","STANDARD_FONTS","SANSSERIF","fontWeight","FONT_WEIGHTS","NORMAL","fontStyle","FONT_STYLES","_this$calculateLines","calculateLines","lines","size_px","total_height","total_width","line","lines_height","xoff","yoff","fillText","font","measureText","reduce","total","_this$calculateLines2","insideRect","_this$calculateLines3","ImageDef","asset","isImageCached","drawImage","getCachedImage","requestImageCache","PROP_DEFS","subtype","format","pageSize","SHAPE_DEFS","circle","image","ICONS","plane","model","cut","copy","paste","delete","SERIF","MONOSPACE","BOLD","ITALIC","OBLIQUE","isShapeType","targetParentPos","targetPos","sourceParentPos","sourcePos","targetDir","sourceDir","pos","quat","bindBoneMatrix","relativeMatrix","globalMatrix","ObjectDef","position","z","rotation","material","set","parseInt","tx","ty","tz","NONE_ASSET","assetsManager","getTexture","tex","getLogger","side","DoubleSide","alphaTest","MeshLambertMaterial","err","COUNTER","CubeDef","scene","OBJ_TYPES","cube","rz","sx","sy","sz","createArray","Mesh","BoxGeometry","userData","clickable","attachAsset","esm_get","geometry","SphereDef","SphereBufferGeometry","PlaneDef","THREE","GLTFLoader","manager","undefined","DefaultLoadingManager","dracoLoader","GLTFRegistry","objects","get","remove","removeAll","constructor","crossOrigin","load","onLoad","onProgress","onError","resourcePath","scope","path","LoaderUtils","extractUrlBase","itemStart","_onError","itemError","itemEnd","loader","FileLoader","setPath","setResponseType","parse","gltf","setCrossOrigin","setResourcePath","setDRACOLoader","content","extensions","decodeText","Uint8Array","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","KHR_BINARY_GLTF","GLTFBinaryExtension","version","extensionsUsed","extensionName","extensionsRequired","KHR_LIGHTS_PUNCTUAL","GLTFLightsExtension","KHR_MATERIALS_UNLIT","GLTFMaterialsUnlitExtension","KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS","GLTFMaterialsPbrSpecularGlossinessExtension","KHR_DRACO_MESH_COMPRESSION","GLTFDracoMeshCompressionExtension","MSFT_TEXTURE_DDS","GLTFTextureDDSExtension","KHR_TEXTURE_TRANSFORM","GLTFTextureTransformExtension","GLTFParser","DDSLoader","ddsLoader","extension","lightDefs","lights","loadLight","lightIndex","lightNode","lightDef","Color","fromArray","range","DirectionalLight","PointLight","SpotLight","spot","innerConeAngle","outerConeAngle","angle","penumbra","decay","intensity","getMaterialType","MeshBasicMaterial","extendParams","materialParams","materialDef","parser","pending","opacity","metallicRoughness","pbrMetallicRoughness","isArray","baseColorFactor","baseColorTexture","assignTexture","all","BINARY_EXTENSION_HEADER_LENGTH","BINARY_EXTENSION_CHUNK_TYPES","BIN","headerView","DataView","header","magic","getUint32","chunkView","chunkIndex","byteLength","chunkLength","chunkType","contentArray","byteOffset","specularGlossinessParams","ShaderMaterial","pbrSpecularGlossiness","shader","ShaderLib","uniforms","UniformsUtils","clone","specularMapParsFragmentChunk","glossinessMapParsFragmentChunk","specularMapFragmentChunk","glossinessMapFragmentChunk","lightPhysicalFragmentChunk","fragmentShader","roughness","metalness","roughnessMap","metalnessMap","specular","setHex","glossiness","specularMap","glossinessMap","vertexShader","defines","STANDARD","diffuseFactor","diffuseTexture","emissive","glossinessFactor","specularFactor","specularGlossinessTexture","specGlossMapDef","createMaterial","params","fog","isGLTFSpecularGlossinessMaterial","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalScale","displacementMap","displacementScale","displacementBias","alphaMap","envMap","envMapIntensity","refractionRatio","derivatives","cloneMaterial","source","il","refreshUniforms","camera","uvScaleMap","diffuse","multiplyScalar","isWebGLRenderTarget","texture","matrixAutoUpdate","updateMatrix","uvTransform","matrix","flipEnvMap","isCubeTexture","reflectivity","maxMipLevel","properties","__maxMipLevel","USE_GLOSSINESSMAP","USE_ROUGHNESSMAP","GLTFCubicSplineInterpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","Interpolant","decodePrimitive","primitive","bufferViewIndex","bufferView","gltfAttributeMap","attributes","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","attributeName","threeAttributeName","ATTRIBUTES","toLowerCase","accessorDef","accessors","componentType","WEBGL_COMPONENT_TYPES","normalized","getDependency","decodeDracoFile","attribute","extendTexture","transform","offset","repeat","texCoord","needsUpdate","create","copySampleValue_","result","valueSize","beforeStart_","afterEnd_","interpolate_","i1","t0","t","t1","stride","stride2","stride3","td","pp","ppp","offset1","offset0","s2","s3","s0","s1","p0","m0","p1","m1","defaultMaterial","WEBGL_CONSTANTS","Number","Matrix3","Matrix4","Vector2","Vector3","Vector4","Texture","5120","Int8Array","5121","5122","Int16Array","5123","Uint16Array","5125","Uint32Array","5126","Float32Array","WEBGL_FILTERS","9728","NearestFilter","9729","LinearFilter","9984","NearestMipMapNearestFilter","9985","LinearMipMapNearestFilter","9986","NearestMipMapLinearFilter","9987","LinearMipMapLinearFilter","WEBGL_WRAPPINGS","33071","ClampToEdgeWrapping","33648","MirroredRepeatWrapping","10497","RepeatWrapping","WEBGL_TYPE_SIZES","BackSide","FrontSide","NeverDepth","LessDepth","EqualDepth","LessEqualDepth","GreaterEqualDepth","NotEqualDepth","AlwaysDepth","AddEquation","SubtractEquation","ReverseSubtractEquation","ZeroFactor","OneFactor","SrcColorFactor","OneMinusSrcColorFactor","SrcAlphaFactor","OneMinusSrcAlphaFactor","DstAlphaFactor","OneMinusDstAlphaFactor","DstColorFactor","OneMinusDstColorFactor","SrcAlphaSaturateFactor","SCALAR","VEC2","VEC3","VEC4","MAT2","MAT3","MAT4","POSITION","TANGENT","TEXCOORD_0","TEXCOORD_1","COLOR_0","WEIGHTS_0","JOINTS_0","PATH_PROPERTIES","translation","weights","INTERPOLATION","CUBICSPLINE","LINEAR","InterpolateLinear","STEP","InterpolateDiscrete","ALPHA_MODES","MIME_TYPE_FORMATS","image/png","RGBAFormat","image/jpeg","RGBFormat","resolveURL","test","addUnknownExtensionsToUserData","knownExtensions","objectDef","gltfExtensions","assignExtrasToUserData","gltfDef","extras","updateMorphTargets","mesh","meshDef","morphTargetInfluences","targetNames","morphTargetDictionary","createAttributesKey","attributesKey","sort","cloneBufferAttribute","isInterleavedBufferAttribute","itemSize","getX","getY","getZ","getW","BufferAttribute","primitiveCache","textureLoader","TextureLoader","fileLoader","addPrimitiveAttributes","primitiveDef","assignAttributeAccessor","accessorIndex","accessor","addAttribute","gltfAttributeName","indices","setIndex","targets","hasMorphPosition","hasMorphNormal","pendingPositionAccessors","pendingNormalAccessors","pendingAccessor","normal","morphPositions","morphNormals","positionAttribute","jl","setXYZ","normalAttribute","morphAttributes","addMorphTargets","markDefs","getDependencies","dependencies","scenes","animations","cameras","nodeDefs","nodes","skinDefs","skins","meshDefs","meshes","meshReferences","meshUses","skinIndex","skinLength","joints","isBone","nodeIndex","nodeLength","nodeDef","skin","isSkinnedMesh","cacheKey","dependency","loadScene","loadNode","loadMesh","loadAccessor","loadBufferView","loadBuffer","loadMaterial","loadTexture","loadSkin","loadAnimation","loadCamera","defs","bufferIndex","bufferDef","buffers","uri","reject","bufferViewDef","bufferViews","sparse","pendingBufferViews","bufferAttribute","TypedArray","elementBytes","BYTES_PER_ELEMENT","itemBytes","byteStride","ibCacheKey","ib","InterleavedBuffer","InterleavedBufferAttribute","itemSizeIndices","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","setArray","setX","setY","setZ","setW","textureIndex","URL","webkitURL","textureDef","textures","textureExtensions","sourceURI","images","isObjectURL","blob","Blob","mimeType","createObjectURL","Loader","Handlers","revokeObjectURL","flipY","sampler","samplers","magFilter","minFilter","wrapS","wrapT","mapName","mapDef","isCompressedTexture","assignFinalMaterial","useVertexTangents","tangent","useVertexColors","useFlatShading","useSkinning","useMorphTargets","useMorphNormals","isPoints","pointsMaterial","PointsMaterial","Material","isLine","lineMaterial","LineBasicMaterial","cachedMaterial","skinning","vertexTangents","vertexColors","VertexColors","flatShading","morphTargets","uv2","uv","onBeforeRender","materialIndex","materialType","materials","materialExtensions","sgExtension","kmuExtension","MeshStandardMaterial","metallicFactor","roughnessFactor","metallicRoughnessTexture","doubleSided","alphaMode","alphaCutoff","normalTexture","occlusionTexture","strength","emissiveFactor","emissiveTexture","encoding","sRGBEncoding","loadGeometries","primitives","createDracoPrimitive","dracoExtension","geometryPromise","cached","promise","BufferGeometry","meshIndex","depthTest","originalMaterials","geometries","SkinnedMesh","normalizeSkinWeights","drawMode","TriangleStripDrawMode","TriangleFanDrawMode","LineSegments","Line","LineLoop","Points","Group","cameraIndex","cameraDef","PerspectiveCamera","radToDeg","yfov","aspectRatio","znear","zfar","OrthographicCamera","xmag","ymag","skinDef","skinEntry","inverseBindMatrices","animationIndex","animationDef","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","input","parameters","output","inputAccessors","outputAccessors","tracks","inputAccessor","outputAccessor","TypedKeyframeTrack","NumberKeyframeTrack","QuaternionKeyframeTrack","VectorKeyframeTrack","targetName","interpolation","traverse","isMesh","track","createInterpolant","times","getValueSize","isInterpolantFactoryMethodGLTFCubicSpline","AnimationClip","Bone","instanceNum","o","light","Object3D","PropertyBinding","sanitizeNodeName","applyMatrix","quaternion","buildNodeHierachy","nodeId","parentObject","pendingJoints","jointNodes","isGroup","bones","boneInverses","jointNode","mat","Skeleton","matrixWorld","sceneIndex","sceneDef","Scene","nodeIds","DRACOLoader","timeLoaded","verbosity","attributeOptions","TrianglesDrawMode","nativeAttributeMap","setVerbosity","level","setDrawMode","setSkipDequantization","skip","skipDequantization","getAttributeOptions","rawBuffer","callback","attributeUniqueIdMap","getDecoderModule","decodeDracoFileInternal","decoder","dracoDecoder","DecoderBuffer","Init","Decoder","geometryType","GetEncodedGeometryType","TRIANGULAR_MESH","POINT_CLOUD","errorMsg","convertDracoGeometryTo3JS","addAttributeToGeometry","dracoGeometry","attributeType","geometryBuffer","ptr","attributeData","TypedBufferAttribute","numComponents","num_components","numValues","num_points","DracoFloat32Array","GetAttributeFloatForAllPoints","Float32BufferAttribute","DracoInt8Array","GetAttributeInt8ForAllPoints","Int8BufferAttribute","DracoInt16Array","GetAttributeInt16ForAllPoints","Int16BufferAttribute","Int32Array","DracoInt32Array","GetAttributeInt32ForAllPoints","Int32BufferAttribute","DracoUInt8Array","GetAttributeUInt8ForAllPoints","Uint8BufferAttribute","DracoUInt16Array","GetAttributeUInt16ForAllPoints","Uint16BufferAttribute","DracoUInt32Array","GetAttributeUInt32ForAllPoints","Uint32BufferAttribute","GetValue","destroy","decodingStatus","SkipAttributeTransform","start_time","performance","DecodeBufferToMesh","PointCloud","DecodeBufferToPointCloud","ok","error_msg","numFaces","decode_end","num_faces","numPoints","numAttributes","num_attributes","posAttId","GetAttributeId","posAttribute","GetAttribute","attributeId","GetAttributeByUniqueId","attId","stripsArray","GetTriangleStripsFromMesh","numIndices","ia","GetFaceFromMesh","posTransform","AttributeQuantizationTransform","InitFromAttribute","isQuantized","maxRange","numQuantizationBits","quantization_bits","minValues","min_value","decode_time","import_time","isVersionSupported","decoderPath","decoderConfig","decoderModulePromise","setDecoderPath","setDecoderConfig","config","wasmBinary","releaseDecoderModule","DracoDecoderModule","WebAssembly","_loadScript","wasmBinaryFile","_loadArrayBuffer","onModuleLoaded","prevScript","getElementById","removeChild","head","getElementsByTagName","script","onload","appendChild","SkeletonUtils","retarget","Quaternion","preserveMatrix","preservePosition","preserveHipPosition","useTargetMatrix","hip","names","bindBones","bone","boneTo","bonesPosition","sourceBones","isObject3D","skeleton","getBones","pose","updateMatrixWorld","identity","offsets","decompose","getBoneByName","getInverse","setFromMatrixScale","makeRotationFromQuaternion","setFromRotationMatrix","boneIndex","wBindMatrix","copyPosition","setPosition","retargetClip","useFirstFramePosition","fps","getHelperFromSkeleton","positionOffset","boneData","numFrames","round","duration","delta","convertedTracks","mixer","AnimationMixer","boneDatas","clipAction","play","update","time","toArray","uncacheAction","SkeletonHelper","getSkeletonOffsets","nameKeys","nameValues","boneParent","getNearestBone","boneToParent","setFromMatrixPosition","subVectors","normalize","laterialAngle","makeRotationFromEuler","Euler","renameBones","findBoneTrackData","regexp","trackData","exec","getEqualsBonesNames","targetSkeleton","targetBones","boneName","sourceLookup","Map","cloneLookup","parallelTraverse","sourceNode","clonedNode","clonedMesh","sourceMesh","bindMatrix","ModelDef","clicker","enter","scriptManager","currentClip","action","shouldPlay","exit","accessObject","tick","dt","deltaTime","useClip","findByName","clips","currentClipName","stopAllAction","uncacheRoot","getRoot","validate","optimize","getGLTF","boundingBox","setFromObject","boundingBoxSize","getSize","BoundingBoxCenter","getCenter","setClips","BG360Def","bg360","imageOffsetAngle","imageCropStartAngle","imageCropEndAngle","onBeforeCompile","matShader","customize","cssStyle","div","innerHTML","classList","setAttribute","divLayer","WebLayer3D","pixelRatio","devicePixelRatio","onLayerCreate","graphid","refresh","previewUpdate","setText","regenerateText","Image2DDef","img2d","ratio","GroupDef","GPUParticleShader","UPDATEABLE_ATTRIBUTES","GPUParticles","blending","NormalBlending","PARTICLE_COUNT","maxParticles","PARTICLE_CURSOR","DPR","particleUpdate","onTick","reverseTime","fadeIn","fadeOut","rand","sprite","particleSpriteTex","ctx","CanvasTexture","depthWrite","uTime","uScale","tSprite","defaultAttributeValues","particlePositionsStartTime","particleVelColSizeLife","setDynamic","particleSystem","frustumCulled","attr","getAttribute","updateRange","ttime","geometryUpdate","dispose","old","velocity","acceleration","endColor","positionStartAttribute","startTimeAttribute","velocityAttribute","accelerationAttribute","colorAttribute","endcolorAttribute","sizeAttribute","lifeTimeAttribute","lifetime","sizeRandomness","r","ParticlesDef","particles","pointSize","startColor","positionRandomness","baseVelocity","velocityRandomness","baseColor","colorRandomness","AdditiveBlending","system","spawnParticle","attachTexture","exists","getAssetURL","updateSprite","LocalAnchorDef","localanchor","recType","REC_TYPES","SCENE_START","preview","PlaneBufferGeometry","toRad","fireEventAtTarget","sgp","startLocalAnchor","stopLocalAnchor","ImageAnchorDef","imageanchor","reactivate","targetImage","imageRealworldWidth","updateImagePreview","getGraphObjectById","startImageRecognizer","stopImageRecognizer","GeoAnchorDef","geoanchor","targetGeoLocation","startGeoTracker","stopGeoTracker","HudAnchorDef","_ObjectDef","hudanchor","getCamera","getThreeObject","stdhints","description","defaultFloor","splashImage","padding","borderWidth","borderRadius","textColor","borderColor","drawBackground","scriptBody","defaultScene","latitude","longitude","altitude","useAltitude","autoRecenter","SIMPLE_COLORS","sphere","TOTAL_OBJ_TYPES","SCENE","ASSET","BEHAVIOR","BEHAVIOR_SCRIPT","ASSETS_LIST","BEHAVIORS_LIST","ROOT","is3DObjectType","canHaveShape","canBeDeleted","get3DObjectDef","degrees","MIME_TYPES","PNG","JPEG","GIF","MP3","AAC","WAV","JAVASCRIPT","GLB","MP4","MOV","ASSET_TYPES","IMAGE","GLTF","AUDIO","VIDEO","GEOLOCATION","isImageType","ITEM_ICONS","assets","behavior","behavior_script","audio","video","geolocation","parseBehaviorScript","contents","Function","OrbitControls","domElement","quatInverse","lastPosition","lastQuaternion","minDistance","maxDistance","Infinity","minZoom","maxZoom","minPolarAngle","maxPolarAngle","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","keyPanSpeed","autoRotate","autoRotateSpeed","enableKeys","UP","mouseButtons","ORBIT","MOUSE","ZOOM","PAN","target0","position0","zoom0","zoom","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","saveState","reset","updateProjectionMatrix","dispatchEvent","changeEvent","STATE","setFromUnitVectors","up","inverse","applyQuaternion","setFromVector3","rotateLeft","sphericalDelta","makeSafe","panOffset","setFromSpherical","lookAt","zoomChanged","distanceToSquared","EPS","dot","onMouseWheel","onTouchStart","onTouchEnd","onTouchMove","startEvent","endEvent","ROTATE","DOLLY","TOUCH_ROTATE","TOUCH_DOLLY","TOUCH_PAN","Spherical","rotateStart","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","getZoomScale","rotateUp","panLeft","objectMatrix","setFromMatrixColumn","panUp","pan","deltaX","deltaY","element","isPerspectiveCamera","targetDistance","tan","fov","clientHeight","isOrthographicCamera","clientWidth","dollyIn","dollyScale","dollyOut","event","button","handleMouseDownRotate","handleMouseDownDolly","handleMouseDownPan","handleMouseMoveRotate","handleMouseMoveDolly","handleMouseMovePan","handleMouseWheel","handleKeyDown","touches","pageX","pageY","handleTouchStartRotate","handleTouchStartDolly","handleTouchStartPan","handleTouchMoveRotate","handleTouchMoveDolly","handleTouchMovePan","EventDispatcher","defineProperties","noZoom","noRotate","noPan","noKeys","staticMoving","dynamicDampingFactor","GLTFAssetView","renderThree","prevTime","checkAspectRatio","controls","render","initThreeJS","nextContext","swapModel","draco","near","far","playAllClips","sceneContainer","background","innerHeight","antialias","setPixelRatio","setSize","gammaOutput","screenSpacePanning","setAnimationLoop","aspect","GeoAssetView","context","loadCurrentLocation","navigator","getCurrentPosition","coords","quick_setPropertyValue","onMapClick","latlng","lat","lng","updateLocation","ll","latLng","lon","marker","setLatLng","mymap","panTo","d","setView","tileLayer","attribution","addTo","customIcon","divIcon","AssetView","renderAsset","alt","playsInline","GLTFAssetView_GLTFAssetView","GeoAssetView_GeoAssetView","addImageAssetFromExpandedURL","assetId","supportsAssetUpload","getAssetsObject","insertChildLast","img","addImageAssetFromFile","ToasterManager","uploadFile","ans","addGLBAssetFromFile","addAudioAssetFromURL","fileType","lastIndexOf","AddImageAssetDialog","view","fileInput","files","switchLocal","switchRemote","selectedFile","typedURL","React","createRef","GridEditorApp_ToggleButton","renderSelectedPanel","PageCanvasView","handleKeypress","onNext","onPrev","tabIndex","PresentationApp","docSwapped","pageIndex","pages","getPages","PageCanvasView_PageCanvasView","cloneObjectDeep","newParent","id2","children2","arr2","ch2","insertElement","cloneArrayDeep","createProperty","GraphAccessor","hasObject","insertFirstChild","getParent","EnumTitleRenderer","STANDARD_PAGE_SIZES","PageSizeRenderer","MetadocEditor","getApp","PresentationApp_PresentationApp","assertThisInitialized","Editor1_MetadocApp","getTitle","getObjectById","addShape","make","addRect","addCircle","addText","addImage","addImageAssetFromURL","deleteSelection","getSelectedShape","deleteSelectedAsset","cutSelection","setClipboard","copySelection","pasteSelection","obj1","getClipboard","obj2","cloneShape","exportSVG","svg","renderSVGWrapper","renderSVGChildren","link","href","encodeURIComponent","download","click","exportPNG","toDataURL","newView","openPresentationView","showAddImageAssetDialog","AddImageAssetDialog_AddImageAssetDialog","imagecache","rect1","out","copyPropDef","margin","rootobj","parts","trim","parseDimension","toSVGString","tgt","complete","Image","MetadocApp","_this6","canvasSelected","showAddPopup","acts","addPage","addLayer","GridEditorApp_MenuPopup","getSelectedRoot","zoomIn","zoomOut","im","addKeyBinding","_this7","attachKeyEvents","GridEditorApp_GridEditorApp","GridEditorApp_Panel","TreeTable_TreeTable","renderCenterPane","PropSheet_PropSheet","MetadocCanvas_MetadocCanvas","AssetView_AssetView","TransformControls","_gizmo","TransformControlsGizmo","_plane","TransformControlsPlane","defineProperty","mouseDownEvent","mouseUpEvent","objectChangeEvent","ray","Raycaster","_tempVector","_tempVector2","_tempQuaternion","_unit","Y","_identityQuaternion","_alignVector","pointStart","pointEnd","rotationAxis","rotationAngle","cameraPosition","cameraQuaternion","cameraScale","parentPosition","parentQuaternion","parentScale","worldPositionStart","worldQuaternionStart","worldScaleStart","worldPosition","worldQuaternion","worldScale","eye","_positionStart","_quaternionStart","_scaleStart","propName","defaultValue","propValue","getPointer","pointer","changedTouches","onContext","onPointerHover","pointerHover","onPointerDown","onPointerMove","pointerDown","pointerMove","onPointerUp","pointerUp","attach","detach","axis","dragging","setFromCamera","intersect","intersectObjects","picker","planeIntersect","space","rotationSnap","point","translationSnap","ROTATION_SPEED","distanceTo","cross","angleTo","setFromAxisAngle","getMode","setMode","setTranslationSnap","setRotationSnap","setSpace","isTransformControls","gizmoMaterial","gizmoLineMaterial","linewidth","matInvisible","matHelper","matRed","matGreen","matBlue","matWhiteTransperent","matYellowTransparent","matCyanTransparent","matMagentaTransparent","matLineRed","matLineGreen","matLineBlue","matLineCyan","matLineMagenta","matLineYellow","matLineGray","matLineYellowTransparent","arrowGeometry","CylinderBufferGeometry","scaleHandleGeometry","BoxBufferGeometry","lineGeometry","CircleGeometry","vertices","cos","sin","gizmoTranslate","XYZ","OctahedronBufferGeometry","XY","YZ","XZ","pickerTranslate","helperTranslate","START","END","DELTA","gizmoRotate","E","XYZE","helperRotate","AXIS","pickerRotate","TorusBufferGeometry","gizmoScale","XYZX","XYZY","XYZZ","pickerScale","helperScale","setupGizmo","gizmoMap","gizmo","tag","tempGeometry","tempVector","tempEuler","alignVector","zeroVector","lookAtMatrix","tempQuaternion","tempQuaternion2","identityQuaternion","unitX","unitY","unitZ","helper","handles","handle","eyeDistance","atan2","multiplyQuaternions","showX","showY","showZ","_opacity","_color","lerp","setFromEuler","isTransformControlsGizmo","wireframe","dirVector","tempMatrix","isTransformControlsPlane","SceneDef","generateUniqueTitle","sc","setDefaultFloor","sceneAnchor","chNode","chObj","ToasterNotification","notification","SceneGraphProvider","beh","SystemFacade","logger","tween","getTweenManager","globalStorage","storage","getGraphObjectByName","trusted","_event","isTrusted","AssetFacade","playMedia","playMediaAsset","stopMediaAsset","getCurrentScene","fireSceneLifecycleEvent","navigateScene","fireMessageAtTarget","captureEvent","ScriptManager","sceneGraphProvider","running","system_cache","bubbling","getAllScenes","graphTarget","getParsedBehaviorAsset","getSystemFacadeFromCache","code","startTime","lastTime","session","stopRunning","fireLifecycleEvent","destroyListeners","getBehaviorsForObject","Tween","WaitTween","dur","ActionTween","fn","ForeverTween","diff","PROP_TYPES","SINGLE","COMPOUND","LERP_TYPES","ELASTIC","easeLinear","to","PropTween","property","propertyType","lerp_type","lerpType","loop","loopCount","reversed","autoReverse","easeOutElastic","ClipTween","speed","setLoop","setEffectiveTimeScale","ParallelTween","isAlive","SequentialTween","_this8","_startNext","cur","TweenManager","meshMap","workingMatrix","mat4","savedOrigin","savedDirection","reticleParent","reticle","reticleTrackedColor","reticleNotTrackedColor","reticleMaterial","requestNextHit","singleton","XRWorldInfo","_THREE$Group","engine","_floorPos","vec3","updateWorldSensingState","illuminationDetectionState","meshDetectionState","normals","_handleHitResults","handleHitResults","makeRotationX","degToRad","frame","worldInfo","worldInformation","seen","worldMesh","uid","handleUpdateNode","handleNewNode","handleRemoveNode","requestFrameOfReference","headFrameOfReference","eyeLevelFrameOfReference","floorUpdate","requestHitTest","hits","hit","getTransformTo","hitMatrix","timeStamp","ts","vertexCountChanged","newMesh","newMeshNode","threeMesh","vertexPositionsChanged","vertexPositions","textureCoordinatesChanged","textureCoordinates","triangleIndicesChanged","triangleIndices","vertexNormalsChanged","vertexNormals","_removeAnchorForNode","worldMeshGroup","addAnchoredNode","dynamic","verticesBufferAttribute","uvBufferAttribute","normalsBufferAttribute","computeVertexNormals","wireMaterial","headLevel","eyeLevel","playerPos","meshPos","bestPos","bestY","_center","modelMatrix","distanceY","_extent","Cesium","XRGeospatialAnchor","XRSupport","imageDetectorMap","geoAnchorMap","_workingMatrix","_identity","_vec","lastFrameTime","heightAboveFloor","device","xrCanvas","xrContext","_anchoredNodes","projectionMatrix","that","xr","requestDevice","xrDevice","requestSession","outputContext","alignEUS","worldSensing","xrSession","useEstimatedElevation","updateGeoElevationLoop","nonStandard_setNumberOfTrackedImages","compatibleXRDevice","baseLayer","XRWebGLLayer","_updateGeoElevationLoop","asyncToGenerator","regenerator_default","mark","_callee","sleep","wrap","_context","next","userAnimationCallback","frameOfReference","__handleAnimationFrame","_handleAnimationFrame","requestAnimationFrame","ended","getDevicePose","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","views","Symbol","iterator","done","refreshWorldInfo","getViewport","getViewMatrix","return","anchor","_handleAnchorUpdateCallback","_handleAnchorUpdate","_handleAnchorDeleteCallback","_handleAnchorDelete","_createSceneAnchor","_callee2","sceneNode","newAnchor","_context2","abrupt","sent","addAnchor","_x","_x2","_removeAnchorFromNode","removeAnchor","normalizedX","normalizedY","rayorigin","raydir","xrhitresults","floorPos","det","realWorldWidth","_fetchImage","idata","getImageData","documentURI","nonStandard_createDetectionImage","anchorName","nonStandard_activateDetectionImage","anchorStyle","nonStandard_deactivateDetectionImage","lla","Cartographic","createGeoAnchor","getDefaultElevation","getDeviceCartographic","cartographic","details","_this9","anchoredNode","_mozillaXRViewer","Adapter","getSelectedSceneObject","findNode","getCachedBehaviorAsset","tweenManager","MOVE_SPEED","VRCanvas","moveCameraForward","moveCameraBackward","handleKeyPress","recenterOnSelection","orbitControls","cam","transformChanged","transformDraggingChanged","obj_node_map","rebuildNode","sceneObj","setCurrentSceneWrapper","transformControls","findSceneObjectParent","clickedCanvas","raycaster","getCurrentSceneWrapper","findKnownParent","performClickAction","previewUpdateNodes","current_scene_wrapper","inset","makeNode","insertNodeMapping","addSceneWrapper","wrapper","supportsARKit","setupRenderer","animationLoopWithCamera","animationLoop","saveOrbitControlsState","audioListener","setAudioListener","updateScene","viewMatrix","matrixWorldNeedsUpdate","removeNodeMapping","updateProperty","populateNode","stopAllMedia","resetSceneGraph","stopRecognizers","startRecognizers","startRunning","startFirstScene","boxSizing","flex","overflow","ToasterNotification_ToasterNotification","nodeid","obj3d","rebuildParentLink","ch3","orbit_state","restoreOrbitControlsState","dump","_this10","graphObj","threeObj","TranslationArrow","control","startHover","endHover","beginDrag","startPoint","intersection","worldToLocal","oldFilter","intersectionFilter","startPosition","POINTER_MOVE","updateDrag","POINTER_RELEASE","endDrag","endPoint","finalPoint","end","makePlane","makeArrow","makeInputGrabber","POINTER_ENTER","POINTER_EXIT","POINTER_PRESS","TranslateControl","Panel2D","canvasTexture","redrawHandler","inside","fpt","contains","comp","findAt","POINTER_CLICK","startDrag","dragSphere","moveDrag","Component2D","Button2D","fsize","normalBg","hoverBg","bg","metrics","Group2D","layout","translate","childProps","deg","YAXIS","ThreeDOFController","stagePos","stageRot","states","touchpad","keystates","ArrowLeft","previous","ArrowRight","ArrowUp","ArrowDown","dir","rotateRight","moveForward","moveBackward","applyAxisAngle","_fire","scanGamepads","updateKeys","gamepads","getGamepads","gamepad","startsWith","buttons","axes","down","addScene","deleteObject","isEmpty","newDoc","switcher","generateAddAssetPopup","showAddServerImageDialog","showAddGLTFAssetDialog","showAddGLBAssetDialog","showAddAudioAssetDialog","showOpenAssetDialog","showAddGeoLocationAssetDialog","editor","currentScene","swapScene","ImmersiveVREditor","standardViewClickHandler","isRunning","sceneWrappers","initScene","render3","stats","controller","$","querySelector","container","WebGLRenderer","vr","vrmanager","VRManager","AudioListener","initContent","VR_DETECTED","removeAttribute","innerText","enterVR","updateSceneOp","documentSwapped","selectedNode","AmbientLight","VRStats","editable","Pointer","cameraFollowMouse","mouseSimulatesController","enableLaser","laserLength","stick","controller1","tools","panel2d","button2d","setAll","add3DObject","runButton","color_group","group2d","panel","setColor","defaults","nodeObj","AddGLTFAssetDialog","fileinput","multiple","webkitdirectory","AddGLBAssetDialog","AddAudioAssetDialog","addAudioAssetFromFile","UnsavedDocumentDialog","onAnyway","OpenFileDialog","refreshList","loadDocList","docs","docList","dismiss","removeDoc","generateDocUrl","renderDeleteButton","supportsDocDelete","deleteDoc","OpenAssetDialog","loadAssetList","assetList","isVideoType","addVideoAssetFromURL","isGLTFType","addGLBAssetFromURL","removeAssetSource","addAsset","deleteAsset","ScriptEditor","swap","changeText","updateBehaviorAssetContents","fetchBehaviorAssetContents","lib_default","theme","showGutter","OpenScriptDialog","loadScriptList","scripts","addBehaviorAssetFromURL","removeBehaviorAssetSource","addScript","supportsScriptEdit","deleteScript","CUSTOM_BEHAVIOR_SCRIPT","CUSTOM_SCENE_SCRIPT","QRCanvas","QRCode","QRDialog","wurl","QRCanvas_QRCanvas","PasswordDialog","doPasswordLogin","field","GithubAuthDialog","ErrorCatcher","errorInfo","parseGIF","gif","delayTimes","graphicControl","frames","disposals","transparencies","transparentColors","loopCnt","gifHeader","subarray","blockId","label","imageData","GIFTexture","delays","_ctx","generateMipmaps","isVideoTexture","frameStartTime","firstDrawCount","playing","clearRect","AssetsManager","assets_url_map","videocache","audiocache","lg","sound","isPlaying","Audio","getAudioListener","AudioLoader","setBuffer","setVolume","muted","arrayBuffer","String","fromCharCode","rawImageData","loadCnt","_loop","createGIFTexture","preload","VideoTexture","xhr","SaveDocumentAsDialog","edited","newTitle","saveAs","duplicateDocument","BadAssetsDialog","badAssets","VREditor","VREditor_VREditorApp","ImmersiveVREditor_ImmersiveVREditor","getBehaviorsObject","setCachedBehaviorAsset","cacheAssetsList","addAssetLoadingError","answers","showBadAssetsDialog","editIn2D","protocol","pathname","QRDialog_QRDialog","editInVR","viewInVR","nodeName","AddAudioAssetDialog_AddAudioAssetDialog","AddGLTFAssetDialog_AddGLTFAssetDialog","AddGLBAssetDialog_AddGLBAssetDialog","showOpenDocumentDialog","OpenFileDialog_OpenFileDialog","OpenAssetDialog_OpenAssetDialog","showOpenBehaviorDialog","OpenScriptDialog_OpenScriptDialog","showPasswordDialog","PasswordDialog_PasswordDialog","showGithubDialog","GithubAuthDialog_GithubAuthDialog","addCustomBehaviorAsset","TEMPLATE","randi","fname","addSceneScript","addBehaviorToObject","behaviorCache","rootObj","scene1","behaviors","behaviorProps","getCachedBehaviorPropDefs","pname","propdef","ndef","realobj","nodeType","acceptsImageAsset","acceptsVideoAsset","withNone","getFirstSceneObject","ov","cmds","canHaveBehavior","isGLTFFile","VREditor_ColorEditor","VREditor_GroupPropertyEditor","al","BadAssetsDialog_BadAssetsDialog","VREditorApp","showSaveAsDialog","SaveDocumentAsDialog_SaveDocumentAsDialog","toggleRunning","dirty","UnsavedDocumentDialog_UnsavedDocumentDialog","user","getUsername","bot","ErrorCatcher_ErrorCatcher","showAddAssetPopup","showAddBehaviorPopup","VREditor_RunButton","active","renderLoginButton","ScriptEditor_ScriptEditor","VRCanvas_VRCanvas","supportsAuth","supportsPassword","supportsDocList","GroupPropertyEditor","syncChanged","sync","newvals","_this11","boxes","RunButton","ColorEditor","showPopup","VREditor_ColorPopup","_this12","ColorPopup","_this13","_this14","attachUtilFunctions","obj_map","ImmersivePlayer","clickedStart","renderThreeWithCamera","startScene","three_map","current_scene","inter","gobj","showErrors","title_map","behavior_map","behavior_assets","pendingAssets","loadDocument","initAssets","assetsRoot","validateAssets","buildRoot","setCurrentScene","startupsound","renderSplashImage","renderErrors","initObject","initBehaviors","chnode","documentElement","prom","sceneAnchorNode","removeSceneAnchor","createSceneAnchor","updateAnchoredSceneNode","assetsList","player","_this15","sceneid","createFloorAnchorFromHitTest","screenx","screeny","createLocalAnchorFromHitTest","_this16","createDetectionImage","_this17","addGeoAnchoredNode","stopWorldInfo","worldInfoMesh","startWorldInfo","App","showProviderList","providers","openNewProvider","sw","ImmersivePlayer_ImmersivePlayer","zIndex","ReactDOM","App_App"],"mappings":"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","file":"static/js/main.117bc591.chunk.js","sourcesContent":["/**\n * Created by josh on 11/29/16.\n */\nmodule.exports = {\n    adds: [],\n    add: function add(note) {\n        this.adds.forEach(cb => cb(note))\n    },\n    onAdd: function onAdd(cb) {\n        this.adds.push(cb);\n    },\n    offAdd: function offAdd(cb) {\n        this.adds = this.adds.filter(n => n !== cb)\n    }\n}\n","module.exports = __webpack_public_path__ + \"static/media/startup-sound.8786b4e1.m4a\";","export function parseOptions(opts) {\n    let loc = document.location\n    if (loc.search) {\n        const parts = loc.search.substring(1).split('&')\n        parts.forEach((part)=>{\n            const keyval = part.split('=')\n            opts[keyval[0]] = keyval[1]\n        })\n    }\n    // console.log(opts)\n    // if(typeof opts.switcher === 'string') {\n    //     console.log(\"parsing switcher\")\n    // }\n    return opts;\n}\n\n\nexport const on = (elem,type,cb) => elem.addEventListener(type,cb)\nexport const $ = (sel) => document.querySelector(sel)\n\nexport function genID(prefix) {\n    return `${prefix}_${Math.floor(Math.random() * 10000)}`\n}\n\nexport function toFlatString(obj) {\n    return JSON.stringify(obj)\n}\n\n/*\nexport function GET_JSON(path, cb) {\n    return new Promise((res,rej) => {\n        console.log(\"fetching\",path);\n        const req = new XMLHttpRequest()\n        req.onreadystatechange = function() {\n            // console.log(\"got\",req.readyState, req.status)\n            if(req.readyState === 4) {\n                if(req.status === 200) return res(JSON.parse(req.responseText));\n                //if anything other than 200, reject it\n                rej(req)\n            }\n            if(req.status === 500) rej(req);\n            if(req.status === 404) rej(req);\n        };\n        req.open(\"GET\",path,true);\n        req.send();\n    });\n}\n\n\nexport function POST_JSON(path, payload) {\n    // console.log(\"POSTING\",path,payload);\n    return new Promise((res,rej)=>{\n        const req = new XMLHttpRequest();\n        req.onreadystatechange = function() {\n            if(req.readyState === 4 && req.status === 200) {\n                try {\n                    res(JSON.parse(req.responseText));\n                } catch(e) {\n                    rej(e);\n                }\n            }\n            if(req.status === 500) rej(req);\n            if(req.status === 404) rej(req);\n        };\n        req.onerror = (e) => rej(e);\n        req.open(\"POST\",path,true);\n        req.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\n        if(typeof payload === 'string') {\n            req.send(payload)\n        } else {\n            req.send(JSON.stringify(payload));\n        }\n    })\n}\n */\n\n\nexport function makePoint(x,y) {\n    return {\n        x:x,\n        y:y,\n        minus: function(pt) {\n            return makePoint(this.x-pt.x, this.y-pt.y);\n        },\n        add: function(pt) {\n            return makePoint(this.x+pt.x, this.y+pt.y);\n        },\n        divide: function(v) {\n            return makePoint(this.x/v,this.y/v)\n        },\n        multiply: function(v) {\n            return makePoint(this.x*v,this.y*v)\n        },\n        idivide: function(v) {\n            return makePoint(\n                Math.floor(this.x/v),\n                Math.floor(this.y/v)\n            )\n        },\n        floor: function() {\n            return makePoint(\n                Math.floor(this.x),\n                Math.floor(this.y)\n            )\n        },\n        distance(pt) {\n            const dx = pt.x-this.x;\n            const dy = pt.y-this.y;\n            return Math.sqrt(dx*dx+dy*dy)\n        },\n        equals(pt) {\n            return pt.x === this.x && pt.y === this.y\n        },\n        toString() {\n            return `(${x},${y})`\n        }\n    }\n}\n\n//use only capital letters, 65->90\nexport function genAlphaID(count) {\n    let id = \"\"\n    for(let i=0; i<count; i++) {\n        id += String.fromCharCode(65 + Math.floor(Math.random() * (90 - 65)))\n    }\n    return id\n}\n\nexport function setQuery(obj) {\n    const oldOpts = parseOptions({})\n    const final = {}\n    Object.keys(oldOpts).forEach(key=> final[key] = oldOpts[key])\n    Object.keys(obj).forEach(key=> final[key] = obj[key])\n    const query = Object.keys(final).map((key)=>`${key}=${final[key]}`).join('&')\n    window.history.pushState(obj,'a title','?'+query)\n}\nexport function toQueryString(obj) {\n    return Object.keys(obj).map((key)=>`${key}=${obj[key]}`).join('&')\n}\n\n\nexport function shallowCopy(obj) {\n    const out = {};\n    Object.keys(obj).forEach((key) => out[key] = obj[key])\n    return out;\n}\n","import React, {Component} from 'react'\nimport {PopupManager, VBox} from 'appy-comps'\nimport {makePoint} from '../utils'\n\nconst GridLayout = (props) => {\n    let clss = \"grid fill\";\n    let leftWidth = props.leftWidth\n    let rightWidth = props.rightWidth\n    if (!props.showLeft) {\n        clss += ' hide-left'\n        leftWidth = 0\n    }\n    if (!props.showRight) {\n        clss += ' hide-right'\n        rightWidth = 0\n    }\n    const cols = `\n    [left] ${leftWidth}px\n    [left-resize] 2px\n    [center] auto\n    [right-resize] 2px\n    [right] ${rightWidth}px\n    `\n    const style = {gridTemplateColumns:cols}\n    return <div className={clss} style={style}>{props.children}</div>\n};\n\nexport const Toolbar = (props) => {\n    let cls = \"toolbar\";\n    if (props.left) cls += \" left\";\n    if (props.right) cls += \" right\";\n    if (props.bottom) cls += \" bottom\";\n    if (props.top) cls += \" top\";\n    if (props.center) cls += \" center\";\n    if (props.middle) cls += \" middle\";\n    if (props.scroll) cls += \" scroll\";\n    return <div className={cls}>{props.children}</div>\n};\nexport const Panel = (props) => {\n    let cls = 'panel';\n    if (props.left) cls += \" left\";\n    if (props.right) cls += \" right\";\n    if (props.bottom) cls += \" bottom\";\n    if (props.top) cls += \" top\";\n    if (props.center) cls += \" center\";\n    if (props.middle) cls += \" middle\";\n    if (props.scroll) cls += \" scroll\";\n    if(props.transparent) cls += \" transparent\"\n    return <div className={cls}>{props.children}</div>\n};\nexport const Spacer = (props) => {\n    return <span className='spacer'/>\n};\n\nexport const ToggleButton = (props) => {\n    const {selected, ...rest} = props\n    const clss = selected?\"selected\":\"\"\n    return <button className={clss} {...rest}></button>\n}\n\nexport const MenuPopup = (props) => {\n    return <VBox className={\"popup-menu\"}>\n        {props.actions.map((act,i)=>{\n            if(act.divider) return <div className=\"divider\" key={i}></div>\n            let enabled = false\n            if(typeof act.enabled === 'undefined') enabled = true\n            if(act.enabled === true) enabled = true\n            return <button  key={i}\n                            disabled={!enabled}\n                            onClick={()=>{\n                PopupManager.hide();\n                if(act.fun) act.fun()\n            }}><i className={'fa fa-' + act.icon}/> {act.title}</button>\n        })}\n    </VBox>\n\n}\n\nexport default class GridEditorApp extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            showLeft: true,\n            showRight: true,\n            leftWidth:250,\n            rightWidth:250,\n            dragSide:'none'\n        }\n    }\n    toggleLeftPane = (e) => this.setState({showLeft: !this.state.showLeft})\n    toggleRightPane = (e) => this.setState({showRight: !this.state.showRight})\n    onMouseDownLeft = (e) => {\n        e.preventDefault()\n        e.stopPropagation()\n        this.setState({dragSide:'left'})\n        window.addEventListener('mousemove',this.onMouseMove)\n        window.addEventListener('mouseup',this.onMouseUp)\n    }\n    onMouseDownRight = (e) => {\n        e.preventDefault()\n        e.stopPropagation()\n        this.setState({dragSide:'right'})\n        window.addEventListener('mousemove',this.onMouseMove)\n        window.addEventListener('mouseup',this.onMouseUp)\n    }\n    onMouseMove = (e) => {\n        e.preventDefault()\n        e.stopPropagation()\n        const cursor = makePoint(e.clientX, e.clientY)\n        if(this.state.dragSide === 'left')  this.setState({leftWidth:cursor.x})\n        if(this.state.dragSide === 'right') this.setState({rightWidth:window.innerWidth-cursor.x})\n    }\n    onMouseUp = (e) => {\n        e.preventDefault()\n        e.stopPropagation()\n        window.removeEventListener('mousemove', this.onMouseMove)\n        window.removeEventListener('mouseup', this.onMouseUp)\n    }\n    render() {\n        return <GridLayout showLeft={this.state.showLeft}\n                           showRight={this.state.showRight}\n                           leftWidth={this.state.leftWidth}\n                           rightWidth={this.state.rightWidth}\n        >\n            <Toolbar center bottom>\n                <button className={'fa' + (this.state.showLeft ? ' fa-caret-left' : ' fa-caret-right')}\n                        onClick={this.toggleLeftPane}/>\n                <Spacer/>\n                {this.props.bottomText}\n                <Spacer/>\n                <button className={'fa' + (this.state.showRight ? ' fa-caret-right' : ' fa-caret-left')}\n                        onClick={this.toggleRightPane}/>\n            </Toolbar>\n\n            <div className={'left-resize'}  onMouseDown={this.onMouseDownLeft}/>\n            <div className={'right-resize'} onMouseDown={this.onMouseDownRight}/>\n\n            {this.props.children}\n        </GridLayout>\n    }\n}\n","\n\nexport const SELECTION_MANAGER = {\n    CHANGED:'CHANGED',\n    DROP_TARGET_CHANGED:'DROP_TARGET'\n}\n\nclass SelectionManager {\n    constructor(props) {\n        this.listeners = {};\n        this.selected = [];\n        this.dropTarget = null;\n        this.clip = null\n    }\n    on(type,cb) {\n        if(!this.listeners[type]) this.listeners[type] = [];\n        this.listeners[type].push(cb);\n    }\n    off(type,cb) {\n        const index = this.listeners[type].indexOf(cb)\n        if(index>=0) this.listeners[type].splice(index,1)\n    }\n    fire(type, value) {\n        if(!this.listeners[type]) this.listeners[type] = [];\n        this.listeners[type].forEach((cb) => cb(value));\n    }\n    setSelection(node) {\n        this.selected = [node]\n        this.fire(SELECTION_MANAGER.CHANGED,this)\n    }\n    addToSelection(node) {\n        this.selected.push(node)\n        this.fire(SELECTION_MANAGER.CHANGED,this)\n    }\n    clearSelection() {\n        this.selected = []\n        this.fire(SELECTION_MANAGER.CHANGED,this)\n    }\n    isSelected(node) {\n        return (this.selected.indexOf(node) >= 0)\n    }\n    getSelection() {\n        if(this.selected.length === 0) return null;\n        return this.selected[0];\n    }\n    isEmpty() {\n        return this.selected.length === 0\n    }\n    getFullSelection() {\n        return this.selected\n    }\n    setDropTarget(node) {\n        if(this.dropTarget !== node) {\n            this.dropTarget = node;\n            this.fire(SELECTION_MANAGER.DROP_TARGET_CHANGED, this.dropTarget)\n        }\n    }\n    getDropTarget() {\n        return this.dropTarget\n    }\n    setDropType(type) {\n        this.dropType = type\n    }\n    getDropType() {\n        return this.dropType\n    }\n\n    setClipboard(clip) {\n        this.clip = clip\n    }\n    getClipboard() {\n        return this.clip\n    }\n}\n\nexport default new SelectionManager();\n","import React, { Component } from 'react'\nimport {makePoint} from \"../utils\"\nimport hsluv from 'hsluv'\nimport {PopupManager} from \"appy-comps\"\n\nexport default class HSLUVColorPicker extends Component {\n    constructor(props) {\n        super(props)\n\n        const comps = hsluv.hexToHsluv(props.value)\n        this.state = {\n            hue:comps[0],\n            lightness:comps[1],\n            value:comps[2],\n        }\n        console.log(\"the current value is\",props.value, hsluv.hexToHsluv(props.value))\n    }\n    componentDidMount() {\n        this.redraw();\n    }\n    canvasToPoint(e) {\n        const canvasBounds = this.canvas.getBoundingClientRect()\n        const pt = makePoint(e.clientX, e.clientY).minus(makePoint(canvasBounds.x,canvasBounds.y))\n        const h = this.canvas.height;\n        const w = this.canvas.width;\n        const f = makePoint(pt.x/w*100, pt.y/h*100)\n        return f;\n    }\n    mousePress = (e) => {\n        const pt = this.canvasToPoint(e)\n        this.setState({lightness:pt.x, value:pt.y})\n        this.redraw()\n        this.pressed = true;\n    }\n    mouseMove = (e) => {\n        if(!this.pressed) return\n        const pt = this.canvasToPoint(e)\n        this.setState({lightness:pt.x, value:pt.y})\n        this.redraw()\n    }\n    mouseUp = (e) => {\n        this.pressed = false\n        this.redraw()\n    }\n    redraw = () => {\n        this.drawPicker()\n        this.drawSlider()\n        this.drawIndicator()\n    }\n    drawPicker() {\n        const canvas = this.canvas\n        if(!canvas) return\n        const c = this.canvas.getContext('2d')\n        let w = 100\n        let h = 100\n        const hue = Math.floor(this.state.hue)\n        for(let i=0; i<=4; i++) {\n            for(let j=0; j<=4; j++) {\n                let color = hsluv.hsluvToHex([hue,i*25,j*25])\n                if(color.length > 7) color = '#000000'\n                c.fillStyle = color\n                c.fillRect(i*20,j*20,20,20)\n            }\n        }\n        const g = 20\n        const cp = this.livalToCanvas(this.state.lightness, this.state.value)\n        c.strokeStyle = 'white'\n        c.strokeRect(Math.floor(cp.x/g)*g, Math.floor(cp.y/g)*g,g,g)\n        c.strokeStyle = 'black'\n        c.strokeRect(Math.floor(cp.x/g)*g+1, Math.floor(cp.y/g)*g+1,g-2,g-2)\n\n        c.strokeStyle = 'black';\n        c.lineWidth = 1.0\n        c.strokeRect(0,0,w,h)\n    }\n\n    livalToCanvas = (l,v) => {\n        return makePoint(l/100*100,v/100*100)\n    }\n\n    mouseToCanvas = (e) => {\n        const bounds = e.target.getBoundingClientRect()\n        return makePoint(e.clientX, e.clientY).minus(makePoint(bounds.x,bounds.y))\n    }\n\n    canvasToHue(pt) {\n        return Math.floor(pt.x/this.slider.width*360);\n    }\n    hueToCanvas(hue) {\n        return hue/360*this.slider.width\n    }\n    mousePressSlider = (e) => {\n        this.sliderPressed = true\n        const pt = this.mouseToCanvas(e)\n        const hue = this.canvasToHue(pt)\n        this.setState({hue:hue})\n        setTimeout(this.redraw,100)\n    }\n    mouseMoveSlider = (e) => {\n        if(!this.sliderPressed) return\n        const pt = this.mouseToCanvas(e)\n        const hue = this.canvasToHue(pt)\n        this.setState({hue:hue})\n        setTimeout(this.redraw,100)\n    }\n    mouseUpSlider = () => {\n        this.sliderPressed = false\n    }\n    drawSlider() {\n        const g = 10\n        const c = this.slider.getContext('2d')\n        const w = this.slider.width\n        const h = this.slider.height\n        c.fillStyle = 'red';\n        c.fillRect(0,0,w,h)\n        for(let x=0; x<w; x+=g) {\n            let hue = this.canvasToHue(makePoint(x,0))\n            let color = hsluv.hsluvToHex([hue,100,50])\n            if(color.length > 7) color = '#000000'\n            c.fillStyle = color\n            c.fillRect(x,0,g,h)\n        }\n        c.strokeStyle = 'black'\n        c.lineWidth = 1.0\n        const x = Math.floor(this.hueToCanvas(this.state.hue)/g)*g\n        c.strokeRect(x,0,g,h)\n        c.strokeRect(0,0,w,h)\n    }\n\n    drawIndicator() {\n        const c = this.indicator.getContext('2d')\n        const w = this.indicator.width\n        const h = this.indicator.height\n        let color = hsluv.hsluvToHex([Math.floor(this.state.hue),Math.floor(this.state.lightness),Math.floor(this.state.value)])\n        if(color.length > 7) color = '#000000'\n        c.fillStyle = color\n        c.fillRect(0,0,w,h)\n        c.strokeStyle = 'black'\n        c.lineWidth = 1.0\n        c.strokeRect(0,0,w,h)\n    }\n\n    close = () => {\n        let color = hsluv.hsluvToHex([Math.floor(this.state.hue),Math.floor(this.state.lightness),Math.floor(this.state.value)])\n        if(color.length > 7) color = '#000000'\n        this.props.onSelect(color)\n        PopupManager.hide()\n    }\n\n    render() {\n        return <div style={{\n            display:'flex',\n            flexDirection:'column',\n            alignItems:'center'\n        }}>\n            <canvas\n                ref={(can)=>this.canvas = can}\n                width={100} height={100}\n                onMouseDown={this.mousePress}\n                onMouseMove={this.mouseMove}\n                onMouseUp={this.mouseUp}\n            />\n            <canvas\n                ref={(can)=>this.slider = can}\n                width={100} height={30}\n                onMouseDown={this.mousePressSlider}\n                onMouseMove={this.mouseMoveSlider}\n                onMouseUp={this.mouseUpSlider}\n            />\n            <canvas\n                ref={(can)=>this.indicator = can}\n                width={32} height={32}\n                onClick={this.close}\n            />\n        </div>\n    }\n}","import {getAssetsURL, getInfoURL, getUserURL} from '../TreeItemProvider'\nimport * as ToasterMananager from './ToasterManager'\nimport {genID} from \"../utils\"\n\nexport const USER_CHANGE = 'USER_CHANGE'\nexport const CONNECTED = \"CONNECTED\"\nclass AuthModuleSingleton {\n    constructor() {\n        this.listeners = {}\n        this.supported = false\n        this.doclistSupported = false\n        this.docDeleteSupported = false\n        this.assetUploadSupported = false\n        this.scriptEditingSupported = false\n        this.passwordSupported = false\n        this.connected = false\n        this.serverID = genID(\"serverid\")\n    }\n    on(type,cb) {\n        if(!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].push(cb)\n    }\n    fire(type,payload) {\n        if(!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].forEach(cb => cb(payload))\n    }\n\n    init() {\n        if(this.isLoggedIn()) this.doclistSupported = true\n        fetch(getInfoURL()).then(res => res.json())\n            .then(info => {\n                console.info(\"Server Info:\",info)\n                if(info.authentication === true)      this.supported = true\n                if(info.passwordSupported === true)   this.passwordSupported = true\n                if(info.assetUpload === true)         this.assetUploadSupported = true\n                if(info.scriptEditing === true)       this.scriptEditingSupported = true\n                if(info.docDeleteSupported === true)  this.docDeleteSupported = true\n                this.serverID = getInfoURL().replace(/[\\.\\:\\/]/g,\"\")\n\n\n                this.getJSON(getUserURL()).then(res=>{\n                    if(!res.success) {\n                        this.logout()\n                    } else {\n                        this.fire(USER_CHANGE)\n                        this.doclistSupported = true\n                    }\n                    this.connected = true\n                    this.fire(CONNECTED)\n                }).then(()=>{\n                    this.connected = true\n                    this.fire(CONNECTED)\n                })\n            })\n    }\n    isConnected() {\n        return this.connected\n    }\n\n    isLoggedIn() {\n        if(localStorage.getItem('access-token')) return true\n        return false\n    }\n    supportsPassword() {\n        return this.passwordSupported\n    }\n    supportsAuth() {\n        return this.supported\n    }\n    supportsDocList() {\n        return this.doclistSupported\n    }\n    supportsAssetUpload() {\n        return this.assetUploadSupported\n    }\n    supportsScriptEdit() {\n        return this.scriptEditingSupported\n    }\n    supportsDocDelete() {\n        return this.docDeleteSupported\n    }\n\n    login = (res) => {\n        this.win = window.open(res.url,'_blank')\n        window.addEventListener('message',this.authCallback)\n        if(this.win) this.win.focus()\n    }\n    logout = () => {\n        localStorage.clear()\n        this.doclistSupported = false\n        this.fire(USER_CHANGE)\n    }\n    doPasswordLogin (password) {\n        localStorage.setItem('access-token',password)\n        return this.getJSON(getUserURL()).then(res=>{\n            if(res.success === true) {\n                console.log(\"the logged in response is\", res)\n                this.doclistSupported = true\n                ToasterMananager.add(\"login succeeded\")\n                this.fire(USER_CHANGE)\n            } else {\n                ToasterMananager.add(\"login failed\")\n                localStorage.clear()\n                this.doclistSupported = false\n                this.fire(USER_CHANGE)\n            }\n        })\n\n    }\n    authCallback = (msg) => {\n        this.setUserData(msg.data.payload)\n        this.win.close()\n        window.removeEventListener('message',this.authCallback)\n        this.doclistSupported = true\n        this.fire(USER_CHANGE)\n        ToasterMananager.add(\"login succeeded\")\n    }\n    setUserData(data) {\n        localStorage.setItem('access-token',data.accessToken)\n    }\n    getAccessToken() {\n        return localStorage.getItem('access-token')\n    }\n\n    getUsername() {\n        return this.getAccessToken()\n    }\n\n    getServerID() {\n        return this.serverID\n    }\n\n    fetch(url, options) {\n        options.mode = 'cors'\n        options.cache = 'no-cache'\n        if(!options.headers) options.headers = {}\n        options.headers[\"access-key\"] =  AuthModule.getAccessToken()\n        console.log(\"fetching\",url,'with options',options)\n        return fetch(url,options)\n            .then(res => {\n                if(res.status === 404) throw new Error(res.statusText + \" \" + res.url)\n                return res\n            })\n    }\n    getJSON(url) {\n        return this.fetch(url,{\n            method:'GET',\n            headers: {\n                \"Content-Type\": \"application/json\",\n            }\n        }).then(res => res.json())\n    }\n\n    uploadFile(file) {\n        const url = getAssetsURL()+file.name\n        return this.fetch(url,{\n            method:'POST',\n            body:file\n        }).then(res => res.json())\n    }\n\n}\n\nexport const AuthModule = new AuthModuleSingleton()\n","import {setQuery, toQueryString} from './utils'\nimport Selection from './SelectionManager'\nimport {AuthModule} from './vr/AuthModule'\n\nexport const TREE_ITEM_PROVIDER = {\n    EXPANDED_CHANGED:'EXPANDED_CHANGED',\n    STRUCTURE_CHANGED:'STRUCTURE_CHANGED',\n    STRUCTURE_ADDED:'STRUCTURE_ADDED',\n    STRUCTURE_REMOVED:'STRUCTURE_REMOVED',\n    PROPERTY_CHANGED:'PROPERTY_CHANGED',\n    CLEAR_DIRTY:'CLEAR_DIRTY',\n    SAVED:'SAVED',\n    DOCUMENT_SWAPPED:'DOCUMENT_SWAPPED',\n}\n\nconst URLS = {\n    BASE:'https://vr.josh.earth/generaled/api/'\n    // BASE:'https://buttered-elk.glitch.me/'\n    // BASE:'http://localhost:1234/'\n}\nexport function getDocsURL() {\n    return URLS.BASE + 'doc/'\n}\nexport function getAssetsURL() {\n    return URLS.BASE + 'asset/'\n}\nexport function getScriptsURL() {\n    return URLS.BASE + 'scripts/'\n}\nexport function getLoginURL() {\n    return URLS.BASE + 'auth/github/login'\n}\nexport function getInfoURL() {\n    return URLS.BASE +'info'\n}\nexport function getUserURL() {\n    return URLS.BASE + 'userinfo'\n}\n\n// export const SERVER_URL = \"http://localhost:30065/doc/\"\n// export const SERVER_URL_ASSETS = \"http://localhost:30065/asset/\"\n// export const SERVER_URL = \"http://localhost:55555/doc/\"\n// export const SERVER_URL = \"https://vr.josh.earth/generaled/api/doc/\"\n// export const BASE_URL = \"http://localhost:55555/\"\n// export const BASE_URL = \"https://vr.josh.earth:55555/\"\n// export const SERVER_URL_ASSETS = \"http://localhost:55555/asset/\"\n// export const SERVER_URL_ASSETS = \"https://vr.josh.earth/generaled/api/asset/\"\n// export const SERVER_URL_ASSETS = \"http://josh.earth:30068/asset/\"\n// export const LOGIN_URL = \"http://localhost:55555/auth/github/login\"\n// export const LOGIN_URL = \"https://vr.josh.earth/generaled/api/auth/github/login\"\n\nclass TreeItemProviderInterface {\n    /** register a listener */\n    on(type, cb) {\n        throw new Error(`interface 'on' not implemented`)\n    }\n\n    /** un-register a listener */\n    off(type, cb) {\n        throw  new Error(\"interface 'off' not implemented\")\n    }\n\n    /** fire an event. internal use */\n    fire(type, value) {\n        throw  new Error(\"interface 'fire' not implemented\")\n    }\n\n    // ============== tree interface\n    /** returns the root of the tree structure */\n    getSceneRoot() {\n        throw new Error(\"interface 'getSceneRoot' not implemented\")\n    }\n    /** delete child node */\n    deleteChild(child) { throw new Error(\"deleteChild not implemented yet\")}\n    /** append child to the parent */\n    appendChild(parent,child) { throw new Error(\"appendChild not implemented yet\")}\n    /** insert child node before a particular other node */\n    insertNodeBefore(node,sibling) { throw new Error(\"insertNodeBefore() not implemented yet\")}\n    /** find a given node by ID */\n    findNodeById(id) { throw new Error(\"findNodeById() not implemented yet\")}\n    /** find the parent of the given node */\n    findParent(node) { throw new Error(\"findParent() not implemented yet\")}\n    /** return true if the given node has children */\n    hasChildren(node) { throw new Error(\"hasChildren() not implemented yet\")}\n    /** returns an array of children for the parent node */\n    getChildren(node) { throw new Error(\"getChildren() not implemented yet\")}\n\n    // ========= Tree View support =========\n\n    /** returns true if item is expanded */\n    isExpanded(item) {\n        throw  new Error(\"interface 'isExpanded' not implemented\")\n    }\n\n    /** return a react component for the context menu of the item in the tree view */\n    calculateContextMenu(item) {\n        throw new Error(\"calculateContextMenu() not implemented yet\")\n    }\n    /** toggles the collapsed state of the item */\n    toggleItemCollapsed(item) {\n        throw new Error(\"toggleItemCollapsed() not implemented yet\")\n    }\n    /** returns a react component to display the item in the tree view */\n    getRendererForItem(item) {\n        throw new Error(\"getRendererForItem() not implemented yet\")\n    }\n\n\n\n    // ================ properties ==================\n    /** set the property value using a prop def */\n    setPropertyValue(item, def, value) {\n        throw new Error(\"interface setPropertyValue not implemented\")\n    }\n    setPropertyValueByName(child,name,value) { throw new Error(`interface 'setPropertyValueByName() not implemented'`)}\n    /** return an array of property definitions for the specified tree item */\n    getProperties(item) { throw new Error(`interface 'getProperties()' not implemented`) }\n\n\n    // ================ doc def stuff\n    getDocId() {  throw new Error(\"getDocId() not implemented\")  }\n    getDocType() {  throw new Error(\"getDocType() not implemented\")  }\n    getApp() { throw new Error(\"getApp() not implemented\")  }\n    getTitle() { throw new Error(\"getTitle() not implemented\") }\n}\n\nconst AUTO_DETECT_GLITCH = true\nfunction calculateServerUrl(SERVER_URL) {\n    if(SERVER_URL) {\n        return `https://${SERVER_URL}/`\n    }\n\n    if(AUTO_DETECT_GLITCH) {\n        console.log(\"no server url, checking the document\")\n        const host = document.location.host\n        if (host.endsWith(\".glitch.me\")) {\n            console.log(\"this is a glitch. using autodetected server\")\n            return `https://${host}/`\n        }\n    }\n    return URLS.BASE\n}\n\nexport default class TreeItemProvider extends TreeItemProviderInterface {\n    constructor(options) {\n        super()\n        this.listeners = {};\n        this.expanded_map = {};\n        this.docid = null\n        URLS.BASE = calculateServerUrl(options.SERVER_URL)\n        console.log(\"using server\",URLS.BASE)\n        AuthModule.init()\n    }\n\n    on(type, cb) {\n        if (!this.listeners[type]) this.listeners[type] = [];\n        this.listeners[type].push(cb);\n    }\n\n    fire(type, value) {\n        if (!this.listeners[type]) this.listeners[type] = [];\n        this.listeners[type].forEach((cb) => cb(value));\n    }\n\n    off(type, cb) {\n        if (this.listeners[type]) this.listeners[type] = this.listeners[type].filter(list => list !== cb)\n    }\n\n    isExpanded(item) {\n        if (!item.id) item.id = \"\" + Math.random();\n        if (typeof this.expanded_map[item.id] === 'undefined') this.expanded_map[item.id] = true;\n        return this.expanded_map[item.id];\n    }\n    toggleItemCollapsed(item) {\n        const current = this.isExpanded(item);\n        this.expanded_map[item.id] = !current;\n        this.fire(TREE_ITEM_PROVIDER.EXPANDED_CHANGED,item);\n    }\n\n\n    setPropertyValue(item, def, value) {\n        throw new Error(\"subclass of TreeItemProvider must implement setPropertyValue\")\n    }\n\n    genID = (prefix) => {\n        return `${prefix}_${Math.floor(Math.random() * 1000*1000*1000)}`\n    }\n\n    setDocument(doc, docid) {\n        this.root = doc\n        this.docid = docid\n        this.fire(TREE_ITEM_PROVIDER.STRUCTURE_CHANGED, {\n            provider:this\n        });\n    }\n\n    getDocId() {\n        return this.docid\n    }\n\n    save = () => {\n        console.info(\"saving\",this.getSceneRoot())\n        const payload_obj = {\n            doc:this.getSceneRoot(),\n            type:this.getDocType(),\n            id:this.getDocId()\n        }\n        const payload_string = JSON.stringify(payload_obj,(key,value)=>{\n            if(key === 'parent') return undefined\n            return value\n        })\n        console.info(\"doc is\",payload_string)\n        return AuthModule.fetch(getDocsURL()+this.docid, {\n            method:'POST',\n            body: payload_string,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            },\n        })\n            .then(res => res.json())\n            .then((res)=>{\n            console.log(\"Success result is\",res)\n            setQuery({mode:'edit',doc:this.docid, doctype:this.getDocType()})\n            this.fire(TREE_ITEM_PROVIDER.SAVED,true)\n        }).catch((e)=> console.log(\"error\",e))\n    }\n    loadDoc(docid) {\n        console.log(\"need to load the doc\",docid)\n        AuthModule.getJSON(getDocsURL()+docid).then((payload)=>{\n            console.log(\"got the doc\",payload)\n            if(payload.type !== this.getDocType()) throw new Error(\"incorrect doctype for this provider\",payload.type)\n            this.setDocument(payload.doc,payload.id)\n        }).catch((e)=>{\n            console.warn(\"missing doc\",e)\n            this.setDocument(this.makeEmptyRoot(),this.genID('doc'))\n            setQuery({mode:'edit',doc:this.docid, doctype:this.getDocType()})\n        })\n    }\n    reloadDocument() {\n        const spath = this.generateSelectionPath(Selection.getSelection());\n        console.log(\"got the path\",spath)\n        AuthModule.getJSON(getDocsURL()+this.docid).then((payload)=>{\n            if(payload.type !== this.getDocType()) throw new Error(\"incorrect doctype for this provider\",payload.type)\n            this.setDocument(payload.doc,payload.id)\n            this.fire(TREE_ITEM_PROVIDER.CLEAR_DIRTY,true)\n            const newsel = this.findNodeFromSelectionPath(this.getSceneRoot(),spath)\n            console.log(\"set new selection to \", newsel)\n            Selection.setSelection(newsel)\n        }).catch((e)=>{\n            console.warn(\"couldn't reload the doc\",e)\n        })\n\n    }\n\n    /* required functions for subclasses */\n\n    generateSelectionPath() {\n        throw new Error(\"generateSelectionPath not implemented\")\n    }\n    findNodeFromSelectionPath() {\n        throw new Error(\"findNodeFromSelectionPath not implemented\")\n    }\n    makeEmptyRoot() {\n        throw new Error(\"makeEmptyRoot() not implemented\")\n    }\n\n    getSceneRoot() {\n        return this.root;\n    }\n\n    uploadFile(file) {\n        return new Promise((res,rej)=>{\n            const fd = new FormData()\n            fd.append('file',file)\n            console.info(\"filesize is\",file.size, file.name);\n            const xml = new XMLHttpRequest()\n            xml.onreadystatechange = () => console.log(`ready state = ${xml.readyState} status ${xml.status}`)\n            xml.addEventListener('progress',(e)=>console.log(`progress`))\n            xml.addEventListener('load',(e)=> res(xml.response))\n            xml.addEventListener('error',(e)=>console.log(`error`))\n            xml.addEventListener('abort',(e)=>console.log(`abort`))\n            const url = getAssetsURL()+file.name;\n            console.info(\"uploading to \", url)\n            xml.responseType = 'json'\n            xml.open('POST',url)\n            xml.setRequestHeader('access-key',AuthModule.getAccessToken())\n            xml.send(file)\n        })\n    }\n\n\n    hasChildren = (item) => item && item.children && item.children.length\n    getChildren = (item) => item.children\n\n}\n","import React, {Component} from \"react\";\n\nexport class StringEditor extends Component {\n    keypressed = (e) => {\n        if(e.charCode === 13) this.props.onCommit();\n    }\n\n    render() {\n        const prop = this.props.def;\n        if (prop.hasHints()) {\n            const hints = prop.getHints()\n            if (hints.multiline) {\n                return <textarea value={this.props.value}\n                                 onChange={this.props.onChange}\n                                 onBlur={this.props.onBlur}\n                />\n            }\n        }\n        return <input type='string'\n                      value={this.props.value}\n                      onChange={this.props.onChange}\n                      onKeyPress={this.keypressed}\n                      onBlur={this.props.onBlur}\n        />\n    }\n}","import React, {Component} from \"react\";\nimport {HBox, PopupManager, VBox} from \"appy-comps\";\n\nconst EnumPicker = (props) => {\n    const Rend = props.renderer\n    const items = props.values.map(val=>\n        <HBox\n            key={val}\n            onClick={(e)=>props.onSelect(val)}>\n            <Rend value={val} def={props.def} obj={props.obj} provider={props.provider}/>\n        </HBox>\n    )\n    return <VBox className=\"popup-menu\">{items}</VBox>\n}\n\nconst DefaultEnumRenderer = (props) => {\n    let value = \"\"\n    if(typeof props.value !== 'undefined' && props.value !== null) {\n        value = props.value.toString()\n    }\n    return <span>{value}</span>\n}\n\nexport class EnumEditor extends Component {\n    calculateRenderer() {\n        const proxy = this.props.def\n        const obj = this.props.obj\n        if (!this.props.provider.getRendererForEnum) return DefaultEnumRenderer\n        const renderer = this.props.provider.getRendererForEnum(proxy.getKey(), obj)\n        if (!renderer) return DefaultEnumRenderer\n        return renderer\n    }\n\n    calculateValues() {\n        const vals = this.props.provider.getValuesForEnum(this.props.def.getKey(), this.props.obj, this.props.def)\n        if (!vals) {\n            console.log(`no values for enum ${this.props.def.getKey()}`);\n            return []\n        }\n        return vals\n    }\n\n    open = (e) => {\n        PopupManager.show(<EnumPicker\n            values={this.calculateValues()}\n            renderer={this.calculateRenderer()}\n            onSelect={this.selectValue}\n            provider={this.props.provider}\n        />, e.target)\n    }\n    selectValue = (value) => {\n        PopupManager.hide()\n        this.props.onChange(value)\n    }\n    renderValue = (value) => {\n        const def = this.props.def\n        const obj = this.props.obj\n        const Rend = this.calculateRenderer()\n        return <Rend value={value} def={def} obj={obj} provider={this.props.provider}/>\n    }\n\n    render() {\n        return <button onClick={this.open}>{this.renderValue(this.props.value)}</button>\n    }\n}","import React, {Component} from \"react\";\nimport {VBox} from \"appy-comps\";\nimport {EnumEditor} from \"./EnumEditor\";\n\nconst DefaultEnumRenderer = (props) => {\n    let value = \"\"\n    if(typeof props.value !== 'undefined') {\n        value = props.value.toString()\n    }\n    return <span>{value}</span>\n}\n\nexport class ArrayEditor extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            showEditor: false,\n            value: \"\"\n        }\n\n    }\n\n    calculateRenderer() {\n        const def = this.props.def\n        const obj = this.props.obj\n        if (!this.props.provider.getRendererForEnum) return DefaultEnumRenderer\n        const renderer = this.props.provider.getRendererForEnum(def.key, obj)\n        if (!renderer) return DefaultEnumRenderer\n        return renderer\n    }\n\n    addValue = () => {\n        this.setState({showEditor: true})\n    }\n    enumChanged = (value) => {\n        const arr = this.props.value.slice();\n        arr.push(value)\n        this.props.onChange(arr)\n    }\n\n    render() {\n        // const def = this.props.def\n        // const obj = this.props.obj\n        let value = this.props.value\n        if (!value) value = []\n        return <div>\n            {this.renderValues()}\n            <button onClick={this.addValue} className=\"fa fa-plus\"/>\n            {this.renderEditor()}\n        </div>\n    }\n\n    deleteItem(val) {\n        let arr = this.props.value.slice()\n        arr = arr.filter((v) => v !== val)\n        this.props.onChange(arr)\n    }\n\n    renderValues() {\n        const Renderer = this.calculateRenderer()\n        return <VBox>{this.props.value.map((val, i) => {\n            return <div key={i}>\n                <button className=\"fa fa-minus\" onClick={() => this.deleteItem(val)}/>\n                <Renderer value={val} provider={this.props.provider}/>\n            </div>\n        })}</VBox>\n    }\n\n    renderEditor() {\n        if (!this.state.showEditor) return \"\"\n        const def = this.props.def\n        const obj = this.props.obj\n        return <EnumEditor value={this.state.value}\n                           onChange={this.enumChanged}\n                           def={def}\n                           obj={obj}\n                           provider={this.props.provider}/>\n\n    }\n}\n","import React, {Component} from 'react';\nimport {PopupManager} from 'appy-comps'\n\nimport selMan, {SELECTION_MANAGER} from \"../SelectionManager\";\nimport HSLUVColorPicker from \"./HSLUVColorPicker\";\nimport {TREE_ITEM_PROVIDER} from '../TreeItemProvider'\nimport {StringEditor} from \"./StringEditor\";\nimport {EnumEditor} from \"./EnumEditor\";\nimport {ArrayEditor} from \"./ArrayEditor\";\n\nexport const TYPES = {\n    STRING:'string',\n    NUMBER:'number',\n    BOOLEAN:'boolean',\n    ENUM:'enum',\n    COLOR:'color',\n    GROUP:'group',\n}\n\nclass PropEditor extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            value:props.def.getValue()\n        }\n    }\n    componentWillReceiveProps(nextProps) {\n        if(this.props.def !== nextProps.def) {\n            this.setState({value:nextProps.def.getValue()})\n        }\n    }\n    shouldComponentUpdate(nextProps, nextState) {\n        if(nextProps.def.getType() === 'group') return true\n        if(this.state.value !== nextState.value) return true\n        if(this.props.def.getKey() === nextProps.def.getKey()) {\n            if(this.props.def.getValue() === nextProps.def.getValue()) {\n                return false\n            }\n        }\n        return true\n    }\n    changed = (e) => {\n        if(this.props.def.isType(TYPES.STRING)) {\n            this.setState({value:e.target.value})\n            if(this.props.def.isLive()) {\n                this.props.def.setValue(e.target.value)\n            }\n        }\n        if(this.props.def.isType(TYPES.NUMBER)) this.updateNum(e.target.value)\n        if(this.props.def.isType(TYPES.BOOLEAN)) this.setState({value:e.target.checked})\n    }\n    customChanged = value => {\n        if(this.props.def.isType(TYPES.COLOR)) return this.colorChanged(value)\n        this.setState({value:value})\n        this.props.def.setValue(value)\n    }\n    keypressed = (e) => {\n        if(e.charCode === 13) this.commit();\n    }\n    updateNum = (v) => {\n        const def = this.props.def;\n        if(def.hasHints()) {\n            if(def.getHints().hasOwnProperty('min')) {\n                if(v < def.getHints().min) v = def.getHints().min\n            }\n            if(def.getHints().hasOwnProperty('max')) {\n                if (v > def.getHints().max) v = def.getHints().max\n            }\n        }\n        this.setState({value:v})\n        if(!isNaN(parseFloat(v))) {\n            def.setValue(parseFloat(v))\n        }\n    }\n    numberKeyDown = (e) => {\n        if(e.key === 'ArrowUp' && e.shiftKey) {\n            e.preventDefault()\n            this.updateNum(this.state.value+10)\n        }\n        if(e.key === 'ArrowDown' && e.shiftKey) {\n            e.preventDefault()\n            this.updateNum(this.state.value-10)\n        }\n    }\n    booleanChanged = (e) => {\n        this.setState({value:e.target.checked});\n        this.props.def.setValue(e.target.checked)\n    }\n    enumChanged = (value) => {\n        this.setState({value:value})\n        this.props.def.setValue(value)\n    }\n    arrayChanged = (value) => {\n        this.setState({value:value})\n        this.props.def.setValue(value)\n    }\n    colorChanged = (color) => {\n        this.setState({value:color});\n        this.props.def.setValue(color)\n    }\n    commit = () => {\n        this.props.def.setValue(this.state.value)\n    }\n    openColorEditor = (e) => {\n        PopupManager.show(<HSLUVColorPicker onSelect={this.colorChanged} value={this.state.value}/>, e.target)\n    }\n    render() {\n        const prop = this.props.def;\n        const obj = selMan.getSelection();\n        const provider = this.props.provider\n        if (prop.isCustom()) return this.props.provider.createCustomEditor(this.props.item, prop, provider, this.state.value, this.customChanged)\n        if (prop.isLocked()) return <i>{prop.getValue()}</i>\n        if (prop.isType(TYPES.STRING))  return <StringEditor value={this.state.value}\n                                 onChange={this.changed}\n                                 onBlur={this.commit} onCommit={this.commit}\n                                 def={prop} obj={obj}\n                                 provider={this.props.provider}/>\n        if (prop.isType(TYPES.NUMBER))  {\n            let step = 1\n            if(prop.hasHints()) {\n                const hints = prop.getHints()\n                if (hints.incrementValue) {\n                    step = hints.incrementValue\n                }\n            }\n            return <input type='number'\n                          value={this.state.value}\n                          onChange={this.changed}\n                          onKeyPress={this.keypressed}\n                          onKeyDown={this.numberKeyDown}\n                          onBlur={this.commit}\n                          step={step}/>\n        }\n        if (prop.isType(TYPES.BOOLEAN)) return <input type='checkbox'\n                                                  checked={this.state.value}\n                                                  onChange={this.booleanChanged}/>\n        if (prop.isType(TYPES.ENUM)) return <EnumEditor value={this.state.value} onChange={this.enumChanged} def={prop} obj={obj} provider={this.props.provider}/>\n        if (prop.isType(TYPES.COLOR)) return <button style={{ backgroundColor:this.state.value}} onClick={this.openColorEditor}>{this.state.value}</button>\n        if (prop.isType('array')) return <ArrayEditor value={this.state.value} onChange={this.arrayChanged} def={prop} obj={obj} provider={this.props.provider}/>\n        return <b>{prop.getType()}:{prop.getValue()}</b>\n    }\n}\n\n/*class PaletteColorPicker extends Component {\n    chooseColor(c) {\n        this.props.onSelect(c);\n    }\n    render() {\n        const style = {\n            display:'flex',\n            flexDirection:'row',\n            flexWrap:'wrap'\n        }\n        return <div style={style}>\n            {Object.keys(COLORS2).map((key,i) => {\n                let color = COLORS2[key];\n                let scolor = color.toString(16);\n                while(scolor.length < 6) scolor = \"0\"+scolor\n                scolor = '#' +scolor\n                let style = {\n                    backgroundColor:scolor,\n                    color:'red'\n                }\n                return <button key={key}\n                               style={style}\n                               onClick={this.chooseColor.bind(this, scolor)}\n                >&nbsp;</button>\n            })}\n        </div>\n    }\n}\n*/\nexport default class PropSheet extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            selection:null\n        }\n    }\n    componentDidMount() {\n        this.h2 = () => this.setState({selection:selMan.getSelection()})\n        this.props.provider.on(TREE_ITEM_PROVIDER.PROPERTY_CHANGED,this.h2)\n        this.hand = (s) => this.setState({selection:selMan.getSelection()})\n        selMan.on(SELECTION_MANAGER.CHANGED, this.hand)\n    }\n    componentWillUnmount() {\n        selMan.off(SELECTION_MANAGER.CHANGED, this.hand);\n        this.props.provider.off(TREE_ITEM_PROVIDER.PROPERTY_CHANGED,this.h2)\n    }\n    render() {\n        const props = this.calculateGroups(this.calculateProps())\n        const item = selMan.getSelection()\n        return <ul className=\"prop-sheet\">{props.map((prop, i) => {\n            return [\n                <label key={prop.getKey()+'-label'} title={prop.getKey()}>{prop.getName()}</label>,\n                this.renderIndeterminate(prop,i),\n                <PropEditor key={prop.getKey()+'-editor'} def={prop} provider={this.props.provider} item={item}/>\n            ]\n        })}</ul>\n    }\n    renderIndeterminate(prop, i) {\n        if(prop.isIndeterminate()) {\n            return <i key={prop.getKey()+'-indeterminate'} className=\"icon fa fa-exclamation-circle\"/>\n        } else {\n            return \"\"\n        }\n    }\n    calculateProps() {\n        const items = selMan.getFullSelection()\n        const first = items[0]\n        const prov = this.props.provider\n        let props = prov.getProperties(first)\n        items.forEach((item)=>{\n            props = calculateIntersection(props, prov.getProperties(item))\n        })\n        return props.map((prop)=>{\n            const multi = new MultiPropProxy(prov, prop.key)\n            items.forEach((item)=>{\n                const p2 = prov.getProperties(item)\n                const match = p2.find(def=>def.key === prop.key)\n                multi.addSubProxy(new PropProxy(prov,item,match))\n            })\n            return multi\n        });\n    }\n\n    calculateGroups(props) {\n        const group_defs = props.filter(p => p.getType() === TYPES.GROUP)\n        group_defs.forEach(def => {\n            const group_keys = def.getGroupKeys()\n            //remove any groups in the group keys of a group def\n            props = props.filter(p => group_keys.indexOf(p.getKey())<0)\n        })\n        return props\n    }\n}\n\n//return items from A that are also in B\nfunction calculateIntersection(A,B) {\n    return  A.filter((pa)=> B.find((pb)=>pa.key===pb.key))\n}\n\n\nclass MultiPropProxy {\n    constructor(provider,key) {\n        this.provider = provider\n        this.key = key\n        this.subs = []\n    }\n    addSubProxy(sub) {\n        this.subs.push(sub)\n    }\n    first() {\n        return this.subs[0]\n    }\n    getName()  { return this.first().getName()  }\n    getValue() { return this.first().getValue() }\n    isCustom() { return this.first().isCustom() }\n    hasHints() { return this.first().hasHints() }\n    getHints() { return this.first().getHints() }\n    isLocked() { return this.first().isLocked() }\n    getType()  { return this.first().getType()  }\n    isType(s)  { return this.first().isType(s)  }\n    isLive()   { return this.first().isLive()   }\n    getKey()   { return this.key                }\n    getGroupKeys() { return this.first().getGroupKeys() }\n    setValue(v) {\n        this.subs.forEach((s)=> s.setValue(v))\n    }\n    isIndeterminate() {\n        let same = true\n        let value = this.first().getValue()\n        this.subs.forEach((s)=>{\n            if(s.getValue() !== value) same = false\n        })\n        return !same;\n    }\n}\n\n\nclass PropProxy {\n    constructor(provider, item, def) {\n        this.provider = provider\n        this.item = item\n        this.def = def\n    }\n    getKey() {\n        return this.def.key\n    }\n    getName() {\n        return this.def.name\n    }\n    isCustom() {\n        return this.def.custom\n    }\n    isLocked() {\n        return this.def.locked\n    }\n    getType() {\n        return this.def.type\n    }\n    getValue() {\n        return this.def.value\n    }\n    isLive() {\n        return this.def.live\n    }\n    isType(type) {\n        return this.def.type === type\n    }\n    setValue(value) {\n        return this.provider.setPropertyValue(this.item,this.def,value)\n    }\n    hasHints() {\n        return this.def.hints\n    }\n    getHints() {\n        return this.def.hints\n    }\n    getGroupKeys() {\n        return this.def.group\n    }\n    isIndeterminate() { return false; }\n}\n","export function listToArray(list) {\n    return Array.prototype.slice.call(list)\n}\nexport function createGraphObjectFromObject(graph, json) {\n    return graph.createObject(json)\n}\n\nexport function fetchGraphObject(graph, objid) {\n    const obj = {}\n    graph.getPropertiesForObject(objid).forEach(key => {\n        obj[key] = graph.getPropertyValue(objid, key)\n    })\n    obj.id = objid\n    return obj\n}\n\nexport function propToArray(doc, CH) {\n    const len = doc.getArrayLength(CH)\n    const ch = []\n    for (let i = 0; i < len; i++) {\n        ch.push(doc.getElementAt(CH, i))\n    }\n    return ch\n}\n\nexport function indexOf(graph, array, target) {\n    const arr = propToArray(graph,array)\n    return arr.findIndex(e => e === target)\n}\n\nexport function insertAsFirstChild(graph, parent, child) {\n    graph.setProperty(child.id,'parent',parent.id)\n    const ch = graph.getPropertyValue(parent.id,'children')\n    graph.insertAfter(ch,null,child.id)\n}\n\nexport function insertAsLastChild(graph, parent, child) {\n    graph.setProperty(child.id,'parent',parent.id)\n    const ch = graph.getPropertyValue(parent.id,'children')\n    const len = graph.getArrayLength(ch)\n    const prev = graph.getElementAt(ch,len-1)\n    graph.insertAfter(ch,prev,child.id)\n}\n\nexport function removeFromParent(graph, obj) {\n    const parent = fetchGraphObject(graph, obj.parent)\n    const n = indexOf(graph, parent.children, obj.id)\n    if (n >= 0) {\n        graph.removeElement(parent.children, n)\n    } else {\n        console.error(\"could not find index for child\", obj, 'in children', parent.children)\n    }\n}\n\n\nexport function cloneShape(graph,shape) {\n    const id = shape.id\n    const id2 = graph.createObject()\n    const props = graph.getPropertiesForObject(id)\n    props.forEach(key => {\n        graph.createProperty(id2,key,graph.getPropertyValue(id,key))\n    })\n    const shape2 = fetchGraphObject(graph,id2)\n    return shape2\n}\n","import React, { Component } from 'react';\nimport selMan, {SELECTION_MANAGER} from \"../SelectionManager\";\nimport {TREE_ITEM_PROVIDER} from '../TreeItemProvider';\nimport {PopupManager, VBox} from \"appy-comps\";\nimport {fetchGraphObject, removeFromParent} from \"../syncgraph/utils\";\nimport {Spacer} from './GridEditorApp'\n\n\nconst ContextMenu = (props) => {\n    return <VBox className={\"popup-menu\"}>\n        {props.menu.map((item,i)=>{\n            if(item.divider) return <div className=\"divider\" key={i}></div>\n            let enabled = false\n            if(typeof item.enabled === 'undefined') enabled = true\n            if(item.enabled === true) enabled = true\n            return <button key={i}\n                           disabled={!enabled}\n                           onClick={()=>{\n                PopupManager.hide()\n                if(item.fun) item.fun()\n            }}\n            ><i className={'fa fa-'+item.icon}/> {item.title}</button>\n        })}\n    </VBox>\n}\n\nclass TreeTableItem extends Component {\n    onSelect = (e)=>  {\n        if(e.shiftKey) {\n            selMan.addToSelection(this.props.node)\n        } else {\n            selMan.setSelection(this.props.node)\n        }\n    }\n    onContextMenu = (e) => {\n        e.preventDefault()\n        e.stopPropagation()\n        selMan.setSelection(this.props.node)\n        if(this.props.provider.calculateContextMenu) {\n            const menu = this.props.provider.calculateContextMenu(this.props.node)\n            PopupManager.show(<ContextMenu menu={menu}/>,e.target)\n        }\n    }\n    toggleItemCollapsed = (e) => {\n        e.preventDefault()\n        e.stopPropagation()\n        this.props.provider.toggleItemCollapsed(this.props.node);\n    }\n    onDragStart = (e) => {\n        this.props.onDragStart(e,this.props.node)\n    }\n    onDragOver = (e) => {\n        this.props.onDragOver(e,this.props.node)\n    }\n    onDragEnd = (e) => {\n        this.props.onDragEnd(e,this.props.node)\n    }\n    onDrop = (e) => {\n        this.props.onDrop(e,this.props.node)\n    }\n    render() {\n        let cls = \"tree-node\";\n        const node = this.props.node\n        if (selMan.isSelected(node)) cls += \" selected\"\n        if (selMan.getDropTarget() === node) {\n            cls += \" drop-target\"\n            if(selMan.getDropType() === 'parent') cls += \" drop-parent\"\n        }\n        let arrow = \"\";\n        const prov = this.props.provider\n        if (prov.hasChildren(node)) {\n            const expanded = prov.isExpanded(node)\n            if (expanded) {\n                arrow = <button className=\"fa fa-caret-down fa-fw borderless\" onClick={this.toggleItemCollapsed}/>;\n            } else {\n                arrow = <button className=\"fa fa-caret-right fa-fw borderless\" onClick={this.toggleItemCollapsed}/>;\n            }\n        } else {\n            arrow = <span className=\"fa fa-fw borderless\"/>\n        }\n\n        return <div className={cls}\n                    onClick={this.onSelect}\n                    onContextMenu={this.onContextMenu}\n                    data-nodeid={node.id}\n                    onDragOver={this.onDragOver}\n                    onDrop={this.onDrop}\n        >\n            <span style={{\n                width:this.props.depth*1.5+'em'\n            }}></span>\n            {arrow}\n            {prov.getRendererForItem(node)}\n            <Spacer/>\n            {this.renderDragBars()}\n        </div>\n    }\n\n    renderDragBars() {\n        if(this.props.provider.canBeMoved && !this.props.provider.canBeMoved(this.props.node))  return \"\"\n        return <span className={\"drag fa fa-bars\"}\n              draggable\n              onDragStart={this.onDragStart}\n              onDragEnd={this.onDragEnd}\n        />\n\n    }\n}\n\n\n\nexport default class TreeTable extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            root:this.props.root,\n            dropTarget:null,\n            selection:null,\n            dragTarget:null,\n            internalDrag:false,\n        }\n    }\n    componentDidMount() {\n        this.listener = this.props.provider.on(TREE_ITEM_PROVIDER.EXPANDED_CHANGED,\n            (item)=>  this.setState({root:this.props.provider.getSceneRoot()}))\n        this.props.provider.on(TREE_ITEM_PROVIDER.STRUCTURE_ADDED,\n            (item)=>  this.setState({root:this.props.provider.getSceneRoot()}))\n        this.props.provider.on(TREE_ITEM_PROVIDER.STRUCTURE_CHANGED,\n            (item)=>  this.setState({root:this.props.provider.getSceneRoot()}))\n\n        this.other_listener = selMan.on(SELECTION_MANAGER.CHANGED, (sel)=> this.setState({selection:sel}))\n        selMan.on(SELECTION_MANAGER.DROP_TARGET_CHANGED, (sel) => this.setState({dropTarget:selMan.getDropTarget()}))\n    }\n    componentWillUnmount() {\n        this.props.provider.off(TREE_ITEM_PROVIDER.EXPANDED_CHANGED, this.listener)\n        selMan.off(SELECTION_MANAGER.CHANGED,this.other_listener)\n    }\n    componentWillReceiveProps(newProps) {\n        if(newProps.root) this.setState({root:newProps.root})\n    }\n\n    onDragStart = (e,item) => {\n        console.log('starting to drag the item',item)\n        e.dataTransfer.effectAllowed = \"move\";\n        e.dataTransfer.setData(\"text/html\", e.target.parentNode);\n        e.dataTransfer.setDragImage(e.target.parentNode, 20, 20);\n        e.dataTransfer.dropEffect = 'move'\n        this.setState({dragTarget:item, internalDrag:true})\n    }\n    onDragOver = (e,item) => {\n        if(!this.state.internalDrag) {\n            e.preventDefault()\n            if(this.props.provider.canAddExternalChild(item,e.dataTransfer)) {\n                selMan.setDropTarget(item)\n                selMan.setDropType('parent')\n            } else {\n                selMan.setDropType(null)\n                selMan.setDropTarget(null)\n            }\n            return\n        }\n        const prov = this.props.provider\n        if(prov.canAddChild(item,this.state.dragTarget)) {\n            //use the rop target as a parent\n            selMan.setDropTarget(item)\n            selMan.setDropType('parent')\n            return\n        } else if(prov.canBeSibling(item,this.state.dragTarget)) {\n            //use the drop target as a sibling\n            selMan.setDropType('sibling')\n            selMan.setDropTarget(item)\n        } else {\n            //no valid target\n            selMan.setDropType(null)\n            selMan.setDropTarget(null)\n        }\n    }\n    onDragEnd = (e,item) => {\n        //handle external case\n        if(!this.state.internalDrag){\n            this.setState({dragTarget:null, internalDrag:false})\n            e.preventDefault()\n            e.stopPropagation()\n            return\n        }\n\n        const graph = this.props.provider.getDataGraph()\n        if(!this.state.dragTarget) return\n        if(!this.state.dropTarget) return\n        const src = fetchGraphObject(graph,this.state.dragTarget)\n        const dst = fetchGraphObject(graph,this.state.dropTarget)\n\n\n        //can't drop onto self\n        if(dst.id === src.id) {\n            this.setState({dragTarget:null, internalDrag:false})\n            selMan.setDropTarget(null)\n            return\n        }\n\n\n        //remove from old location\n        removeFromParent(graph,src)\n\n        const dt = selMan.getDropType()\n        if(dt === 'parent') {\n            graph.setProperty(src.id,'parent',dst.id)\n            graph.insertAfter(dst.children,null,src.id)\n        } else {\n            const parent2 = fetchGraphObject(graph,dst.parent)\n            graph.setProperty(src.id, 'parent', parent2.id)\n            graph.insertAfter(parent2.children, dst.id, src.id)\n        }\n        this.setState({dragTarget:null})\n        selMan.setDropTarget(null)\n    }\n    onDrop = (e,item) => {\n        if(!this.state.internalDrag) {\n            e.stopPropagation()\n            e.preventDefault()\n            this.props.provider.acceptDrop(e,item)\n            this.setState({internalDrag:false, dragTarget:null})\n        }\n        // var data = e.dataTransfer.getData(\"text/html\");\n        // console.log('the dropped data is',data)\n    }\n    render() {\n        if(!this.state.root) return <ul>no root yet</ul>\n        const children = [];\n        this.generateChildren(this.state.root,children,0)\n        return <ul className='tree-table'>\n            {children.map((info,i)=>{\n                return <TreeTableItem key={i}\n                                      node={info.node}\n                                      depth={info.depth}\n                                      provider={this.props.provider}\n                                      selection={this.state.selection}\n                                      onDragStart={this.onDragStart}\n                                      onDragOver={this.onDragOver}\n                                      onDragEnd={this.onDragEnd}\n                                      onDrop={this.onDrop}\n                />\n            })}\n        </ul>\n    }\n\n    generateChildren = (root, chs,depth) => {\n        const prov = this.props.provider\n        chs.push({node:root, depth:depth})\n        if(!prov.hasChildren(root)) return\n        if(!prov.isExpanded(root)) return;\n        prov.getChildren(root).forEach((child)=>{\n            this.generateChildren(child,chs,depth+1)\n        })\n    }\n}\n\n","export const UNITS = {\n    PIXEL:{\n        name:'pixel',\n        matches:['pixel','pixels','px'],\n        short:'px'\n    },\n    MILLIMETER: {\n        name:'millimeter',\n        matches:['mm'],\n        short:'mm'\n    }\n}\nexport const DEFAULT_DPI = 72\n\nexport function parseDimension(str) {\n    if(str.value) str = str.value\n    // console.log(\"parsing dimension\",str)\n\n    const parts = str.trim().match(/(\\d+)\\s*x\\s*(\\d+)\\s*(px|mm)/)\n    // console.log(\"parsed parts\",parts)\n    if(parts[3] === 'px') {\n        return new Dimension(parseInt(parts[1]),parseInt(parts[2]),UNITS.PIXEL)\n    }\n    if(parts[3] === 'mm') {\n        return new Dimension(parseInt(parts[1]),parseInt(parts[2]),UNITS.MILLIMETER)\n    }\n    return new Dimension(100,100,UNITS.PIXEL)\n}\nexport class Dimension {\n    constructor(width,height,unit) {\n        this.width = width\n        this.height = height\n        this.unit = unit\n    }\n\n    as(unit, scale, dpi) {\n        if(this.unit.name === UNITS.MILLIMETER.name && unit.name===UNITS.PIXEL.name) {\n            const in_per_mm = 0.0393701\n            const px_per_in = dpi\n            return new Dimension(\n                this.width*in_per_mm*px_per_in*scale*1,  // 100mm at dpi of 76 is 76 px/in * mm/in 0.0393701\n                this.height*in_per_mm*px_per_in*scale*1,  // 100mm at dpi of 76 is 76 px/in * mm/in 0.0393701\n                unit\n            )\n        }\n        return new Dimension(\n            this.width*scale,\n            this.height*scale,\n            unit,\n        )\n    }\n}","import React, {Component} from \"react\";\nimport SelectionManager, {SELECTION_MANAGER} from \"../SelectionManager\";\nimport {TREE_ITEM_PROVIDER} from \"../TreeItemProvider\";\nimport {fetchGraphObject, propToArray} from \"../syncgraph/utils\";\nimport {makePoint} from '../utils'\nimport {UNITS, DEFAULT_DPI} from \"./Dimension\"\n\n\nexport class MetadocCanvas extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            pressed: false,\n            selection: null,\n            shape:null,\n            hsnap:null,\n            vsnap:null,\n        }\n        props.prov.onRawChange(e => {\n            if (this.props.list === -1) return\n            this.redraw()\n        })\n    }\n\n    selectionChanged = (sel) => this.setState({selection: sel})\n    componentDidMount() {\n        SelectionManager.on(SELECTION_MANAGER.CHANGED, this.selectionChanged)\n        this.props.prov.on(TREE_ITEM_PROVIDER.STRUCTURE_CHANGED, this.redraw)\n    }\n    componentWillUnmount() {\n        SelectionManager.off(SELECTION_MANAGER.CHANGED, this.selectionChanged)\n        this.props.prov.off(TREE_ITEM_PROVIDER.STRUCTURE_CHANGED, this.redraw)\n    }\n\n    toCanvas(e) {\n        const rect = e.target.getBoundingClientRect()\n        return makePoint(\n            Math.floor((e.clientX - rect.left) / this.props.scale),\n            Math.floor((e.clientY - rect.top) / this.props.scale))\n    }\n\n\n    componentDidUpdate(prevProps) {\n        this.redraw()\n    }\n\n    redraw = () => {\n        if(!this.canvas) return\n        const c = this.canvas.getContext('2d')\n        const size = this.props.prov.getPageSize(this.props.prov.getSelectedPage()).as(UNITS.PIXEL,this.props.scale,DEFAULT_DPI)\n        this.canvas.width = size.width\n        this.canvas.height = size.height\n        c.fillStyle = 'white'\n        c.fillRect(0, 0, this.canvas.width, this.canvas.height)\n        c.save()\n        c.scale(this.props.scale, this.props.scale)\n        const graph = this.props.prov.getRawGraph()\n        const page = this.props.prov.getSelectedPage()\n        if(page) this.drawPage(c,graph,page)\n        c.fillStyle = \"rgba(0,255,255,0.5)\"\n        if(this.state.hsnap) c.fillRect(this.state.hsnap.value - 1,0,2,this.canvas.height)\n        if(this.state.vsnap) c.fillRect(0, this.state.vsnap.value - 1,this.canvas.width,2)\n        c.restore()\n    }\n\n    drawPage(c,g,page) {\n        propToArray(g,page.children).forEach(id => this.drawLayer(c,g,fetchGraphObject(g,id)))\n    }\n\n    drawLayer(c,g,layer) {\n        propToArray(g,layer.children).forEach(id => this.drawShape(c,g,fetchGraphObject(g,id)))\n    }\n\n    drawShape(c,g,shape) {\n        const def = this.props.prov.getShapeDef(shape.type)\n        if(def) def.draw(c,g,shape,SelectionManager.getSelection() === shape.id,this.props.prov)\n    }\n\n    isInside(pt, objid) {\n        const graph = this.props.prov.getRawGraph()\n        const shape = fetchGraphObject(graph,objid)\n        const def = this.props.prov.getShapeDef(shape.type)\n        if(def) return def.isInside(pt,shape,this.canvas)\n        return false\n    }\n\n    onClick = (e) => {\n        const pt = this.toCanvas(e)\n        const shape = this.findShape(pt)\n        if (shape) this.props.onSelect(shape)\n    }\n\n    findShape(pt) {\n        const prov = this.props.prov\n        const layer = prov.getSelectedLayer()\n        if (!layer) return null\n        const graph = prov.getRawGraph()\n        const arr = propToArray(graph,layer.children)\n        arr.reverse()\n        return arr.find((ch)=> this.isInside(pt,ch))\n    }\n\n    mouseDown = (e) => {\n        this.props.prov.pauseQueue()\n        const pt = this.toCanvas(e)\n        const shapeid = this.findShape(pt)\n        if (shapeid) {\n            const shapeobj = fetchGraphObject(this.props.prov.getRawGraph(),shapeid)\n            this.setState({\n                pressed: true,\n                initial: makePoint(shapeobj.x,shapeobj.y).minus(pt),\n                start: pt,\n                shape: shapeid,\n            })\n        } else {\n            const layer = this.props.prov.getSelectedLayer()\n            if(layer) SelectionManager.setSelection(layer.id)\n        }\n    }\n    mouseMove = (e) => {\n        if (!this.state.pressed) return\n        let pt = this.toCanvas(e).add(this.state.initial)\n        pt = this.snap(pt)\n        const graph = this.props.prov.getRawGraph()\n        graph.process(this.props.prov.cmd.setProperty(this.state.shape, 'x', pt.x))\n        graph.process(this.props.prov.cmd.setProperty(this.state.shape, 'y', pt.y))\n    }\n    mouseUp = (e) => {\n        this.setState({pressed: false, hsnap:null, vsnap:null})\n        this.props.prov.unpauseQueue()\n    }\n\n    render() {\n        return <div className=\"panel\">\n            <canvas style={{border: '0px solid red'}}\n                    width={100} height={100} ref={(e) => this.canvas = e}\n                    onClick={this.onClick}\n                    onMouseDown={this.mouseDown}\n                    onMouseUp={this.mouseUp}\n                    onMouseMove={this.mouseMove}\n            ></canvas>\n        </div>\n    }\n\n    snap(pt) {\n        const EDGES = {\n            LEFT:'LEFT',\n            RIGHT:'RIGHT',\n            CENTER:'CENTER',\n            TOP:'TOP',\n            MIDDLE:'MIDDLE',\n            BOTTOM:'BOTTOM',\n            NONE:'NONE',\n        }\n\n        const snaps = [\n            {value:0,type:EDGES.LEFT},\n            {value:320,type:EDGES.CENTER},\n            {value:640,type:EDGES.RIGHT},\n            {value:0, type:EDGES.TOP},\n            {value:240, type:EDGES.MIDDLE},\n            {value:480, type:EDGES.BOTTOM},\n        ]\n        const SNAP_THRESHOLD = 20\n        function isNearH(pt,snap) {\n            if(snap.type === EDGES.LEFT && Math.abs(pt.x-snap.value) < SNAP_THRESHOLD) return EDGES.LEFT\n            if(snap.type === EDGES.CENTER && Math.abs(pt.x + pt.width/2 - snap.value) < SNAP_THRESHOLD) return EDGES.CENTER\n            if(snap.type === EDGES.RIGHT && Math.abs(pt.x + pt.width - snap.value) < SNAP_THRESHOLD) return EDGES.RIGHT\n            return EDGES.NONE\n        }\n        function isNearV(pt,snap) {\n            if(snap.type === EDGES.TOP && Math.abs(pt.y-snap.value) < SNAP_THRESHOLD) return EDGES.TOP\n            if(snap.type === EDGES.MIDDLE && Math.abs(pt.y + pt.height/2 -snap.value) < SNAP_THRESHOLD) return EDGES.MIDDLE\n            if(snap.type === EDGES.BOTTOM && Math.abs(pt.y + pt.height -snap.value) < SNAP_THRESHOLD) return EDGES.BOTTOM\n            return EDGES.NONE\n        }\n\n        const graph = this.props.prov.getRawGraph()\n        const shape = fetchGraphObject(graph,this.state.shape)\n        const def = this.props.prov.getShapeDef(shape.type)\n        let hsnap = null\n        let vsnap = null\n        if(def) {\n            const bounds = def.getBounds(pt,shape,this.canvas)\n            for(let i=0; i<snaps.length; i++)  {\n                const snap = snaps[i]\n                const nearH = isNearH(bounds,snap)\n                if(nearH === EDGES.LEFT)   pt.x = snap.value\n                if(nearH === EDGES.CENTER) pt.x = snap.value-bounds.width/2\n                if(nearH === EDGES.RIGHT)  pt.x = snap.value-bounds.width\n\n                const nearV = isNearV(bounds,snap)\n                if(nearV === EDGES.TOP)    pt.y = snap.value\n                if(nearV === EDGES.MIDDLE) pt.y = snap.value-bounds.height/2\n                if(nearV === EDGES.BOTTOM) pt.y = snap.value-bounds.height\n\n                if(nearH !== EDGES.NONE) hsnap = snap\n                if(nearV !== EDGES.NONE) vsnap = snap\n            }\n        }\n        this.setState({hsnap:hsnap, vsnap:vsnap})\n\n        return pt\n    }\n}\n","const {SET_PROPERTY, CREATE_PROPERTY, DELETE_PROPERTY,\n    CREATE_OBJECT, DELETE_OBJECT,\n    INSERT_ELEMENT, DELETE_ELEMENT\n} = require(\"syncing_protocol\");\n\nexport class UndoQueue {\n    constructor(graph) {\n        this.graph = graph\n        this.history = []\n        this.current = -1\n    }\n\n    submit(op) {\n        // console.log(\"UNDOREDO: submit\",op)\n        this.history.push(op)\n        this.current = this.history.length - 1\n    }\n\n    canUndo() {\n        return this.current >= 0\n    }\n\n    canRedo() {\n        return this.current < this.history.length - 1\n    }\n\n    undo() {\n        const last = this.history[this.current]\n        this.current--\n        // console.log(\"undoing\",last)\n        // this.history.forEach(op => console.log(short(op)))\n        if (last.type === SET_PROPERTY) {\n            if (!last.prevValue) {\n                console.warn(\"undoing set property without a previous value!\", last)\n                return\n            }\n            const op = {\n                type: SET_PROPERTY,\n                host: this.graph.getHostId(),\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                object: last.object,\n                name: last.name,\n                value: last.prevValue,\n            }\n            this.graph.process(op)\n            return\n        }\n        if (last.type === CREATE_PROPERTY) {\n            const op = {\n                type: DELETE_PROPERTY,\n                host: this.graph.getHostId(),\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                object: last.object,\n                name: last.name,\n            }\n            this.graph.process(op)\n            return\n        }\n        if (last.type === CREATE_OBJECT) {\n            const op = {\n                type: DELETE_OBJECT,\n                host: this.graph.getHostId(),\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                id: last.id,\n            }\n            this.graph.process(op)\n            return\n        }\n        if (last.type === INSERT_ELEMENT) {\n            const op = {\n                type: DELETE_ELEMENT,\n                host: this.graph.getHostId(),\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                array: last.array,\n                entry: last.entryid\n            }\n            this.graph.process(op)\n            return\n        }\n        throw new Error(`undo for type not supported: ${last.type}`)\n    }\n\n    redo() {\n        this.current++\n        const last = this.history[this.current]\n        // console.log(\"redoin\",this.current,last.type,last.name,'=',last.value)\n        if (last.type === SET_PROPERTY) {\n            const op = {\n                type: last.type,\n                host: last.host,\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                object: last.object,\n                name: last.name,\n                value: last.value\n            }\n            this.graph.process(op)\n            return\n        }\n        if (last.type === CREATE_PROPERTY) {\n            const op = {\n                type: last.type,\n                host: last.host,\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                object: last.object,\n                name: last.name,\n                value: last.value\n            }\n            this.graph.process(op)\n            return\n        }\n        if (last.type === CREATE_OBJECT) {\n            const op = {\n                type: last.type,\n                host: last.host,\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                id: last.id,\n            }\n            this.graph.process(op)\n            return\n        }\n        if (last.type === INSERT_ELEMENT) {\n            console.log(\"redoing\", last)\n            const op = {\n                type: last.type,\n                host: last.host,\n                seq: this.graph.nextSeq(),\n                timestamp: Date.now(),\n                array: last.array,\n                value: last.value,\n                entryid: this.graph.makeGUID(),\n                prev: -1,\n            }\n            this.graph.process(op)\n            return\n        }\n        throw new Error(`redo for type not supported: ${last.type}`)\n    }\n\n    dump() {\n        return this.history.map((op, i) => i + \" \" + op.type + \" \" + op.name + \" => \" + op.value)\n    }\n}\n","const {SET_PROPERTY} = require(\"syncing_protocol\");\n\n\nexport class EventCoalescer {\n    constructor(graph) {\n        this.graph = graph\n        this.listeners = []\n        this.rawlisteners = []\n        this.paused = false\n        this.buffer = []\n        this.first = {}\n        this.last = {}\n    }\n\n    pause() {\n        this.paused = true\n    }\n\n    unpause() {\n        this.paused = false\n        this.buffer = []\n        // console.log(\"need to send out set property updates\",this.last)\n        // console.log('the originals are',this.first)\n        Object.keys(this.last).forEach((key) => {\n            Object.keys(this.last[key]).forEach(name => {\n                const op = this.last[key][name]\n                // console.log(\"sending\",short(op))\n                op.prevValue = this.first[key][name].value\n                this.fire(op)\n                this.graph.process(op)\n            })\n        })\n\n        this.first = {}\n        this.last = {}\n\n        // console.log(this.graph.dumpGraph())\n        // this.graph.getHistory().forEach(h => console.log(h.type,h.name,h.value))\n    }\n\n    onChange = cb => this.listeners.push(cb)\n    onRawChange = cb => this.rawlisteners.push(cb)\n    fire = op => this.listeners.forEach(cb => cb(op))\n    fireRaw = op => this.rawlisteners.forEach(cb => cb(op))\n    getPropertiesForObject = (obj) => this.graph.getPropertiesForObject(obj)\n    getArrayLength = (obj) => this.graph.getArrayLength(obj)\n    getElementAt = (obj, index) => this.graph.getElementAt(obj, index)\n    getHostId = () => this.graph.getHostId()\n\n\n    getPropertyValue(obj, key) {\n        // console.log(\"checking\",this.paused,obj,key)\n        if (this.paused && this.last[obj] && this.last[obj][key]) {\n            // console.log(\"returning the raw property values\",this.last[obj][key])\n            return this.last[obj][key].value\n        } else {\n            return this.graph.getPropertyValue(obj, key)\n        }\n    }\n\n    bufferOp(op) {\n        if (!this.first[op.object]) this.first[op.object] = {}\n        if (!this.first[op.object][op.name]) this.first[op.object][op.name] = op\n        if (!this.last[op.object]) this.last[op.object] = {}\n        this.last[op.object][op.name] = op\n        this.buffer.push(op)\n        this.fireRaw(op)\n    }\n\n    process(op) {\n        if (op.type === SET_PROPERTY && this.paused) {\n            this.bufferOp(op)\n        } else {\n            this.fire(op)\n            this.graph.process(op)\n        }\n    }\n}\n","import PubNub from \"pubnub\";\nimport {AuthModule} from '../vr/AuthModule'\nfunction short(op) {\n    let str = `${op.type} ${op.uuid} |  `\n    if(op.name) {\n        str += `${op.name} = ${op.value}  prev = ${op.prevValue}`\n    }\n    return str\n}\nconst settings = {\n    publishKey: 'pub-c-1cba58da-c59a-4b8b-b756-09e9b33b1edd',\n    subscribeKey: 'sub-c-39263f3a-f6fb-11e7-847e-5ef6eb1f4733',\n}\n\nexport class PubnubSyncWrapper {\n    constructor(provider, graph) {\n        if(!provider) throw new Error('created PubnubSyncWrapper without a provider')\n        if(!graph) throw new Error('created PubnubSyncWrapper without a graph')\n        this.paused = false\n        this.buffer = []\n        this.provider = provider\n\n        graph.onChange((e)=>this.handleGraphChange(e))\n\n        this.pubnub = new PubNub(settings)\n    }\n\n    calculateChannelName() {\n        return \"metadoc-docupdate-\" + this.provider.getDocId() + \"_\"+AuthModule.getServerID()\n    }\n    calculateLoggerChannelName() {\n        return \"metadoc-log-\" + this.provider.getDocId()+\"_\"+AuthModule.getServerID()\n    }\n\n    start() {\n        this.pubnub.addListener({\n            status: (e) => {\n                // console.log(e)\n                if (e.operation === 'PNSubscribeOperation' && e.category === 'PNConnectedCategory') {\n                    this.sendHistoryRequest()\n                }\n            },\n            message: (m)=>this.handleMessage(m),\n        })\n\n        this.pubnub.subscribe({channels: [this.calculateChannelName(),this.calculateLoggerChannelName()]})\n    }\n\n    pause() {\n        this.paused = true\n    }\n\n    unpause() {\n        this.paused = false\n        // console.log(\"we need to send the waiting messages\", this.buffer)\n        this.buffer.forEach(op => this.sendMessage(op))\n        this.buffer = []\n        //now request history from the network for anything we missed\n        // this.sendHistoryRequest()\n    }\n\n    shutdown() {\n        this.pubnub.unsubscribe({channels: [this.calculateChannelName()]})\n        this.pubnub.stop()\n    }\n\n    sendMessage(e) {\n        console.log(\"PN_SEND:\", short(e))\n        this.pubnub.publish({\n            channel: this.calculateChannelName(),\n            message: e\n        }, (status, response) => {\n            // console.log(\"published\",status,response)\n        })\n\n    }\n\n    handleGraphChange (e) {\n        // console.log(\"graph changed\",e)\n        const host = this.provider.getDataGraph().getHostId()\n        if (e.host !== host) return\n        if (this.paused) return this.buffer.push(e)\n        this.sendMessage(e)\n    }\n\n    sendHistoryRequest() {\n        // console.log(\"sending a history request\")\n        this.pubnub.publish({\n            channel: this.calculateChannelName(),\n            message: {\n                type: 'GET_HISTORY',\n                host: this.provider.getDataGraph().getHostId()\n            }\n        })\n    }\n\n    handleGetHistory() {\n        // console.log(\"need to send out the history\")\n        const graph = this.provider.getDataGraph()\n        const hist = graph.getHistory().slice()\n        console.log(hist)\n        const chunkSize = 30\n        let count = 0\n        while (hist.length > 0) {\n            if (count > 100) {\n                console.log(\"breaking out. possible infinite loop\")\n                break\n            }\n            count++\n            const chunk = hist.splice(0, chunkSize)\n            console.log(\"sending\", chunk.length, chunk)\n            this.pubnub.publish({\n                channel: this.calculateChannelName(),\n                message: {\n                    type: 'SEND_HISTORY',\n                    host: graph.getHostId(),\n                    history: chunk\n                }\n            }, (status, response) => {\n                console.log(\"published\", status, response)\n            })\n        }\n\n    }\n\n    handleReceiveHistory(msg) {\n        // console.log(\"got some history\", msg.history.length)\n        msg.history.forEach(op => this.provider.getDataGraph().process(op))\n    }\n\n\n    handleMessage (evt) {\n        if (this.paused) return\n//        console.log(\"channel is\",evt.channel)\n        if(evt.channel === this.calculateLoggerChannelName()) {\n            if(evt.publisher !== this.pubnub.getUUID()) {\n                if(evt.message.length) {\n                    console.log(\"REMOTE LOGGER\",...evt.message)\n                } else {\n                    console.log(\"REMOTE LOGGER\", evt.message)\n                }\n            }\n            return\n        }\n        const graph = this.provider.getDataGraph()\n        // console.log('PN_REMOTE',evt)\n        if (evt.message.type === 'GET_HISTORY') {\n            // console.log(\"got a history request\",evt.message.host, graph.getHostId())\n            if (evt.message.host !== graph.getHostId()) {\n                return this.handleGetHistory()\n            }\n            return\n        }\n        if (evt.message.type === 'SEND_HISTORY') {\n            if (evt.message.host !== graph.getHostId()) {\n                return this.handleReceiveHistory(evt.message)\n            }\n            return\n        }\n        const op = evt.message\n        if (!op.host) return console.log(\"received a message without a host\", op)\n        if (!op.timestamp) return console.error(\"received a message without a timestamp\", op)\n        if (op.host && op.host === graph.getHostId()) {\n            // console.log(\"SKIP: my own message came in. ignoring it\")\n            return\n        }\n        console.log(\"REMOTE\", op)\n        graph.process(op)\n    }\n\n    getLogger() {\n        return new PubnubLogger(this.provider.getDocId(),this.pubnub)\n    }\n}\n\n\nexport class PubnubLogger {\n    constructor(docid, pubnub) {\n        this.count = 0\n        this.docid = docid\n        if(!pubnub) {\n            this.pubnub = new PubNub(settings)\n        } else {\n            this.pubnub = pubnub\n        }\n    }\n    calculateLoggerChannelName() {\n        return \"metadoc-log-\" + this.docid+\"_\"+AuthModule.getServerID()\n    }\n    log() {\n        console.log(\"LOGGER\",...arguments)\n        this.pubnub.publish({\n            channel:this.calculateLoggerChannelName(),\n            message:Array.from(arguments).concat(this.count++)\n        })\n    }\n    error () {\n        console.log(\"LOGGER ERROR\",...arguments)\n        this.pubnub.publish({\n            channel:this.calculateLoggerChannelName(),\n            message:Array.from(arguments).concat(this.count++)\n        })\n    }\n}\n\nexport class ConsoleLogger {\n    constructor() {\n\n    }\n    log() {\n        console.log(\"DUMMY LOGGER\",...arguments)\n    }\n    error () {\n        console.log(\"DUMMY LOGGER ERROR\",...arguments)\n    }\n}","import React, {Component} from 'react'\n\nexport  class Dialog extends Component {\n    clickedScrim = (e) => {\n        if(e.target !== this.scrim) return\n        if(this.props.onScrimClick) this.props.onScrimClick(e)\n    }\n    render() {\n        if(!this.props.visible) return <div/>;\n        const bodyStyle = {}\n        if(this.props.width) bodyStyle.width = this.props.width\n        if(this.props.height) bodyStyle.height = this.props.height\n        return <div className={\"ac-dialog-scrim\"} ref={(scrim)=>this.scrim=scrim} onClick={this.clickedScrim}>\n            <div className={\"ac-dialog-body\"} style={bodyStyle}>{this.props.children}</div>\n        </div>\n\n    }\n}\n","import React, {Component} from 'react'\nimport {DialogManager, HBox, VBox} from 'appy-comps'\nimport {Dialog} from '../common/Dialog'\n\nexport class MissingDocDialog extends Component {\n\n    cancel = () => {\n        DialogManager.hide()\n    }\n\n    okay = () => {\n        DialogManager.hide()\n        this.props.provider.createNewDocument(this.props.docid)\n    }\n\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n            <VBox grow>\n                <h3>Document \"<b>{this.props.docid}</b>\" not found</h3>\n                <VBox grow>\n                    Create a new document?\n                </VBox>\n                <HBox>\n                    <button onClick={this.cancel}>cancel</button>\n                    <button onClick={this.okay}>okay</button>\n                </HBox>\n            </VBox>\n        </Dialog>\n    }\n\n}","import TreeItemProvider, {getDocsURL, TREE_ITEM_PROVIDER} from '../TreeItemProvider'\nimport {setQuery, toQueryString} from '../utils'\nimport {UndoQueue} from './UndoQueue'\nimport {EventCoalescer} from '../metadoc/EventCoalescer'\nimport SelectionManager from '../SelectionManager'\nimport {PubnubSyncWrapper} from './PubnubSyncWrapper'\nimport {propToArray} from \"./utils\";\nimport * as ToasterMananager from '../vr/ToasterManager'\nimport {DialogManager} from 'appy-comps'\nimport {MissingDocDialog} from './MissingDocDialog'\nimport React from 'react'\nimport {AuthModule} from '../vr/AuthModule'\n\nconst {DocGraph, CommandGenerator, toDocGraphFromObjectGraph, toObjectGraphFromDocGraph} = require(\"syncing_protocol\");\n\n\n\nexport default class SyncGraphProvider extends TreeItemProvider {\n    constructor(options) {\n        super(options)\n        this.options = options || {}\n        this.mode = options.mode || 'edit'\n        this.datalisteners = []\n        this.rawlisteners = []\n        this.expanded = {}\n\n        if(options.doc) {\n            this.loadDoc(options.doc)\n        } else {\n            this.createNewDocument()\n        }\n    }\n    getDocTitle = () => \"untitled\"\n    getDocHistory = () => this.getDataGraph().getHistory()\n    getDocGraph = () => {\n        const root = this.getDataGraph().getObjectByProperty('type','root')\n        return toObjectGraphFromDocGraph(this.getDataGraph(),root)\n    }\n    onRawChange = cb => this.rawlisteners.push(cb)\n    getRawGraph = () => this.coalescer\n    getDataGraph = () => this.syncdoc\n    getSceneRoot = () => this.getDataGraph().getObjectByProperty('type','root')\n    hasChildren = (item) => item && this.getDataGraph().hasPropertyValue(item,'children')\n    getChildren = (item) => {\n        const doc = this.getDataGraph()\n        return propToArray(doc,doc.getPropertyValue(item,'children'))\n    }\n    isExpanded = (item) => {\n        if (typeof this.expanded[item] === 'undefined') this.expanded[item] = true;\n        return this.expanded[item]\n    }\n    toggleItemCollapsed(item) {\n        const current = this.isExpanded(item);\n        this.expanded[item] = !current;\n        this.fire(TREE_ITEM_PROVIDER.EXPANDED_CHANGED,item);\n    }\n\n    setPropertyValue(item, def, value) {\n        const op = this.cmd.setProperty(item,def.key,value)\n        op.prevValue = def.value\n        this.getRawGraph().process(op)\n        this.fire(TREE_ITEM_PROVIDER.PROPERTY_CHANGED,{\n            provider: this,\n            child:item,\n            propKey:def.key,\n            oldValue:def.value,\n            newValue:value\n        })\n    }\n\n    save = (e) => {\n        if(e) e.preventDefault()\n        const payload_obj = {\n            history:this.getDocHistory(),\n            type:this.getDocType(),\n            id:this.getDocId(),\n            graph:this.getDocGraph(),\n            title:this.getDocTitle(),\n        }\n        const payload_string = JSON.stringify(payload_obj)\n        ToasterMananager.add('saving')\n        const opts = {\n            type:this.getDocType(),\n            title:this.getDocTitle(),\n        }\n        const url = getDocsURL()+this.getDocId()+'?'+toQueryString(opts)\n        console.log(`saving ${payload_string.length} chars to ${url}`, payload_obj)\n        return AuthModule.fetch(url,{\n            method:'POST',\n            body:payload_string,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            },\n        })\n            .then(res=>res.json())\n            .then(res => {\n                console.log(\"got back result\",res)\n                setQuery({mode:this.mode,doc:this.getDocId(), doctype:this.getDocType()})\n                ToasterMananager.add(res.message)\n                this.fire(TREE_ITEM_PROVIDER.SAVED,true)\n            }).catch((e)=> console.log(\"error\",e))\n    }\n\n    loadDoc(docid) {\n        return AuthModule.getJSON(getDocsURL()+docid)\n            .then((payload)=>{\n                console.log(\"got the payload\",payload)\n                if(!payload.id) return this.showMissingDocDialog(docid)\n                const doc = this.makeDocFromServerHistory(payload.history)\n                return this.setupDocFlow(doc,docid)\n            })\n            .catch((e)=> {\n                console.error(\"there was an error loading doc\", docid, e)\n                console.log(\"trying to load again without the history\")\n                return AuthModule.getJSON(getDocsURL() + docid)\n                    .then((payload) => {\n                        console.log(\"got the payload\", payload)\n                        const doc = this.makeDocFromServerGraph(payload.graph)\n                        return this.setupDocFlow(doc, docid)\n                    })\n            }).catch((e) => {\n                console.error(\"there was an error loading doc\", docid, e)\n                const doc = new DocGraph()\n                this.makeEmptyRoot(doc)\n                this.setupDocFlow(doc,this.genID('doc'))\n            })\n    }\n\n    createNewDocument(docid) {\n        if(!docid) docid = this.genID(\"doc\")\n        const doc = new DocGraph()\n        this.makeEmptyRoot(doc)\n        this.setupDocFlow(doc,docid)\n    }\n\n    setupDocFlow(doc,docid) {\n        //shut down old network connection\n        if(this.pubnub) this.pubnub.shutdown()\n        this.pubnub = null\n\n        this.syncdoc = doc\n        this.cmd = new CommandGenerator(this.syncdoc)\n        this.root = this.getSceneRoot()\n        this.docid = docid\n        this.undoqueue = new UndoQueue(doc)\n        this.coalescer = new EventCoalescer(this.syncdoc) //sends calls on to sync doc, and fires change event\n        this.coalescer.onChange((op) => this.undoqueue.submit(op))\n\n        this.coalescer.onRawChange(op =>this.rawlisteners.forEach(cb => cb(op)))\n        this.syncdoc.onChange(op => this.rawlisteners.forEach(cb => cb(op)))\n        this.syncdoc.onChange((op)=>{\n            this.fire(TREE_ITEM_PROVIDER.STRUCTURE_CHANGED, { provider:this });\n            this.fire(TREE_ITEM_PROVIDER.PROPERTY_CHANGED, { provider:this });\n        })\n        this.fire(TREE_ITEM_PROVIDER.STRUCTURE_CHANGED, { provider:this });\n        this.fire(TREE_ITEM_PROVIDER.CLEAR_DIRTY,true)\n        SelectionManager.clearSelection()\n        this.pubnub = new PubnubSyncWrapper(this,this.syncdoc)\n        this.pubnub.unpause()\n        this.pubnub.start()\n        return this.docLoaded().then(()=>{\n            this.fire(TREE_ITEM_PROVIDER.DOCUMENT_SWAPPED,{provider:this})\n            setQuery({mode:this.mode,doc:this.getDocId(), doctype:this.getDocType()})\n            this.connected = true\n            this.fire(\"CONNECTED\",this.connected)\n        })\n    }\n\n    reloadDocument() {\n        return AuthModule.getJSON(getDocsURL()+this.docid).then((payload)=>{\n            if(payload.type !== this.getDocType()) throw new Error(\"incorrect doctype for this provider\",payload.type)\n            const doc = this.makeDocFromServerHistory(payload.history)\n            this.setupDocFlow(doc,this.docid)\n        }).catch((e)=>{\n            console.error(\"couldn't reload the doc\",e)\n            const doc = new DocGraph()\n            this.makeEmptyRoot(doc)\n            this.setupDocFlow(doc,this.genID('doc'))\n        })\n\n    }\n\n    duplicateDocument(title) {\n        const newDocId = this.genID(\"doc\")\n        this.save().then(()=> {\n            this.docid = newDocId\n            this.setDocTitle(title)\n            const graph = this.getDocGraph()\n            const new_doc = new DocGraph()\n            const new_root = toDocGraphFromObjectGraph(graph,new_doc)\n            this.syncdoc = new_doc\n            return this.save()\n        }).then(()=>{\n            ToasterMananager.add('duplicating doc')\n            return this.loadDoc(newDocId)\n        })\n    }\n\n    docLoaded = () => {\n        return Promise.resolve()\n    }\n\n    toggleConnected = () => {\n        this.connected = !this.connected\n        if(this.pubnub) {\n            if(this.connected) {\n                this.pubnub.unpause()\n            } else {\n                this.pubnub.pause()\n            }\n        }\n        this.fire(\"CONNECTED\",this.connected)\n    }\n\n    isConnected = () => this.connected\n\n    pauseQueue = () => this.coalescer.pause()\n    unpauseQueue = () => this.coalescer.unpause()\n\n    performUndo = (e) => {\n        if(e && e.preventDefault) e.preventDefault()\n\n        if(this.undoqueue.canUndo()) {\n            this.undoqueue.undo()\n        } else {\n            console.warn(\"at beginnning of the undo queue\")\n        }\n    }\n    performRedo = (e) => {\n        if(e && e.preventDefault) e.preventDefault()\n        if(this.undoqueue.canRedo()) this.undoqueue.redo()\n    }\n\n    makeDocFromServerHistory(history) {\n        const doc = new DocGraph()\n        history.forEach(op => doc.process(op))\n        return doc\n    }\n\n\n    showMissingDocDialog(docid) {\n        DialogManager.show(<MissingDocDialog docid={docid} provider={this}/>)\n    }\n\n    makeDocFromServerGraph(graph) {\n        console.log(\"Making Doc from Server Graph\",graph)\n        const doc = new DocGraph()\n        toDocGraphFromObjectGraph(graph,doc)\n        return doc\n    }\n}\n","\nexport default class InputManager {\n    static KEYS = {\n        S:83,\n        Z:90,\n        C:67,\n        V:86,\n        X:88,\n        LEFT_ARROW:37,\n        RIGHT_ARROW:39,\n    }\n    static MODIFIERS = {\n        COMMAND:'COMMAND',\n        SHIFT:'SHIFT'\n    }\n\n    constructor() {\n        this.bindings = []\n        this.listeners = {}\n    }\n\n    addKeyBinding(binding) {\n        this.bindings.push(binding)\n    }\n    addListener(name,cb) {\n        if(!this.listeners[name]) {\n            this.listeners[name] = []\n        }\n        this.listeners[name].push(cb)\n    }\n\n    attachKeyEvents(document) {\n        document.addEventListener('keydown',this.keyDown)\n    }\n\n    keyDown = (e)=>{\n        // console.log(\"-------------\")\n        // console.log(\"got a key press\",e.shiftKey, e.metaKey, e.key, e.keyCode)\n        const matches = this.bindings.filter((b)=>b.key === e.keyCode)\n        // console.log(\"got the bindings\",matches)\n        const m2 = matches.filter((b)=>{\n            let valid = true\n            b.modifiers.forEach((mod)=>{\n                if(mod === InputManager.MODIFIERS.COMMAND && !e.metaKey) {\n                    // console.log(\"missing the meta key\");\n                    valid = false\n                }\n                if(mod === InputManager.MODIFIERS.SHIFT && !e.shiftKey) {\n                    // console.log(\"missing the shift key\");\n                    valid = false\n                }\n            })\n            if(e.shiftKey && !b.modifiers.some(mod=>mod === InputManager.MODIFIERS.SHIFT)) {\n                // console.log(\"shift is down, but missing shift in the def\")\n                valid = false\n            }\n            // console.log(\"still valid\",valid)\n            return valid\n        })\n        // console.log(\"final list is\",m2.length)\n        if(m2.length > 0) {\n            // console.log(\"something matched\")\n            // e.preventDefault()\n            this.dispatchEvents(m2,e)\n        }\n    }\n    dispatchEvents(matches,e) {\n        matches.forEach((bind)=>{\n            if(this.listeners[bind.id]) this.listeners[bind.id].forEach((cb)=>cb?cb(e):null)\n        })\n    }\n}\n","import {fetchGraphObject} from \"../syncgraph/utils\";\n\nexport default class RectDef {\n    make(graph,layer) {\n        return fetchGraphObject(graph,graph.createObject({\n            type:'rect',\n            title:'second rect',\n            x: 100,\n            y: 100,\n            rx:20,\n            ry:20,\n            width: 100,\n            height: 100,\n            fillColor: '#ff00ff',\n            parent:layer.id,\n        }))\n    }\n\n    draw(c,g,shape,selected) {\n        c.fillStyle = 'gray'\n        c.fillStyle = shape.fillColor\n        if(shape.rx > 0 || shape.ry > 0) {\n            const c0 = {x:shape.x,y:shape.y}\n            const c1 = {x:shape.x+shape.width, y:shape.y}\n            const c2 = {x:shape.x+shape.width, y:shape.y+shape.height}\n            const c3 = {x:shape.x, y:shape.y+shape.height}\n            c.beginPath()\n            c.moveTo(c0.x+shape.rx,c0.y)\n            c.lineTo(c1.x-shape.rx,c1.y)\n            c.quadraticCurveTo(c1.x,c1.y, c1.x,c1.y+shape.ry)\n            c.lineTo(c2.x,c2.y-shape.ry)\n            c.quadraticCurveTo(c2.x,c2.y, c2.x-shape.rx,c2.y)\n            c.lineTo(c3.x+shape.rx,c3.y)\n            c.quadraticCurveTo(c3.x,c3.y, c3.x,c3.y-shape.ry)\n            c.lineTo(c0.x,c0.y+shape.ry)\n            c.quadraticCurveTo(c0.x,c0.y, c0.x+shape.rx,c0.y)\n            c.closePath()\n            c.fill()\n        } else {\n            c.fillRect(shape.x, shape.y, shape.width, shape.height)\n        }\n\n        if (selected) {\n            c.strokeStyle = 'red'\n            c.strokeRect(shape.x+0.5,shape.y+0.5,shape.width, shape.height)\n        }\n\n    }\n\n    isInside(pt,shape) {\n        if (pt.x < shape.x) return false\n        if (pt.x > shape.x + shape.width) return false\n        if (pt.y < shape.y) return false\n        if (pt.y > shape.y + shape.height) return false\n        return true\n    }\n\n    getBounds(newOrigin,shape) {\n        return {\n            x:newOrigin.x,\n            y:newOrigin.y,\n            width:shape.width,\n            height:shape.height,\n        }\n    }\n\n    toSVGString(obj) {\n        return `<rect x=\"${obj.x}\" y=\"${obj.y}\" width=\"${obj.width}\" height=\"${obj.height}\" fill=\"${obj.fillColor}\"/>`\n    }\n\n}\n","import {createGraphObjectFromObject, fetchGraphObject} from \"../syncgraph/utils\";\n\nexport default class CircleDef {\n    make(graph,layer) {\n        return fetchGraphObject(graph,createGraphObjectFromObject(graph, {\n            type: 'circle',\n            title: 'circle',\n            x: 100,\n            y: 100,\n            radius: 50,\n            fillColor: '#ffff00',\n            parent: layer.id,\n        }))\n    }\n\n\n    draw(c,g,shape,selected) {\n        c.fillStyle = 'gray'\n        c.fillStyle = shape.fillColor\n        c.beginPath()\n        c.arc(shape.x, shape.y, shape.radius, 0, Math.PI*2)\n        c.fill()\n        if (selected) {\n            c.strokeStyle = 'red'\n            c.strokeRect(shape.x-shape.radius+0.5,shape.y-shape.radius+0.5,shape.radius*2, shape.radius*2)\n        }\n    }\n\n    isInside(pt,shape) {\n        if(Math.pow(shape.x-pt.x,2) + Math.pow(shape.y - pt.y,2) < Math.pow(shape.radius,2)) return true\n        return false\n    }\n\n    getBounds(newOrigin,shape, canvas) {\n        return {\n            x:newOrigin.x,\n            y:newOrigin.y,\n            width:shape.radius*2,\n            height:shape.radius*2,\n        }\n    }\n\n    toSVGString(obj) {\n        return `<circle cx=\"${obj.x}\" cy=\"${obj.y}\" r=\"${obj.radius}\" fill=\"${obj.fillColor}\"/>`\n    }\n\n}\n","import {fetchGraphObject} from \"../syncgraph/utils\";\nimport {FONT_STYLES, FONT_WEIGHTS, HORIZONTAL_ALIGNMENT, STANDARD_FONTS, VERTICAL_ALIGNMENT} from \"./Common\";\n\nexport default class TextDef {\n    make(graph,layer) {\n        const text = fetchGraphObject(graph,graph.createObject({\n            type:'text',\n            title:'text',\n\n            text:'title text',\n\n            horizontalAlign:HORIZONTAL_ALIGNMENT.CENTER,\n            verticalAlign:VERTICAL_ALIGNMENT.BASELINE,\n            autoFit:true,\n            fontSize:30,\n            fontFamily:STANDARD_FONTS.SANSSERIF,\n            fontWeight:FONT_WEIGHTS.NORMAL,\n            fontStyle:FONT_STYLES.NORMAL,\n\n            x: 100,\n            y: 100,\n            width: 200,\n            height: 120,\n            fillColor: '#ff00ff',\n            parent:layer.id,\n        }))\n        return text\n    }\n\n    draw(c,g,shape,selected) {\n        //calculate the general line metrics\n        const {lines, size_px, total_height, total_width} = this.calculateLines(shape,c)\n        //add offsets for alignment\n        lines.forEach((line,i) => {\n            const lines_height = lines.length*size_px\n            line.xoff = 0\n            if(shape.horizontalAlign === HORIZONTAL_ALIGNMENT.LEFT)   line.xoff = 0\n            if(shape.horizontalAlign === HORIZONTAL_ALIGNMENT.CENTER) line.xoff = (total_width - line.width)/2\n            if(shape.horizontalAlign === HORIZONTAL_ALIGNMENT.RIGHT)  line.xoff = total_width  - line.width\n            if(shape.verticalAlign === VERTICAL_ALIGNMENT.TOP)        line.yoff = 0\n            if(shape.verticalAlign === VERTICAL_ALIGNMENT.CENTER)     line.yoff = (total_height- lines_height)/2\n            if(shape.verticalAlign === VERTICAL_ALIGNMENT.BASELINE)   line.yoff = total_height - lines_height\n            if(shape.verticalAlign === VERTICAL_ALIGNMENT.BOTTOM)     line.yoff = total_height - lines_height\n            line.yoff += (i+1)*line.height\n        })\n\n        //draw text\n        c.fillStyle = shape.fillColor\n        lines.forEach((line,i) => c.fillText(line.text,shape.x+line.xoff,shape.y+ line.yoff))\n        //draw outline\n        if (selected) {\n            c.strokeStyle = 'red'\n            c.strokeRect(shape.x + 0.5, shape.y + 0.5, total_width, total_height)\n        }\n    }\n\n    calculateLines(shape,c) {\n        const size_px = parseFloat(shape.fontSize)\n        c.font = `normal ${size_px}px sans-serif`\n        const lines = shape.text.split(\"\\n\").map(text => {\n            return {\n                text:text,\n                width: c.measureText(text).width,\n                height: size_px\n            }\n        })\n\n        let total_width = 0\n        let total_height = 0\n        if(shape.autoFit) {\n            total_width = lines.reduce((max, line) => Math.max(max,line.width),0)\n            total_height = lines.reduce((total,line) => total + line.height,0)\n        } else {\n            total_width = shape.width\n            total_height = shape.height\n        }\n        return {\n            total_width:total_width,\n            total_height: total_height,\n            lines:lines,\n            size_px:size_px\n        }\n    }\n\n    insideRect(pt,x,y,w,h) {\n        if (pt.x < x) return false\n        if (pt.x > x + w) return false\n        if (pt.y < y) return false\n        if (pt.y > y + h) return false\n        return true\n    }\n\n    isInside(pt,shape, canvas) {\n        const c = canvas.getContext('2d')\n        const {total_width, total_height} = this.calculateLines(shape,c)\n        return this.insideRect(pt,shape.x,shape.y,total_width,total_height)\n    }\n\n    getBounds(newOrigin,shape, canvas) {\n        const c = canvas.getContext('2d')\n        const {total_width, total_height} = this.calculateLines(shape,c)\n        return {\n            x:newOrigin.x,\n            y:newOrigin.y,\n            width:total_width,\n            height:total_height,\n        }\n    }\n\n\n    toSVGString(obj) {\n        return `<text x=\"${obj.x}\" y=\"${obj.y}\"\n                     fill=\"${obj.fillColor}\" fontSize=\"${obj.fontSize}\"\n                     fontFamily=\"${obj.fontFamily}\"\n                >${obj.text}</text>`\n    }\n\n}\n","import {fetchGraphObject} from \"../syncgraph/utils\";\n\nexport default class ImageDef {\n    make(graph,layer) {\n        return fetchGraphObject(graph,graph.createObject({\n            type:'image',\n            title:'image',\n            x: 100,\n            y: 100,\n            width: 50,\n            height: 50,\n            asset:0,\n            parent:layer.id,\n        }))\n    }\n\n    draw(c,g,shape,selected, provider) {\n        if(shape.asset) {\n            const src = g.getPropertyValue(shape.asset,'src')\n            if(provider.isImageCached(src)) {\n                c.drawImage(provider.getCachedImage(src),shape.x,shape.y,shape.width,shape.height)\n            } else {\n                provider.requestImageCache(src)\n                c.fillStyle = 'aqua'\n                c.fillRect(shape.x,shape.y,shape.width,shape.height)\n            }\n        } else {\n            c.fillStyle = 'aqua'\n            c.fillRect(shape.x,shape.y,shape.width,shape.height)\n        }\n        if (selected) {\n            c.strokeStyle = 'red'\n            c.strokeRect(shape.x+0.5,shape.y+0.5,shape.width, shape.height)\n        }\n    }\n\n    isInside(pt,shape) {\n        if (pt.x < shape.x) return false\n        if (pt.x > shape.x + shape.width) return false\n        if (pt.y < shape.y) return false\n        if (pt.y > shape.y + shape.height) return false\n        return true\n    }\n    toSVGString(obj,prov) {\n        console.log('serializing',obj,prov)\n        const asset = fetchGraphObject(prov.getDataGraph(),obj.asset)\n        console.log('asset is',asset)\n        // return `<rect x=\"${obj.x}\" y=\"${obj.y}\" width=\"${obj.width}\" height=\"${obj.height}\" fill=\"${obj.fillColor}\"/>`\n        return `<image xlinkHref=\"${asset.src}\"\n                      width=\"${obj.width}\" height=\"${obj.height}\"\n        />`\n\n    }\n}\n","import {TYPES} from \"../common/PropSheet\";\nimport RectDef from \"./RectDef\";\nimport CircleDef from \"./CircleDef\";\nimport TextDef from \"./TextDef\";\nimport ImageDef from \"./ImageDef\";\n\nexport const PROP_DEFS = {\n    title: {\n        key:'title',\n        name:'Title',\n        type:TYPES.STRING\n    },\n    x: {\n        key:'x',\n        name:'X',\n        type:TYPES.NUMBER\n    },\n    y: {\n        key:'y',\n        name:'Y',\n        type:TYPES.NUMBER\n    },\n    rx: {\n        key:'rx',\n        name:'RX',\n        type:TYPES.NUMBER\n    },\n    ry: {\n        key:'ry',\n        name:'RY',\n        type:TYPES.NUMBER\n    },\n    fillColor: {\n        key:'fillColor',\n        name:'color',\n        type:TYPES.COLOR,\n        custom:true,\n    },\n    width: {\n        key:'width',\n        name:'Width',\n        type:TYPES.NUMBER\n    },\n    height: {\n        key:'height',\n        name:'Height',\n        type:TYPES.NUMBER\n    },\n    radius: {\n        key:'radius',\n        name:'Radius',\n        type:TYPES.NUMBER\n    },\n    text: {\n        key:'text',\n        name:'text',\n        type:TYPES.STRING,\n        hints: {\n            multiline:true\n        }\n    },\n    src: {\n        key:'src',\n        name:'src',\n        type:TYPES.STRING,\n    },\n    asset: {\n        key:'asset',\n        name:'asset',\n        type:TYPES.ENUM,\n    },\n    subtype: {\n        key:'subtype',\n        name:'kind',\n        type:TYPES.STRING,\n        locked:true,\n    },\n    format: {\n        key:'format',\n        name:'format',\n        type:TYPES.STRING,\n        locked:true,\n    },\n\n    autoFit: {\n        key:'autoFit',\n        name:'Size to Fit',\n        type:TYPES.BOOLEAN,\n        locked:false,\n    },\n    fontSize: {\n        key:'fontSize',\n        name:'Font Size',\n        type:TYPES.STRING,\n        locked:false,\n    },\n    fontFamily: {\n        key:'fontFamily',\n        name:'Font Family',\n        type:TYPES.ENUM,\n        locked:true,\n    },\n    fontWeight: {\n        key:'fontWeight',\n        name:'Font Weight',\n        type:TYPES.ENUM,\n        locked:true,\n    },\n    fontStyle: {\n        key:'fontStyle',\n        name:'Font Style',\n        type:TYPES.ENUM,\n        locked:true,\n    },\n    horizontalAlign: {\n        key:'horizontalAlign',\n        name:'H Align',\n        type:TYPES.ENUM,\n        locked:false,\n    },\n    verticalAlign: {\n        key:'verticalAlign',\n        name:'V Align',\n        type:TYPES.ENUM,\n        locked:false,\n    },\n    pageSize: {\n        key:'pageSize',\n        name:'Size',\n        type:TYPES.STRING,\n        locked:false,\n        custom:true,\n    }\n}\n\nexport const SHAPE_DEFS = {\n    rect: new RectDef(),\n    circle: new CircleDef(),\n    text: new TextDef(),\n    image: new ImageDef(),\n}\n\nexport const ICONS = {\n    page:'file',\n    layer:'sticky-note',\n    rect:'square',\n    circle:'circle',\n    text:'font',\n    plane:'plane',\n    image:'image',\n    model:'cube',\n    cut:'cut',\n    copy:'copy',\n    paste:'paste',\n    delete:'close'\n}\n\nexport const VERTICAL_ALIGNMENT = {\n    TOP:'TOP',\n    BASELINE:'BASELINE',\n    CENTER:'CENTER',\n    BOTTOM:'BOTTOM',\n}\nexport const HORIZONTAL_ALIGNMENT = {\n    LEFT:'LEFT',\n    CENTER:'CENTER',\n    RIGHT:'RIGHT',\n}\n\nexport const STANDARD_FONTS = {\n    SERIF:'serif',\n    SANSSERIF:'sans-serif',\n    MONOSPACE:'monospace',\n}\n\nexport const FONT_WEIGHTS = {\n    NORMAL:'normal',\n    BOLD:'bold'\n}\n\nexport const FONT_STYLES = {\n    NORMAL:'normal',\n    ITALIC:'italic',\n    OBLIQUE:'oblique'\n}\n\n\n\nexport function isShapeType(type) {\n    if(type === 'rect') return true\n    if(type === 'circle') return true\n    if(type === 'text') return true\n    if(type === 'image') return true\n    return false\n}\n","/**\n * @author sunag / http://www.sunag.com.br\n */\nconst THREE = require('three');//requireimport * as THREE from 'three'\n\n\nconst SkeletonUtils = {\n\n\tretarget: function () {\n\n\t\tvar pos = new THREE.Vector3(),\n\t\t\tquat = new THREE.Quaternion(),\n\t\t\tscale = new THREE.Vector3(),\n\t\t\tbindBoneMatrix = new THREE.Matrix4(),\n\t\t\trelativeMatrix = new THREE.Matrix4(),\n\t\t\tglobalMatrix = new THREE.Matrix4();\n\n\t\treturn function ( target, source, options ) {\n\n\t\t\toptions = options || {};\n\t\t\toptions.preserveMatrix = options.preserveMatrix !== undefined ? options.preserveMatrix : true;\n\t\t\toptions.preservePosition = options.preservePosition !== undefined ? options.preservePosition : true;\n\t\t\toptions.preserveHipPosition = options.preserveHipPosition !== undefined ? options.preserveHipPosition : false;\n\t\t\toptions.useTargetMatrix = options.useTargetMatrix !== undefined ? options.useTargetMatrix : false;\n\t\t\toptions.hip = options.hip !== undefined ? options.hip : \"hip\";\n\t\t\toptions.names = options.names || {};\n\n\t\t\tvar sourceBones = source.isObject3D ? source.skeleton.bones : this.getBones( source ),\n\t\t\t\tbones = target.isObject3D ? target.skeleton.bones : this.getBones( target ),\n\t\t\t\tbindBones,\n\t\t\t\tbone, name, boneTo,\n\t\t\t\tbonesPosition, i;\n\n\t\t\t// reset bones\n\n\t\t\tif ( target.isObject3D ) {\n\n\t\t\t\ttarget.skeleton.pose();\n\n\t\t\t} else {\n\n\t\t\t\toptions.useTargetMatrix = true;\n\t\t\t\toptions.preserveMatrix = false;\n\n\t\t\t}\n\n\t\t\tif ( options.preservePosition ) {\n\n\t\t\t\tbonesPosition = [];\n\n\t\t\t\tfor ( i = 0; i < bones.length; i ++ ) {\n\n\t\t\t\t\tbonesPosition.push( bones[ i ].position.clone() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( options.preserveMatrix ) {\n\n\t\t\t\t// reset matrix\n\n\t\t\t\ttarget.updateMatrixWorld();\n\n\t\t\t\ttarget.matrixWorld.identity();\n\n\t\t\t\t// reset children matrix\n\n\t\t\t\tfor ( i = 0; i < target.children.length; ++ i ) {\n\n\t\t\t\t\ttarget.children[ i ].updateMatrixWorld( true );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( options.offsets ) {\n\n\t\t\t\tbindBones = [];\n\n\t\t\t\tfor ( i = 0; i < bones.length; ++ i ) {\n\n\t\t\t\t\tbone = bones[ i ];\n\t\t\t\t\tname = options.names[ bone.name ] || bone.name;\n\n\t\t\t\t\tif ( options.offsets && options.offsets[ name ] ) {\n\n\t\t\t\t\t\tbone.matrix.multiply( options.offsets[ name ] );\n\n\t\t\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\n\n\t\t\t\t\t\tbone.updateMatrixWorld();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbindBones.push( bone.matrixWorld.clone() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfor ( i = 0; i < bones.length; ++ i ) {\n\n\t\t\t\tbone = bones[ i ];\n\t\t\t\tname = options.names[ bone.name ] || bone.name;\n\n\t\t\t\tboneTo = this.getBoneByName( name, sourceBones );\n\n\t\t\t\tglobalMatrix.copy( bone.matrixWorld );\n\n\t\t\t\tif ( boneTo ) {\n\n\t\t\t\t\tboneTo.updateMatrixWorld();\n\n\t\t\t\t\tif ( options.useTargetMatrix ) {\n\n\t\t\t\t\t\trelativeMatrix.copy( boneTo.matrixWorld );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\trelativeMatrix.getInverse( target.matrixWorld );\n\t\t\t\t\t\trelativeMatrix.multiply( boneTo.matrixWorld );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// ignore scale to extract rotation\n\n\t\t\t\t\tscale.setFromMatrixScale( relativeMatrix );\n\t\t\t\t\trelativeMatrix.scale( scale.set( 1 / scale.x, 1 / scale.y, 1 / scale.z ) );\n\n\t\t\t\t\t// apply to global matrix\n\n\t\t\t\t\tglobalMatrix.makeRotationFromQuaternion( quat.setFromRotationMatrix( relativeMatrix ) );\n\n\t\t\t\t\tif ( target.isObject3D ) {\n\n\t\t\t\t\t\tvar boneIndex = bones.indexOf( bone ),\n\t\t\t\t\t\t\twBindMatrix = bindBones ? bindBones[ boneIndex ] : bindBoneMatrix.getInverse( target.skeleton.boneInverses[ boneIndex ] );\n\n\t\t\t\t\t\tglobalMatrix.multiply( wBindMatrix );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tglobalMatrix.copyPosition( relativeMatrix );\n\n\t\t\t\t}\n\n\t\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\t\tbone.matrix.getInverse( bone.parent.matrixWorld );\n\t\t\t\t\tbone.matrix.multiply( globalMatrix );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbone.matrix.copy( globalMatrix );\n\n\t\t\t\t}\n\n\t\t\t\tif ( options.preserveHipPosition && name === options.hip ) {\n\n\t\t\t\t\tbone.matrix.setPosition( pos.set( 0, bone.position.y, 0 ) );\n\n\t\t\t\t}\n\n\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\n\n\t\t\t\tbone.updateMatrixWorld();\n\n\t\t\t}\n\n\t\t\tif ( options.preservePosition ) {\n\n\t\t\t\tfor ( i = 0; i < bones.length; ++ i ) {\n\n\t\t\t\t\tbone = bones[ i ];\n\t\t\t\t\tname = options.names[ bone.name ] || bone.name;\n\n\t\t\t\t\tif ( name !== options.hip ) {\n\n\t\t\t\t\t\tbone.position.copy( bonesPosition[ i ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( options.preserveMatrix ) {\n\n\t\t\t\t// restore matrix\n\n\t\t\t\ttarget.updateMatrixWorld( true );\n\n\t\t\t}\n\n\t\t};\n\n\t}(),\n\n\tretargetClip: function ( target, source, clip, options ) {\n\n\t\toptions = options || {};\n\t\toptions.useFirstFramePosition = options.useFirstFramePosition !== undefined ? options.useFirstFramePosition : false;\n\t\toptions.fps = options.fps !== undefined ? options.fps : 30;\n\t\toptions.names = options.names || [];\n\n\t\tif ( ! source.isObject3D ) {\n\n\t\t\tsource = this.getHelperFromSkeleton( source );\n\n\t\t}\n\n\t\tvar numFrames = Math.round( clip.duration * ( options.fps / 1000 ) * 1000 ),\n\t\t\tdelta = 1 / options.fps,\n\t\t\tconvertedTracks = [],\n\t\t\tmixer = new THREE.AnimationMixer( source ),\n\t\t\tbones = this.getBones( target.skeleton ),\n\t\t\tboneDatas = [],\n\t\t\tpositionOffset,\n\t\t\tbone, boneTo, boneData,\n\t\t\tname, i, j;\n\n\t\tmixer.clipAction( clip ).play();\n\t\tmixer.update( 0 );\n\n\t\tsource.updateMatrixWorld();\n\n\t\tfor ( i = 0; i < numFrames; ++ i ) {\n\n\t\t\tvar time = i * delta;\n\n\t\t\tthis.retarget( target, source, options );\n\n\t\t\tfor ( j = 0; j < bones.length; ++ j ) {\n\n\t\t\t\tname = options.names[ bones[ j ].name ] || bones[ j ].name;\n\n\t\t\t\tboneTo = this.getBoneByName( name, source.skeleton );\n\n\t\t\t\tif ( boneTo ) {\n\n\t\t\t\t\tbone = bones[ j ];\n\t\t\t\t\tboneData = boneDatas[ j ] = boneDatas[ j ] || { bone: bone };\n\n\t\t\t\t\tif ( options.hip === name ) {\n\n\t\t\t\t\t\tif ( ! boneData.pos ) {\n\n\t\t\t\t\t\t\tboneData.pos = {\n\t\t\t\t\t\t\t\ttimes: new Float32Array( numFrames ),\n\t\t\t\t\t\t\t\tvalues: new Float32Array( numFrames * 3 )\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( options.useFirstFramePosition ) {\n\n\t\t\t\t\t\t\tif ( i === 0 ) {\n\n\t\t\t\t\t\t\t\tpositionOffset = bone.position.clone();\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbone.position.sub( positionOffset );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tboneData.pos.times[ i ] = time;\n\n\t\t\t\t\t\tbone.position.toArray( boneData.pos.values, i * 3 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! boneData.quat ) {\n\n\t\t\t\t\t\tboneData.quat = {\n\t\t\t\t\t\t\ttimes: new Float32Array( numFrames ),\n\t\t\t\t\t\t\tvalues: new Float32Array( numFrames * 4 )\n\t\t\t\t\t\t};\n\n\t\t\t\t\t}\n\n\t\t\t\t\tboneData.quat.times[ i ] = time;\n\n\t\t\t\t\tbone.quaternion.toArray( boneData.quat.values, i * 4 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tmixer.update( delta );\n\n\t\t\tsource.updateMatrixWorld();\n\n\t\t}\n\n\t\tfor ( i = 0; i < boneDatas.length; ++ i ) {\n\n\t\t\tboneData = boneDatas[ i ];\n\n\t\t\tif ( boneData ) {\n\n\t\t\t\tif ( boneData.pos ) {\n\n\t\t\t\t\tconvertedTracks.push( new THREE.VectorKeyframeTrack(\n\t\t\t\t\t\t\".bones[\" + boneData.bone.name + \"].position\",\n\t\t\t\t\t\tboneData.pos.times,\n\t\t\t\t\t\tboneData.pos.values\n\t\t\t\t\t) );\n\n\t\t\t\t}\n\n\t\t\t\tconvertedTracks.push( new THREE.QuaternionKeyframeTrack(\n\t\t\t\t\t\".bones[\" + boneData.bone.name + \"].quaternion\",\n\t\t\t\t\tboneData.quat.times,\n\t\t\t\t\tboneData.quat.values\n\t\t\t\t) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tmixer.uncacheAction( clip );\n\n\t\treturn new THREE.AnimationClip( clip.name, - 1, convertedTracks );\n\n\t},\n\n\tgetHelperFromSkeleton: function ( skeleton ) {\n\n\t\tvar source = new THREE.SkeletonHelper( skeleton.bones[ 0 ] );\n\t\tsource.skeleton = skeleton;\n\n\t\treturn source;\n\n\t},\n\n\tgetSkeletonOffsets: function () {\n\n\t\tvar targetParentPos = new THREE.Vector3(),\n\t\t\ttargetPos = new THREE.Vector3(),\n\t\t\tsourceParentPos = new THREE.Vector3(),\n\t\t\tsourcePos = new THREE.Vector3(),\n\t\t\ttargetDir = new THREE.Vector2(),\n\t\t\tsourceDir = new THREE.Vector2();\n\n\t\treturn function ( target, source, options ) {\n\n\t\t\toptions = options || {};\n\t\t\toptions.hip = options.hip !== undefined ? options.hip : \"hip\";\n\t\t\toptions.names = options.names || {};\n\n\t\t\tif ( ! source.isObject3D ) {\n\n\t\t\t\tsource = this.getHelperFromSkeleton( source );\n\n\t\t\t}\n\n\t\t\tvar nameKeys = Object.keys( options.names ),\n\t\t\t\tnameValues = Object.values( options.names ),\n\t\t\t\tsourceBones = source.isObject3D ? source.skeleton.bones : this.getBones( source ),\n\t\t\t\tbones = target.isObject3D ? target.skeleton.bones : this.getBones( target ),\n\t\t\t\toffsets = [],\n\t\t\t\tbone, boneTo,\n\t\t\t\tname, i;\n\n\t\t\ttarget.skeleton.pose();\n\n\t\t\tfor ( i = 0; i < bones.length; ++ i ) {\n\n\t\t\t\tbone = bones[ i ];\n\t\t\t\tname = options.names[ bone.name ] || bone.name;\n\n\t\t\t\tboneTo = this.getBoneByName( name, sourceBones );\n\n\t\t\t\tif ( boneTo && name !== options.hip ) {\n\n\t\t\t\t\tvar boneParent = this.getNearestBone( bone.parent, nameKeys ),\n\t\t\t\t\t\tboneToParent = this.getNearestBone( boneTo.parent, nameValues );\n\n\t\t\t\t\tboneParent.updateMatrixWorld();\n\t\t\t\t\tboneToParent.updateMatrixWorld();\n\n\t\t\t\t\ttargetParentPos.setFromMatrixPosition( boneParent.matrixWorld );\n\t\t\t\t\ttargetPos.setFromMatrixPosition( bone.matrixWorld );\n\n\t\t\t\t\tsourceParentPos.setFromMatrixPosition( boneToParent.matrixWorld );\n\t\t\t\t\tsourcePos.setFromMatrixPosition( boneTo.matrixWorld );\n\n\t\t\t\t\ttargetDir.subVectors(\n\t\t\t\t\t\tnew THREE.Vector2( targetPos.x, targetPos.y ),\n\t\t\t\t\t\tnew THREE.Vector2( targetParentPos.x, targetParentPos.y )\n\t\t\t\t\t).normalize();\n\n\t\t\t\t\tsourceDir.subVectors(\n\t\t\t\t\t\tnew THREE.Vector2( sourcePos.x, sourcePos.y ),\n\t\t\t\t\t\tnew THREE.Vector2( sourceParentPos.x, sourceParentPos.y )\n\t\t\t\t\t).normalize();\n\n\t\t\t\t\tvar laterialAngle = targetDir.angle() - sourceDir.angle();\n\n\t\t\t\t\tvar offset = new THREE.Matrix4().makeRotationFromEuler(\n\t\t\t\t\t\tnew THREE.Euler(\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\tlaterialAngle\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\n\t\t\t\t\tbone.matrix.multiply( offset );\n\n\t\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\n\n\t\t\t\t\tbone.updateMatrixWorld();\n\n\t\t\t\t\toffsets[ name ] = offset;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn offsets;\n\n\t\t};\n\n\t}(),\n\n\trenameBones: function ( skeleton, names ) {\n\n\t\tvar bones = this.getBones( skeleton );\n\n\t\tfor ( var i = 0; i < bones.length; ++ i ) {\n\n\t\t\tvar bone = bones[ i ];\n\n\t\t\tif ( names[ bone.name ] ) {\n\n\t\t\t\tbone.name = names[ bone.name ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tgetBones: function ( skeleton ) {\n\n\t\treturn Array.isArray( skeleton ) ? skeleton : skeleton.bones;\n\n\t},\n\n\tgetBoneByName: function ( name, skeleton ) {\n\n\t\tfor ( var i = 0, bones = this.getBones( skeleton ); i < bones.length; i ++ ) {\n\n\t\t\tif ( name === bones[ i ].name )\n\n\t\t\t\treturn bones[ i ];\n\n\t\t}\n\n\t},\n\n\tgetNearestBone: function ( bone, names ) {\n\n\t\twhile ( bone.isBone ) {\n\n\t\t\tif ( names.indexOf( bone.name ) !== - 1 ) {\n\n\t\t\t\treturn bone;\n\n\t\t\t}\n\n\t\t\tbone = bone.parent;\n\n\t\t}\n\n\t},\n\n\tfindBoneTrackData: function ( name, tracks ) {\n\n\t\tvar regexp = /\\[(.*)\\]\\.(.*)/,\n\t\t\tresult = { name: name };\n\n\t\tfor ( var i = 0; i < tracks.length; ++ i ) {\n\n\t\t\t// 1 is track name\n\t\t\t// 2 is track type\n\t\t\tvar trackData = regexp.exec( tracks[ i ].name );\n\n\t\t\tif ( trackData && name === trackData[ 1 ] ) {\n\n\t\t\t\tresult[ trackData[ 2 ] ] = i;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn result;\n\n\t},\n\n\tgetEqualsBonesNames: function ( skeleton, targetSkeleton ) {\n\n\t\tvar sourceBones = this.getBones( skeleton ),\n\t\t\ttargetBones = this.getBones( targetSkeleton ),\n\t\t\tbones = [];\n\n\t\tsearch : for ( var i = 0; i < sourceBones.length; i ++ ) {\n\n\t\t\tvar boneName = sourceBones[ i ].name;\n\n\t\t\tfor ( var j = 0; j < targetBones.length; j ++ ) {\n\n\t\t\t\tif ( boneName === targetBones[ j ].name ) {\n\n\t\t\t\t\tbones.push( boneName );\n\n\t\t\t\t\tcontinue search;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn bones;\n\n\t},\n\n\tclone: function ( source ) {\n\n\t\tvar sourceLookup = new Map();\n\t\tvar cloneLookup = new Map();\n\n\t\tvar clone = source.clone();\n\n\t\tparallelTraverse( source, clone, function ( sourceNode, clonedNode ) {\n\n\t\t\tsourceLookup.set( clonedNode, sourceNode );\n\t\t\tcloneLookup.set( sourceNode, clonedNode );\n\n\t\t} );\n\n\t\tclone.traverse( function ( node ) {\n\n\t\t\tif ( ! node.isSkinnedMesh ) return;\n\n\t\t\tvar clonedMesh = node;\n\t\t\tvar sourceMesh = sourceLookup.get( node );\n\t\t\tvar sourceBones = sourceMesh.skeleton.bones;\n\n\t\t\tclonedMesh.skeleton = sourceMesh.skeleton.clone();\n\t\t\tclonedMesh.bindMatrix.copy( sourceMesh.bindMatrix );\n\n\t\t\tclonedMesh.skeleton.bones = sourceBones.map( function ( bone ) {\n\n\t\t\t\treturn cloneLookup.get( bone );\n\n\t\t\t} );\n\n\t\t\tclonedMesh.bind( clonedMesh.skeleton, clonedMesh.bindMatrix );\n\n\t\t} );\n\n\t\treturn clone;\n\n\t}\n\n};\n\n\nfunction parallelTraverse ( a, b, callback ) {\n\n\tcallback( a, b );\n\n\tfor ( var i = 0; i < a.children.length; i ++ ) {\n\n\t\tparallelTraverse( a.children[ i ], b.children[ i ], callback );\n\n\t}\n\n}\n\nexport default SkeletonUtils","import {NONE_ASSET} from '../Common'\nimport {DoubleSide, MeshLambertMaterial} from 'three'\n\nexport default class ObjectDef {\n    updateProperty(node, obj, op, provider) {\n        if (op.name === 'tx') node.position.x = parseFloat(op.value)\n        if (op.name === 'ty') node.position.y = parseFloat(op.value)\n        if (op.name === 'tz') node.position.z = parseFloat(op.value)\n        if (op.name === 'rx') node.rotation.x = parseFloat(op.value)\n        if (op.name === 'ry') node.rotation.y = parseFloat(op.value)\n        if (op.name === 'rz') node.rotation.z = parseFloat(op.value)\n        if (op.name === 'sx') node.scale.x = parseFloat(op.value)\n        if (op.name === 'sy') node.scale.y = parseFloat(op.value)\n        if (op.name === 'sz') node.scale.z = parseFloat(op.value)\n        if (op.name === 'visible') node.visible = op.value\n\n        if (op.name === 'color') {\n            let color = op.value\n            if(color.indexOf('#') === 0) color = color.substring(1)\n            node.material.color.set(parseInt(color,16))\n            return\n        }\n\n    }\n    reset(node, obj) {\n        node.position.set(obj.tx,obj.ty,obj.tz)\n        node.visible = obj.visible\n    }\n\n    attachAsset(node, obj, provider) {\n        if(obj.asset === NONE_ASSET.id) {\n            node.material = new MeshLambertMaterial({color: obj.color, side:DoubleSide})\n            return\n        }\n        provider.assetsManager.getTexture(obj.asset).then(tex => {\n            provider.getLogger().log(\"loadded asset\",obj.asset)\n            provider.getLogger().log(tex)\n            if(!tex) provider.getLogger().error(\"error loading asset\",obj.asset)\n            const opts = {\n                color: obj.color,\n                side: DoubleSide,\n                map:tex\n            }\n            if(obj.transparent) {\n                opts.transparent = true\n                opts.alphaTest = 0.5\n            }\n            node.material = new MeshLambertMaterial(opts)\n        }).catch(err => {\n            provider.getLogger().error('error somwhere',err.message,err)\n        })\n    }\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport {BoxGeometry, Mesh, MeshLambertMaterial, TextureLoader, DoubleSide, VideoTexture} from 'three'\nimport ObjectDef from './ObjectDef'\nimport {ASSET_TYPES, NONE_ASSET, OBJ_TYPES, PROP_DEFS} from '../Common'\n\nlet COUNTER = 0\n\nexport default class CubeDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create cube w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.cube,\n            title:'cube '+COUNTER++,\n            visible:true,\n            width:0.3, height:0.3, depth:0.3,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#00ff00',\n            children:graph.createArray(),\n            asset:NONE_ASSET.id,\n            transparent:false,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new Mesh(\n            new BoxGeometry(obj.width, obj.height, obj.depth),\n            new MeshLambertMaterial({color: obj.color})\n        )\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        this.attachAsset(node, obj, provider)\n        return node\n    }\n\n\n\n    updateProperty(node, obj, op, provider) {\n        if (op.name === 'width' || op.name === 'height' || op.name === 'depth') {\n            node.geometry = new BoxGeometry(obj.width, obj.height, obj.depth)\n            return\n        }\n        if (op.name === PROP_DEFS.asset.key || op.name === PROP_DEFS.transparent.key) return this.attachAsset(node, obj, provider)\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\";\nimport ObjectDef from './ObjectDef'\nimport {ASSET_TYPES, NONE_ASSET, PROP_DEFS} from '../Common'\nimport {TextureLoader, MeshLambertMaterial, DoubleSide, VideoTexture, Mesh, SphereBufferGeometry} from 'three'\n\nexport default class SphereDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create sphere w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:'sphere',\n            title:'a sphere',\n            visible:true,\n            radius: 0.3/2,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#0000ff',\n            children:graph.createArray(),\n            asset:NONE_ASSET.id,\n            transparent:false,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new Mesh(\n            new SphereBufferGeometry(obj.radius),\n            new MeshLambertMaterial({color: obj.color})\n        )\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        this.attachAsset(node, obj, provider)\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        if (op.name === 'radius') node.geometry = new SphereBufferGeometry(op.value)\n        if (op.name === PROP_DEFS.asset.key || op.name === PROP_DEFS.transparent.key) return this.attachAsset(node, obj, provider)\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\";\nimport * as THREE from \"three\";\nimport {ASSET_TYPES, NONE_ASSET, PROP_DEFS} from '../Common'\nimport ObjectDef from './ObjectDef'\nimport {MeshLambertMaterial} from 'three'\nimport {DoubleSide} from 'three'\nimport {TextureLoader} from 'three'\nimport {VideoTexture} from 'three'\n\nexport default class PlaneDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create plane w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:'plane',\n            title:'a plane',\n            visible:true,\n            width: 0.5,\n            height: 0.5,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#ffffff',\n            children:graph.createArray(),\n            asset:NONE_ASSET.id,\n            transparent:false,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new THREE.Mesh(\n            new THREE.PlaneBufferGeometry(obj.width,obj.height),\n            new THREE.MeshLambertMaterial({color: obj.color, side: THREE.DoubleSide})\n        )\n        this.attachAsset(node, obj, provider)\n        node.userData.clickable = true\n        // on(node,POINTER_CLICK,e =>SelectionManager.setSelection(node.userData.graphid))\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        if (op.name === 'width') node.geometry = new THREE.PlaneBufferGeometry(op.value,obj.height)\n        if (op.name === 'height') node.geometry = new THREE.PlaneBufferGeometry(obj.width,op.value)\n        if (op.name === PROP_DEFS.asset.key || op.name === PROP_DEFS.transparent.key) return this.attachAsset(node, obj, provider)\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n}\n","/* eslint-disable */\nconst THREE = require('three');//requireimport * as THREE from 'three'\n\n/**\n * @author Rich Tibbett / https://github.com/richtr\n * @author mrdoob / http://mrdoob.com/\n * @author Tony Parisi / http://www.tonyparisi.com/\n * @author Takahiro / https://github.com/takahirox\n * @author Don McCurdy / https://www.donmccurdy.com\n */\n\nconst GLTFLoader = ( function () {\n\n\tfunction GLTFLoader( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\t\tthis.dracoLoader = null;\n\n\t}\n\n\tGLTFLoader.prototype = {\n\n\t\tconstructor: GLTFLoader,\n\n\t\tcrossOrigin: 'anonymous',\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar scope = this;\n\n\t\t\tvar resourcePath;\n\n\t\t\tif ( this.resourcePath !== undefined ) {\n\n\t\t\t\tresourcePath = this.resourcePath;\n\n\t\t\t} else if ( this.path !== undefined ) {\n\n\t\t\t\tresourcePath = this.path;\n\n\t\t\t} else {\n\n\t\t\t\tresourcePath = THREE.LoaderUtils.extractUrlBase( url );\n\n\t\t\t}\n\n\t\t\t// Tells the LoadingManager to track an extra item, which resolves after\n\t\t\t// the model is fully loaded. This means the count of items loaded will\n\t\t\t// be incorrect, but ensures manager.onLoad() does not fire early.\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\tvar _onError = function ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t};\n\n\t\t\tvar loader = new THREE.FileLoader( scope.manager );\n\n\t\t\tloader.setPath( this.path );\n\t\t\tloader.setResponseType( 'arraybuffer' );\n\n\t\t\tloader.load( url, function ( data ) {\n\n\t\t\t\ttry {\n\n\t\t\t\t\tscope.parse( data, resourcePath, function ( gltf ) {\n\n\t\t\t\t\t\tonLoad( gltf );\n\n\t\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t\t}, _onError );\n\n\t\t\t\t} catch ( e ) {\n\n\t\t\t\t\t_onError( e );\n\n\t\t\t\t}\n\n\t\t\t}, onProgress, _onError );\n\n\t\t},\n\n\t\tsetCrossOrigin: function ( value ) {\n\n\t\t\tthis.crossOrigin = value;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetPath: function ( value ) {\n\n\t\t\tthis.path = value;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetResourcePath: function ( value ) {\n\n\t\t\tthis.resourcePath = value;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetDRACOLoader: function ( dracoLoader ) {\n\n\t\t\tthis.dracoLoader = dracoLoader;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tparse: function ( data, path, onLoad, onError ) {\n\n\t\t\tvar content;\n\t\t\tvar extensions = {};\n\n\t\t\tif ( typeof data === 'string' ) {\n\n\t\t\t\tcontent = data;\n\n\t\t\t} else {\n\n\t\t\t\tvar magic = THREE.LoaderUtils.decodeText( new Uint8Array( data, 0, 4 ) );\n\n\t\t\t\tif ( magic === BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\textensions[ EXTENSIONS.KHR_BINARY_GLTF ] = new GLTFBinaryExtension( data );\n\n\t\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\t\tif ( onError ) onError( error );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tcontent = extensions[ EXTENSIONS.KHR_BINARY_GLTF ].content;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tcontent = THREE.LoaderUtils.decodeText( new Uint8Array( data ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar json = JSON.parse( content );\n\n\t\t\tif ( json.asset === undefined || json.asset.version[ 0 ] < 2 ) {\n\n\t\t\t\tif ( onError ) onError( new Error( 'THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead.' ) );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( json.extensionsUsed ) {\n\n\t\t\t\tfor ( var i = 0; i < json.extensionsUsed.length; ++ i ) {\n\n\t\t\t\t\tvar extensionName = json.extensionsUsed[ i ];\n\t\t\t\t\tvar extensionsRequired = json.extensionsRequired || [];\n\n\t\t\t\t\tswitch ( extensionName ) {\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_LIGHTS_PUNCTUAL:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFLightsExtension( json );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_UNLIT:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsUnlitExtension( json );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsPbrSpecularGlossinessExtension( json );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFDracoMeshCompressionExtension( json, this.dracoLoader );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.MSFT_TEXTURE_DDS:\n\t\t\t\t\t\t\textensions[ EXTENSIONS.MSFT_TEXTURE_DDS ] = new GLTFTextureDDSExtension();\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n\t\t\t\t\t\t\textensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] = new GLTFTextureTransformExtension( json );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tif ( extensionsRequired.indexOf( extensionName ) >= 0 ) {\n\n\t\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".' );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar parser = new GLTFParser( json, extensions, {\n\n\t\t\t\tpath: path || this.resourcePath || '',\n\t\t\t\tcrossOrigin: this.crossOrigin,\n\t\t\t\tmanager: this.manager\n\n\t\t\t} );\n\n\t\t\tparser.parse( onLoad, onError );\n\n\t\t}\n\n\t};\n\n\t/* GLTFREGISTRY */\n\n\tfunction GLTFRegistry() {\n\n\t\tvar objects = {};\n\n\t\treturn\t{\n\n\t\t\tget: function ( key ) {\n\n\t\t\t\treturn objects[ key ];\n\n\t\t\t},\n\n\t\t\tadd: function ( key, object ) {\n\n\t\t\t\tobjects[ key ] = object;\n\n\t\t\t},\n\n\t\t\tremove: function ( key ) {\n\n\t\t\t\tdelete objects[ key ];\n\n\t\t\t},\n\n\t\t\tremoveAll: function () {\n\n\t\t\t\tobjects = {};\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t/*********************************/\n\t/********** EXTENSIONS ***********/\n\t/*********************************/\n\n\tvar EXTENSIONS = {\n\t\tKHR_BINARY_GLTF: 'KHR_binary_glTF',\n\t\tKHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n\t\tKHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n\t\tKHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: 'KHR_materials_pbrSpecularGlossiness',\n\t\tKHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n\t\tKHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n\t\tMSFT_TEXTURE_DDS: 'MSFT_texture_dds'\n\t};\n\n\t/**\n\t * DDS Texture Extension\n\t *\n\t * Specification:\n\t * https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/MSFT_texture_dds\n\t *\n\t */\n\tfunction GLTFTextureDDSExtension() {\n\n\t\tif ( ! THREE.DDSLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.MSFT_TEXTURE_DDS;\n\t\tthis.ddsLoader = new THREE.DDSLoader();\n\n\t}\n\n\t/**\n\t * Lights Extension\n\t *\n\t * Specification: PENDING\n\t */\n\tfunction GLTFLightsExtension( json ) {\n\n\t\tthis.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\n\n\t\tvar extension = ( json.extensions && json.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ] ) || {};\n\t\tthis.lightDefs = extension.lights || [];\n\n\t}\n\n\tGLTFLightsExtension.prototype.loadLight = function ( lightIndex ) {\n\n\t\tvar lightDef = this.lightDefs[ lightIndex ];\n\t\tvar lightNode;\n\n\t\tvar color = new THREE.Color( 0xffffff );\n\t\tif ( lightDef.color !== undefined ) color.fromArray( lightDef.color );\n\n\t\tvar range = lightDef.range !== undefined ? lightDef.range : 0;\n\n\t\tswitch ( lightDef.type ) {\n\n\t\t\tcase 'directional':\n\t\t\t\tlightNode = new THREE.DirectionalLight( color );\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tcase 'point':\n\t\t\t\tlightNode = new THREE.PointLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\tbreak;\n\n\t\t\tcase 'spot':\n\t\t\t\tlightNode = new THREE.SpotLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\t// Handle spotlight properties.\n\t\t\t\tlightDef.spot = lightDef.spot || {};\n\t\t\t\tlightDef.spot.innerConeAngle = lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\n\t\t\t\tlightDef.spot.outerConeAngle = lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\n\t\t\t\tlightNode.angle = lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Unexpected light type, \"' + lightDef.type + '\".' );\n\n\t\t}\n\n\t\t// Some lights (e.g. spot) default to a position other than the origin. Reset the position\n\t\t// here, because node-level parsing will only override position if explicitly specified.\n\t\tlightNode.position.set( 0, 0, 0 );\n\n\t\tlightNode.decay = 2;\n\n\t\tif ( lightDef.intensity !== undefined ) lightNode.intensity = lightDef.intensity;\n\n\t\tlightNode.name = lightDef.name || ( 'light_' + lightIndex );\n\n\t\treturn Promise.resolve( lightNode );\n\n\t};\n\n\t/**\n\t * Unlit Materials Extension (pending)\n\t *\n\t * PR: https://github.com/KhronosGroup/glTF/pull/1163\n\t */\n\tfunction GLTFMaterialsUnlitExtension() {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\n\n\t}\n\n\tGLTFMaterialsUnlitExtension.prototype.getMaterialType = function () {\n\n\t\treturn THREE.MeshBasicMaterial;\n\n\t};\n\n\tGLTFMaterialsUnlitExtension.prototype.extendParams = function ( materialParams, materialDef, parser ) {\n\n\t\tvar pending = [];\n\n\t\tmaterialParams.color = new THREE.Color( 1.0, 1.0, 1.0 );\n\t\tmaterialParams.opacity = 1.0;\n\n\t\tvar metallicRoughness = materialDef.pbrMetallicRoughness;\n\n\t\tif ( metallicRoughness ) {\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tvar array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t};\n\n\t/* BINARY EXTENSION */\n\n\tvar BINARY_EXTENSION_BUFFER_NAME = 'binary_glTF';\n\tvar BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\n\tvar BINARY_EXTENSION_HEADER_LENGTH = 12;\n\tvar BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4E4F534A, BIN: 0x004E4942 };\n\n\tfunction GLTFBinaryExtension( data ) {\n\n\t\tthis.name = EXTENSIONS.KHR_BINARY_GLTF;\n\t\tthis.content = null;\n\t\tthis.body = null;\n\n\t\tvar headerView = new DataView( data, 0, BINARY_EXTENSION_HEADER_LENGTH );\n\n\t\tthis.header = {\n\t\t\tmagic: THREE.LoaderUtils.decodeText( new Uint8Array( data.slice( 0, 4 ) ) ),\n\t\t\tversion: headerView.getUint32( 4, true ),\n\t\t\tlength: headerView.getUint32( 8, true )\n\t\t};\n\n\t\tif ( this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported glTF-Binary header.' );\n\n\t\t} else if ( this.header.version < 2.0 ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.' );\n\n\t\t}\n\n\t\tvar chunkView = new DataView( data, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tvar chunkIndex = 0;\n\n\t\twhile ( chunkIndex < chunkView.byteLength ) {\n\n\t\t\tvar chunkLength = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tvar chunkType = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tif ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON ) {\n\n\t\t\t\tvar contentArray = new Uint8Array( data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength );\n\t\t\t\tthis.content = THREE.LoaderUtils.decodeText( contentArray );\n\n\t\t\t} else if ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN ) {\n\n\t\t\t\tvar byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n\t\t\t\tthis.body = data.slice( byteOffset, byteOffset + chunkLength );\n\n\t\t\t}\n\n\t\t\t// Clients must ignore chunks with unknown types.\n\n\t\t\tchunkIndex += chunkLength;\n\n\t\t}\n\n\t\tif ( this.content === null ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: JSON content not found.' );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * DRACO Mesh Compression Extension\n\t *\n\t * Specification: https://github.com/KhronosGroup/glTF/pull/874\n\t */\n\tfunction GLTFDracoMeshCompressionExtension( json, dracoLoader ) {\n\n\t\tif ( ! dracoLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: No DRACOLoader instance provided.' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\n\t\tthis.json = json;\n\t\tthis.dracoLoader = dracoLoader;\n\n\t}\n\n\tGLTFDracoMeshCompressionExtension.prototype.decodePrimitive = function ( primitive, parser ) {\n\n\t\tvar json = this.json;\n\t\tvar dracoLoader = this.dracoLoader;\n\t\tvar bufferViewIndex = primitive.extensions[ this.name ].bufferView;\n\t\tvar gltfAttributeMap = primitive.extensions[ this.name ].attributes;\n\t\tvar threeAttributeMap = {};\n\t\tvar attributeNormalizedMap = {};\n\t\tvar attributeTypeMap = {};\n\n\t\tfor ( var attributeName in gltfAttributeMap ) {\n\n\t\t\tvar threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tthreeAttributeMap[ threeAttributeName ] = gltfAttributeMap[ attributeName ];\n\n\t\t}\n\n\t\tfor ( attributeName in primitive.attributes ) {\n\n\t\t\tvar threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tif ( gltfAttributeMap[ attributeName ] !== undefined ) {\n\n\t\t\t\tvar accessorDef = json.accessors[ primitive.attributes[ attributeName ] ];\n\t\t\t\tvar componentType = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t\tattributeTypeMap[ threeAttributeName ] = componentType;\n\t\t\t\tattributeNormalizedMap[ threeAttributeName ] = accessorDef.normalized === true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.getDependency( 'bufferView', bufferViewIndex ).then( function ( bufferView ) {\n\n\t\t\treturn new Promise( function ( resolve ) {\n\n\t\t\t\tdracoLoader.decodeDracoFile( bufferView, function ( geometry ) {\n\n\t\t\t\t\tfor ( var attributeName in geometry.attributes ) {\n\n\t\t\t\t\t\tvar attribute = geometry.attributes[ attributeName ];\n\t\t\t\t\t\tvar normalized = attributeNormalizedMap[ attributeName ];\n\n\t\t\t\t\t\tif ( normalized !== undefined ) attribute.normalized = normalized;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve( geometry );\n\n\t\t\t\t}, threeAttributeMap, attributeTypeMap );\n\n\t\t\t} );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Texture Transform Extension\n\t *\n\t * Specification:\n\t */\n\tfunction GLTFTextureTransformExtension() {\n\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\n\n\t}\n\n\tGLTFTextureTransformExtension.prototype.extendTexture = function ( texture, transform ) {\n\n\t\ttexture = texture.clone();\n\n\t\tif ( transform.offset !== undefined ) {\n\n\t\t\ttexture.offset.fromArray( transform.offset );\n\n\t\t}\n\n\t\tif ( transform.rotation !== undefined ) {\n\n\t\t\ttexture.rotation = transform.rotation;\n\n\t\t}\n\n\t\tif ( transform.scale !== undefined ) {\n\n\t\t\ttexture.repeat.fromArray( transform.scale );\n\n\t\t}\n\n\t\tif ( transform.texCoord !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Custom UV sets in \"' + this.name + '\" extension not yet supported.' );\n\n\t\t}\n\n\t\ttexture.needsUpdate = true;\n\n\t\treturn texture;\n\n\t};\n\n\t/**\n\t * Specular-Glossiness Extension\n\t *\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_pbrSpecularGlossiness\n\t */\n\tfunction GLTFMaterialsPbrSpecularGlossinessExtension() {\n\n\t\treturn {\n\n\t\t\tname: EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,\n\n\t\t\tspecularGlossinessParams: [\n\t\t\t\t'color',\n\t\t\t\t'map',\n\t\t\t\t'lightMap',\n\t\t\t\t'lightMapIntensity',\n\t\t\t\t'aoMap',\n\t\t\t\t'aoMapIntensity',\n\t\t\t\t'emissive',\n\t\t\t\t'emissiveIntensity',\n\t\t\t\t'emissiveMap',\n\t\t\t\t'bumpMap',\n\t\t\t\t'bumpScale',\n\t\t\t\t'normalMap',\n\t\t\t\t'displacementMap',\n\t\t\t\t'displacementScale',\n\t\t\t\t'displacementBias',\n\t\t\t\t'specularMap',\n\t\t\t\t'specular',\n\t\t\t\t'glossinessMap',\n\t\t\t\t'glossiness',\n\t\t\t\t'alphaMap',\n\t\t\t\t'envMap',\n\t\t\t\t'envMapIntensity',\n\t\t\t\t'refractionRatio',\n\t\t\t],\n\n\t\t\tgetMaterialType: function () {\n\n\t\t\t\treturn THREE.ShaderMaterial;\n\n\t\t\t},\n\n\t\t\textendParams: function ( materialParams, materialDef, parser ) {\n\n\t\t\t\tvar pbrSpecularGlossiness = materialDef.extensions[ this.name ];\n\n\t\t\t\tvar shader = THREE.ShaderLib[ 'standard' ];\n\n\t\t\t\tvar uniforms = THREE.UniformsUtils.clone( shader.uniforms );\n\n\t\t\t\tvar specularMapParsFragmentChunk = [\n\t\t\t\t\t'#ifdef USE_SPECULARMAP',\n\t\t\t\t\t'\tuniform sampler2D specularMap;',\n\t\t\t\t\t'#endif'\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar glossinessMapParsFragmentChunk = [\n\t\t\t\t\t'#ifdef USE_GLOSSINESSMAP',\n\t\t\t\t\t'\tuniform sampler2D glossinessMap;',\n\t\t\t\t\t'#endif'\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar specularMapFragmentChunk = [\n\t\t\t\t\t'vec3 specularFactor = specular;',\n\t\t\t\t\t'#ifdef USE_SPECULARMAP',\n\t\t\t\t\t'\tvec4 texelSpecular = texture2D( specularMap, vUv );',\n\t\t\t\t\t'\ttexelSpecular = sRGBToLinear( texelSpecular );',\n\t\t\t\t\t'\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture',\n\t\t\t\t\t'\tspecularFactor *= texelSpecular.rgb;',\n\t\t\t\t\t'#endif'\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar glossinessMapFragmentChunk = [\n\t\t\t\t\t'float glossinessFactor = glossiness;',\n\t\t\t\t\t'#ifdef USE_GLOSSINESSMAP',\n\t\t\t\t\t'\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );',\n\t\t\t\t\t'\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture',\n\t\t\t\t\t'\tglossinessFactor *= texelGlossiness.a;',\n\t\t\t\t\t'#endif'\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar lightPhysicalFragmentChunk = [\n\t\t\t\t\t'PhysicalMaterial material;',\n\t\t\t\t\t'material.diffuseColor = diffuseColor.rgb;',\n\t\t\t\t\t'material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );',\n\t\t\t\t\t'material.specularColor = specularFactor.rgb;',\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar fragmentShader = shader.fragmentShader\n\t\t\t\t\t.replace( 'uniform float roughness;', 'uniform vec3 specular;' )\n\t\t\t\t\t.replace( 'uniform float metalness;', 'uniform float glossiness;' )\n\t\t\t\t\t.replace( '#include <roughnessmap_pars_fragment>', specularMapParsFragmentChunk )\n\t\t\t\t\t.replace( '#include <metalnessmap_pars_fragment>', glossinessMapParsFragmentChunk )\n\t\t\t\t\t.replace( '#include <roughnessmap_fragment>', specularMapFragmentChunk )\n\t\t\t\t\t.replace( '#include <metalnessmap_fragment>', glossinessMapFragmentChunk )\n\t\t\t\t\t.replace( '#include <lights_physical_fragment>', lightPhysicalFragmentChunk );\n\n\t\t\t\tdelete uniforms.roughness;\n\t\t\t\tdelete uniforms.metalness;\n\t\t\t\tdelete uniforms.roughnessMap;\n\t\t\t\tdelete uniforms.metalnessMap;\n\n\t\t\t\tuniforms.specular = { value: new THREE.Color().setHex( 0x111111 ) };\n\t\t\t\tuniforms.glossiness = { value: 0.5 };\n\t\t\t\tuniforms.specularMap = { value: null };\n\t\t\t\tuniforms.glossinessMap = { value: null };\n\n\t\t\t\tmaterialParams.vertexShader = shader.vertexShader;\n\t\t\t\tmaterialParams.fragmentShader = fragmentShader;\n\t\t\t\tmaterialParams.uniforms = uniforms;\n\t\t\t\tmaterialParams.defines = { 'STANDARD': '' };\n\n\t\t\t\tmaterialParams.color = new THREE.Color( 1.0, 1.0, 1.0 );\n\t\t\t\tmaterialParams.opacity = 1.0;\n\n\t\t\t\tvar pending = [];\n\n\t\t\t\tif ( Array.isArray( pbrSpecularGlossiness.diffuseFactor ) ) {\n\n\t\t\t\t\tvar array = pbrSpecularGlossiness.diffuseFactor;\n\n\t\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t\t}\n\n\t\t\t\tif ( pbrSpecularGlossiness.diffuseTexture !== undefined ) {\n\n\t\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', pbrSpecularGlossiness.diffuseTexture ) );\n\n\t\t\t\t}\n\n\t\t\t\tmaterialParams.emissive = new THREE.Color( 0.0, 0.0, 0.0 );\n\t\t\t\tmaterialParams.glossiness = pbrSpecularGlossiness.glossinessFactor !== undefined ? pbrSpecularGlossiness.glossinessFactor : 1.0;\n\t\t\t\tmaterialParams.specular = new THREE.Color( 1.0, 1.0, 1.0 );\n\n\t\t\t\tif ( Array.isArray( pbrSpecularGlossiness.specularFactor ) ) {\n\n\t\t\t\t\tmaterialParams.specular.fromArray( pbrSpecularGlossiness.specularFactor );\n\n\t\t\t\t}\n\n\t\t\t\tif ( pbrSpecularGlossiness.specularGlossinessTexture !== undefined ) {\n\n\t\t\t\t\tvar specGlossMapDef = pbrSpecularGlossiness.specularGlossinessTexture;\n\t\t\t\t\tpending.push( parser.assignTexture( materialParams, 'glossinessMap', specGlossMapDef ) );\n\t\t\t\t\tpending.push( parser.assignTexture( materialParams, 'specularMap', specGlossMapDef ) );\n\n\t\t\t\t}\n\n\t\t\t\treturn Promise.all( pending );\n\n\t\t\t},\n\n\t\t\tcreateMaterial: function ( params ) {\n\n\t\t\t\t// setup material properties based on MeshStandardMaterial for Specular-Glossiness\n\n\t\t\t\tvar material = new THREE.ShaderMaterial( {\n\t\t\t\t\tdefines: params.defines,\n\t\t\t\t\tvertexShader: params.vertexShader,\n\t\t\t\t\tfragmentShader: params.fragmentShader,\n\t\t\t\t\tuniforms: params.uniforms,\n\t\t\t\t\tfog: true,\n\t\t\t\t\tlights: true,\n\t\t\t\t\topacity: params.opacity,\n\t\t\t\t\ttransparent: params.transparent\n\t\t\t\t} );\n\n\t\t\t\tmaterial.isGLTFSpecularGlossinessMaterial = true;\n\n\t\t\t\tmaterial.color = params.color;\n\n\t\t\t\tmaterial.map = params.map === undefined ? null : params.map;\n\n\t\t\t\tmaterial.lightMap = null;\n\t\t\t\tmaterial.lightMapIntensity = 1.0;\n\n\t\t\t\tmaterial.aoMap = params.aoMap === undefined ? null : params.aoMap;\n\t\t\t\tmaterial.aoMapIntensity = 1.0;\n\n\t\t\t\tmaterial.emissive = params.emissive;\n\t\t\t\tmaterial.emissiveIntensity = 1.0;\n\t\t\t\tmaterial.emissiveMap = params.emissiveMap === undefined ? null : params.emissiveMap;\n\n\t\t\t\tmaterial.bumpMap = params.bumpMap === undefined ? null : params.bumpMap;\n\t\t\t\tmaterial.bumpScale = 1;\n\n\t\t\t\tmaterial.normalMap = params.normalMap === undefined ? null : params.normalMap;\n\n\t\t\t\tif ( params.normalScale ) material.normalScale = params.normalScale;\n\n\t\t\t\tmaterial.displacementMap = null;\n\t\t\t\tmaterial.displacementScale = 1;\n\t\t\t\tmaterial.displacementBias = 0;\n\n\t\t\t\tmaterial.specularMap = params.specularMap === undefined ? null : params.specularMap;\n\t\t\t\tmaterial.specular = params.specular;\n\n\t\t\t\tmaterial.glossinessMap = params.glossinessMap === undefined ? null : params.glossinessMap;\n\t\t\t\tmaterial.glossiness = params.glossiness;\n\n\t\t\t\tmaterial.alphaMap = null;\n\n\t\t\t\tmaterial.envMap = params.envMap === undefined ? null : params.envMap;\n\t\t\t\tmaterial.envMapIntensity = 1.0;\n\n\t\t\t\tmaterial.refractionRatio = 0.98;\n\n\t\t\t\tmaterial.extensions.derivatives = true;\n\n\t\t\t\treturn material;\n\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Clones a GLTFSpecularGlossinessMaterial instance. The ShaderMaterial.copy() method can\n\t\t\t * copy only properties it knows about or inherits, and misses many properties that would\n\t\t\t * normally be defined by MeshStandardMaterial.\n\t\t\t *\n\t\t\t * This method allows GLTFSpecularGlossinessMaterials to be cloned in the process of\n\t\t\t * loading a glTF model, but cloning later (e.g. by the user) would require these changes\n\t\t\t * AND also updating `.onBeforeRender` on the parent mesh.\n\t\t\t *\n\t\t\t * @param  {THREE.ShaderMaterial} source\n\t\t\t * @return {THREE.ShaderMaterial}\n\t\t\t */\n\t\t\tcloneMaterial: function ( source ) {\n\n\t\t\t\tvar target = source.clone();\n\n\t\t\t\ttarget.isGLTFSpecularGlossinessMaterial = true;\n\n\t\t\t\tvar params = this.specularGlossinessParams;\n\n\t\t\t\tfor ( var i = 0, il = params.length; i < il; i ++ ) {\n\n\t\t\t\t\ttarget[ params[ i ] ] = source[ params[ i ] ];\n\n\t\t\t\t}\n\n\t\t\t\treturn target;\n\n\t\t\t},\n\n\t\t\t// Here's based on refreshUniformsCommon() and refreshUniformsStandard() in WebGLRenderer.\n\t\t\trefreshUniforms: function ( renderer, scene, camera, geometry, material, group ) {\n\n\t\t\t\tif ( material.isGLTFSpecularGlossinessMaterial !== true ) {\n\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tvar uniforms = material.uniforms;\n\t\t\t\tvar defines = material.defines;\n\n\t\t\t\tuniforms.opacity.value = material.opacity;\n\n\t\t\t\tuniforms.diffuse.value.copy( material.color );\n\t\t\t\tuniforms.emissive.value.copy( material.emissive ).multiplyScalar( material.emissiveIntensity );\n\n\t\t\t\tuniforms.map.value = material.map;\n\t\t\t\tuniforms.specularMap.value = material.specularMap;\n\t\t\t\tuniforms.alphaMap.value = material.alphaMap;\n\n\t\t\t\tuniforms.lightMap.value = material.lightMap;\n\t\t\t\tuniforms.lightMapIntensity.value = material.lightMapIntensity;\n\n\t\t\t\tuniforms.aoMap.value = material.aoMap;\n\t\t\t\tuniforms.aoMapIntensity.value = material.aoMapIntensity;\n\n\t\t\t\t// uv repeat and offset setting priorities\n\t\t\t\t// 1. color map\n\t\t\t\t// 2. specular map\n\t\t\t\t// 3. normal map\n\t\t\t\t// 4. bump map\n\t\t\t\t// 5. alpha map\n\t\t\t\t// 6. emissive map\n\n\t\t\t\tvar uvScaleMap;\n\n\t\t\t\tif ( material.map ) {\n\n\t\t\t\t\tuvScaleMap = material.map;\n\n\t\t\t\t} else if ( material.specularMap ) {\n\n\t\t\t\t\tuvScaleMap = material.specularMap;\n\n\t\t\t\t} else if ( material.displacementMap ) {\n\n\t\t\t\t\tuvScaleMap = material.displacementMap;\n\n\t\t\t\t} else if ( material.normalMap ) {\n\n\t\t\t\t\tuvScaleMap = material.normalMap;\n\n\t\t\t\t} else if ( material.bumpMap ) {\n\n\t\t\t\t\tuvScaleMap = material.bumpMap;\n\n\t\t\t\t} else if ( material.glossinessMap ) {\n\n\t\t\t\t\tuvScaleMap = material.glossinessMap;\n\n\t\t\t\t} else if ( material.alphaMap ) {\n\n\t\t\t\t\tuvScaleMap = material.alphaMap;\n\n\t\t\t\t} else if ( material.emissiveMap ) {\n\n\t\t\t\t\tuvScaleMap = material.emissiveMap;\n\n\t\t\t\t}\n\n\t\t\t\tif ( uvScaleMap !== undefined ) {\n\n\t\t\t\t\t// backwards compatibility\n\t\t\t\t\tif ( uvScaleMap.isWebGLRenderTarget ) {\n\n\t\t\t\t\t\tuvScaleMap = uvScaleMap.texture;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( uvScaleMap.matrixAutoUpdate === true ) {\n\n\t\t\t\t\t\tuvScaleMap.updateMatrix();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tuniforms.uvTransform.value.copy( uvScaleMap.matrix );\n\n\t\t\t\t}\n\n\t\t\t\tif ( material.envMap ) {\n\n\t\t\t\t\tuniforms.envMap.value = material.envMap;\n\t\t\t\t\tuniforms.envMapIntensity.value = material.envMapIntensity;\n\n\t\t\t\t\t// don't flip CubeTexture envMaps, flip everything else:\n\t\t\t\t\t//  WebGLRenderTargetCube will be flipped for backwards compatibility\n\t\t\t\t\t//  WebGLRenderTargetCube.texture will be flipped because it's a Texture and NOT a CubeTexture\n\t\t\t\t\t// this check must be handled differently, or removed entirely, if WebGLRenderTargetCube uses a CubeTexture in the future\n\t\t\t\t\tuniforms.flipEnvMap.value = material.envMap.isCubeTexture ? - 1 : 1;\n\n\t\t\t\t\tuniforms.reflectivity.value = material.reflectivity;\n\t\t\t\t\tuniforms.refractionRatio.value = material.refractionRatio;\n\n\t\t\t\t\tuniforms.maxMipLevel.value = renderer.properties.get( material.envMap ).__maxMipLevel;\n\n\t\t\t\t}\n\n\t\t\t\tuniforms.specular.value.copy( material.specular );\n\t\t\t\tuniforms.glossiness.value = material.glossiness;\n\n\t\t\t\tuniforms.glossinessMap.value = material.glossinessMap;\n\n\t\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\n\t\t\t\tuniforms.bumpMap.value = material.bumpMap;\n\t\t\t\tuniforms.normalMap.value = material.normalMap;\n\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t\t\tif ( uniforms.glossinessMap.value !== null && defines.USE_GLOSSINESSMAP === undefined ) {\n\n\t\t\t\t\tdefines.USE_GLOSSINESSMAP = '';\n\t\t\t\t\t// set USE_ROUGHNESSMAP to enable vUv\n\t\t\t\t\tdefines.USE_ROUGHNESSMAP = '';\n\n\t\t\t\t}\n\n\t\t\t\tif ( uniforms.glossinessMap.value === null && defines.USE_GLOSSINESSMAP !== undefined ) {\n\n\t\t\t\t\tdelete defines.USE_GLOSSINESSMAP;\n\t\t\t\t\tdelete defines.USE_ROUGHNESSMAP;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t/*********************************/\n\t/********** INTERPOLATION ********/\n\t/*********************************/\n\n\t// Spline Interpolation\n\t// Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\n\tfunction GLTFCubicSplineInterpolant( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tTHREE.Interpolant.call( this, parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tGLTFCubicSplineInterpolant.prototype = Object.create( THREE.Interpolant.prototype );\n\tGLTFCubicSplineInterpolant.prototype.constructor = GLTFCubicSplineInterpolant;\n\n\tGLTFCubicSplineInterpolant.prototype.copySampleValue_ = function ( index ) {\n\n\t\t// Copies a sample value to the result buffer. See description of glTF\n\t\t// CUBICSPLINE values layout in interpolate_() function below.\n\n\t\tvar result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tvalueSize = this.valueSize,\n\t\t\toffset = index * valueSize * 3 + valueSize;\n\n\t\tfor ( var i = 0; i !== valueSize; i ++ ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t};\n\n\tGLTFCubicSplineInterpolant.prototype.beforeStart_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\n\tGLTFCubicSplineInterpolant.prototype.afterEnd_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\n\tGLTFCubicSplineInterpolant.prototype.interpolate_ = function ( i1, t0, t, t1 ) {\n\n\t\tvar result = this.resultBuffer;\n\t\tvar values = this.sampleValues;\n\t\tvar stride = this.valueSize;\n\n\t\tvar stride2 = stride * 2;\n\t\tvar stride3 = stride * 3;\n\n\t\tvar td = t1 - t0;\n\n\t\tvar p = ( t - t0 ) / td;\n\t\tvar pp = p * p;\n\t\tvar ppp = pp * p;\n\n\t\tvar offset1 = i1 * stride3;\n\t\tvar offset0 = offset1 - stride3;\n\n\t\tvar s2 = - 2 * ppp + 3 * pp;\n\t\tvar s3 = ppp - pp;\n\t\tvar s0 = 1 - s2;\n\t\tvar s1 = s3 - pp + p;\n\n\t\t// Layout of keyframe output values for CUBICSPLINE animations:\n\t\t//   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n\t\tfor ( var i = 0; i !== stride; i ++ ) {\n\n\t\t\tvar p0 = values[ offset0 + i + stride ]; // splineVertex_k\n\t\t\tvar m0 = values[ offset0 + i + stride2 ] * td; // outTangent_k * (t_k+1 - t_k)\n\t\t\tvar p1 = values[ offset1 + i + stride ]; // splineVertex_k+1\n\t\t\tvar m1 = values[ offset1 + i ] * td; // inTangent_k+1 * (t_k+1 - t_k)\n\n\t\t\tresult[ i ] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\n\n\t\t}\n\n\t\treturn result;\n\n\t};\n\n\t/*********************************/\n\t/********** INTERNALS ************/\n\t/*********************************/\n\n\t/* CONSTANTS */\n\n\tvar WEBGL_CONSTANTS = {\n\t\tFLOAT: 5126,\n\t\t//FLOAT_MAT2: 35674,\n\t\tFLOAT_MAT3: 35675,\n\t\tFLOAT_MAT4: 35676,\n\t\tFLOAT_VEC2: 35664,\n\t\tFLOAT_VEC3: 35665,\n\t\tFLOAT_VEC4: 35666,\n\t\tLINEAR: 9729,\n\t\tREPEAT: 10497,\n\t\tSAMPLER_2D: 35678,\n\t\tPOINTS: 0,\n\t\tLINES: 1,\n\t\tLINE_LOOP: 2,\n\t\tLINE_STRIP: 3,\n\t\tTRIANGLES: 4,\n\t\tTRIANGLE_STRIP: 5,\n\t\tTRIANGLE_FAN: 6,\n\t\tUNSIGNED_BYTE: 5121,\n\t\tUNSIGNED_SHORT: 5123\n\t};\n\n\tvar WEBGL_TYPE = {\n\t\t5126: Number,\n\t\t//35674: THREE.Matrix2,\n\t\t35675: THREE.Matrix3,\n\t\t35676: THREE.Matrix4,\n\t\t35664: THREE.Vector2,\n\t\t35665: THREE.Vector3,\n\t\t35666: THREE.Vector4,\n\t\t35678: THREE.Texture\n\t};\n\n\tvar WEBGL_COMPONENT_TYPES = {\n\t\t5120: Int8Array,\n\t\t5121: Uint8Array,\n\t\t5122: Int16Array,\n\t\t5123: Uint16Array,\n\t\t5125: Uint32Array,\n\t\t5126: Float32Array\n\t};\n\n\tvar WEBGL_FILTERS = {\n\t\t9728: THREE.NearestFilter,\n\t\t9729: THREE.LinearFilter,\n\t\t9984: THREE.NearestMipMapNearestFilter,\n\t\t9985: THREE.LinearMipMapNearestFilter,\n\t\t9986: THREE.NearestMipMapLinearFilter,\n\t\t9987: THREE.LinearMipMapLinearFilter\n\t};\n\n\tvar WEBGL_WRAPPINGS = {\n\t\t33071: THREE.ClampToEdgeWrapping,\n\t\t33648: THREE.MirroredRepeatWrapping,\n\t\t10497: THREE.RepeatWrapping\n\t};\n\n\tvar WEBGL_SIDES = {\n\t\t1028: THREE.BackSide, // Culling front\n\t\t1029: THREE.FrontSide // Culling back\n\t\t//1032: THREE.NoSide   // Culling front and back, what to do?\n\t};\n\n\tvar WEBGL_DEPTH_FUNCS = {\n\t\t512: THREE.NeverDepth,\n\t\t513: THREE.LessDepth,\n\t\t514: THREE.EqualDepth,\n\t\t515: THREE.LessEqualDepth,\n\t\t516: THREE.GreaterEqualDepth,\n\t\t517: THREE.NotEqualDepth,\n\t\t518: THREE.GreaterEqualDepth,\n\t\t519: THREE.AlwaysDepth\n\t};\n\n\tvar WEBGL_BLEND_EQUATIONS = {\n\t\t32774: THREE.AddEquation,\n\t\t32778: THREE.SubtractEquation,\n\t\t32779: THREE.ReverseSubtractEquation\n\t};\n\n\tvar WEBGL_BLEND_FUNCS = {\n\t\t0: THREE.ZeroFactor,\n\t\t1: THREE.OneFactor,\n\t\t768: THREE.SrcColorFactor,\n\t\t769: THREE.OneMinusSrcColorFactor,\n\t\t770: THREE.SrcAlphaFactor,\n\t\t771: THREE.OneMinusSrcAlphaFactor,\n\t\t772: THREE.DstAlphaFactor,\n\t\t773: THREE.OneMinusDstAlphaFactor,\n\t\t774: THREE.DstColorFactor,\n\t\t775: THREE.OneMinusDstColorFactor,\n\t\t776: THREE.SrcAlphaSaturateFactor\n\t\t// The followings are not supported by Three.js yet\n\t\t//32769: CONSTANT_COLOR,\n\t\t//32770: ONE_MINUS_CONSTANT_COLOR,\n\t\t//32771: CONSTANT_ALPHA,\n\t\t//32772: ONE_MINUS_CONSTANT_COLOR\n\t};\n\n\tvar WEBGL_TYPE_SIZES = {\n\t\t'SCALAR': 1,\n\t\t'VEC2': 2,\n\t\t'VEC3': 3,\n\t\t'VEC4': 4,\n\t\t'MAT2': 4,\n\t\t'MAT3': 9,\n\t\t'MAT4': 16\n\t};\n\n\tvar ATTRIBUTES = {\n\t\tPOSITION: 'position',\n\t\tNORMAL: 'normal',\n\t\tTANGENT: 'tangent',\n\t\tTEXCOORD_0: 'uv',\n\t\tTEXCOORD_1: 'uv2',\n\t\tCOLOR_0: 'color',\n\t\tWEIGHTS_0: 'skinWeight',\n\t\tJOINTS_0: 'skinIndex',\n\t};\n\n\tvar PATH_PROPERTIES = {\n\t\tscale: 'scale',\n\t\ttranslation: 'position',\n\t\trotation: 'quaternion',\n\t\tweights: 'morphTargetInfluences'\n\t};\n\n\tvar INTERPOLATION = {\n\t\tCUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n\t\t                        // keyframe track will be initialized with a default interpolation type, then modified.\n\t\tLINEAR: THREE.InterpolateLinear,\n\t\tSTEP: THREE.InterpolateDiscrete\n\t};\n\n\tvar STATES_ENABLES = {\n\t\t2884: 'CULL_FACE',\n\t\t2929: 'DEPTH_TEST',\n\t\t3042: 'BLEND',\n\t\t3089: 'SCISSOR_TEST',\n\t\t32823: 'POLYGON_OFFSET_FILL',\n\t\t32926: 'SAMPLE_ALPHA_TO_COVERAGE'\n\t};\n\n\tvar ALPHA_MODES = {\n\t\tOPAQUE: 'OPAQUE',\n\t\tMASK: 'MASK',\n\t\tBLEND: 'BLEND'\n\t};\n\n\tvar MIME_TYPE_FORMATS = {\n\t\t'image/png': THREE.RGBAFormat,\n\t\t'image/jpeg': THREE.RGBFormat\n\t};\n\n\t/* UTILITY FUNCTIONS */\n\n\tfunction resolveURL( url, path ) {\n\n\t\t// Invalid URL\n\t\tif ( typeof url !== 'string' || url === '' ) return '';\n\n\t\t// Absolute URL http://,https://,//\n\t\tif ( /^(https?:)?\\/\\//i.test( url ) ) return url;\n\n\t\t// Data URI\n\t\tif ( /^data:.*,.*$/i.test( url ) ) return url;\n\n\t\t// Blob URL\n\t\tif ( /^blob:.*$/i.test( url ) ) return url;\n\n\t\t// Relative URL\n\t\treturn path + url;\n\n\t}\n\n\tvar defaultMaterial;\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n\t */\n\tfunction createDefaultMaterial() {\n\n\t\tdefaultMaterial = defaultMaterial || new THREE.MeshStandardMaterial( {\n\t\t\tcolor: 0xFFFFFF,\n\t\t\temissive: 0x000000,\n\t\t\tmetalness: 1,\n\t\t\troughness: 1,\n\t\t\ttransparent: false,\n\t\t\tdepthTest: true,\n\t\t\tside: THREE.FrontSide\n\t\t} );\n\n\t\treturn defaultMaterial;\n\n\t}\n\n\tfunction addUnknownExtensionsToUserData( knownExtensions, object, objectDef ) {\n\n\t\t// Add unknown glTF extensions to an object's userData.\n\n\t\tfor ( var name in objectDef.extensions ) {\n\n\t\t\tif ( knownExtensions[ name ] === undefined ) {\n\n\t\t\t\tobject.userData.gltfExtensions = object.userData.gltfExtensions || {};\n\t\t\t\tobject.userData.gltfExtensions[ name ] = objectDef.extensions[ name ];\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * @param {THREE.Object3D|THREE.Material|THREE.BufferGeometry} object\n\t * @param {GLTF.definition} gltfDef\n\t */\n\tfunction assignExtrasToUserData( object, gltfDef ) {\n\n\t\tif ( gltfDef.extras !== undefined ) {\n\n\t\t\tif ( typeof gltfDef.extras === 'object' ) {\n\n\t\t\t\tobject.userData = gltfDef.extras;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n\t *\n\t * @param {THREE.BufferGeometry} geometry\n\t * @param {Array<GLTF.Target>} targets\n\t * @param {GLTFParser} parser\n\t * @return {Promise<THREE.BufferGeometry>}\n\t */\n\tfunction addMorphTargets( geometry, targets, parser ) {\n\n\t\tvar hasMorphPosition = false;\n\t\tvar hasMorphNormal = false;\n\n\t\tfor ( var i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tvar target = targets[ i ];\n\n\t\t\tif ( target.POSITION !== undefined ) hasMorphPosition = true;\n\t\t\tif ( target.NORMAL !== undefined ) hasMorphNormal = true;\n\n\t\t\tif ( hasMorphPosition && hasMorphNormal ) break;\n\n\t\t}\n\n\t\tif ( ! hasMorphPosition && ! hasMorphNormal ) return Promise.resolve( geometry );\n\n\t\tvar pendingPositionAccessors = [];\n\t\tvar pendingNormalAccessors = [];\n\n\t\tfor ( var i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tvar target = targets[ i ];\n\n\t\t\tif ( hasMorphPosition ) {\n\n\t\t\t\tvar pendingAccessor = target.POSITION !== undefined\n\t\t\t\t\t? parser.getDependency( 'accessor', target.POSITION )\n\t\t\t\t\t: geometry.attributes.position;\n\n\t\t\t\tpendingPositionAccessors.push( pendingAccessor );\n\n\t\t\t}\n\n\t\t\tif ( hasMorphNormal ) {\n\n\t\t\t\tvar pendingAccessor = target.NORMAL !== undefined\n\t\t\t\t\t? parser.getDependency( 'accessor', target.NORMAL )\n\t\t\t\t\t: geometry.attributes.normal;\n\n\t\t\t\tpendingNormalAccessors.push( pendingAccessor );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( [\n\t\t\tPromise.all( pendingPositionAccessors ),\n\t\t\tPromise.all( pendingNormalAccessors )\n\t\t] ).then( function ( accessors ) {\n\n\t\t\tvar morphPositions = accessors[ 0 ];\n\t\t\tvar morphNormals = accessors[ 1 ];\n\n\t\t\t// Clone morph target accessors before modifying them.\n\n\t\t\tfor ( var i = 0, il = morphPositions.length; i < il; i ++ ) {\n\n\t\t\t\tif ( geometry.attributes.position === morphPositions[ i ] ) continue;\n\n\t\t\t\tmorphPositions[ i ] = cloneBufferAttribute( morphPositions[ i ] );\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0, il = morphNormals.length; i < il; i ++ ) {\n\n\t\t\t\tif ( geometry.attributes.normal === morphNormals[ i ] ) continue;\n\n\t\t\t\tmorphNormals[ i ] = cloneBufferAttribute( morphNormals[ i ] );\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\t\tvar target = targets[ i ];\n\t\t\t\tvar attributeName = 'morphTarget' + i;\n\n\t\t\t\tif ( hasMorphPosition ) {\n\n\t\t\t\t\t// Three.js morph position is absolute value. The formula is\n\t\t\t\t\t//   basePosition\n\t\t\t\t\t//     + weight0 * ( morphPosition0 - basePosition )\n\t\t\t\t\t//     + weight1 * ( morphPosition1 - basePosition )\n\t\t\t\t\t//     ...\n\t\t\t\t\t// while the glTF one is relative\n\t\t\t\t\t//   basePosition\n\t\t\t\t\t//     + weight0 * glTFmorphPosition0\n\t\t\t\t\t//     + weight1 * glTFmorphPosition1\n\t\t\t\t\t//     ...\n\t\t\t\t\t// then we need to convert from relative to absolute here.\n\n\t\t\t\t\tif ( target.POSITION !== undefined ) {\n\n\t\t\t\t\t\tvar positionAttribute = morphPositions[ i ];\n\t\t\t\t\t\tpositionAttribute.name = attributeName;\n\n\t\t\t\t\t\tvar position = geometry.attributes.position;\n\n\t\t\t\t\t\tfor ( var j = 0, jl = positionAttribute.count; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tpositionAttribute.setXYZ(\n\t\t\t\t\t\t\t\tj,\n\t\t\t\t\t\t\t\tpositionAttribute.getX( j ) + position.getX( j ),\n\t\t\t\t\t\t\t\tpositionAttribute.getY( j ) + position.getY( j ),\n\t\t\t\t\t\t\t\tpositionAttribute.getZ( j ) + position.getZ( j )\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( hasMorphNormal ) {\n\n\t\t\t\t\t// see target.POSITION's comment\n\n\t\t\t\t\tif ( target.NORMAL !== undefined ) {\n\n\t\t\t\t\t\tvar normalAttribute = morphNormals[ i ];\n\t\t\t\t\t\tnormalAttribute.name = attributeName;\n\n\t\t\t\t\t\tvar normal = geometry.attributes.normal;\n\n\t\t\t\t\t\tfor ( var j = 0, jl = normalAttribute.count; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tnormalAttribute.setXYZ(\n\t\t\t\t\t\t\t\tj,\n\t\t\t\t\t\t\t\tnormalAttribute.getX( j ) + normal.getX( j ),\n\t\t\t\t\t\t\t\tnormalAttribute.getY( j ) + normal.getY( j ),\n\t\t\t\t\t\t\t\tnormalAttribute.getZ( j ) + normal.getZ( j )\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( hasMorphPosition ) geometry.morphAttributes.position = morphPositions;\n\t\t\tif ( hasMorphNormal ) geometry.morphAttributes.normal = morphNormals;\n\n\t\t\treturn geometry;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * @param {THREE.Mesh} mesh\n\t * @param {GLTF.Mesh} meshDef\n\t */\n\tfunction updateMorphTargets( mesh, meshDef ) {\n\n\t\tmesh.updateMorphTargets();\n\n\t\tif ( meshDef.weights !== undefined ) {\n\n\t\t\tfor ( var i = 0, il = meshDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\tmesh.morphTargetInfluences[ i ] = meshDef.weights[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// .extras has user-defined data, so check that .extras.targetNames is an array.\n\t\tif ( meshDef.extras && Array.isArray( meshDef.extras.targetNames ) ) {\n\n\t\t\tvar targetNames = meshDef.extras.targetNames;\n\n\t\t\tif ( mesh.morphTargetInfluences.length === targetNames.length ) {\n\n\t\t\t\tmesh.morphTargetDictionary = {};\n\n\t\t\t\tfor ( var i = 0, il = targetNames.length; i < il; i ++ ) {\n\n\t\t\t\t\tmesh.morphTargetDictionary[ targetNames[ i ] ] = i;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\tfunction isObjectEqual( a, b ) {\n\n\t\tif ( Object.keys( a ).length !== Object.keys( b ).length ) return false;\n\n\t\tfor ( var key in a ) {\n\n\t\t\tif ( a[ key ] !== b[ key ] ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tfunction createPrimitiveKey( primitiveDef ) {\n\n\t\tvar dracoExtension = primitiveDef.extensions && primitiveDef.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ];\n\t\tvar geometryKey;\n\n\t\tif ( dracoExtension ) {\n\n\t\t\tgeometryKey = 'draco:' + dracoExtension.bufferView\n\t\t\t\t+ ':' + dracoExtension.indices\n\t\t\t\t+ ':' + createAttributesKey( dracoExtension.attributes );\n\n\t\t} else {\n\n\t\t\tgeometryKey = primitiveDef.indices + ':' + createAttributesKey( primitiveDef.attributes ) + ':' + primitiveDef.mode;\n\n\t\t}\n\n\t\treturn geometryKey;\n\n\t}\n\n\tfunction createAttributesKey( attributes ) {\n\n\t\tvar attributesKey = '';\n\n\t\tvar keys = Object.keys( attributes ).sort();\n\n\t\tfor ( var i = 0, il = keys.length; i < il; i ++ ) {\n\n\t\t\tattributesKey += keys[ i ] + ':' + attributes[ keys[ i ] ] + ';';\n\n\t\t}\n\n\t\treturn attributesKey;\n\n\t}\n\n\tfunction cloneBufferAttribute( attribute ) {\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tvar count = attribute.count;\n\t\t\tvar itemSize = attribute.itemSize;\n\t\t\tvar array = attribute.array.slice( 0, count * itemSize );\n\n\t\t\tfor ( var i = 0, j = 0; i < count; ++ i ) {\n\n\t\t\t\tarray[ j ++ ] = attribute.getX( i );\n\t\t\t\tif ( itemSize >= 2 ) array[ j ++ ] = attribute.getY( i );\n\t\t\t\tif ( itemSize >= 3 ) array[ j ++ ] = attribute.getZ( i );\n\t\t\t\tif ( itemSize >= 4 ) array[ j ++ ] = attribute.getW( i );\n\n\t\t\t}\n\n\t\t\treturn new THREE.BufferAttribute( array, itemSize, attribute.normalized );\n\n\t\t}\n\n\t\treturn attribute.clone();\n\n\t}\n\n\t/* GLTF PARSER */\n\n\tfunction GLTFParser( json, extensions, options ) {\n\n\t\tthis.json = json || {};\n\t\tthis.extensions = extensions || {};\n\t\tthis.options = options || {};\n\n\t\t// loader object cache\n\t\tthis.cache = new GLTFRegistry();\n\n\t\t// BufferGeometry caching\n\t\tthis.primitiveCache = {};\n\n\t\tthis.textureLoader = new THREE.TextureLoader( this.options.manager );\n\t\tthis.textureLoader.setCrossOrigin( this.options.crossOrigin );\n\n\t\tthis.fileLoader = new THREE.FileLoader( this.options.manager );\n\t\tthis.fileLoader.setResponseType( 'arraybuffer' );\n\n\t}\n\n\tGLTFParser.prototype.parse = function ( onLoad, onError ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\t\tvar extensions = this.extensions;\n\n\t\t// Clear the loader cache\n\t\tthis.cache.removeAll();\n\n\t\t// Mark the special nodes/meshes in json for efficient parse\n\t\tthis.markDefs();\n\n\t\tPromise.all( [\n\n\t\t\tthis.getDependencies( 'scene' ),\n\t\t\tthis.getDependencies( 'animation' ),\n\t\t\tthis.getDependencies( 'camera' ),\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tvar result = {\n\t\t\t\tscene: dependencies[ 0 ][ json.scene || 0 ],\n\t\t\t\tscenes: dependencies[ 0 ],\n\t\t\t\tanimations: dependencies[ 1 ],\n\t\t\t\tcameras: dependencies[ 2 ],\n\t\t\t\tasset: json.asset,\n\t\t\t\tparser: parser,\n\t\t\t\tuserData: {}\n\t\t\t};\n\n\t\t\taddUnknownExtensionsToUserData( extensions, result, json );\n\n\t\t\tonLoad( result );\n\n\t\t} ).catch( onError );\n\n\t};\n\n\t/**\n\t * Marks the special nodes/meshes in json for efficient parse.\n\t */\n\tGLTFParser.prototype.markDefs = function () {\n\n\t\tvar nodeDefs = this.json.nodes || [];\n\t\tvar skinDefs = this.json.skins || [];\n\t\tvar meshDefs = this.json.meshes || [];\n\n\t\tvar meshReferences = {};\n\t\tvar meshUses = {};\n\n\t\t// Nothing in the node definition indicates whether it is a Bone or an\n\t\t// Object3D. Use the skins' joint references to mark bones.\n\t\tfor ( var skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex ++ ) {\n\n\t\t\tvar joints = skinDefs[ skinIndex ].joints;\n\n\t\t\tfor ( var i = 0, il = joints.length; i < il; i ++ ) {\n\n\t\t\t\tnodeDefs[ joints[ i ] ].isBone = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Meshes can (and should) be reused by multiple nodes in a glTF asset. To\n\t\t// avoid having more than one THREE.Mesh with the same name, count\n\t\t// references and rename instances below.\n\t\t//\n\t\t// Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n\t\tfor ( var nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tvar nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\tif ( meshReferences[ nodeDef.mesh ] === undefined ) {\n\n\t\t\t\t\tmeshReferences[ nodeDef.mesh ] = meshUses[ nodeDef.mesh ] = 0;\n\n\t\t\t\t}\n\n\t\t\t\tmeshReferences[ nodeDef.mesh ] ++;\n\n\t\t\t\t// Nothing in the mesh definition indicates whether it is\n\t\t\t\t// a SkinnedMesh or Mesh. Use the node's mesh reference\n\t\t\t\t// to mark SkinnedMesh if node has skin.\n\t\t\t\tif ( nodeDef.skin !== undefined ) {\n\n\t\t\t\t\tmeshDefs[ nodeDef.mesh ].isSkinnedMesh = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.json.meshReferences = meshReferences;\n\t\tthis.json.meshUses = meshUses;\n\n\t};\n\n\t/**\n\t * Requests the specified dependency asynchronously, with caching.\n\t * @param {string} type\n\t * @param {number} index\n\t * @return {Promise<THREE.Object3D|THREE.Material|THREE.Texture|THREE.AnimationClip|ArrayBuffer|Object>}\n\t */\n\tGLTFParser.prototype.getDependency = function ( type, index ) {\n\n\t\tvar cacheKey = type + ':' + index;\n\t\tvar dependency = this.cache.get( cacheKey );\n\n\t\tif ( ! dependency ) {\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'scene':\n\t\t\t\t\tdependency = this.loadScene( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'node':\n\t\t\t\t\tdependency = this.loadNode( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'mesh':\n\t\t\t\t\tdependency = this.loadMesh( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'accessor':\n\t\t\t\t\tdependency = this.loadAccessor( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bufferView':\n\t\t\t\t\tdependency = this.loadBufferView( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'buffer':\n\t\t\t\t\tdependency = this.loadBuffer( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'material':\n\t\t\t\t\tdependency = this.loadMaterial( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'texture':\n\t\t\t\t\tdependency = this.loadTexture( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'skin':\n\t\t\t\t\tdependency = this.loadSkin( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'animation':\n\t\t\t\t\tdependency = this.loadAnimation( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'camera':\n\t\t\t\t\tdependency = this.loadCamera( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'light':\n\t\t\t\t\tdependency = this.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ].loadLight( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error( 'Unknown type: ' + type );\n\n\t\t\t}\n\n\t\t\tthis.cache.add( cacheKey, dependency );\n\n\t\t}\n\n\t\treturn dependency;\n\n\t};\n\n\t/**\n\t * Requests all dependencies of the specified type asynchronously, with caching.\n\t * @param {string} type\n\t * @return {Promise<Array<Object>>}\n\t */\n\tGLTFParser.prototype.getDependencies = function ( type ) {\n\n\t\tvar dependencies = this.cache.get( type );\n\n\t\tif ( ! dependencies ) {\n\n\t\t\tvar parser = this;\n\t\t\tvar defs = this.json[ type + ( type === 'mesh' ? 'es' : 's' ) ] || [];\n\n\t\t\tdependencies = Promise.all( defs.map( function ( def, index ) {\n\n\t\t\t\treturn parser.getDependency( type, index );\n\n\t\t\t} ) );\n\n\t\t\tthis.cache.add( type, dependencies );\n\n\t\t}\n\n\t\treturn dependencies;\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tGLTFParser.prototype.loadBuffer = function ( bufferIndex ) {\n\n\t\tvar bufferDef = this.json.buffers[ bufferIndex ];\n\t\tvar loader = this.fileLoader;\n\n\t\tif ( bufferDef.type && bufferDef.type !== 'arraybuffer' ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.' );\n\n\t\t}\n\n\t\t// If present, GLB container is required to be the first buffer.\n\t\tif ( bufferDef.uri === undefined && bufferIndex === 0 ) {\n\n\t\t\treturn Promise.resolve( this.extensions[ EXTENSIONS.KHR_BINARY_GLTF ].body );\n\n\t\t}\n\n\t\tvar options = this.options;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tloader.load( resolveURL( bufferDef.uri, options.path ), resolve, undefined, function () {\n\n\t\t\t\treject( new Error( 'THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".' ) );\n\n\t\t\t} );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferViewIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tGLTFParser.prototype.loadBufferView = function ( bufferViewIndex ) {\n\n\t\tvar bufferViewDef = this.json.bufferViews[ bufferViewIndex ];\n\n\t\treturn this.getDependency( 'buffer', bufferViewDef.buffer ).then( function ( buffer ) {\n\n\t\t\tvar byteLength = bufferViewDef.byteLength || 0;\n\t\t\tvar byteOffset = bufferViewDef.byteOffset || 0;\n\t\t\treturn buffer.slice( byteOffset, byteOffset + byteLength );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n\t * @param {number} accessorIndex\n\t * @return {Promise<THREE.BufferAttribute|THREE.InterleavedBufferAttribute>}\n\t */\n\tGLTFParser.prototype.loadAccessor = function ( accessorIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\n\t\tvar accessorDef = this.json.accessors[ accessorIndex ];\n\n\t\tif ( accessorDef.bufferView === undefined && accessorDef.sparse === undefined ) {\n\n\t\t\t// Ignore empty accessors, which may be used to declare runtime\n\t\t\t// information about attributes coming from another source (e.g. Draco\n\t\t\t// compression extension).\n\t\t\treturn Promise.resolve( null );\n\n\t\t}\n\n\t\tvar pendingBufferViews = [];\n\n\t\tif ( accessorDef.bufferView !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.bufferView ) );\n\n\t\t} else {\n\n\t\t\tpendingBufferViews.push( null );\n\n\t\t}\n\n\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.indices.bufferView ) );\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.values.bufferView ) );\n\n\t\t}\n\n\t\treturn Promise.all( pendingBufferViews ).then( function ( bufferViews ) {\n\n\t\t\tvar bufferView = bufferViews[ 0 ];\n\n\t\t\tvar itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tvar TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t// For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n\t\t\tvar elementBytes = TypedArray.BYTES_PER_ELEMENT;\n\t\t\tvar itemBytes = elementBytes * itemSize;\n\t\t\tvar byteOffset = accessorDef.byteOffset || 0;\n\t\t\tvar byteStride = accessorDef.bufferView !== undefined ? json.bufferViews[ accessorDef.bufferView ].byteStride : undefined;\n\t\t\tvar normalized = accessorDef.normalized === true;\n\t\t\tvar array, bufferAttribute;\n\n\t\t\t// The buffer is not interleaved if the stride is the item size in bytes.\n\t\t\tif ( byteStride && byteStride !== itemBytes ) {\n\n\t\t\t\tvar ibCacheKey = 'InterleavedBuffer:' + accessorDef.bufferView + ':' + accessorDef.componentType;\n\t\t\t\tvar ib = parser.cache.get( ibCacheKey );\n\n\t\t\t\tif ( ! ib ) {\n\n\t\t\t\t\t// Use the full buffer if it's interleaved.\n\t\t\t\t\tarray = new TypedArray( bufferView );\n\n\t\t\t\t\t// Integer parameters to IB/IBA are in array elements, not bytes.\n\t\t\t\t\tib = new THREE.InterleavedBuffer( array, byteStride / elementBytes );\n\n\t\t\t\t\tparser.cache.add( ibCacheKey, ib );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new THREE.InterleavedBufferAttribute( ib, itemSize, byteOffset / elementBytes, normalized );\n\n\t\t\t} else {\n\n\t\t\t\tif ( bufferView === null ) {\n\n\t\t\t\t\tarray = new TypedArray( accessorDef.count * itemSize );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, byteOffset, accessorDef.count * itemSize );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new THREE.BufferAttribute( array, itemSize, normalized );\n\n\t\t\t}\n\n\t\t\t// https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n\t\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\t\tvar itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\n\t\t\t\tvar TypedArrayIndices = WEBGL_COMPONENT_TYPES[ accessorDef.sparse.indices.componentType ];\n\n\t\t\t\tvar byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\n\t\t\t\tvar byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\n\n\t\t\t\tvar sparseIndices = new TypedArrayIndices( bufferViews[ 1 ], byteOffsetIndices, accessorDef.sparse.count * itemSizeIndices );\n\t\t\t\tvar sparseValues = new TypedArray( bufferViews[ 2 ], byteOffsetValues, accessorDef.sparse.count * itemSize );\n\n\t\t\t\tif ( bufferView !== null ) {\n\n\t\t\t\t\t// Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n\t\t\t\t\tbufferAttribute.setArray( bufferAttribute.array.slice() );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var i = 0, il = sparseIndices.length; i < il; i ++ ) {\n\n\t\t\t\t\tvar index = sparseIndices[ i ];\n\n\t\t\t\t\tbufferAttribute.setX( index, sparseValues[ i * itemSize ] );\n\t\t\t\t\tif ( itemSize >= 2 ) bufferAttribute.setY( index, sparseValues[ i * itemSize + 1 ] );\n\t\t\t\t\tif ( itemSize >= 3 ) bufferAttribute.setZ( index, sparseValues[ i * itemSize + 2 ] );\n\t\t\t\t\tif ( itemSize >= 4 ) bufferAttribute.setW( index, sparseValues[ i * itemSize + 3 ] );\n\t\t\t\t\tif ( itemSize >= 5 ) throw new Error( 'THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn bufferAttribute;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n\t * @param {number} textureIndex\n\t * @return {Promise<THREE.Texture>}\n\t */\n\tGLTFParser.prototype.loadTexture = function ( textureIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\t\tvar options = this.options;\n\t\tvar textureLoader = this.textureLoader;\n\n\t\tvar URL = window.URL || window.webkitURL;\n\n\t\tvar textureDef = json.textures[ textureIndex ];\n\n\t\tvar textureExtensions = textureDef.extensions || {};\n\n\t\tvar source;\n\n\t\tif ( textureExtensions[ EXTENSIONS.MSFT_TEXTURE_DDS ] ) {\n\n\t\t\tsource = json.images[ textureExtensions[ EXTENSIONS.MSFT_TEXTURE_DDS ].source ];\n\n\t\t} else {\n\n\t\t\tsource = json.images[ textureDef.source ];\n\n\t\t}\n\n\t\tvar sourceURI = source.uri;\n\t\tvar isObjectURL = false;\n\n\t\tif ( source.bufferView !== undefined ) {\n\n\t\t\t// Load binary image data from bufferView, if provided.\n\n\t\t\tsourceURI = parser.getDependency( 'bufferView', source.bufferView ).then( function ( bufferView ) {\n\n\t\t\t\tisObjectURL = true;\n\t\t\t\tvar blob = new Blob( [ bufferView ], { type: source.mimeType } );\n\t\t\t\tsourceURI = URL.createObjectURL( blob );\n\t\t\t\treturn sourceURI;\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn Promise.resolve( sourceURI ).then( function ( sourceURI ) {\n\n\t\t\t// Load Texture resource.\n\n\t\t\tvar loader = THREE.Loader.Handlers.get( sourceURI );\n\n\t\t\tif ( ! loader ) {\n\n\t\t\t\tloader = textureExtensions[ EXTENSIONS.MSFT_TEXTURE_DDS ]\n\t\t\t\t\t? parser.extensions[ EXTENSIONS.MSFT_TEXTURE_DDS ].ddsLoader\n\t\t\t\t\t: textureLoader;\n\n\t\t\t}\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tloader.load( resolveURL( sourceURI, options.path ), resolve, undefined, reject );\n\n\t\t\t} );\n\n\t\t} ).then( function ( texture ) {\n\n\t\t\t// Clean up resources and configure Texture.\n\n\t\t\tif ( isObjectURL === true ) {\n\n\t\t\t\tURL.revokeObjectURL( sourceURI );\n\n\t\t\t}\n\n\t\t\ttexture.flipY = false;\n\n\t\t\tif ( textureDef.name !== undefined ) texture.name = textureDef.name;\n\n\t\t\t// Ignore unknown mime types, like DDS files.\n\t\t\tif ( source.mimeType in MIME_TYPE_FORMATS ) {\n\n\t\t\t\ttexture.format = MIME_TYPE_FORMATS[ source.mimeType ];\n\n\t\t\t}\n\n\t\t\tvar samplers = json.samplers || {};\n\t\t\tvar sampler = samplers[ textureDef.sampler ] || {};\n\n\t\t\ttexture.magFilter = WEBGL_FILTERS[ sampler.magFilter ] || THREE.LinearFilter;\n\t\t\ttexture.minFilter = WEBGL_FILTERS[ sampler.minFilter ] || THREE.LinearMipMapLinearFilter;\n\t\t\ttexture.wrapS = WEBGL_WRAPPINGS[ sampler.wrapS ] || THREE.RepeatWrapping;\n\t\t\ttexture.wrapT = WEBGL_WRAPPINGS[ sampler.wrapT ] || THREE.RepeatWrapping;\n\n\t\t\treturn texture;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Asynchronously assigns a texture to the given material parameters.\n\t * @param {Object} materialParams\n\t * @param {string} mapName\n\t * @param {Object} mapDef\n\t * @return {Promise}\n\t */\n\tGLTFParser.prototype.assignTexture = function ( materialParams, mapName, mapDef ) {\n\n\t\tvar parser = this;\n\n\t\treturn this.getDependency( 'texture', mapDef.index ).then( function ( texture ) {\n\n\t\t\tif ( ! texture.isCompressedTexture ) {\n\n\t\t\t\tswitch ( mapName ) {\n\n\t\t\t\t\tcase 'aoMap':\n\t\t\t\t\tcase 'emissiveMap':\n\t\t\t\t\tcase 'metalnessMap':\n\t\t\t\t\tcase 'normalMap':\n\t\t\t\t\tcase 'roughnessMap':\n\t\t\t\t\t\ttexture.format = THREE.RGBFormat;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] ) {\n\n\t\t\t\tvar transform = mapDef.extensions !== undefined ? mapDef.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] : undefined;\n\n\t\t\t\tif ( transform ) {\n\n\t\t\t\t\ttexture = parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ].extendTexture( texture, transform );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tmaterialParams[ mapName ] = texture;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Assigns final material to a Mesh, Line, or Points instance. The instance\n\t * already has a material (generated from the glTF material options alone)\n\t * but reuse of the same glTF material may require multiple threejs materials\n\t * to accomodate different primitive types, defines, etc. New materials will\n\t * be created if necessary, and reused from a cache.\n\t * @param  {THREE.Object3D} mesh Mesh, Line, or Points instance.\n\t */\n\tGLTFParser.prototype.assignFinalMaterial = function ( mesh ) {\n\n\t\tvar geometry = mesh.geometry;\n\t\tvar material = mesh.material;\n\t\tvar extensions = this.extensions;\n\n\t\tvar useVertexTangents = geometry.attributes.tangent !== undefined;\n\t\tvar useVertexColors = geometry.attributes.color !== undefined;\n\t\tvar useFlatShading = geometry.attributes.normal === undefined;\n\t\tvar useSkinning = mesh.isSkinnedMesh === true;\n\t\tvar useMorphTargets = Object.keys( geometry.morphAttributes ).length > 0;\n\t\tvar useMorphNormals = useMorphTargets && geometry.morphAttributes.normal !== undefined;\n\n\t\tif ( mesh.isPoints ) {\n\n\t\t\tvar cacheKey = 'PointsMaterial:' + material.uuid;\n\n\t\t\tvar pointsMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! pointsMaterial ) {\n\n\t\t\t\tpointsMaterial = new THREE.PointsMaterial();\n\t\t\t\tTHREE.Material.prototype.copy.call( pointsMaterial, material );\n\t\t\t\tpointsMaterial.color.copy( material.color );\n\t\t\t\tpointsMaterial.map = material.map;\n\t\t\t\tpointsMaterial.lights = false; // PointsMaterial doesn't support lights yet\n\n\t\t\t\tthis.cache.add( cacheKey, pointsMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = pointsMaterial;\n\n\t\t} else if ( mesh.isLine ) {\n\n\t\t\tvar cacheKey = 'LineBasicMaterial:' + material.uuid;\n\n\t\t\tvar lineMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! lineMaterial ) {\n\n\t\t\t\tlineMaterial = new THREE.LineBasicMaterial();\n\t\t\t\tTHREE.Material.prototype.copy.call( lineMaterial, material );\n\t\t\t\tlineMaterial.color.copy( material.color );\n\t\t\t\tlineMaterial.lights = false; // LineBasicMaterial doesn't support lights yet\n\n\t\t\t\tthis.cache.add( cacheKey, lineMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = lineMaterial;\n\n\t\t}\n\n\t\t// Clone the material if it will be modified\n\t\tif ( useVertexTangents || useVertexColors || useFlatShading || useSkinning || useMorphTargets ) {\n\n\t\t\tvar cacheKey = 'ClonedMaterial:' + material.uuid + ':';\n\n\t\t\tif ( material.isGLTFSpecularGlossinessMaterial ) cacheKey += 'specular-glossiness:';\n\t\t\tif ( useSkinning ) cacheKey += 'skinning:';\n\t\t\tif ( useVertexTangents ) cacheKey += 'vertex-tangents:';\n\t\t\tif ( useVertexColors ) cacheKey += 'vertex-colors:';\n\t\t\tif ( useFlatShading ) cacheKey += 'flat-shading:';\n\t\t\tif ( useMorphTargets ) cacheKey += 'morph-targets:';\n\t\t\tif ( useMorphNormals ) cacheKey += 'morph-normals:';\n\n\t\t\tvar cachedMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! cachedMaterial ) {\n\n\t\t\t\tcachedMaterial = material.isGLTFSpecularGlossinessMaterial\n\t\t\t\t\t? extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].cloneMaterial( material )\n\t\t\t\t\t: material.clone();\n\n\t\t\t\tif ( useSkinning ) cachedMaterial.skinning = true;\n\t\t\t\tif ( useVertexTangents ) cachedMaterial.vertexTangents = true;\n\t\t\t\tif ( useVertexColors ) cachedMaterial.vertexColors = THREE.VertexColors;\n\t\t\t\tif ( useFlatShading ) cachedMaterial.flatShading = true;\n\t\t\t\tif ( useMorphTargets ) cachedMaterial.morphTargets = true;\n\t\t\t\tif ( useMorphNormals ) cachedMaterial.morphNormals = true;\n\n\t\t\t\tthis.cache.add( cacheKey, cachedMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = cachedMaterial;\n\n\t\t}\n\n\t\t// workarounds for mesh and geometry\n\n\t\tif ( material.aoMap && geometry.attributes.uv2 === undefined && geometry.attributes.uv !== undefined ) {\n\n\t\t\tconsole.log( 'THREE.GLTFLoader: Duplicating UVs to support aoMap.' );\n\t\t\tgeometry.addAttribute( 'uv2', new THREE.BufferAttribute( geometry.attributes.uv.array, 2 ) );\n\n\t\t}\n\n\t\tif ( material.isGLTFSpecularGlossinessMaterial ) {\n\n\t\t\t// for GLTFSpecularGlossinessMaterial(ShaderMaterial) uniforms runtime update\n\t\t\tmesh.onBeforeRender = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].refreshUniforms;\n\n\t\t}\n\n\t\tmesh.material = material;\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n\t * @param {number} materialIndex\n\t * @return {Promise<THREE.Material>}\n\t */\n\tGLTFParser.prototype.loadMaterial = function ( materialIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\t\tvar extensions = this.extensions;\n\t\tvar materialDef = json.materials[ materialIndex ];\n\n\t\tvar materialType;\n\t\tvar materialParams = {};\n\t\tvar materialExtensions = materialDef.extensions || {};\n\n\t\tvar pending = [];\n\n\t\tif ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ] ) {\n\n\t\t\tvar sgExtension = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ];\n\t\t\tmaterialType = sgExtension.getMaterialType();\n\t\t\tpending.push( sgExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else if ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ] ) {\n\n\t\t\tvar kmuExtension = extensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ];\n\t\t\tmaterialType = kmuExtension.getMaterialType();\n\t\t\tpending.push( kmuExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else {\n\n\t\t\t// Specification:\n\t\t\t// https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n\t\t\tmaterialType = THREE.MeshStandardMaterial;\n\n\t\t\tvar metallicRoughness = materialDef.pbrMetallicRoughness || {};\n\n\t\t\tmaterialParams.color = new THREE.Color( 1.0, 1.0, 1.0 );\n\t\t\tmaterialParams.opacity = 1.0;\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tvar array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\n\n\t\t\t}\n\n\t\t\tmaterialParams.metalness = metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n\t\t\tmaterialParams.roughness = metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n\t\t\tif ( metallicRoughness.metallicRoughnessTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'metalnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'roughnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.doubleSided === true ) {\n\n\t\t\tmaterialParams.side = THREE.DoubleSide;\n\n\t\t}\n\n\t\tvar alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\n\n\t\tif ( alphaMode === ALPHA_MODES.BLEND ) {\n\n\t\t\tmaterialParams.transparent = true;\n\n\t\t} else {\n\n\t\t\tmaterialParams.transparent = false;\n\n\t\t\tif ( alphaMode === ALPHA_MODES.MASK ) {\n\n\t\t\t\tmaterialParams.alphaTest = materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.normalTexture !== undefined && materialType !== THREE.MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'normalMap', materialDef.normalTexture ) );\n\n\t\t\tmaterialParams.normalScale = new THREE.Vector2( 1, 1 );\n\n\t\t\tif ( materialDef.normalTexture.scale !== undefined ) {\n\n\t\t\t\tmaterialParams.normalScale.set( materialDef.normalTexture.scale, materialDef.normalTexture.scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.occlusionTexture !== undefined && materialType !== THREE.MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'aoMap', materialDef.occlusionTexture ) );\n\n\t\t\tif ( materialDef.occlusionTexture.strength !== undefined ) {\n\n\t\t\t\tmaterialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.emissiveFactor !== undefined && materialType !== THREE.MeshBasicMaterial ) {\n\n\t\t\tmaterialParams.emissive = new THREE.Color().fromArray( materialDef.emissiveFactor );\n\n\t\t}\n\n\t\tif ( materialDef.emissiveTexture !== undefined && materialType !== THREE.MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'emissiveMap', materialDef.emissiveTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\tvar material;\n\n\t\t\tif ( materialType === THREE.ShaderMaterial ) {\n\n\t\t\t\tmaterial = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].createMaterial( materialParams );\n\n\t\t\t} else {\n\n\t\t\t\tmaterial = new materialType( materialParams );\n\n\t\t\t}\n\n\t\t\tif ( materialDef.name !== undefined ) material.name = materialDef.name;\n\n\t\t\t// baseColorTexture, emissiveTexture, and specularGlossinessTexture use sRGB encoding.\n\t\t\tif ( material.map ) material.map.encoding = THREE.sRGBEncoding;\n\t\t\tif ( material.emissiveMap ) material.emissiveMap.encoding = THREE.sRGBEncoding;\n\t\t\tif ( material.specularMap ) material.specularMap.encoding = THREE.sRGBEncoding;\n\n\t\t\tassignExtrasToUserData( material, materialDef );\n\n\t\t\tif ( materialDef.extensions ) addUnknownExtensionsToUserData( extensions, material, materialDef );\n\n\t\t\treturn material;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * @param {THREE.BufferGeometry} geometry\n\t * @param {GLTF.Primitive} primitiveDef\n\t * @param {GLTFParser} parser\n\t * @return {Promise<THREE.BufferGeometry>}\n\t */\n\tfunction addPrimitiveAttributes( geometry, primitiveDef, parser ) {\n\n\t\tvar attributes = primitiveDef.attributes;\n\n\t\tvar pending = [];\n\n\t\tfunction assignAttributeAccessor( accessorIndex, attributeName ) {\n\n\t\t\treturn parser.getDependency( 'accessor', accessorIndex )\n\t\t\t\t.then( function ( accessor ) {\n\n\t\t\t\t\tgeometry.addAttribute( attributeName, accessor );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tfor ( var gltfAttributeName in attributes ) {\n\n\t\t\tvar threeAttributeName = ATTRIBUTES[ gltfAttributeName ] || gltfAttributeName.toLowerCase();\n\n\t\t\t// Skip attributes already provided by e.g. Draco extension.\n\t\t\tif ( threeAttributeName in geometry.attributes ) continue;\n\n\t\t\tpending.push( assignAttributeAccessor( attributes[ gltfAttributeName ], threeAttributeName ) );\n\n\t\t}\n\n\t\tif ( primitiveDef.indices !== undefined && ! geometry.index ) {\n\n\t\t\tvar accessor = parser.getDependency( 'accessor', primitiveDef.indices ).then( function ( accessor ) {\n\n\t\t\t\tgeometry.setIndex( accessor );\n\n\t\t\t} );\n\n\t\t\tpending.push( accessor );\n\n\t\t}\n\n\t\tassignExtrasToUserData( geometry, primitiveDef );\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\treturn primitiveDef.targets !== undefined\n\t\t\t\t? addMorphTargets( geometry, primitiveDef.targets, parser )\n\t\t\t\t: geometry;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n\t *\n\t * Creates BufferGeometries from primitives.\n\t *\n\t * @param {Array<GLTF.Primitive>} primitives\n\t * @return {Promise<Array<THREE.BufferGeometry>>}\n\t */\n\tGLTFParser.prototype.loadGeometries = function ( primitives ) {\n\n\t\tvar parser = this;\n\t\tvar extensions = this.extensions;\n\t\tvar cache = this.primitiveCache;\n\n\t\tfunction createDracoPrimitive( primitive ) {\n\n\t\t\treturn extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ]\n\t\t\t\t.decodePrimitive( primitive, parser )\n\t\t\t\t.then( function ( geometry ) {\n\n\t\t\t\t\treturn addPrimitiveAttributes( geometry, primitive, parser );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tvar pending = [];\n\n\t\tfor ( var i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tvar primitive = primitives[ i ];\n\t\t\tvar cacheKey = createPrimitiveKey( primitive );\n\n\t\t\t// See if we've already created this geometry\n\t\t\tvar cached = cache[ cacheKey ];\n\n\t\t\tif ( cached ) {\n\n\t\t\t\t// Use the cached geometry if it exists\n\t\t\t\tpending.push( cached.promise );\n\n\t\t\t} else {\n\n\t\t\t\tvar geometryPromise;\n\n\t\t\t\tif ( primitive.extensions && primitive.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] ) {\n\n\t\t\t\t\t// Use DRACO geometry if available\n\t\t\t\t\tgeometryPromise = createDracoPrimitive( primitive );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Otherwise create a new geometry\n\t\t\t\t\tgeometryPromise = addPrimitiveAttributes( new THREE.BufferGeometry(), primitive, parser );\n\n\t\t\t\t}\n\n\t\t\t\t// Cache this geometry\n\t\t\t\tcache[ cacheKey ] = { primitive: primitive, promise: geometryPromise };\n\n\t\t\t\tpending.push( geometryPromise );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n\t * @param {number} meshIndex\n\t * @return {Promise<THREE.Group|THREE.Mesh|THREE.SkinnedMesh>}\n\t */\n\tGLTFParser.prototype.loadMesh = function ( meshIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\t\tvar extensions = this.extensions;\n\n\t\tvar meshDef = json.meshes[ meshIndex ];\n\t\tvar primitives = meshDef.primitives;\n\n\t\tvar pending = [];\n\n\t\tfor ( var i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tvar material = primitives[ i ].material === undefined\n\t\t\t\t? createDefaultMaterial()\n\t\t\t\t: this.getDependency( 'material', primitives[ i ].material );\n\n\t\t\tpending.push( material );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function ( originalMaterials ) {\n\n\t\t\treturn parser.loadGeometries( primitives ).then( function ( geometries ) {\n\n\t\t\t\tvar meshes = [];\n\n\t\t\t\tfor ( var i = 0, il = geometries.length; i < il; i ++ ) {\n\n\t\t\t\t\tvar geometry = geometries[ i ];\n\t\t\t\t\tvar primitive = primitives[ i ];\n\n\t\t\t\t\t// 1. create Mesh\n\n\t\t\t\t\tvar mesh;\n\n\t\t\t\t\tvar material = originalMaterials[ i ];\n\n\t\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n\t\t\t\t\t\tprimitive.mode === undefined ) {\n\n\t\t\t\t\t\t// .isSkinnedMesh isn't in glTF spec. See .markDefs()\n\t\t\t\t\t\tmesh = meshDef.isSkinnedMesh === true\n\t\t\t\t\t\t\t? new THREE.SkinnedMesh( geometry, material )\n\t\t\t\t\t\t\t: new THREE.Mesh( geometry, material );\n\n\t\t\t\t\t\tif ( mesh.isSkinnedMesh === true ) mesh.normalizeSkinWeights(); // #15319\n\n\t\t\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ) {\n\n\t\t\t\t\t\t\tmesh.drawMode = THREE.TriangleStripDrawMode;\n\n\t\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ) {\n\n\t\t\t\t\t\t\tmesh.drawMode = THREE.TriangleFanDrawMode;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINES ) {\n\n\t\t\t\t\t\tmesh = new THREE.LineSegments( geometry, material );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_STRIP ) {\n\n\t\t\t\t\t\tmesh = new THREE.Line( geometry, material );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_LOOP ) {\n\n\t\t\t\t\t\tmesh = new THREE.LineLoop( geometry, material );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.POINTS ) {\n\n\t\t\t\t\t\tmesh = new THREE.Points( geometry, material );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( Object.keys( mesh.geometry.morphAttributes ).length > 0 ) {\n\n\t\t\t\t\t\tupdateMorphTargets( mesh, meshDef );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmesh.name = meshDef.name || ( 'mesh_' + meshIndex );\n\n\t\t\t\t\tif ( geometries.length > 1 ) mesh.name += '_' + i;\n\n\t\t\t\t\tassignExtrasToUserData( mesh, meshDef );\n\n\t\t\t\t\tparser.assignFinalMaterial( mesh );\n\n\t\t\t\t\tmeshes.push( mesh );\n\n\t\t\t\t}\n\n\t\t\t\tif ( meshes.length === 1 ) {\n\n\t\t\t\t\treturn meshes[ 0 ];\n\n\t\t\t\t}\n\n\t\t\t\tvar group = new THREE.Group();\n\n\t\t\t\tfor ( var i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\t\tgroup.add( meshes[ i ] );\n\n\t\t\t\t}\n\n\t\t\t\treturn group;\n\n\t\t\t} );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n\t * @param {number} cameraIndex\n\t * @return {Promise<THREE.Camera>}\n\t */\n\tGLTFParser.prototype.loadCamera = function ( cameraIndex ) {\n\n\t\tvar camera;\n\t\tvar cameraDef = this.json.cameras[ cameraIndex ];\n\t\tvar params = cameraDef[ cameraDef.type ];\n\n\t\tif ( ! params ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing camera parameters.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( cameraDef.type === 'perspective' ) {\n\n\t\t\tcamera = new THREE.PerspectiveCamera( THREE.Math.radToDeg( params.yfov ), params.aspectRatio || 1, params.znear || 1, params.zfar || 2e6 );\n\n\t\t} else if ( cameraDef.type === 'orthographic' ) {\n\n\t\t\tcamera = new THREE.OrthographicCamera( params.xmag / - 2, params.xmag / 2, params.ymag / 2, params.ymag / - 2, params.znear, params.zfar );\n\n\t\t}\n\n\t\tif ( cameraDef.name !== undefined ) camera.name = cameraDef.name;\n\n\t\tassignExtrasToUserData( camera, cameraDef );\n\n\t\treturn Promise.resolve( camera );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n\t * @param {number} skinIndex\n\t * @return {Promise<Object>}\n\t */\n\tGLTFParser.prototype.loadSkin = function ( skinIndex ) {\n\n\t\tvar skinDef = this.json.skins[ skinIndex ];\n\n\t\tvar skinEntry = { joints: skinDef.joints };\n\n\t\tif ( skinDef.inverseBindMatrices === undefined ) {\n\n\t\t\treturn Promise.resolve( skinEntry );\n\n\t\t}\n\n\t\treturn this.getDependency( 'accessor', skinDef.inverseBindMatrices ).then( function ( accessor ) {\n\n\t\t\tskinEntry.inverseBindMatrices = accessor;\n\n\t\t\treturn skinEntry;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n\t * @param {number} animationIndex\n\t * @return {Promise<THREE.AnimationClip>}\n\t */\n\tGLTFParser.prototype.loadAnimation = function ( animationIndex ) {\n\n\t\tvar json = this.json;\n\n\t\tvar animationDef = json.animations[ animationIndex ];\n\n\t\tvar pendingNodes = [];\n\t\tvar pendingInputAccessors = [];\n\t\tvar pendingOutputAccessors = [];\n\t\tvar pendingSamplers = [];\n\t\tvar pendingTargets = [];\n\n\t\tfor ( var i = 0, il = animationDef.channels.length; i < il; i ++ ) {\n\n\t\t\tvar channel = animationDef.channels[ i ];\n\t\t\tvar sampler = animationDef.samplers[ channel.sampler ];\n\t\t\tvar target = channel.target;\n\t\t\tvar name = target.node !== undefined ? target.node : target.id; // NOTE: target.id is deprecated.\n\t\t\tvar input = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.input ] : sampler.input;\n\t\t\tvar output = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.output ] : sampler.output;\n\n\t\t\tpendingNodes.push( this.getDependency( 'node', name ) );\n\t\t\tpendingInputAccessors.push( this.getDependency( 'accessor', input ) );\n\t\t\tpendingOutputAccessors.push( this.getDependency( 'accessor', output ) );\n\t\t\tpendingSamplers.push( sampler );\n\t\t\tpendingTargets.push( target );\n\n\t\t}\n\n\t\treturn Promise.all( [\n\n\t\t\tPromise.all( pendingNodes ),\n\t\t\tPromise.all( pendingInputAccessors ),\n\t\t\tPromise.all( pendingOutputAccessors ),\n\t\t\tPromise.all( pendingSamplers ),\n\t\t\tPromise.all( pendingTargets )\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tvar nodes = dependencies[ 0 ];\n\t\t\tvar inputAccessors = dependencies[ 1 ];\n\t\t\tvar outputAccessors = dependencies[ 2 ];\n\t\t\tvar samplers = dependencies[ 3 ];\n\t\t\tvar targets = dependencies[ 4 ];\n\n\t\t\tvar tracks = [];\n\n\t\t\tfor ( var i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tvar node = nodes[ i ];\n\t\t\t\tvar inputAccessor = inputAccessors[ i ];\n\t\t\t\tvar outputAccessor = outputAccessors[ i ];\n\t\t\t\tvar sampler = samplers[ i ];\n\t\t\t\tvar target = targets[ i ];\n\n\t\t\t\tif ( node === undefined ) continue;\n\n\t\t\t\tnode.updateMatrix();\n\t\t\t\tnode.matrixAutoUpdate = true;\n\n\t\t\t\tvar TypedKeyframeTrack;\n\n\t\t\t\tswitch ( PATH_PROPERTIES[ target.path ] ) {\n\n\t\t\t\t\tcase PATH_PROPERTIES.weights:\n\n\t\t\t\t\t\tTypedKeyframeTrack = THREE.NumberKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase PATH_PROPERTIES.rotation:\n\n\t\t\t\t\t\tTypedKeyframeTrack = THREE.QuaternionKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase PATH_PROPERTIES.position:\n\t\t\t\t\tcase PATH_PROPERTIES.scale:\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tTypedKeyframeTrack = THREE.VectorKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tvar targetName = node.name ? node.name : node.uuid;\n\n\t\t\t\tvar interpolation = sampler.interpolation !== undefined ? INTERPOLATION[ sampler.interpolation ] : THREE.InterpolateLinear;\n\n\t\t\t\tvar targetNames = [];\n\n\t\t\t\tif ( PATH_PROPERTIES[ target.path ] === PATH_PROPERTIES.weights ) {\n\n\t\t\t\t\t// Node may be a THREE.Group (glTF mesh with several primitives) or a THREE.Mesh.\n\t\t\t\t\tnode.traverse( function ( object ) {\n\n\t\t\t\t\t\tif ( object.isMesh === true && object.morphTargetInfluences ) {\n\n\t\t\t\t\t\t\ttargetNames.push( object.name ? object.name : object.uuid );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttargetNames.push( targetName );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var j = 0, jl = targetNames.length; j < jl; j ++ ) {\n\n\t\t\t\t\tvar track = new TypedKeyframeTrack(\n\t\t\t\t\t\ttargetNames[ j ] + '.' + PATH_PROPERTIES[ target.path ],\n\t\t\t\t\t\tinputAccessor.array,\n\t\t\t\t\t\toutputAccessor.array,\n\t\t\t\t\t\tinterpolation\n\t\t\t\t\t);\n\n\t\t\t\t\t// Override interpolation with custom factory method.\n\t\t\t\t\tif ( sampler.interpolation === 'CUBICSPLINE' ) {\n\n\t\t\t\t\t\ttrack.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline( result ) {\n\n\t\t\t\t\t\t\t// A CUBICSPLINE keyframe in glTF has three output values for each input value,\n\t\t\t\t\t\t\t// representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n\t\t\t\t\t\t\t// must be divided by three to get the interpolant's sampleSize argument.\n\n\t\t\t\t\t\t\treturn new GLTFCubicSplineInterpolant( this.times, this.values, this.getValueSize() / 3, result );\n\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\n\t\t\t\t\t\ttrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttracks.push( track );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar name = animationDef.name !== undefined ? animationDef.name : 'animation_' + animationIndex;\n\n\t\t\treturn new THREE.AnimationClip( name, undefined, tracks );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n\t * @param {number} nodeIndex\n\t * @return {Promise<THREE.Object3D>}\n\t */\n\tGLTFParser.prototype.loadNode = function ( nodeIndex ) {\n\n\t\tvar json = this.json;\n\t\tvar extensions = this.extensions;\n\t\tvar parser = this;\n\n\t\tvar meshReferences = json.meshReferences;\n\t\tvar meshUses = json.meshUses;\n\n\t\tvar nodeDef = json.nodes[ nodeIndex ];\n\n\t\treturn ( function () {\n\n\t\t\t// .isBone isn't in glTF spec. See .markDefs\n\t\t\tif ( nodeDef.isBone === true ) {\n\n\t\t\t\treturn Promise.resolve( new THREE.Bone() );\n\n\t\t\t} else if ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\treturn parser.getDependency( 'mesh', nodeDef.mesh ).then( function ( mesh ) {\n\n\t\t\t\t\tvar node;\n\n\t\t\t\t\tif ( meshReferences[ nodeDef.mesh ] > 1 ) {\n\n\t\t\t\t\t\tvar instanceNum = meshUses[ nodeDef.mesh ] ++;\n\n\t\t\t\t\t\tnode = mesh.clone();\n\t\t\t\t\t\tnode.name += '_instance_' + instanceNum;\n\n\t\t\t\t\t\t// onBeforeRender copy for Specular-Glossiness\n\t\t\t\t\t\tnode.onBeforeRender = mesh.onBeforeRender;\n\n\t\t\t\t\t\tfor ( var i = 0, il = node.children.length; i < il; i ++ ) {\n\n\t\t\t\t\t\t\tnode.children[ i ].name += '_instance_' + instanceNum;\n\t\t\t\t\t\t\tnode.children[ i ].onBeforeRender = mesh.children[ i ].onBeforeRender;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tnode = mesh;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// if weights are provided on the node, override weights on the mesh.\n\t\t\t\t\tif ( nodeDef.weights !== undefined ) {\n\n\t\t\t\t\t\tnode.traverse( function ( o ) {\n\n\t\t\t\t\t\t\tif ( ! o.isMesh ) return;\n\n\t\t\t\t\t\t\tfor ( var i = 0, il = nodeDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\t\t\t\t\to.morphTargetInfluences[ i ] = nodeDef.weights[ i ];\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn node;\n\n\t\t\t\t} );\n\n\t\t\t} else if ( nodeDef.camera !== undefined ) {\n\n\t\t\t\treturn parser.getDependency( 'camera', nodeDef.camera );\n\n\t\t\t} else if ( nodeDef.extensions\n\t\t\t\t&& nodeDef.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ]\n\t\t\t\t&& nodeDef.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ].light !== undefined ) {\n\n\t\t\t\treturn parser.getDependency( 'light', nodeDef.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ].light );\n\n\t\t\t} else {\n\n\t\t\t\treturn Promise.resolve( new THREE.Object3D() );\n\n\t\t\t}\n\n\t\t}() ).then( function ( node ) {\n\n\t\t\tif ( nodeDef.name !== undefined ) {\n\n\t\t\t\tnode.name = THREE.PropertyBinding.sanitizeNodeName( nodeDef.name );\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( node, nodeDef );\n\n\t\t\tif ( nodeDef.extensions ) addUnknownExtensionsToUserData( extensions, node, nodeDef );\n\n\t\t\tif ( nodeDef.matrix !== undefined ) {\n\n\t\t\t\tvar matrix = new THREE.Matrix4();\n\t\t\t\tmatrix.fromArray( nodeDef.matrix );\n\t\t\t\tnode.applyMatrix( matrix );\n\n\t\t\t} else {\n\n\t\t\t\tif ( nodeDef.translation !== undefined ) {\n\n\t\t\t\t\tnode.position.fromArray( nodeDef.translation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.rotation !== undefined ) {\n\n\t\t\t\t\tnode.quaternion.fromArray( nodeDef.rotation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.scale !== undefined ) {\n\n\t\t\t\t\tnode.scale.fromArray( nodeDef.scale );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n\t * @param {number} sceneIndex\n\t * @return {Promise<THREE.Scene>}\n\t */\n\tGLTFParser.prototype.loadScene = function () {\n\n\t\t// scene node hierachy builder\n\n\t\tfunction buildNodeHierachy( nodeId, parentObject, json, parser ) {\n\n\t\t\tvar nodeDef = json.nodes[ nodeId ];\n\n\t\t\treturn parser.getDependency( 'node', nodeId ).then( function ( node ) {\n\n\t\t\t\tif ( nodeDef.skin === undefined ) return node;\n\n\t\t\t\t// build skeleton here as well\n\n\t\t\t\tvar skinEntry;\n\n\t\t\t\treturn parser.getDependency( 'skin', nodeDef.skin ).then( function ( skin ) {\n\n\t\t\t\t\tskinEntry = skin;\n\n\t\t\t\t\tvar pendingJoints = [];\n\n\t\t\t\t\tfor ( var i = 0, il = skinEntry.joints.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tpendingJoints.push( parser.getDependency( 'node', skinEntry.joints[ i ] ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Promise.all( pendingJoints );\n\n\t\t\t\t} ).then( function ( jointNodes ) {\n\n\t\t\t\t\tvar meshes = node.isGroup === true ? node.children : [ node ];\n\n\t\t\t\t\tfor ( var i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tvar mesh = meshes[ i ];\n\n\t\t\t\t\t\tvar bones = [];\n\t\t\t\t\t\tvar boneInverses = [];\n\n\t\t\t\t\t\tfor ( var j = 0, jl = jointNodes.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tvar jointNode = jointNodes[ j ];\n\n\t\t\t\t\t\t\tif ( jointNode ) {\n\n\t\t\t\t\t\t\t\tbones.push( jointNode );\n\n\t\t\t\t\t\t\t\tvar mat = new THREE.Matrix4();\n\n\t\t\t\t\t\t\t\tif ( skinEntry.inverseBindMatrices !== undefined ) {\n\n\t\t\t\t\t\t\t\t\tmat.fromArray( skinEntry.inverseBindMatrices.array, j * 16 );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tboneInverses.push( mat );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Joint \"%s\" could not be found.', skinEntry.joints[ j ] );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmesh.bind( new THREE.Skeleton( bones, boneInverses ), mesh.matrixWorld );\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn node;\n\n\t\t\t\t} );\n\n\t\t\t} ).then( function ( node ) {\n\n\t\t\t\t// build node hierachy\n\n\t\t\t\tparentObject.add( node );\n\n\t\t\t\tvar pending = [];\n\n\t\t\t\tif ( nodeDef.children ) {\n\n\t\t\t\t\tvar children = nodeDef.children;\n\n\t\t\t\t\tfor ( var i = 0, il = children.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tvar child = children[ i ];\n\t\t\t\t\t\tpending.push( buildNodeHierachy( child, node, json, parser ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn Promise.all( pending );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn function loadScene( sceneIndex ) {\n\n\t\t\tvar json = this.json;\n\t\t\tvar extensions = this.extensions;\n\t\t\tvar sceneDef = this.json.scenes[ sceneIndex ];\n\t\t\tvar parser = this;\n\n\t\t\tvar scene = new THREE.Scene();\n\t\t\tif ( sceneDef.name !== undefined ) scene.name = sceneDef.name;\n\n\t\t\tassignExtrasToUserData( scene, sceneDef );\n\n\t\t\tif ( sceneDef.extensions ) addUnknownExtensionsToUserData( extensions, scene, sceneDef );\n\n\t\t\tvar nodeIds = sceneDef.nodes || [];\n\n\t\t\tvar pending = [];\n\n\t\t\tfor ( var i = 0, il = nodeIds.length; i < il; i ++ ) {\n\n\t\t\t\tpending.push( buildNodeHierachy( nodeIds[ i ], scene, json, parser ) );\n\n\t\t\t}\n\n\t\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\t\treturn scene;\n\n\t\t\t} );\n\n\t\t};\n\n\t}();\n\n\treturn GLTFLoader;\n\n} )();\n\n\nexport default GLTFLoader","/* eslint-disable */\nconst THREE = require('three'); //requireimport * as THREE from 'three'\n\n// Copyright 2016 The Draco Authors.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n\n/**\n * @param {THREE.LoadingManager} manager\n */\n\nconst DRACOLoader = ( function () { \n\n    function DRACOLoader (manager) {\n        this.timeLoaded = 0;\n        this.manager = manager || THREE.DefaultLoadingManager;\n        this.materials = null;\n        this.verbosity = 0;\n        this.attributeOptions = {};\n        this.drawMode = THREE.TrianglesDrawMode;\n        // Native Draco attribute type to Three.JS attribute type.\n        this.nativeAttributeMap = {\n            'position' : 'POSITION',\n            'normal' : 'NORMAL',\n            'color' : 'COLOR',\n            'uv' : 'TEX_COORD'\n        };\n    }\n\n    DRACOLoader.prototype = {\n\n        constructor: DRACOLoader,\n\n        load: function(url, onLoad, onProgress, onError) {\n            var scope = this;\n            var loader = new THREE.FileLoader(scope.manager);\n            loader.setPath(this.path);\n            loader.setResponseType('arraybuffer');\n            loader.load(url, function(blob) {\n                scope.decodeDracoFile(blob, onLoad);\n            }, onProgress, onError);\n        },\n\n        setPath: function(value) {\n            this.path = value;\n            return this;\n        },\n\n        setVerbosity: function(level) {\n            this.verbosity = level;\n            return this;\n        },\n\n        /**\n         *  Sets desired mode for generated geometry indices.\n         *  Can be either:\n         *      THREE.TrianglesDrawMode\n         *      THREE.TriangleStripDrawMode\n         */\n        setDrawMode: function(drawMode) {\n            this.drawMode = drawMode;\n            return this;\n        },\n\n        /**\n         * Skips dequantization for a specific attribute.\n         * |attributeName| is the THREE.js name of the given attribute type.\n         * The only currently supported |attributeName| is 'position', more may be\n         * added in future.\n         */\n        setSkipDequantization: function(attributeName, skip) {\n            var skipDequantization = true;\n            if (typeof skip !== 'undefined')\n            skipDequantization = skip;\n            this.getAttributeOptions(attributeName).skipDequantization =\n                skipDequantization;\n            return this;\n        },\n\n        /**\n         * Decompresses a Draco buffer. Names of attributes (for ID and type maps)\n         * must be one of the supported three.js types, including: position, color,\n         * normal, uv, uv2, skinIndex, skinWeight.\n         *\n         * @param {ArrayBuffer} rawBuffer\n         * @param {Function} callback\n         * @param {Object|undefined} attributeUniqueIdMap Provides a pre-defined ID\n         *     for each attribute in the geometry to be decoded. If given,\n         *     `attributeTypeMap` is required and `nativeAttributeMap` will be\n         *     ignored.\n         * @param {Object|undefined} attributeTypeMap Provides a predefined data\n         *     type (as a typed array constructor) for each attribute in the\n         *     geometry to be decoded.\n         */\n        decodeDracoFile: function(rawBuffer, callback, attributeUniqueIdMap,\n                                attributeTypeMap) {\n        var scope = this;\n        DRACOLoader.getDecoderModule()\n            .then( function ( module ) {\n                scope.decodeDracoFileInternal( rawBuffer, module.decoder, callback,\n                attributeUniqueIdMap, attributeTypeMap);\n            });\n        },\n\n        decodeDracoFileInternal: function(rawBuffer, dracoDecoder, callback,\n                                        attributeUniqueIdMap, attributeTypeMap) {\n            /*\n            * Here is how to use Draco Javascript decoder and get the geometry.\n            */\n            var buffer = new dracoDecoder.DecoderBuffer();\n            buffer.Init(new Int8Array(rawBuffer), rawBuffer.byteLength);\n            var decoder = new dracoDecoder.Decoder();\n\n            /*\n            * Determine what type is this file: mesh or point cloud.\n            */\n            var geometryType = decoder.GetEncodedGeometryType(buffer);\n            if (geometryType == dracoDecoder.TRIANGULAR_MESH) {\n                if (this.verbosity > 0) {\n                console.log('Loaded a mesh.');\n                }\n            } else if (geometryType == dracoDecoder.POINT_CLOUD) {\n                if (this.verbosity > 0) {\n                console.log('Loaded a point cloud.');\n                }\n            } else {\n                var errorMsg = 'THREE.DRACOLoader: Unknown geometry type.';\n                console.error(errorMsg);\n                throw new Error(errorMsg);\n            }\n            callback(this.convertDracoGeometryTo3JS(dracoDecoder, decoder,\n                geometryType, buffer, attributeUniqueIdMap, attributeTypeMap));\n        },\n\n        addAttributeToGeometry: function(dracoDecoder, decoder, dracoGeometry,\n                                            attributeName, attributeType, attribute,\n                                            geometry, geometryBuffer) {\n            if (attribute.ptr === 0) {\n                var errorMsg = 'THREE.DRACOLoader: No attribute ' + attributeName;\n                console.error(errorMsg);\n                throw new Error(errorMsg);\n            }\n\n            var numComponents = attribute.num_components();\n            var numPoints = dracoGeometry.num_points();\n            var numValues = numPoints * numComponents;\n            var attributeData;\n            var TypedBufferAttribute;\n\n            switch ( attributeType ) {\n\n                case Float32Array:\n                attributeData = new dracoDecoder.DracoFloat32Array();\n                decoder.GetAttributeFloatForAllPoints(\n                    dracoGeometry, attribute, attributeData);\n                geometryBuffer[ attributeName ] = new Float32Array( numValues );\n                TypedBufferAttribute = THREE.Float32BufferAttribute;\n                break;\n\n                case Int8Array:\n                attributeData = new dracoDecoder.DracoInt8Array();\n                decoder.GetAttributeInt8ForAllPoints(\n                    dracoGeometry, attribute, attributeData );\n                geometryBuffer[ attributeName ] = new Int8Array( numValues );\n                TypedBufferAttribute = THREE.Int8BufferAttribute;\n                break;\n\n                case Int16Array:\n                attributeData = new dracoDecoder.DracoInt16Array();\n                decoder.GetAttributeInt16ForAllPoints(\n                    dracoGeometry, attribute, attributeData);\n                geometryBuffer[ attributeName ] = new Int16Array( numValues );\n                TypedBufferAttribute = THREE.Int16BufferAttribute;\n                break;\n\n                case Int32Array:\n                attributeData = new dracoDecoder.DracoInt32Array();\n                decoder.GetAttributeInt32ForAllPoints(\n                    dracoGeometry, attribute, attributeData);\n                geometryBuffer[ attributeName ] = new Int32Array( numValues );\n                TypedBufferAttribute = THREE.Int32BufferAttribute;\n                break;\n\n                case Uint8Array:\n                attributeData = new dracoDecoder.DracoUInt8Array();\n                decoder.GetAttributeUInt8ForAllPoints(\n                    dracoGeometry, attribute, attributeData);\n                geometryBuffer[ attributeName ] = new Uint8Array( numValues );\n                TypedBufferAttribute = THREE.Uint8BufferAttribute;\n                break;\n\n                case Uint16Array:\n                attributeData = new dracoDecoder.DracoUInt16Array();\n                decoder.GetAttributeUInt16ForAllPoints(\n                    dracoGeometry, attribute, attributeData);\n                geometryBuffer[ attributeName ] = new Uint16Array( numValues );\n                TypedBufferAttribute = THREE.Uint16BufferAttribute;\n                break;\n\n                case Uint32Array:\n                attributeData = new dracoDecoder.DracoUInt32Array();\n                decoder.GetAttributeUInt32ForAllPoints(\n                    dracoGeometry, attribute, attributeData);\n                geometryBuffer[ attributeName ] = new Uint32Array( numValues );\n                TypedBufferAttribute = THREE.Uint32BufferAttribute;\n                break;\n\n                default:\n                var errorMsg = 'THREE.DRACOLoader: Unexpected attribute type.';\n                console.error( errorMsg );\n                throw new Error( errorMsg );\n\n            }\n\n            // Copy data from decoder.\n            for (var i = 0; i < numValues; i++) {\n                geometryBuffer[attributeName][i] = attributeData.GetValue(i);\n            }\n            // Add attribute to THREEJS geometry for rendering.\n            geometry.addAttribute(attributeName,\n                new TypedBufferAttribute(geometryBuffer[attributeName],\n                    numComponents));\n            dracoDecoder.destroy(attributeData);\n        },\n\n        convertDracoGeometryTo3JS: function(dracoDecoder, decoder, geometryType,\n                                            buffer, attributeUniqueIdMap,\n                                            attributeTypeMap) {\n            // TODO: Should not assume native Draco attribute IDs apply.\n            if (this.getAttributeOptions('position').skipDequantization === true) {\n                 decoder.SkipAttributeTransform(dracoDecoder.POSITION);\n            }\n            var dracoGeometry;\n            var decodingStatus;\n            var start_time = performance.now();\n            if (geometryType === dracoDecoder.TRIANGULAR_MESH) {\n                dracoGeometry = new dracoDecoder.Mesh();\n                decodingStatus = decoder.DecodeBufferToMesh(buffer, dracoGeometry);\n            } else {\n                dracoGeometry = new dracoDecoder.PointCloud();\n                decodingStatus =\n                    decoder.DecodeBufferToPointCloud(buffer, dracoGeometry);\n            }\n            if (!decodingStatus.ok() || dracoGeometry.ptr == 0) {\n                var errorMsg = 'THREE.DRACOLoader: Decoding failed: ';\n                errorMsg += decodingStatus.error_msg();\n                console.error(errorMsg);\n                dracoDecoder.destroy(decoder);\n                dracoDecoder.destroy(dracoGeometry);\n                throw new Error(errorMsg);\n            }\n\n            var decode_end = performance.now();\n            dracoDecoder.destroy(buffer);\n            /*\n            * Example on how to retrieve mesh and attributes.\n            */\n            var numFaces;\n            if (geometryType == dracoDecoder.TRIANGULAR_MESH) {\n                numFaces = dracoGeometry.num_faces();\n                if (this.verbosity > 0) {\n                    console.log('Number of faces loaded: ' + numFaces.toString());\n                }\n            } else {\n               numFaces = 0;\n            }\n\n            var numPoints = dracoGeometry.num_points();\n            var numAttributes = dracoGeometry.num_attributes();\n            if (this.verbosity > 0) {\n                console.log('Number of points loaded: ' + numPoints.toString());\n                console.log('Number of attributes loaded: ' +\n                    numAttributes.toString());\n            }\n\n            // Verify if there is position attribute.\n            // TODO: Should not assume native Draco attribute IDs apply.\n            var posAttId = decoder.GetAttributeId(dracoGeometry,\n                                                dracoDecoder.POSITION);\n            if (posAttId == -1) {\n                var errorMsg = 'THREE.DRACOLoader: No position attribute found.';\n                console.error(errorMsg);\n                dracoDecoder.destroy(decoder);\n                dracoDecoder.destroy(dracoGeometry);\n                throw new Error(errorMsg);\n            }\n            var posAttribute = decoder.GetAttribute(dracoGeometry, posAttId);\n\n            // Structure for converting to THREEJS geometry later.\n            var geometryBuffer = {};\n            // Import data to Three JS geometry.\n            var geometry = new THREE.BufferGeometry();\n\n            // Do not use both the native attribute map and a provided (e.g. glTF) map.\n            if ( attributeUniqueIdMap ) {\n\n                // Add attributes of user specified unique id. E.g. GLTF models.\n                for (var attributeName in attributeUniqueIdMap) {\n                    var attributeType = attributeTypeMap[attributeName];\n                    var attributeId = attributeUniqueIdMap[attributeName];\n                    var attribute = decoder.GetAttributeByUniqueId(dracoGeometry,\n                                                                attributeId);\n                    this.addAttributeToGeometry(dracoDecoder, decoder, dracoGeometry,\n                        attributeName, attributeType, attribute, geometry, geometryBuffer);\n                }\n\n            } else {\n\n                // Add native Draco attribute type to geometry.\n                for (var attributeName in this.nativeAttributeMap) {\n                    var attId = decoder.GetAttributeId(dracoGeometry,\n                        dracoDecoder[this.nativeAttributeMap[attributeName]]);\n                    if (attId !== -1) {\n                    if (this.verbosity > 0) {\n                        console.log('Loaded ' + attributeName + ' attribute.');\n                    }\n                    var attribute = decoder.GetAttribute(dracoGeometry, attId);\n                    this.addAttributeToGeometry(dracoDecoder, decoder, dracoGeometry,\n                        attributeName, Float32Array, attribute, geometry, geometryBuffer);\n                    }\n                }\n\n            }\n\n            // For mesh, we need to generate the faces.\n            if (geometryType == dracoDecoder.TRIANGULAR_MESH) {\n                if (this.drawMode === THREE.TriangleStripDrawMode) {\n                    var stripsArray = new dracoDecoder.DracoInt32Array();\n                    var numStrips = decoder.GetTriangleStripsFromMesh(\n                        dracoGeometry, stripsArray);\n                    geometryBuffer.indices = new Uint32Array(stripsArray.size());\n                    for (var i = 0; i < stripsArray.size(); ++i) {\n                         geometryBuffer.indices[i] = stripsArray.GetValue(i);\n                    }\n                    dracoDecoder.destroy(stripsArray);\n                } else {\n                    var numIndices = numFaces * 3;\n                    geometryBuffer.indices = new Uint32Array(numIndices);\n                    var ia = new dracoDecoder.DracoInt32Array();\n                    for (var i = 0; i < numFaces; ++i) {\n                        decoder.GetFaceFromMesh(dracoGeometry, i, ia);\n                        var index = i * 3;\n                        geometryBuffer.indices[index] = ia.GetValue(0);\n                        geometryBuffer.indices[index + 1] = ia.GetValue(1);\n                        geometryBuffer.indices[index + 2] = ia.GetValue(2);\n                    }\n                    dracoDecoder.destroy(ia);\n                }\n            }\n\n            geometry.drawMode = this.drawMode;\n            if (geometryType == dracoDecoder.TRIANGULAR_MESH) {\n            geometry.setIndex(new(geometryBuffer.indices.length > 65535 ?\n                    THREE.Uint32BufferAttribute : THREE.Uint16BufferAttribute)\n                (geometryBuffer.indices, 1));\n            }\n\n            // TODO: Should not assume native Draco attribute IDs apply.\n            // TODO: Can other attribute types be quantized?\n            var posTransform = new dracoDecoder.AttributeQuantizationTransform();\n            if (posTransform.InitFromAttribute(posAttribute)) {\n                // Quantized attribute. Store the quantization parameters into the\n                // THREE.js attribute.\n                geometry.attributes['position'].isQuantized = true;\n                geometry.attributes['position'].maxRange = posTransform.range();\n                geometry.attributes['position'].numQuantizationBits =\n                    posTransform.quantization_bits();\n                geometry.attributes['position'].minValues = new Float32Array(3);\n                for (var i = 0; i < 3; ++i) {\n                    geometry.attributes['position'].minValues[i] =\n                        posTransform.min_value(i);\n                }\n            }\n            dracoDecoder.destroy(posTransform);\n            dracoDecoder.destroy(decoder);\n            dracoDecoder.destroy(dracoGeometry);\n\n            this.decode_time = decode_end - start_time;\n            this.import_time = performance.now() - decode_end;\n\n            if (this.verbosity > 0) {\n            console.log('Decode time: ' + this.decode_time);\n            console.log('Import time: ' + this.import_time);\n            }\n            return geometry;\n        },\n\n        isVersionSupported: function(version, callback) {\n            DRACOLoader.getDecoderModule()\n                .then( function ( module ) {\n                callback( module.decoder.isVersionSupported( version ) );\n                });\n        },\n\n        getAttributeOptions: function(attributeName) {\n            if (typeof this.attributeOptions[attributeName] === 'undefined')\n            this.attributeOptions[attributeName] = {};\n            return this.attributeOptions[attributeName];\n        }\n    };\n\n    DRACOLoader.decoderPath = './';\n    DRACOLoader.decoderConfig = {};\n    DRACOLoader.decoderModulePromise = null;\n\n    /**\n     * Sets the base path for decoder source files.\n     * @param {string} path\n     */\n    DRACOLoader.setDecoderPath = function ( path ) {\n       DRACOLoader.decoderPath = path;\n    };\n\n    /**\n     * Sets decoder configuration and releases singleton decoder module. Module\n     * will be recreated with the next decoding call.\n     * @param {Object} config\n     */\n    DRACOLoader.setDecoderConfig = function ( config ) {\n        var wasmBinary = THREE.DRACOLoader.decoderConfig.wasmBinary;\n        DRACOLoader.decoderConfig = config || {};\n        DRACOLoader.releaseDecoderModule();\n\n        // Reuse WASM binary.\n        if ( wasmBinary ) DRACOLoader.decoderConfig.wasmBinary = wasmBinary;\n    };\n\n    /**\n     * Releases the singleton DracoDecoderModule instance. Module will be recreated\n     * with the next decoding call.\n     */\n    DRACOLoader.releaseDecoderModule = function () {\n    DRACOLoader.decoderModulePromise = null;\n    };\n\n    /**\n     * Gets WebAssembly or asm.js singleton instance of DracoDecoderModule\n     * after testing for browser support. Returns Promise that resolves when\n     * module is available.\n     * @return {Promise<{decoder: DracoDecoderModule}>}\n     */\n    DRACOLoader.getDecoderModule = function () {\n        var scope = this;\n        var path = DRACOLoader.decoderPath;\n        var config = DRACOLoader.decoderConfig;\n        var promise = DRACOLoader.decoderModulePromise;\n\n        if ( promise ) return promise;\n\n        // Load source files.\n        if ( typeof DracoDecoderModule !== 'undefined' ) {\n            // Loaded externally.\n            promise = Promise.resolve();\n        } else if ( typeof WebAssembly !== 'object' || config.type === 'js' ) {\n            // Load with asm.js.\n            promise = DRACOLoader._loadScript( path + 'draco_decoder.js' );\n        } else {\n            // Load with WebAssembly.\n            config.wasmBinaryFile = path + 'draco_decoder.wasm';\n            promise = DRACOLoader._loadScript( path + 'draco_wasm_wrapper.js' )\n                .then( function () {\n                return DRACOLoader._loadArrayBuffer( config.wasmBinaryFile );\n                } )\n                .then( function ( wasmBinary ) {\n                config.wasmBinary = wasmBinary;\n                } );\n        }\n\n        // Wait for source files, then create and return a decoder.\n        promise = promise.then( function () {\n            return new Promise( function ( resolve ) {\n            config.onModuleLoaded = function ( decoder ) {\n                scope.timeLoaded = performance.now();\n                // Module is Promise-like. Wrap before resolving to avoid loop.\n                resolve( { decoder: decoder } );\n            };\n            DracoDecoderModule( config );\n            } );\n        } );\n\n        DRACOLoader.decoderModulePromise = promise;\n        return promise;\n    };\n\n    /**\n     * @param {string} src\n     * @return {Promise}\n     */\n    DRACOLoader._loadScript = function ( src ) {\n        var prevScript = document.getElementById( 'decoder_script' );\n        if ( prevScript !== null ) {\n            prevScript.parentNode.removeChild( prevScript );\n        }\n        var head = document.getElementsByTagName( 'head' )[ 0 ];\n        var script = document.createElement( 'script' );\n        script.id = 'decoder_script';\n        script.type = 'text/javascript';\n        script.src = src;\n        return new Promise( function ( resolve ) {\n            script.onload = resolve;\n            head.appendChild( script );\n        });\n    };\n\n    /**\n     * @param {string} src\n     * @return {Promise}\n     */\n    DRACOLoader._loadArrayBuffer = function ( src ) {\n        var loader = new THREE.FileLoader();\n        loader.setResponseType( 'arraybuffer' );\n        return new Promise( function( resolve, reject ) {\n            loader.load( src, resolve, undefined, reject );\n        });\n    };\n\n    return DRACOLoader;\n\n} )();\n\nexport default DRACOLoader","import {fetchGraphObject} from \"../../syncgraph/utils\";\nimport * as THREE from \"three\";\nimport {NONE_ASSET, PROP_DEFS} from '../Common'\nimport GLTFLoader from '../GLTFLoader'\nimport DRACOLoader from '../DRACOLoader'\nimport SkeletonUtils from '../SkeletonUtils'\nimport {MeshLambertMaterial} from 'three'\nimport ObjectDef from './ObjectDef'\n\nexport default class ModelDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create model w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:'model',\n            title:'a model',\n            visible:true,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#ffffff',\n            children:graph.createArray(),\n            asset:NONE_ASSET.id,\n            transparent:false,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new THREE.Group()\n        node.name = obj.title\n        const clicker =  new THREE.Mesh(\n            new THREE.SphereBufferGeometry(1),\n            new MeshLambertMaterial({color:\"red\", transparent:true, opacity: 0.2})\n        )\n        clicker.material.visible = true\n        clicker.userData.clickable = true\n        node.userData.clicker = clicker\n        node.add(clicker)\n        // on(clicker,POINTER_CLICK,e =>SelectionManager.setSelection(node.userData.graphid))\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        this.attachAsset(node, obj, provider)\n\n        node.enter = (evt,scriptManager) => {\n            node.userData.clicker.visible = false\n            // if (node.userData.mixer) {\n            //     provider.addMixer(obj.id, node.userData.mixer)\n            // }\n            if (node.userData.model) {\n                if (node.userData.currentClip) {\n                    node.userData.action = node.userData.mixer.clipAction( node.userData.currentClip );\n                    node.userData.action.play()\n                }\n            } else {\n                node.userData.shouldPlay = true\n            }\n        }\n        node.exit = (evt,scriptManager) => {\n            const ob2 = provider.accessObject(obj.id)\n            if(ob2.asset === NONE_ASSET.id) {\n                node.userData.clicker.visible = true\n            }\n            // if (node.userData.mixer) {\n            //     provider.removeMixer(obj.id)\n            // }\n        }\n        node.tick = (evt,scriptManager) => {\n            const dt = evt.deltaTime / 1000;\n            node.userData.mixer && node.userData.mixer.update(dt);\n        }\n\n        // node.playAllClips = (evt, scriptManager) => {\n        //     node.userData.clips.forEach((clip) => {\n        //         node.userData.mixer.clipAction(clip).reset().play();\n        //     });\n        // }\n        // need to get this into the render loop somehow\n\n        node.useClip = (name) => {\n            if (node.userData.model) {\n                var clip = THREE.AnimationClip.findByName( node.userData.clips, name );\n                if (clip) {\n                    node.userData.currentClip = clip\n                }\n            } else {\n                node.userData.currentClipName = name\n            }\n        }\n\n        node.play = () => {\n            if (node.userData.currentClip) {\n                node.userData.mixer.stopAllAction();\n                node.userData.action = node.userData.mixer.clipAction( node.userData.currentClip );\n                node.userData.action.play()\n            }\n        }\n\n        node.stop = () => {\n            if (node.userData.mixer) {\n                node.userData.mixer.stopAllAction();            \n            }\n        }\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        if (op.name === PROP_DEFS.asset.key) return this.attachAsset(node, obj, provider)\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n    setClips ( userData ) {\n        if (userData.mixer) {\n          userData.mixer.stopAllAction();\n          userData.mixer.uncacheRoot(userData.mixer.getRoot());\n          userData.mixer = null;\n        }\n    \n        userData.clips.forEach((clip) => {\n          if (clip.validate()) clip.optimize();\n        });\n\n        if (!userData.clips.length) return;\n    \n        userData.currentClip = userData.clips[0]\n        userData.mixer = new THREE.AnimationMixer( userData.model );\n    }\n        \n    attachAsset(node, obj, provider) {\n        if(obj.asset === NONE_ASSET.id) {\n            // node.material = new MeshLambertMaterial({color: obj.color, side:THREE.DoubleSide})\n            console.log(\"REMOVE NODE CHILDREN\")\n            if(node.userData.model) {\n                node.remove(node.userData.model)\n                delete node.userData.model\n            }\n            node.userData.clicker.visible = true\n            return\n        }\n\n        node.userData.shouldPlay = false\n        node.userData.currentClip = null\n        node.userData.model = null\n        node.userData.currentClipName = null\n\n        provider.assetsManager.getGLTF(obj.asset).then(gltf => {\n            //swap the model\n            if(node.userData.model) node.remove(node.userData.model)\n\n            node.userData.model = gltf.scene || gltf.scenes[0]\n\n            // clone it, in case the loader is returning the same cached version?\n            node.userData.model = SkeletonUtils.clone( node.userData.model  );\n\n            node.userData.clips = gltf.animations || [];\n\n            node.add(node.userData.model)\n            node.userData.model.updateMatrixWorld();\n\n            //calculate the size of the model\n            // if(node.userData.model.geometry) {\n                // node.userData.model.geometry.computeBoundingSphere()\n                // node.userData.boundingSphere = node.userData.model.geometry.boundingSphere\n                // const bs = node.userData.boundingSphere\n                const model = node.userData.model\n\n                node.userData.boundingBox = new THREE.Box3().setFromObject(model);\n                node.userData.boundingBoxSize = node.userData.boundingBox.getSize(new THREE.Vector3()).length();\n                node.userData.BoundingBoxCenter = node.userData.boundingBox.getCenter(new THREE.Vector3());     \n                      \n                node.userData.mixer = null\n                this.setClips(node.userData)\n\n                // Really don't want to move it\n                ///\n                // model.position.x += model.position.x - node.userData.BoundingBoxCenter.x\n                // model.position.y += model.position.y - node.userData.BoundingBoxCenter.y\n                // model.position.z += model.position.z - node.userData.BoundingBoxCenter.z\n\n                // model.position.x = -bs.center.x\n                // model.position.y = -bs.center.y\n                // model.position.z = -bs.center.z\n\n                if (node.userData.currentClipName) {\n                    var clip = THREE.AnimationClip.findByName( node.userData.clips, node.userData.currentClipName );\n                    if (clip) {\n                        node.userData.currentClip = clip\n                    }\n                    node.userData.currentClipName = null\n                }\n\n                if (node.userData.shouldPlay && node.userData.currentClip) {\n                    node.userData.action = node.userData.mixer.clipAction( node.userData.currentClip );\n                    node.userData.action.play()\n                    node.userData.shouldPlay = false\n                }\n                node.userData.clicker.geometry = new THREE.SphereBufferGeometry(node.userData.boundingBoxSize / 2)\n            // }\n            //disable the clicker sphere\n            node.userData.clicker.visible = false\n        })\n    }\n\n}\n","import {fetchGraphObject} from '../../syncgraph/utils'\nimport {NONE_ASSET, OBJ_TYPES, PROP_DEFS} from '../Common'\nimport * as THREE from 'three'\nimport {MeshLambertMaterial} from 'three'\nimport {DoubleSide} from 'three'\n\nfunction customize(node,mat,obj) {\n    mat.onBeforeCompile = (shader) => {\n        //add uniform\n        shader.uniforms.imageOffsetAngle    = { value: obj.imageOffsetAngle }\n        shader.uniforms.imageCropStartAngle = { value: obj.imageCropStartAngle }\n        shader.uniforms.imageCropEndAngle   = { value: obj.imageCropEndAngle }\n        //prepend to the shader the defs\n        shader.vertexShader = `\n            uniform float imageOffsetAngle;\n            varying float vImageOffsetAngle;\n            uniform float imageCropStartAngle;            \n            varying float vImageCropStartAngle;            \n            uniform float imageCropEndAngle;            \n            varying float vImageCropEndAngle;            \n        ` + shader.vertexShader\n\n        //copy into fragment shader\n        shader.vertexShader = shader.vertexShader.replace('#include <begin_vertex>',`\n            #include <begin_vertex>\n            vImageOffsetAngle = imageOffsetAngle;\n            vImageCropStartAngle = imageCropStartAngle;\n            vImageCropEndAngle = imageCropEndAngle;\n        `)\n\n        //prepend to the fragment shader the defs\n        shader.fragmentShader = `\n                varying float vImageOffsetAngle;\n                varying float vImageCropStartAngle;\n                varying float vImageCropEndAngle;\n            `+shader.fragmentShader\n        //use in the shader\n        shader.fragmentShader = shader.fragmentShader.replace('#include <dithering_fragment>',`\n            if(vUv.x < vImageCropStartAngle) discard;\n            if(vUv.x > vImageCropEndAngle)  discard;\n            // gl_FragColor.r = vUv.x;\n            // vec3 jv = vec3(cos(gl_FragCoord.x/50.0)); \n            // vec3 empty = vec3(0.0,0.0,0.0);//vec3(jv,jv,jv)\n            // gl_FragColor.rgb = mix(empty,diffuseColor.rgb,jv);\n        `)\n        node.userData.matShader = shader\n    }\n}\n\nexport default class BG360Def {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create sphere w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.bg360,\n            title:'background',\n            visible:true,\n            asset:NONE_ASSET.id,\n            transparent:false,\n            parent:scene.id,\n            imageOffsetAngle:0.0, //offset in UV coords, 0 to 1\n            imageCropStartAngle:0.0, //crop left edge of image\n            imageCropEndAngle:1.0, //crop right edge of image\n        }))\n    }\n    makeNode(obj, provider) {\n        const mat = new THREE.MeshLambertMaterial({color: 'white', side: THREE.BackSide})\n        const node = new THREE.Mesh(new THREE.SphereBufferGeometry(20.0, 50,50),mat)\n        this.attachAsset(node, obj, provider)\n        customize(node,mat,obj)\n        node.name = obj.title\n        node.userData.clickable = true\n        node.visible = obj.visible\n        return node\n    }\n    updateProperty(node, obj, op, provider) {\n        if (op.name === PROP_DEFS.asset.key || op.name === PROP_DEFS.transparent.key) return this.attachAsset(node, obj, provider)\n        if(node.userData.matShader) {\n            if (op.name === 'imageOffsetAngle') node.userData.matShader.uniforms.imageOffsetAngle.value = op.value\n            if (op.name === 'imageCropStartAngle') node.userData.matShader.uniforms.imageCropStartAngle.value = op.value\n            if (op.name === 'imageCropEndAngle') node.userData.matShader.uniforms.imageCropEndAngle.value = op.value\n        } else {\n            console.warn(\"BG360: no shader reference?!\")\n        }\n    }\n\n    attachAsset(node, obj, provider) {\n        if(obj.asset === NONE_ASSET.id) {\n            node.material = new MeshLambertMaterial({side:DoubleSide})\n            return\n        }\n        provider.assetsManager.getTexture(obj.asset).then(tex => {\n            provider.getLogger().log(\"loadded asset\",obj.asset)\n            provider.getLogger().log(tex)\n            if(!tex) provider.getLogger().error(\"error loading asset\",obj.asset)\n            const opts = {\n                side: DoubleSide,\n                map:tex\n            }\n            if(obj.transparent) {\n                opts.transparent = true\n                opts.alphaTest = 0.5\n            }\n            node.material = new MeshLambertMaterial(opts)\n        }).catch(err => {\n            provider.getLogger().error('error somwhere',err.message,err)\n        })\n    }\n\n}\n","import ObjectDef from './ObjectDef'\nimport {fetchGraphObject} from '../../syncgraph/utils'\nimport {OBJ_TYPES, PROP_DEFS} from '../Common'\nimport * as THREE from 'three'\nimport WebLayer3D from 'three-web-layer'\n\nexport default class TextDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create sphere w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.text,\n            title:'some text',\n            visible:true,\n            text:'cool <b>formatted</b> <i>text</i>',\n            cssStyle:\n`color:black; \nbackground-color:white;\nwidth: 10em;\nfont-size: 200%;\n`,\n\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n\n            children:graph.createArray(),\n            parent:scene.id\n        }))\n    }\n\n    makeNode(obj) {\n        const div = document.createElement('div')\n        div.innerHTML = obj.text\n        div.id = `div_${obj.id}`\n        div.classList.add('weblayer-div')\n        if(obj.cssStyle) div.setAttribute('style',obj.cssStyle)\n        const divLayer = new WebLayer3D(div,{\n            pixelRatio: window.devicePixelRatio,\n            onLayerCreate(layer) {\n                layer.mesh.material.side = THREE.DoubleSide\n                layer.mesh.userData.graphid = obj.id\n                layer.mesh.userData.clickable = true\n            }\n        })\n\n        divLayer.refresh(true)\n        divLayer.userData.clickable = true\n        const node = new THREE.Object3D()\n\n        node.previewUpdate = function() {\n            divLayer.update()\n        }        \n        node.setText = function (text) {\n            if (text !== node.userData.text) {\n                node.userData.text = text\n                node.userData.div.innerHTML = text\n                //if(obj.cssStyle) node.userData.div.setAttribute('style',obj.cssStyle)\n\n                // shouldn't be explicitly calling refresh\n                //node.userData.divLayer.refresh(true)\n            }\n        }\n\n        node.add(divLayer)\n        node.userData.divLayer = divLayer\n        node.userData.text = obj.text\n        node.userData.div = div\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        this.regenerateText(node,obj)\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        if(    op.name === PROP_DEFS.text.key) this.regenerateText(node,obj)\n        if(    op.name === PROP_DEFS.cssStyle.key) this.regenerateText(node,obj)\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n\n    regenerateText(node, obj) {\n        node.userData.div.innerHTML = obj.text\n        if(obj.cssStyle) node.userData.div.setAttribute('style',obj.cssStyle)\n        node.userData.divLayer.refresh(true)\n    }\n}\n\n\n\n","import {fetchGraphObject} from '../../syncgraph/utils'\nimport {ASSET_TYPES, NONE_ASSET, OBJ_TYPES, PROP_DEFS} from '../Common'\nimport * as THREE from 'three'\nimport ObjectDef from './ObjectDef'\nimport {MeshLambertMaterial} from 'three'\nimport {DoubleSide} from 'three'\nimport {TextureLoader} from 'three'\nimport {VideoTexture} from 'three'\n\nexport default class Image2DDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create Image2D with missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.img2d,\n            title:'image',\n            visible:true,\n            width:0.5,\n            ratio:1,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            asset:NONE_ASSET.id,\n            transparent:false,\n            parent:scene.id,\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new THREE.Mesh(\n            new THREE.PlaneBufferGeometry(obj.width, obj.width*obj.ratio),\n            new THREE.MeshLambertMaterial({color: 'white', side: THREE.DoubleSide})\n        )\n        node.name = obj.title\n        node.userData.clickable = true\n        // on(node,POINTER_CLICK,e =>SelectionManager.setSelection(node.userData.graphid))\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        this.attachAsset(node, obj, provider)\n        return node\n    }\n    updateProperty(node, obj, op, provider) {\n        if (op.name === PROP_DEFS.asset.key || op.name === PROP_DEFS.transparent.key) return this.attachAsset(node, obj, provider)\n        if( op.name === PROP_DEFS.width.key || op.name === 'ratio') {\n            node.geometry = new THREE.PlaneBufferGeometry(obj.width, obj.width*(1/obj.ratio))\n            return\n        }\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport {Group} from 'three'\nimport ObjectDef from './ObjectDef'\nimport {OBJ_TYPES} from '../Common'\n\nlet COUNTER = 0\n\nexport default class GroupDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create cube w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.group,\n            title:'group '+COUNTER++,\n            visible:true,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#00ff00',\n            children:graph.createArray(),\n            parent:scene.id\n        }))\n    }\n    makeNode(obj) {\n        const node = new Group()\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n}\n","import {\n    BufferAttribute,\n    BufferGeometry,\n    CanvasTexture,\n    Color,\n    NormalBlending,\n    Object3D,\n    Points,\n    RepeatWrapping,\n    ShaderMaterial,\n    Vector3\n} from 'three'\n\n/*\n* modified from the version from the ThreeJS examples repo\n */\n\nconst GPUParticleShader = {\n\n    vertexShader:\n        `\n                uniform float uTime;\n                uniform float uScale;\n                uniform bool reverseTime;\n                uniform float fadeIn;\n                uniform float fadeOut;\n    \n                attribute vec3 positionStart;\n                attribute float startTime;\n                attribute vec3 velocity;\n                attribute vec3 acceleration;\n                attribute vec3 color;\n                attribute vec3 endColor;\n                attribute float size;\n                attribute float lifeTime;\n    \n                varying vec4 vColor;\n                varying vec4 vEndColor;\n                varying float lifeLeft;\n                varying float alpha;\n    \n                void main() {\n                    vColor = vec4( color, 1.0 );\n                    vEndColor = vec4( endColor, 1.0);\n                    vec3 newPosition;\n                    float timeElapsed = uTime - startTime;\n                    if(reverseTime) timeElapsed = lifeTime - timeElapsed;\n                    if(timeElapsed < fadeIn) {\n                        alpha = timeElapsed/fadeIn;\n                    }\n                    if(timeElapsed >= fadeIn && timeElapsed <= (lifeTime - fadeOut)) {\n                        alpha = 1.0;\n                    }\n                    if(timeElapsed > (lifeTime - fadeOut)) {\n                        alpha = 1.0 - (timeElapsed - (lifeTime-fadeOut))/fadeOut;\n                    }\n                    \n                    lifeLeft = 1.0 - ( timeElapsed / lifeTime );\n                    gl_PointSize = ( uScale * size );// * lifeLeft;\n                    newPosition = positionStart \n                        + (velocity * timeElapsed)\n                        + (acceleration * 0.5 * timeElapsed * timeElapsed)\n                        ;\n                    if (lifeLeft < 0.0) { \n                        lifeLeft = 0.0; \n                        gl_PointSize = 0.;\n                    }\n                    //while active use the new position\n                    if( timeElapsed > 0.0 ) {\n                        gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );\n                    } else {\n                        //if dead use the initial position and set point size to 0\n                        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n                        lifeLeft = 0.0;\n                        gl_PointSize = 0.;\n                    }\n                }\n                `\n    ,\n\n    fragmentShader: `\n                varying vec4 vColor;\n                varying vec4 vEndColor;\n                varying float lifeLeft;\n                varying float alpha;\n                uniform sampler2D tSprite;\n                void main() {\n                    // color based on particle texture and the lifeLeft. \n                    // if lifeLeft is 0 then make invisible\n                    vec4 tex = texture2D( tSprite, gl_PointCoord );\n                    vec4 color = mix(vColor, vEndColor, 1.0-lifeLeft);\n                    gl_FragColor = vec4( color.rgb*tex.rgb, alpha * tex.a);\n                }\n    \n            `\n};\n\nconst UPDATEABLE_ATTRIBUTES = [\n    'positionStart', 'startTime',\n    'velocity', 'acceleration',\n    'color', 'endColor',\n    'size', 'lifeTime']\n\nexport default class GPUParticles extends Object3D {\n    constructor(options) {\n        super()\n        options = options || {};\n\n\n        this.blending = options.blending? options.blending : NormalBlending\n        this.PARTICLE_COUNT = options.maxParticles || 1000000;\n        this.PARTICLE_CURSOR = 0;\n        this.time = 0;\n        this.offset = 0;\n        this.count = 0;\n        this.DPR = window.devicePixelRatio;\n        this.particleUpdate = false;\n        this.onTick = options.onTick\n\n        this.reverseTime = options.reverseTime\n        this.fadeIn = options.fadeIn || 1\n        if(this.fadeIn === 0) this.fadeIn = 0.001\n        this.fadeOut = options.fadeOut || 1\n        if(this.fadeOut === 0) this.fadeOut = 0.001\n\n        // preload a 10_000 random numbers from -0.5 to 0.5\n        this.rand = [];\n        let i;\n        for (i = 1e5; i>0; i--) {\n            this.rand.push( Math.random() - 0.5 );\n        }\n        this.i = i\n\n        //setup the texture\n        this.sprite = options.particleSpriteTex || null;\n        if(!this.sprite) {\n            const can = document.createElement('canvas')\n            can.width = 16\n            can.height = 16\n            const ctx = can.getContext('2d')\n            ctx.fillStyle = 'black'\n            ctx.fillRect(0,0,can.width,can.height)\n            ctx.fillStyle = 'rgba(255,255,255,0.5)'\n            ctx.beginPath()\n            ctx.arc(8,8,8,0,Math.PI*2)\n            ctx.fill()\n            this.sprite = new CanvasTexture(can)\n        }\n        this.sprite.wrapS = this.sprite.wrapT = RepeatWrapping;\n\n        //setup the shader material\n        this.material = new ShaderMaterial( {\n            transparent: true,\n            depthWrite: false,\n            uniforms: {\n                'uTime': {\n                    value: 0.0\n                },\n                'uScale': {\n                    value: 1.0\n                },\n                'tSprite': {\n                    value: this.sprite\n                },\n                reverseTime: {\n                    value: this.reverseTime\n                },\n                fadeIn: {\n                    value: this.fadeIn\n                },\n                fadeOut: {\n                    value: this.fadeOut,\n                }\n            },\n            blending: this.blending,\n            vertexShader: GPUParticleShader.vertexShader,\n            fragmentShader: GPUParticleShader.fragmentShader\n        } );\n\n        // define defaults for all values\n        this.material.defaultAttributeValues.particlePositionsStartTime = [ 0, 0, 0, 0 ];\n        this.material.defaultAttributeValues.particleVelColSizeLife = [ 0, 0, 0, 0 ];\n\n\n        // geometry\n        this.geometry = new BufferGeometry();\n\n        //vec3 attributes\n        this.geometry.addAttribute('position',      new BufferAttribute(new Float32Array(this.PARTICLE_COUNT * 3), 3).setDynamic(true));\n        this.geometry.addAttribute('positionStart', new BufferAttribute(new Float32Array(this.PARTICLE_COUNT * 3), 3).setDynamic(true));\n        this.geometry.addAttribute('velocity',      new BufferAttribute(new Float32Array(this.PARTICLE_COUNT * 3), 3).setDynamic(true));\n        this.geometry.addAttribute('acceleration',  new BufferAttribute(new Float32Array(this.PARTICLE_COUNT * 3), 3).setDynamic(true));\n        this.geometry.addAttribute('color',         new BufferAttribute(new Float32Array(this.PARTICLE_COUNT * 3), 3).setDynamic(true));\n        this.geometry.addAttribute('endColor',      new BufferAttribute(new Float32Array(this.PARTICLE_COUNT * 3), 3).setDynamic(true));\n\n        //scalar attributes\n        this.geometry.addAttribute('startTime',     new BufferAttribute(new Float32Array(this.PARTICLE_COUNT), 1).setDynamic(true));\n        this.geometry.addAttribute('size',          new BufferAttribute(new Float32Array(this.PARTICLE_COUNT), 1).setDynamic(true));\n        this.geometry.addAttribute('lifeTime',      new BufferAttribute(new Float32Array(this.PARTICLE_COUNT), 1).setDynamic(true));\n\n\n        this.particleSystem = new Points(this.geometry, this.material);\n        this.particleSystem.frustumCulled = false;\n        this.add(this.particleSystem);\n    }\n\n    /*\n      This updates the geometry on the shader if at least one particle has been spawned.\n      It uses the offset and the count to determine which part of the data needs to actually\n      be sent to the GPU. This ensures no more data than necessary is sent.\n     */\n    geometryUpdate () {\n        if (this.particleUpdate === true) {\n            this.particleUpdate = false;\n            UPDATEABLE_ATTRIBUTES.forEach(name => {\n                const attr = this.geometry.getAttribute(name)\n                if (this.offset + this.count < this.PARTICLE_COUNT) {\n                    attr.updateRange.offset = this.offset * attr.itemSize\n                    attr.updateRange.count = this.count * attr.itemSize\n                } else {\n                    attr.updateRange.offset = 0\n                    attr.updateRange.count = -1\n                }\n                attr.needsUpdate = true\n            })\n            this.offset = 0;\n            this.count = 0;\n        }\n    }\n\n\n    //use one of the random numbers\n    random () {\n        return ++ this.i >= this.rand.length ? this.rand[ this.i = 1 ] : this.rand[ this.i ];\n    }\n\n    update ( ttime ) {\n        this.time = ttime/1000\n        this.material.uniforms.uTime.value = this.time;\n        if(this.onTick) this.onTick(this,this.time)\n        this.geometryUpdate();\n    }\n\n    dispose () {\n        this.material.dispose();\n        this.sprite.dispose();\n        this.geometry.dispose();\n    }\n\n    updateSprite(sprite) {\n        if(sprite) {\n            const old = this.sprite\n            this.sprite = sprite\n            this.sprite.wrapS = this.sprite.wrapT = RepeatWrapping;\n            this.material.uniforms.tSprite.value = sprite\n            if(old) old.dispose()\n        }\n    }\n\n    /* spawn a particle\n\n    This works by updating values inside of\n    the attribute arrays, then updates the count and the PARTICLE_CURSOR and\n    sets particleUpdate to true.\n\n    This if spawnParticle is called three times in a row before rendering,\n    then count will be 3 and the cursor will have moved by three.\n     */\n    spawnParticle ( options ) {\n        // console.log('spawnparticle')\n        let position = new Vector3()\n        let velocity = new Vector3()\n        let acceleration = new Vector3()\n        let color = new Color()\n        let endColor = new Color()\n\n        const positionStartAttribute = this.geometry.getAttribute('positionStart')\n        const startTimeAttribute = this.geometry.getAttribute('startTime')\n        const velocityAttribute = this.geometry.getAttribute('velocity')\n        const accelerationAttribute = this.geometry.getAttribute('acceleration')\n        const colorAttribute = this.geometry.getAttribute('color')\n        const endcolorAttribute = this.geometry.getAttribute('endColor')\n        const sizeAttribute = this.geometry.getAttribute('size')\n        const lifeTimeAttribute = this.geometry.getAttribute('lifeTime')\n\n        options = options || {};\n\n        // setup reasonable default values for all arguments\n\n        position = options.position !== undefined ? position.copy(options.position) : position.set(0, 0, 0);\n        velocity = options.velocity !== undefined ? velocity.copy(options.velocity) : velocity.set(0, 0, 0);\n        acceleration = options.acceleration !== undefined ? acceleration.copy(options.acceleration) : acceleration.set(0, 0, 0);\n        color = options.color !== undefined ? color.copy(options.color) : color.set(0xffffff);\n        endColor = options.endColor !== undefined ? endColor.copy(options.endColor) : endColor.copy(color)\n\n        const lifetime = options.lifetime !== undefined ? options.lifetime : 5\n        let size = options.size !== undefined ? options.size : 10\n        const sizeRandomness = options.sizeRandomness !== undefined ? options.sizeRandomness : 0\n\n        if (this.DPR !== undefined) size *= this.DPR;\n\n        const i = this.PARTICLE_CURSOR\n\n        // position\n        positionStartAttribute.array[i * 3 + 0] = position.x\n        positionStartAttribute.array[i * 3 + 1] = position.y\n        positionStartAttribute.array[i * 3 + 2] = position.z\n\n        velocityAttribute.array[i * 3 + 0] = velocity.x;\n        velocityAttribute.array[i * 3 + 1] = velocity.y;\n        velocityAttribute.array[i * 3 + 2] = velocity.z;\n\n        accelerationAttribute.array[i * 3 + 0] = acceleration.x;\n        accelerationAttribute.array[i * 3 + 1] = acceleration.y;\n        accelerationAttribute.array[i * 3 + 2] = acceleration.z;\n\n        colorAttribute.array[i * 3 + 0] = color.r;\n        colorAttribute.array[i * 3 + 1] = color.g;\n        colorAttribute.array[i * 3 + 2] = color.b;\n\n        endcolorAttribute.array[i * 3 + 0] = endColor.r;\n        endcolorAttribute.array[i * 3 + 1] = endColor.g;\n        endcolorAttribute.array[i * 3 + 2] = endColor.b;\n\n        //size, lifetime and starttime\n        sizeAttribute.array[i] = size + this.random() * sizeRandomness;\n        lifeTimeAttribute.array[i] = lifetime;\n        startTimeAttribute.array[i] = this.time + this.random() * 2e-2;\n\n        // offset\n        if (this.offset === 0) this.offset = this.PARTICLE_CURSOR;\n        // counter and cursor\n        this.count++;\n        this.PARTICLE_CURSOR++;\n        //wrap the cursor around\n        if (this.PARTICLE_CURSOR >= this.PARTICLE_COUNT) this.PARTICLE_CURSOR = 0;\n        this.particleUpdate = true;\n    };\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport {AdditiveBlending, Color, DoubleSide, MeshLambertMaterial, TextureLoader, Vector3} from 'three'\nimport ObjectDef from './ObjectDef'\nimport {NONE_ASSET, OBJ_TYPES, PROP_DEFS} from '../Common'\nimport GPUParticles from './GPUParticles'\n\nexport const rand = (min,max) => Math.random()*(max-min) + min\n\nlet COUNTER = 0\n\nexport default class ParticlesDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't create cube w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.particles,\n            title:'particles '+COUNTER++,\n            visible:true,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            children:graph.createArray(),\n            pointSize:10.0,\n            lifetime:3.0,\n            startColor:'#ff0000',\n            endColor:'#0000ff',\n            parent:scene.id,\n            texture:NONE_ASSET.id,\n        }))\n    }\n    makeNode(obj, provider) {\n        const options = {\n            velocity: new Vector3(0,1,0),\n            position: new Vector3(0,0,0),\n            size:obj.pointSize,\n            lifetime:obj.lifetime,\n            color: new Color(1.0,0.0,1.0),\n            endColor: new Color(0,1,1),\n        }\n\n        const node = new GPUParticles({\n            maxParticles: 10000,\n            position: new Vector3(0,0,0),\n            positionRandomness: 0.0,\n            baseVelocity: new Vector3(0.0, 0.0, -1),\n            velocity: new Vector3(0.0, 0.0, 0.0),\n            velocityRandomness: 1.0,\n            acceleration: new Vector3(0,0.0,0),\n            baseColor: new Color(1.0,1.0,0.5),\n            color: new Color(1.0,0,0),\n            colorRandomness: 0.5,\n            lifetime: 3,\n            size: 10,\n            sizeRandomness: 1.0,\n            blending: AdditiveBlending,\n            onTick: (system, time) => {\n                options.velocity.set(rand(-1,1),1,rand(-1,1))\n                system.spawnParticle(options);\n            }\n        })\n        node.tick = function(evt) {\n            node.update(evt.time)\n        }\n        this.attachTexture(node,obj,provider)\n        node.userData.options = options\n        node.name = obj.title\n        node.userData.clickable = false\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        if(op.name === PROP_DEFS.pointSize.key) return node.userData.options.size = obj.pointSize\n        if(op.name === PROP_DEFS.lifetime.key) return node.userData.options.lifetime = obj.lifetime\n        if(op.name === PROP_DEFS.startColor.key) return node.userData.options.color.set(obj.startColor)\n        if(op.name === PROP_DEFS.endColor.key) return node.userData.options.endColor.set(obj.endColor)\n        if(op.name === PROP_DEFS.texture.key) return this.attachTexture(node,obj,provider)\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n    attachTexture(node, obj, provider) {\n        if(obj.asset === NONE_ASSET.id) {\n            node.updateSprite(null)\n            return\n        }\n        const texture = provider.accessObject(obj.texture)\n        if(!texture.exists()) return\n        const url = provider.assetsManager.getAssetURL(texture)\n        provider.getLogger().log(\"ParticlesDef: loading the asset url\",url)\n        const tex = new TextureLoader().load(url)\n        node.updateSprite(tex)\n    }\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport {Group, Mesh, MeshLambertMaterial, SphereBufferGeometry, PlaneBufferGeometry, TextureLoader, DoubleSide} from 'three'\nimport ObjectDef from './ObjectDef'\nimport {OBJ_TYPES, REC_TYPES, PROP_DEFS, toRad} from '../Common'\n\nlet COUNTER = 0\n\nexport default class LocalAnchorDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't localanchor w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.localanchor,\n            title:'localanchor '+COUNTER++,\n            visible:true,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#00ff00',\n            children:graph.createArray(),\n            recType:REC_TYPES.SCENE_START,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new Group()\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n\n        const clicker =  new Mesh(\n            new SphereBufferGeometry(1),\n            new MeshLambertMaterial({color:\"blue\", transparent:true, opacity: 0.2})\n        )\n        clicker.material.visible = true\n        clicker.userData.clickable = true\n        node.userData.clicker = clicker\n        node.add(clicker)\n\n        const preview = new Mesh(\n            new PlaneBufferGeometry(1,1),\n            new MeshLambertMaterial({color:'white',transparent:true, opacity: 0.5, side: DoubleSide})\n        )\n        preview.rotation.x = toRad(90)\n        node.add(preview)\n        node.userData.preview = preview\n\n        node.enter = (evt, scriptManager) => {\n            clicker.visible = false\n            node.visible = false\n            preview.visible = false\n            node.userData.info = {\n                recType: obj.recType,\n                object: obj,\n                node: node,\n                callback: (info) => {\n                    scriptManager.fireEventAtTarget(obj, 'recognized', info)\n                    node.visible = true\n                }\n            }\n            scriptManager.sgp.startLocalAnchor(node.userData.info)\n        }\n        node.exit = (evt, scriptManager) => {\n            clicker.visible = true\n            preview.visible = true\n            scriptManager.sgp.stopLocalAnchor(node.userData.info)\n        }\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport {Group, Mesh, MeshLambertMaterial, SphereBufferGeometry, PlaneBufferGeometry, TextureLoader, DoubleSide} from 'three'\nimport ObjectDef from './ObjectDef'\nimport {OBJ_TYPES, REC_TYPES, PROP_DEFS, toRad} from '../Common'\n\nlet COUNTER = 0\n\nexport default class ImageAnchorDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't imageanchor w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.imageanchor,\n            title:'image anchor '+COUNTER++,\n            visible:true,\n            reactivate: false,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            color:'#00ff00',\n            children:graph.createArray(),\n            targetImage:null,\n            imageRealworldWidth:1,\n            recType:REC_TYPES.SCENE_START,\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new Group()\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n\n        const clicker =  new Mesh(\n            new SphereBufferGeometry(1),\n            new MeshLambertMaterial({color:\"red\", transparent:true, opacity: 0.2})\n        )\n        clicker.material.visible = true\n        clicker.userData.clickable = true\n        node.userData.clicker = clicker\n        node.add(clicker)\n\n        const preview = new Mesh(\n            new PlaneBufferGeometry(1,1),\n            new MeshLambertMaterial({color:'white',transparent:true, opacity: 0.5, side: DoubleSide})\n        )\n        preview.rotation.x = toRad(90)\n        node.add(preview)\n        node.userData.preview = preview\n        this.updateImagePreview(node,obj,provider)\n\n        node.enter = (evt, scriptManager) => {\n            clicker.visible = false\n            node.visible = false\n            preview.visible = false\n            node.userData.info = {\n                image: scriptManager.sgp.getGraphObjectById(obj.targetImage),\n                imageRealworldWidth: obj.imageRealworldWidth,\n                reactivate: obj.reactivate,\n                recType: obj.recType,\n                object: obj,\n                node: node,\n                callback: (info) => {\n                    scriptManager.fireEventAtTarget(obj, 'recognized', info)\n                    node.visible = true\n                }\n            }\n            scriptManager.sgp.startImageRecognizer(node.userData.info)\n        }\n        node.exit = (evt, scriptManager) => {\n            clicker.visible = true\n            preview.visible = true\n            scriptManager.sgp.stopImageRecognizer(node.userData.info)\n        }\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        if(op.name === PROP_DEFS.targetImage.key) {\n            return this.updateImagePreview(node,obj,provider)\n        }\n        if(op.name === PROP_DEFS.imageRealworldWidth.key) {\n            return this.updateImagePreview(node,obj,provider)\n        }\n        return super.updateProperty(node,obj,op,provider)\n    }\n\n    updateImagePreview(node,obj,provider) {\n        const targetImage = provider.accessObject(obj.targetImage)\n        if(targetImage.exists()) {\n            const url = provider.assetsManager.getAssetURL(targetImage)\n            provider.getLogger().log(\"ImageAnchor loading the asset url\",url)\n            const tex = new TextureLoader().load(url)\n            node.userData.preview.material = new MeshLambertMaterial({color:'white',transparent:true, opacity:0.5, side:DoubleSide, map:tex})\n            let height = (targetImage.height / targetImage.width)\n            let width = 1\n            node.userData.preview.geometry = new PlaneBufferGeometry(width,height)\n            //console.log(obj)\n            let scale = obj.imageRealworldWidth\n            node.userData.preview.scale.set(scale,scale,scale)\n        }\n        if(provider.accessObject(obj.targetImage).exists()) {\n            node.userData.preview.visible = true\n            node.userData.clicker.visible = false\n        } else {\n            node.userData.preview.visible = false\n            node.userData.clicker.visible = true\n        }\n    }\n\n}\n","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport {Group, Mesh, MeshLambertMaterial, SphereBufferGeometry} from 'three'\nimport ObjectDef from './ObjectDef'\nimport {OBJ_TYPES, REC_TYPES} from '../Common'\nlet COUNTER = 0\n\nexport default class GeoAnchorDef extends ObjectDef {\n    make(graph, scene) {\n        if (!scene.id) throw new Error(\"can't create geo anchor w/ missing parent\")\n        return fetchGraphObject(graph, graph.createObject({\n            type: OBJ_TYPES.geoanchor,\n            title: 'geo anchor ' + COUNTER++,\n            visible: true,\n            tx: 0, ty: 0, tz: 0,\n            rx: 0, ry: 0, rz: 0,\n            sx: 1, sy: 1, sz: 1,\n            color: '#00ff00',\n            children: graph.createArray(),\n            targetGeoLocation: null,\n            recType: REC_TYPES.SCENE_START,\n            parent: scene.id\n        }))\n    }\n    makeNode(obj) {\n        const node = new Group()\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n\n        const clicker =  new Mesh(\n            new SphereBufferGeometry(1),\n            new MeshLambertMaterial({color:\"red\", transparent:true, opacity: 0.2})\n        )\n        clicker.material.visible = true\n        clicker.userData.clickable = true\n        node.userData.clicker = clicker\n        node.add(clicker)\n        node.enter = (evt, scriptManager) => {\n            clicker.visible = false\n            node.visible = false\n            node.userData.info = {\n                location:scriptManager.sgp.getGraphObjectById(obj.targetGeoLocation),\n                recType:obj.recType,\n                object:obj,\n                node:node,\n                callback:(info) => {\n                    scriptManager.fireEventAtTarget(obj, 'localized', info)\n                    node.visible = true\n                }\n            }\n            scriptManager.sgp.startGeoTracker(node.userData.info)\n        }\n        node.exit = (evt, scriptManager) => {\n            clicker.visible = true\n            scriptManager.sgp.stopGeoTracker(node.userData.info)\n        }\n        return node\n    }\n}","import {fetchGraphObject} from \"../../syncgraph/utils\"\nimport {Group, Mesh, MeshLambertMaterial, SphereBufferGeometry, PlaneBufferGeometry, TextureLoader, DoubleSide} from 'three'\nimport ObjectDef from './ObjectDef'\nimport {ASSET_TYPES, OBJ_TYPES, REC_TYPES, PROP_DEFS} from '../Common'\n\nlet COUNTER = 0\n\nexport class HudAnchorDef extends ObjectDef {\n    make(graph, scene) {\n        if(!scene.id) throw new Error(\"can't add hudanchor w/ missing parent\")\n        return fetchGraphObject(graph,graph.createObject({\n            type:OBJ_TYPES.hudanchor,\n            title:'hud anchor '+COUNTER++,\n            visible:true,\n            tx:0, ty:0, tz:0,\n            rx:0, ry:0, rz:0,\n            sx:1, sy:1, sz:1,\n            children:graph.createArray(),\n            parent:scene.id\n        }))\n    }\n    makeNode(obj, provider) {\n        const node = new Group()\n        node.name = obj.title\n        node.userData.clickable = true\n        node.position.set(obj.tx, obj.ty, obj.tz)\n        node.rotation.set(obj.rx,obj.ry,obj.rz)\n        node.scale.set(obj.sx,obj.sy,obj.sz)\n        node.visible = obj.visible\n\n        const clicker =  new Mesh(\n            new SphereBufferGeometry(1),\n            new MeshLambertMaterial({color:\"red\", transparent:true, opacity: 0.2})\n        )\n        clicker.material.visible = true\n        clicker.userData.clickable = true\n        node.userData.clicker = clicker\n        node.add(clicker)\n\n        node.enter = (evt,scriptManager) => {\n            node.parent.remove(node)\n            node.position.z = 0\n            clicker.visible = false\n            scriptManager.sgp.getCamera().add(node)\n        }\n        node.exit = (evt,scriptManager) => {\n            scriptManager.sgp.getCamera().remove(node)\n            clicker.visible = true\n            const scene = scriptManager.sgp.getThreeObject(obj.parent)\n            scene.add(node)\n            node.position.set(obj.tx, obj.ty, obj.tz)\n            node.rotation.set(obj.rx,obj.ry,obj.rz)\n            node.scale.set(obj.sx,obj.sy,obj.sz)\n        }\n        return node\n    }\n\n    updateProperty(node, obj, op, provider) {\n        return super.updateProperty(node,obj,op,provider)\n    }\n}\n","import {TYPES} from '../common/PropSheet'\nimport CubeDef from './defs/CubeDef'\nimport SphereDef from './defs/SphereDef'\nimport PlaneDef from './defs/PlaneDef'\nimport ModelDef from './defs/ModelDef'\nimport BG360Def from './defs/BG360Def'\nimport TextDef from './defs/TextDef'\nimport Image2DDef from './defs/Image2DDef'\nimport GroupDef from './defs/GroupDef'\nimport ParticlesDef from './defs/ParticlesDef'\nimport LocalAnchorDef from './defs/LocalAnchorDef'\nimport ImageAnchorDef from './defs/ImageAnchorDef'\nimport GeoAnchorDef from './defs/GeoAnchorDef'\nimport {HudAnchorDef} from './defs/HudAnchorDef'\n\nexport const NONE_ASSET = {\n    id:-30,\n    title:'NONE'\n}\n\nconst stdhints = {\n    incrementValue:0.1,\n}\nexport const PROP_DEFS = {\n    title: {\n        key:'title',\n        name:'Title',\n        type:TYPES.STRING\n    },\n    description: {\n        key:'description',\n        name:'Description',\n        type:TYPES.STRING\n    },\n    width: {\n        key:'width',\n        name:'Width',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    height: {\n        key:'height',\n        name:'Height',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    depth: {\n        key:'depth',\n        name:'Depth',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    radius: {\n        key:'radius',\n        name:'Radius',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    tx: {\n        key:'tx',\n        name:'TX',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    ty: {\n        key:'ty',\n        name:'TY',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    tz: {\n        key:'tz',\n        name:'TZ',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    rx: {\n        key:'rx',\n        name:'RX',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    ry: {\n        key:'ry',\n        name:'RY',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    rz: {\n        key:'rz',\n        name:'RZ',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    sx: {\n        key:'sx',\n        name:'SX',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    sy: {\n        key:'sy',\n        name:'SY',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    sz: {\n        key:'sz',\n        name:'SZ',\n        type:TYPES.NUMBER,\n        hints: stdhints\n    },\n    color: {\n        key:'color',\n        name:'Color',\n        type:TYPES.COLOR,\n        custom:true,\n    },\n    defaultFloor: {\n        key:'defaultFloor',\n        name:'Default Floor',\n        type:TYPES.BOOLEAN\n    },\n    src: {\n        key:'src',\n        name:'src',\n        type:TYPES.STRING,\n        locked:true,\n    },\n    asset: {\n        key:'asset',\n        name:'asset',\n        type:TYPES.ENUM,\n    },\n    subtype: {\n        key:'subtype',\n        name:'kind',\n        type:TYPES.STRING,\n        locked:true,\n    },\n    format: {\n        key:'format',\n        name:'format',\n        type:TYPES.STRING,\n        locked:true,\n    },\n    imageOffsetAngle: {\n        key:'imageOffsetAngle',\n        name:'Image Offset Angle',\n        type:TYPES.NUMBER,\n        hints: {\n            incrementValue:0.05,\n        }\n    },\n    imageCropStartAngle: {\n        key:'imageCropStartAngle',\n        name:'Image Crop Start Angle',\n        type:TYPES.NUMBER,\n        hints: {\n            incrementValue:0.05,\n        }\n    },\n    imageCropEndAngle: {\n        key:'imageCropEndAngle',\n        name:'Image Crop End Angle',\n        type:TYPES.NUMBER,\n        hints: {\n            incrementValue:0.05,\n        }\n    },\n    transparent: {\n        key:'transparent',\n        name:\"Transparent\",\n        type:TYPES.BOOLEAN\n    },\n    imageRealworldWidth: {\n        key:'imageRealworldWidth',\n        name:'Image width in meters',\n        type: TYPES.NUMBER,\n        hints: {\n            incrementValue:0.01\n        }\n    },\n    recType: {\n        key:'recType',\n        name:'Recognition Type',\n        type: TYPES.ENUM,\n    },\n\n    targetImage: {\n        key:'targetImage',\n        name:'Image to Recognize',\n        type: TYPES.ENUM,\n    },\n\n    targetGeoLocation: {\n        key:'targetGeoLocation',\n        name:'Target Location',\n        type: TYPES.ENUM,\n    },\n\n    splashImage: {\n        key:'splashImage',\n        name:'Splash Image',\n        type: TYPES.ENUM,\n    },\n\n    text: {\n        key:'text',\n        name:'Text',\n        type:TYPES.STRING,\n        hints: {\n            multiline:true\n        }\n    },\n    fontSize: {\n        key:'fontSize',\n        name:'Font Size',\n        type:TYPES.NUMBER,\n    },\n    padding: {\n        key:'padding',\n        name:'Padding',\n        type:TYPES.NUMBER,\n    },\n    borderWidth: {\n        key:'borderWidth',\n        name:'Border width',\n        type:TYPES.NUMBER,\n    },\n    borderRadius: {\n        key:'borderRadius',\n        name:'Corner Size',\n        type:TYPES.NUMBER,\n    },\n    horizontalAlign: {\n        key:'horizontalAlign',\n        name:'H Align',\n        type:TYPES.ENUM,\n        locked:false,\n    },\n    textColor: {\n        key:'textColor',\n        name:'Text Color',\n        type:TYPES.COLOR,\n        custom:true,\n    },\n    backgroundColor: {\n        key:'backgroundColor',\n        name:'BG Color',\n        type:TYPES.COLOR,\n        custom:true,\n    },\n    borderColor: {\n        key:'borderColor',\n        name:'Border Color',\n        type:TYPES.COLOR,\n        custom:true,\n    },\n    startColor: {\n        key:'startColor',\n        name:'Start',\n        type:TYPES.COLOR,\n        custom:true,\n    },\n    endColor: {\n        key:'endColor',\n        name:'End',\n        type:TYPES.COLOR,\n        custom:true,\n    },\n    drawBackground: {\n        key:'drawBackground',\n        name:'BG?',\n        type:TYPES.BOOLEAN,\n    },\n    scriptBody: {\n        key:'scriptBody',\n        name:'code',\n        type:TYPES.STRING,\n        hints: {\n            multiline:true\n        }\n    },\n    defaultScene: {\n        key:'defaultScene',\n        name:'Start Scene',\n        type:TYPES.ENUM,\n    },\n    visible: {\n        key:'visible',\n        name:'Visible',\n        type:TYPES.BOOLEAN\n    },\n\n    reactivate: {\n        key: 'reactivate',\n        name: \"Reactivate Image Search\",\n        type: TYPES.BOOLEAN\n    },\n\n    pointSize: {\n        key:'pointSize',\n        name:'Point Size',\n        type:TYPES.NUMBER,\n    },\n    lifetime: {\n        key:'lifetime',\n        name:'Lifetime',\n        type:TYPES.NUMBER,\n        hints: stdhints,\n    },\n    texture: {\n        key:'texture',\n        name:'texture',\n        type:TYPES.ENUM,\n    },\n    cssStyle: {\n        key:'cssStyle',\n        name:'Style',\n        type:TYPES.STRING,\n        hints: {\n            multiline:true\n        }\n    },\n    latitude: {\n        key:'latitude',\n        name:\"Latitude\",\n        type:TYPES.NUMBER, //value in degrees\n    },\n    longitude: {\n        key:'longitude',\n        name:\"Longitude\",\n        type:TYPES.NUMBER, //value in degrees\n    },\n    altitude: {\n        key:'altitude',\n        name:\"altitude\",\n        type:TYPES.NUMBER, //value in meters\n    },\n    useAltitude: {\n        key:'useAltitude',\n        name:\"use altitude?\",\n        type:TYPES.BOOLEAN,\n    },\n    autoRecenter: {\n        key:'autoRecenter',\n        name:\"Recenter on Load\",\n        type:TYPES.BOOLEAN\n    }\n}\n\nexport const SIMPLE_COLORS = [\"#ffffff\",\"#ff0000\",\"#ffff00\",\"#00ff00\",\"#00ffff\",\"#0000ff\",\"#ff00ff\",\"#000000\"]\n\nexport const OBJ_TYPES = {\n    cube:'cube',\n    sphere:'sphere',\n    plane:'plane',\n    model:'model',\n    bg360:'bg360',\n    text:'text',\n    img2d:'img2d',\n    group:'group',\n    particles:'particles',\n    localanchor:'localanchor',\n    imageanchor:'imageanchor',\n    geoanchor:'geoanchor',\n    hudanchor:'hudanchor',\n}\n\nexport const TOTAL_OBJ_TYPES = {\n    SCENE:'scene',\n    ASSET:'asset',\n    BEHAVIOR:'behavior',\n    BEHAVIOR_SCRIPT:'behavior_script',\n    ASSETS_LIST: 'assets',\n    BEHAVIORS_LIST: 'behaviors',\n    ROOT: 'root'\n}\nexport const HORIZONTAL_ALIGNMENT = {\n    LEFT:'LEFT',\n    CENTER:'CENTER',\n    RIGHT:'RIGHT',\n}\n\n\nexport function is3DObjectType(type) {\n    if(type === OBJ_TYPES.cube) return true\n    if(type === OBJ_TYPES.sphere) return true\n    if(type === OBJ_TYPES.plane) return true\n    if(type === OBJ_TYPES.model) return true\n    if(type === OBJ_TYPES.text) return true\n    if(type === OBJ_TYPES.bg360) return true\n    if(type === OBJ_TYPES.img2d) return true\n    if(type === OBJ_TYPES.group) return true\n    if(type === OBJ_TYPES.particles) return true\n    if(type === OBJ_TYPES.localanchor) return true\n    if(type === OBJ_TYPES.imageanchor) return true\n    if(type === OBJ_TYPES.geoanchor) return true\n    if(type === OBJ_TYPES.hudanchor) return true\n    return false\n}\n\nexport function canHaveShape(type) {\n    if(type === OBJ_TYPES.group) return true\n    if(type === OBJ_TYPES.localanchor) return true\n    if(type === OBJ_TYPES.imageanchor) return true\n    if(type === OBJ_TYPES.geoanchor) return true\n    if(type === OBJ_TYPES.hudanchor) return true\n    if(type === TOTAL_OBJ_TYPES.SCENE) return true\n    return false\n}\n\nexport function canHaveBehavior(type) {\n    if(is3DObjectType(type)) return true\n    if(type === TOTAL_OBJ_TYPES.SCENE) return true\n    return false\n}\n\nexport function canHaveScene(type) {\n    if(type === TOTAL_OBJ_TYPES.ROOT) return true\n    return false\n}\n\nexport function canBeDeleted(type) {\n    if(type === TOTAL_OBJ_TYPES.ROOT) return false\n    if(type === TOTAL_OBJ_TYPES.ASSETS_LIST) return false\n    if(type === TOTAL_OBJ_TYPES.BEHAVIORS_LIST) return false\n    return true\n}\n\nexport function get3DObjectDef(type) {\n    if(type === OBJ_TYPES.cube) return new CubeDef()\n    if(type === OBJ_TYPES.sphere) return new SphereDef()\n    if(type === OBJ_TYPES.plane) return new PlaneDef()\n    if(type === OBJ_TYPES.model) return new ModelDef()\n    if(type === OBJ_TYPES.bg360) return new BG360Def()\n    if(type === OBJ_TYPES.text) return new TextDef()\n    if(type === OBJ_TYPES.img2d) return new Image2DDef()\n    if(type === OBJ_TYPES.group) return new GroupDef()\n    if(type === OBJ_TYPES.particles) return new ParticlesDef()\n    if(type === OBJ_TYPES.localanchor) return new LocalAnchorDef()\n    if(type === OBJ_TYPES.imageanchor) return new ImageAnchorDef()\n    if(type === OBJ_TYPES.geoanchor) return new GeoAnchorDef()\n    if(type === OBJ_TYPES.hudanchor) return new HudAnchorDef()\n    throw new Error(`unknown 3d object type ${type}`)\n}\n\nexport const toRad = (degrees) => degrees*Math.PI/180\n\nexport const MIME_TYPES = {\n    PNG:'image/png',\n    JPEG:'image/jpeg',\n    GIF:'image/gif',\n    MP3: 'audio/mpeg',\n    AAC: 'audio/aac',\n    WAV:'audio/wav',\n    JAVASCRIPT: 'text/javascript',\n    GLB: 'model/gltf-binary',\n    MP4:'video/mp4',\n    MOV:'video/quicktime',\n}\nexport const ASSET_TYPES = {\n    BEHAVIOR:'behavior',\n    IMAGE:'image',\n    GLTF: 'gltf',\n    AUDIO:'audio',\n    VIDEO:'video',\n    GEOLOCATION: 'geolocation'\n}\nexport function isImageType(type) {\n    if (!type) return false\n    if (type.toLowerCase() === MIME_TYPES.PNG) return true\n    if (type.toLowerCase() === MIME_TYPES.JPEG) return true\n    if (type.toLowerCase() === MIME_TYPES.GIF) return true\n    return false;\n}\nexport function isAudioType(type) {\n    if(!type) return false\n    if(type.toLowerCase() === MIME_TYPES.MP3) return true\n    if(type.toLowerCase() === MIME_TYPES.AAC) return true\n    if(type.toLowerCase() === MIME_TYPES.WAV) return true\n    return false\n}\n\nexport function isVideoType(type) {\n    if(!type) return false\n    if(type.toLowerCase() === MIME_TYPES.MP4) return true\n    if(type.toLowerCase() === MIME_TYPES.MOV) return true\n    return false\n}\nexport function isGLTFType(type) {\n    if(!type) return false\n    if(type.toLowerCase() === MIME_TYPES.GLB) return true\n    return false\n}\n\n\nexport function isGLTFFile(file) {\n    if (!file) return false\n    console.log(\"looking at the file\", file, 'type', file.type, 'type')\n    if (!file.type || file.type === '' || file.type.length === 0) {\n        console.log(\"no mimetype. check extension\")\n        if (file.name.toLowerCase().indexOf(\".gltf\") > 0) return true\n        if (file.name.toLowerCase().indexOf(\".glb\") > 0) return true\n    }\n    if (file.type.toLowerCase() === 'image/gltf') return true\n    return false;\n}\n\nexport const ITEM_ICONS = {\n    plane: 'plane',\n    cube: 'square',\n    sphere: 'circle',\n    model: 'cube',\n    asset: 'file',\n    assets: 'archive',\n    behavior:'superpowers',\n    behavior_script:'superpowers',\n    scene: 'globe',\n    bg360:'image',\n    img2d:'image',\n    image:'image',\n    text:'font',\n    audio:'music',\n    video:'video-camera',\n    group:'object-group',\n    particles:'certificate',\n    gltf:'cube',\n    localanchor:'anchor',\n    imageanchor:'anchor',\n    geoanchor:'globe',\n    geolocation:'globe',\n    hudanchor: 'eye',\n\n    cut:'cut',\n    copy:'copy',\n    paste:'paste',\n    delete:'close'\n}\n\n\nexport function parseBehaviorScript(contents) {\n    return Function(`\"use strict\";\n    const toRadians = (deg) => Math.PI/180*deg; \n    return(${contents})`)();\n}\n\nexport const REC_TYPES = {\n    SCENE_START:'SCENE_START'\n}\n","const THREE = require('three');//requireimport * as THREE from 'three'\n\n/**\n * @author qiao / https://github.com/qiao\n * @author mrdoob / http://mrdoob.com\n * @author alteredq / http://alteredqualia.com/\n * @author WestLangley / http://github.com/WestLangley\n * @author erich666 / http://erichaines.com\n */\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one finger move\n//    Zoom - middle mouse, or mousewheel / touch: two finger spread or squish\n//    Pan - right mouse, or arrow keys / touch: three finger swipe\n\nconst OrbitControls = function ( object, domElement ) {\n\n    this.object = object;\n\n    this.domElement = ( domElement !== undefined ) ? domElement : document;\n\n    // Set to false to disable this control\n    this.enabled = true;\n\n    // \"target\" sets the location of focus, where the object orbits around\n    this.target = new THREE.Vector3();\n\n    // How far you can dolly in and out ( PerspectiveCamera only )\n    this.minDistance = 0;\n    this.maxDistance = Infinity;\n\n    // How far you can zoom in and out ( OrthographicCamera only )\n    this.minZoom = 0;\n    this.maxZoom = Infinity;\n\n    // How far you can orbit vertically, upper and lower limits.\n    // Range is 0 to Math.PI radians.\n    this.minPolarAngle = 0; // radians\n    this.maxPolarAngle = Math.PI; // radians\n\n    // How far you can orbit horizontally, upper and lower limits.\n    // If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\n    this.minAzimuthAngle = - Infinity; // radians\n    this.maxAzimuthAngle = Infinity; // radians\n\n    // Set to true to enable damping (inertia)\n    // If damping is enabled, you must call controls.update() in your animation loop\n    this.enableDamping = false;\n    this.dampingFactor = 0.25;\n\n    // This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n    // Set to false to disable zooming\n    this.enableZoom = true;\n    this.zoomSpeed = 1.0;\n\n    // Set to false to disable rotating\n    this.enableRotate = true;\n    this.rotateSpeed = 1.0;\n\n    // Set to false to disable panning\n    this.enablePan = true;\n    this.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n    // Set to true to automatically rotate around the target\n    // If auto-rotate is enabled, you must call controls.update() in your animation loop\n    this.autoRotate = false;\n    this.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n    // Set to false to disable use of the keys\n    this.enableKeys = true;\n\n    // The four arrow keys\n    this.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n    // Mouse buttons\n    this.mouseButtons = { ORBIT: THREE.MOUSE.LEFT, ZOOM: THREE.MOUSE.MIDDLE, PAN: THREE.MOUSE.RIGHT };\n\n    // for reset\n    this.target0 = this.target.clone();\n    this.position0 = this.object.position.clone();\n    this.zoom0 = this.object.zoom;\n\n    //\n    // public methods\n    //\n\n    this.getPolarAngle = function () {\n\n        return spherical.phi;\n\n    };\n\n    this.getAzimuthalAngle = function () {\n\n        return spherical.theta;\n\n    };\n\n    this.saveState = function () {\n\n        scope.target0.copy( scope.target );\n        scope.position0.copy( scope.object.position );\n        scope.zoom0 = scope.object.zoom;\n\n    };\n\n    this.reset = function () {\n\n        scope.target.copy( scope.target0 );\n        scope.object.position.copy( scope.position0 );\n        scope.object.zoom = scope.zoom0;\n\n        scope.object.updateProjectionMatrix();\n        scope.dispatchEvent( changeEvent );\n\n        scope.update();\n\n        state = STATE.NONE;\n\n    };\n\n    // this method is exposed, but perhaps it would be better if we can make it private...\n    this.update = function () {\n\n        var offset = new THREE.Vector3();\n\n        // so camera.up is the orbit axis\n        var quat = new THREE.Quaternion().setFromUnitVectors( object.up, new THREE.Vector3( 0, 1, 0 ) );\n        var quatInverse = quat.clone().inverse();\n\n        var lastPosition = new THREE.Vector3();\n        var lastQuaternion = new THREE.Quaternion();\n\n        return function update() {\n\n            var position = scope.object.position;\n\n            offset.copy( position ).sub( scope.target );\n\n            // rotate offset to \"y-axis-is-up\" space\n            offset.applyQuaternion( quat );\n\n            // angle from z-axis around y-axis\n            spherical.setFromVector3( offset );\n\n            if ( scope.autoRotate && state === STATE.NONE ) {\n\n                rotateLeft( getAutoRotationAngle() );\n\n            }\n\n            spherical.theta += sphericalDelta.theta;\n            spherical.phi += sphericalDelta.phi;\n\n            // restrict theta to be between desired limits\n            spherical.theta = Math.max( scope.minAzimuthAngle, Math.min( scope.maxAzimuthAngle, spherical.theta ) );\n\n            // restrict phi to be between desired limits\n            spherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\n\n            spherical.makeSafe();\n\n\n            spherical.radius *= scale;\n\n            // restrict radius to be between desired limits\n            spherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\n\n            // move target to panned location\n            scope.target.add( panOffset );\n\n            offset.setFromSpherical( spherical );\n\n            // rotate offset back to \"camera-up-vector-is-up\" space\n            offset.applyQuaternion( quatInverse );\n\n            position.copy( scope.target ).add( offset );\n\n            scope.object.lookAt( scope.target );\n\n            if ( scope.enableDamping === true ) {\n\n                sphericalDelta.theta *= ( 1 - scope.dampingFactor );\n                sphericalDelta.phi *= ( 1 - scope.dampingFactor );\n\n            } else {\n\n                sphericalDelta.set( 0, 0, 0 );\n\n            }\n\n            scale = 1;\n            panOffset.set( 0, 0, 0 );\n\n            // update condition is:\n            // min(camera displacement, camera rotation in radians)^2 > EPS\n            // using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n            if ( zoomChanged ||\n                lastPosition.distanceToSquared( scope.object.position ) > EPS ||\n                8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\n\n                scope.dispatchEvent( changeEvent );\n                lastPosition.copy( scope.object.position );\n                lastQuaternion.copy( scope.object.quaternion );\n                zoomChanged = false;\n\n                return true;\n\n            }\n\n            return false;\n\n        };\n\n    }();\n\n    this.dispose = function () {\n\n        scope.domElement.removeEventListener( 'contextmenu', onContextMenu, false );\n        scope.domElement.removeEventListener( 'mousedown', onMouseDown, false );\n        scope.domElement.removeEventListener( 'wheel', onMouseWheel, false );\n\n        scope.domElement.removeEventListener( 'touchstart', onTouchStart, false );\n        scope.domElement.removeEventListener( 'touchend', onTouchEnd, false );\n        scope.domElement.removeEventListener( 'touchmove', onTouchMove, false );\n\n        document.removeEventListener( 'mousemove', onMouseMove, false );\n        document.removeEventListener( 'mouseup', onMouseUp, false );\n\n        window.removeEventListener( 'keydown', onKeyDown, false );\n\n        //scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\n    };\n\n    //\n    // internals\n    //\n\n    var scope = this;\n\n    var changeEvent = { type: 'change' };\n    var startEvent = { type: 'start' };\n    var endEvent = { type: 'end' };\n\n    var STATE = { NONE: - 1, ROTATE: 0, DOLLY: 1, PAN: 2, TOUCH_ROTATE: 3, TOUCH_DOLLY: 4, TOUCH_PAN: 5 };\n\n    var state = STATE.NONE;\n\n    var EPS = 0.000001;\n\n    // current position in spherical coordinates\n    var spherical = new THREE.Spherical();\n    var sphericalDelta = new THREE.Spherical();\n\n    var scale = 1;\n    var panOffset = new THREE.Vector3();\n    var zoomChanged = false;\n\n    var rotateStart = new THREE.Vector2();\n    var rotateEnd = new THREE.Vector2();\n    var rotateDelta = new THREE.Vector2();\n\n    var panStart = new THREE.Vector2();\n    var panEnd = new THREE.Vector2();\n    var panDelta = new THREE.Vector2();\n\n    var dollyStart = new THREE.Vector2();\n    var dollyEnd = new THREE.Vector2();\n    var dollyDelta = new THREE.Vector2();\n\n    function getAutoRotationAngle() {\n\n        return 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n    }\n\n    function getZoomScale() {\n\n        return Math.pow( 0.95, scope.zoomSpeed );\n\n    }\n\n    function rotateLeft( angle ) {\n\n        sphericalDelta.theta -= angle;\n\n    }\n\n    function rotateUp( angle ) {\n\n        sphericalDelta.phi -= angle;\n\n    }\n\n    var panLeft = function () {\n\n        var v = new THREE.Vector3();\n\n        return function panLeft( distance, objectMatrix ) {\n\n            v.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n            v.multiplyScalar( - distance );\n\n            panOffset.add( v );\n\n        };\n\n    }();\n\n    var panUp = function () {\n\n        var v = new THREE.Vector3();\n\n        return function panUp( distance, objectMatrix ) {\n\n            v.setFromMatrixColumn( objectMatrix, 1 ); // get Y column of objectMatrix\n            v.multiplyScalar( distance );\n\n            panOffset.add( v );\n\n        };\n\n    }();\n\n    // deltaX and deltaY are in pixels; right and down are positive\n    var pan = function () {\n\n        var offset = new THREE.Vector3();\n\n        return function pan( deltaX, deltaY ) {\n\n            var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n            if ( scope.object.isPerspectiveCamera ) {\n\n                // perspective\n                var position = scope.object.position;\n                offset.copy( position ).sub( scope.target );\n                var targetDistance = offset.length();\n\n                // half of the fov is center to top of screen\n                targetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n                // we actually don't use screenWidth, since perspective camera is fixed to screen height\n                panLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\n                panUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\n\n            } else if ( scope.object.isOrthographicCamera ) {\n\n                // orthographic\n                panLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\n                panUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\n\n            } else {\n\n                // camera neither orthographic nor perspective\n                console.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n                scope.enablePan = false;\n\n            }\n\n        };\n\n    }();\n\n    function dollyIn( dollyScale ) {\n\n        if ( scope.object.isPerspectiveCamera ) {\n\n            scale /= dollyScale;\n\n        } else if ( scope.object.isOrthographicCamera ) {\n\n            scope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\n            scope.object.updateProjectionMatrix();\n            zoomChanged = true;\n\n        } else {\n\n            console.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n            scope.enableZoom = false;\n\n        }\n\n    }\n\n    function dollyOut( dollyScale ) {\n\n        if ( scope.object.isPerspectiveCamera ) {\n\n            scale *= dollyScale;\n\n        } else if ( scope.object.isOrthographicCamera ) {\n\n            scope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\n            scope.object.updateProjectionMatrix();\n            zoomChanged = true;\n\n        } else {\n\n            console.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n            scope.enableZoom = false;\n\n        }\n\n    }\n\n    //\n    // event callbacks - update the object state\n    //\n\n    function handleMouseDownRotate( event ) {\n\n        //console.log( 'handleMouseDownRotate' );\n\n        rotateStart.set( event.clientX, event.clientY );\n\n    }\n\n    function handleMouseDownDolly( event ) {\n\n        //console.log( 'handleMouseDownDolly' );\n\n        dollyStart.set( event.clientX, event.clientY );\n\n    }\n\n    function handleMouseDownPan( event ) {\n\n        //console.log( 'handleMouseDownPan' );\n\n        panStart.set( event.clientX, event.clientY );\n\n    }\n\n    function handleMouseMoveRotate( event ) {\n\n        //console.log( 'handleMouseMoveRotate' );\n\n        rotateEnd.set( event.clientX, event.clientY );\n        rotateDelta.subVectors( rotateEnd, rotateStart );\n\n        var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n        // rotating across whole screen goes 360 degrees around\n        rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\n\n        // rotating up and down along whole screen attempts to go 360, but limited to 180\n        rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\n\n        rotateStart.copy( rotateEnd );\n\n        scope.update();\n\n    }\n\n    function handleMouseMoveDolly( event ) {\n\n        //console.log( 'handleMouseMoveDolly' );\n\n        dollyEnd.set( event.clientX, event.clientY );\n\n        dollyDelta.subVectors( dollyEnd, dollyStart );\n\n        if ( dollyDelta.y > 0 ) {\n\n            dollyIn( getZoomScale() );\n\n        } else if ( dollyDelta.y < 0 ) {\n\n            dollyOut( getZoomScale() );\n\n        }\n\n        dollyStart.copy( dollyEnd );\n\n        scope.update();\n\n    }\n\n    function handleMouseMovePan( event ) {\n\n        //console.log( 'handleMouseMovePan' );\n\n        panEnd.set( event.clientX, event.clientY );\n\n        panDelta.subVectors( panEnd, panStart );\n\n        pan( panDelta.x, panDelta.y );\n\n        panStart.copy( panEnd );\n\n        scope.update();\n\n    }\n\n    function handleMouseUp( event ) {\n\n        // console.log( 'handleMouseUp' );\n\n    }\n\n    function handleMouseWheel( event ) {\n\n        // console.log( 'handleMouseWheel' );\n\n        if ( event.deltaY < 0 ) {\n\n            dollyOut( getZoomScale() );\n\n        } else if ( event.deltaY > 0 ) {\n\n            dollyIn( getZoomScale() );\n\n        }\n\n        scope.update();\n\n    }\n\n    function handleKeyDown( event ) {\n\n        //console.log( 'handleKeyDown' );\n\n        switch ( event.keyCode ) {\n\n            case scope.keys.UP:\n                pan( 0, scope.keyPanSpeed );\n                scope.update();\n                break;\n\n            case scope.keys.BOTTOM:\n                pan( 0, - scope.keyPanSpeed );\n                scope.update();\n                break;\n\n            case scope.keys.LEFT:\n                pan( scope.keyPanSpeed, 0 );\n                scope.update();\n                break;\n\n            case scope.keys.RIGHT:\n                pan( - scope.keyPanSpeed, 0 );\n                scope.update();\n                break;\n\n        }\n\n    }\n\n    function handleTouchStartRotate( event ) {\n\n        //console.log( 'handleTouchStartRotate' );\n\n        rotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n    }\n\n    function handleTouchStartDolly( event ) {\n\n        //console.log( 'handleTouchStartDolly' );\n\n        var dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n        var dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n        var distance = Math.sqrt( dx * dx + dy * dy );\n\n        dollyStart.set( 0, distance );\n\n    }\n\n    function handleTouchStartPan( event ) {\n\n        //console.log( 'handleTouchStartPan' );\n\n        panStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n    }\n\n    function handleTouchMoveRotate( event ) {\n\n        //console.log( 'handleTouchMoveRotate' );\n\n        rotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n        rotateDelta.subVectors( rotateEnd, rotateStart );\n\n        var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n        // rotating across whole screen goes 360 degrees around\n        rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\n\n        // rotating up and down along whole screen attempts to go 360, but limited to 180\n        rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\n\n        rotateStart.copy( rotateEnd );\n\n        scope.update();\n\n    }\n\n    function handleTouchMoveDolly( event ) {\n\n        //console.log( 'handleTouchMoveDolly' );\n\n        var dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n        var dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n        var distance = Math.sqrt( dx * dx + dy * dy );\n\n        dollyEnd.set( 0, distance );\n\n        dollyDelta.subVectors( dollyEnd, dollyStart );\n\n        if ( dollyDelta.y > 0 ) {\n\n            dollyOut( getZoomScale() );\n\n        } else if ( dollyDelta.y < 0 ) {\n\n            dollyIn( getZoomScale() );\n\n        }\n\n        dollyStart.copy( dollyEnd );\n\n        scope.update();\n\n    }\n\n    function handleTouchMovePan( event ) {\n\n        //console.log( 'handleTouchMovePan' );\n\n        panEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n        panDelta.subVectors( panEnd, panStart );\n\n        pan( panDelta.x, panDelta.y );\n\n        panStart.copy( panEnd );\n\n        scope.update();\n\n    }\n\n    function handleTouchEnd( event ) {\n\n        //console.log( 'handleTouchEnd' );\n\n    }\n\n    //\n    // event handlers - FSM: listen for events and reset state\n    //\n\n    function onMouseDown( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        event.preventDefault();\n\n        switch ( event.button ) {\n\n            case scope.mouseButtons.ORBIT:\n\n                if ( scope.enableRotate === false ) return;\n\n                handleMouseDownRotate( event );\n\n                state = STATE.ROTATE;\n\n                break;\n\n            case scope.mouseButtons.ZOOM:\n\n                if ( scope.enableZoom === false ) return;\n\n                handleMouseDownDolly( event );\n\n                state = STATE.DOLLY;\n\n                break;\n\n            case scope.mouseButtons.PAN:\n\n                if ( scope.enablePan === false ) return;\n\n                handleMouseDownPan( event );\n\n                state = STATE.PAN;\n\n                break;\n\n        }\n\n        if ( state !== STATE.NONE ) {\n\n            document.addEventListener( 'mousemove', onMouseMove, false );\n            document.addEventListener( 'mouseup', onMouseUp, false );\n\n            scope.dispatchEvent( startEvent );\n\n        }\n\n    }\n\n    function onMouseMove( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        event.preventDefault();\n\n        switch ( state ) {\n\n            case STATE.ROTATE:\n\n                if ( scope.enableRotate === false ) return;\n\n                handleMouseMoveRotate( event );\n\n                break;\n\n            case STATE.DOLLY:\n\n                if ( scope.enableZoom === false ) return;\n\n                handleMouseMoveDolly( event );\n\n                break;\n\n            case STATE.PAN:\n\n                if ( scope.enablePan === false ) return;\n\n                handleMouseMovePan( event );\n\n                break;\n\n        }\n\n    }\n\n    function onMouseUp( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        handleMouseUp( event );\n\n        document.removeEventListener( 'mousemove', onMouseMove, false );\n        document.removeEventListener( 'mouseup', onMouseUp, false );\n\n        scope.dispatchEvent( endEvent );\n\n        state = STATE.NONE;\n\n    }\n\n    function onMouseWheel( event ) {\n\n        if ( scope.enabled === false || scope.enableZoom === false || ( state !== STATE.NONE && state !== STATE.ROTATE ) ) return;\n\n        event.preventDefault();\n        event.stopPropagation();\n\n        handleMouseWheel( event );\n\n        scope.dispatchEvent( startEvent ); // not sure why these are here...\n        scope.dispatchEvent( endEvent );\n\n    }\n\n    function onKeyDown( event ) {\n\n        if ( scope.enabled === false || scope.enableKeys === false || scope.enablePan === false ) return;\n\n        handleKeyDown( event );\n\n    }\n\n    function onTouchStart( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        switch ( event.touches.length ) {\n\n            case 1:\t// one-fingered touch: rotate\n\n                if ( scope.enableRotate === false ) return;\n\n                handleTouchStartRotate( event );\n\n                state = STATE.TOUCH_ROTATE;\n\n                break;\n\n            case 2:\t// two-fingered touch: dolly\n\n                if ( scope.enableZoom === false ) return;\n\n                handleTouchStartDolly( event );\n\n                state = STATE.TOUCH_DOLLY;\n\n                break;\n\n            case 3: // three-fingered touch: pan\n\n                if ( scope.enablePan === false ) return;\n\n                handleTouchStartPan( event );\n\n                state = STATE.TOUCH_PAN;\n\n                break;\n\n            default:\n\n                state = STATE.NONE;\n\n        }\n\n        if ( state !== STATE.NONE ) {\n\n            scope.dispatchEvent( startEvent );\n\n        }\n\n    }\n\n    function onTouchMove( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        event.preventDefault();\n        event.stopPropagation();\n\n        switch ( event.touches.length ) {\n\n            case 1: // one-fingered touch: rotate\n\n                if ( scope.enableRotate === false ) return;\n                if ( state !== STATE.TOUCH_ROTATE ) return; // is this needed?...\n\n                handleTouchMoveRotate( event );\n\n                break;\n\n            case 2: // two-fingered touch: dolly\n\n                if ( scope.enableZoom === false ) return;\n                if ( state !== STATE.TOUCH_DOLLY ) return; // is this needed?...\n\n                handleTouchMoveDolly( event );\n\n                break;\n\n            case 3: // three-fingered touch: pan\n\n                if ( scope.enablePan === false ) return;\n                if ( state !== STATE.TOUCH_PAN ) return; // is this needed?...\n\n                handleTouchMovePan( event );\n\n                break;\n\n            default:\n\n                state = STATE.NONE;\n\n        }\n\n    }\n\n    function onTouchEnd( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        handleTouchEnd( event );\n\n        scope.dispatchEvent( endEvent );\n\n        state = STATE.NONE;\n\n    }\n\n    function onContextMenu( event ) {\n\n        if ( scope.enabled === false ) return;\n\n        event.preventDefault();\n\n    }\n\n    //\n\n    scope.domElement.addEventListener( 'contextmenu', onContextMenu, false );\n\n    scope.domElement.addEventListener( 'mousedown', onMouseDown, false );\n    scope.domElement.addEventListener( 'wheel', onMouseWheel, false );\n\n    scope.domElement.addEventListener( 'touchstart', onTouchStart, false );\n    scope.domElement.addEventListener( 'touchend', onTouchEnd, false );\n    scope.domElement.addEventListener( 'touchmove', onTouchMove, false );\n\n    // window.addEventListener( 'keydown', onKeyDown, false );\n\n    // force an update at start\n\n    this.update();\n\n};\n\nOrbitControls.prototype = Object.create( THREE.EventDispatcher.prototype );\nOrbitControls.prototype.constructor = THREE.OrbitControls;\n\nObject.defineProperties( OrbitControls.prototype, {\n\n    center: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .center has been renamed to .target' );\n            return this.target;\n\n        }\n\n    },\n\n    // backward compatibility\n\n    noZoom: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.' );\n            return ! this.enableZoom;\n\n        },\n\n        set: function ( value ) {\n\n            console.warn( 'THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.' );\n            this.enableZoom = ! value;\n\n        }\n\n    },\n\n    noRotate: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.' );\n            return ! this.enableRotate;\n\n        },\n\n        set: function ( value ) {\n\n            console.warn( 'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.' );\n            this.enableRotate = ! value;\n\n        }\n\n    },\n\n    noPan: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.' );\n            return ! this.enablePan;\n\n        },\n\n        set: function ( value ) {\n\n            console.warn( 'THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.' );\n            this.enablePan = ! value;\n\n        }\n\n    },\n\n    noKeys: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.' );\n            return ! this.enableKeys;\n\n        },\n\n        set: function ( value ) {\n\n            console.warn( 'THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.' );\n            this.enableKeys = ! value;\n\n        }\n\n    },\n\n    staticMoving: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.' );\n            return ! this.enableDamping;\n\n        },\n\n        set: function ( value ) {\n\n            console.warn( 'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.' );\n            this.enableDamping = ! value;\n\n        }\n\n    },\n\n    dynamicDampingFactor: {\n\n        get: function () {\n\n            console.warn( 'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );\n            return this.dampingFactor;\n\n        },\n\n        set: function ( value ) {\n\n            console.warn( 'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );\n            this.dampingFactor = value;\n\n        }\n\n    }\n\n} );\n\n\nexport default OrbitControls","import * as THREE from 'three'\nimport React, {Component} from \"react\"\nimport GLTFLoader from './GLTFLoader'\nimport DRACOLoader from './DRACOLoader'\nimport SkeletonUtils from './SkeletonUtils'\nimport OrbitControls from './OrbitControls'\n\nexport default class GLTFAssetView extends Component {\n    componentDidMount() {\n        this.initThreeJS()\n    }\n    componentWillReceiveProps(nextProps, nextContext) {\n        if(this.props.asset && nextProps.asset.id !== this.props.asset.id) {\n            this.swapModel(nextProps.asset)\n        }\n    }\n\n    swapModel(asset) {\n        if(this.model) {\n            this.scene.remove(this.model)\n        }\n\n\n        const url = this.props.provider.assetsManager.getAssetURL(asset)\n\n        this.props.provider.getLogger().log(\"GLTFAssetView loading the url\",url)\n        if(!url) {\n            this.props.provider.getLogger().error(\"GLTFAssetView url is empty!\")\n            return\n        }\n\n\n        const loader = new GLTFLoader()\n        loader.setCrossOrigin('anonymous');\n        const draco = new DRACOLoader()\n        DRACOLoader.setDecoderPath( './draco/' );\n        loader.setDRACOLoader( draco );\n\n        loader.load(url, (gltf)=> {\n            console.log(\"loaded\", url)\n\n            let model = gltf.scene || gltf.scenes[0]\n\n            // clone it, in case the loader is returning the same cached version?\n            this.model = SkeletonUtils.clone( model  );\n            model = this.model\n            model.updateMatrixWorld();\n\n            let clips = gltf.animations || [];\n            this.setClips(clips)\n\n            let boundingBox = new THREE.Box3().setFromObject(model);\n            let boundingBoxSize = boundingBox.getSize(new THREE.Vector3()).length();\n            let BoundingBoxCenter = boundingBox.getCenter(new THREE.Vector3());\n\n            this.controls.reset();\n\n            // this.setClips(node.userData)\n            model.position.x += model.position.x -BoundingBoxCenter.x\n            model.position.y += model.position.y -BoundingBoxCenter.y\n            model.position.z += model.position.z -BoundingBoxCenter.z\n\n            this.controls.maxDistance = boundingBoxSize * 10;\n            this.camera.near = boundingBoxSize / 100;\n            this.camera.far = boundingBoxSize * 100;\n            this.camera.updateProjectionMatrix();\n\n            this.camera.position.copy(BoundingBoxCenter);\n            this.camera.position.x += boundingBoxSize / 2.0;\n            this.camera.position.y += boundingBoxSize / 5.0;\n            this.camera.position.z += boundingBoxSize / 2.0;\n            this.camera.lookAt(BoundingBoxCenter);\n\n            this.controls.enabled = true;\n            this.playAllClips()\n            this.scene.add(model)\n        })\n\n    }\n\n    render() {\n        return <div id={\"gltf-viewer\"} ref={c => this.sceneContainer = c}/>\n    }\n    initThreeJS() {\n        this.scene = new THREE.Scene();\n        this.scene.background = new THREE.Color( 0x000000 );\n        this.camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 0.1, 1000 );\n        this.scene.add(this.camera)\n        this.renderer = new THREE.WebGLRenderer( { antialias: true } );\n        this.renderer.setPixelRatio( window.devicePixelRatio );\n        this.renderer.setSize( window.innerWidth, window.innerHeight );\n        this.renderer.gammaOutput = true\n        this.sceneContainer.appendChild( this.renderer.domElement );\n        this.clips = []\n        this.mixer = null\n        this.model = null\n\n        this.controls = new OrbitControls( this.camera, this.renderer.domElement );\n        this.controls.screenSpacePanning = true;\n\n        this.renderer.setAnimationLoop(this.renderThree)\n\n        const light = new THREE.DirectionalLight( 0xffffff, 1.0 );\n        light.position.set( 1, 1, 1 ).normalize();\n        this.scene.add( light );\n        this.scene.add(new THREE.AmbientLight(0xffffff,0.2))\n        //console.log(\"rendering the asset\",asset)\n\n        this.swapModel(this.props.asset)\n    }\n\n    playAllClips () {\n        this.clips.forEach((clip) => {\n          this.mixer.clipAction(clip).reset().play();\n        });\n    }\n    \n    setClips ( clips ) {\n        if (this.mixer) {\n          this.mixer.stopAllAction();\n          this.mixer.uncacheRoot(this.mixer.getRoot());\n          this.mixer = null;\n        }\n    \n        clips.forEach((clip) => {\n          if (clip.validate()) clip.optimize();\n        });\n    \n        if (!clips.length) return;\n        this.clips = clips\n        this.mixer = new THREE.AnimationMixer( this.model );\n    }\n\n    checkAspectRatio() {\n        if(!this.renderer\n            || !this.renderer.domElement\n            || !this.sceneContainer\n        ) return\n        const w = this.sceneContainer.clientWidth\n        const h = this.sceneContainer.clientHeight\n        const aspect = w/h\n        if(Math.abs(this.camera.aspect - aspect) > 0.001 ) {\n            this.camera.aspect = aspect\n            this.camera.updateProjectionMatrix()\n            this.renderer.setSize(w-4,h-4)\n        }\n    }\n\n    renderThree = (time) => {\n        const dt = (time - this.prevTime) / 1000;\n        this.checkAspectRatio()\n\n        this.controls.update();\n        this.mixer && this.mixer.update(dt);\n\n        this.renderer.render( this.scene, this.camera );\n        this.prevTime = time;\n\n    }\n\n}\n","import React, {Component} from \"react\"\nimport {map, tileLayer, marker, Icon, divIcon, latLng} from \"leaflet/dist/leaflet-src.esm\"\nimport \"leaflet/dist/leaflet.css\"\nimport {TREE_ITEM_PROVIDER} from '../TreeItemProvider'\nimport {HBox} from 'appy-comps'\n\nexport default class GeoAssetView extends Component {\n\n\n    constructor(props, context) {\n        super(props, context)\n        this.updateLocation = (e) => {\n            const obj = this.props.provider.accessObject(this.props.asset.id)\n            const ll = latLng({\n                lat: obj.latitude,\n                lon: obj.longitude\n            })\n            this.marker.setLatLng(ll)\n            this.mymap.panTo(ll)\n        }\n    }\n\n    loadCurrentLocation = () => {\n        navigator.geolocation.getCurrentPosition((success)=>{\n            console.log(\"success\",success)\n            const coords = success.coords\n            this.props.provider.quick_setPropertyValue(this.props.asset.id,'latitude',coords.latitude)\n            this.props.provider.quick_setPropertyValue(this.props.asset.id,'longitude',coords.longitude)\n        },(error)=>{\n            console.log(\"error\",error)\n        })\n    }\n\n    onMapClick = (e) => {\n        this.props.provider.quick_setPropertyValue(this.props.asset.id,'latitude',e.latlng.lat)\n        this.props.provider.quick_setPropertyValue(this.props.asset.id,'longitude',e.latlng.lng)\n    }\n\n    render() {\n        const style = {\n            width: '400px',\n            height: '400px',\n            border: '1px solid black',\n        }\n        return <div>\n            <HBox>\n                <button onClick={this.loadCurrentLocation}>set to current location</button>\n            </HBox>\n            <div id=\"mapid\" ref={d => this.div = d} style={style}></div>\n        </div>\n    }\n\n    componentWillReceiveProps(nextProps, nextContext) {\n        if(nextProps.asset.id !== this.props.asset.id) {\n            this.updateLocation()\n        }\n    }\n\n    componentDidMount() {\n        this.mymap = map('mapid').setView([this.props.asset.longitude, this.props.asset.latitude], 18);\n        tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {\n            maxZoom: 18,\n            attribution: 'Map data &copy; <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors, ' +\n                '<a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, ' +\n                'Imagery  <a href=\"https://www.mapbox.com/\">Mapbox</a>',\n            id: 'mapbox.streets'\n        }).addTo(this.mymap);\n        this.mymap.on('click',this.onMapClick)\n\n        const customIcon = divIcon({className:'map-icon'})\n        this.marker = marker([this.props.asset.longitude, this.props.asset.latitude],{\n            title:'this is the geo location',\n            icon: customIcon\n        }).addTo(this.mymap)\n\n        this.props.provider.on(TREE_ITEM_PROVIDER.PROPERTY_CHANGED, this.updateLocation)\n        this.updateLocation()\n    }\n    componentWillUnmount() {\n        this.props.provider.off(TREE_ITEM_PROVIDER.PROPERTY_CHANGED, this.updateLocation)\n    }\n}\n\n\n\n","import React, {Component} from \"react\"\nimport {fetchGraphObject} from '../syncgraph/utils'\nimport {ASSET_TYPES} from '../vr/Common'\nimport GLTFAssetView from '../vr/GLTFAssetView'\nimport GeoAssetView from '../vr/GeoAssetView'\n\nexport default class AssetView extends Component {\n    render() {\n        const prov = this.props.provider\n        const asset = fetchGraphObject(prov.getDataGraph(),this.props.asset)\n        return <div id={\"asset-view\"}>\n            <h3>{asset.subtype} : <b>{asset.title}</b></h3>\n            {this.renderAsset(asset)}\n        </div>\n    }\n\n    renderAsset(asset) {\n        const url = this.props.provider.assetsManager.getAssetURL(asset)\n        if(asset.subtype === ASSET_TYPES.IMAGE) return <img src={url} alt={asset.title}/>\n        if(asset.subtype === ASSET_TYPES.AUDIO) return <audio src={url} controls/>\n        // added playsinline so video shows in editor on ipad \n        if(asset.subtype === ASSET_TYPES.VIDEO) return <video src={url} controls playsInline crossOrigin=\"anonymous\"/>\n        if(asset.subtype === ASSET_TYPES.BEHAVIOR) return <div>{url}</div>\n        if(asset.subtype === ASSET_TYPES.GLTF) return <GLTFAssetView asset={asset} provider={this.props.provider}/>\n        if(asset.subtype === ASSET_TYPES.GEOLOCATION) return <GeoAssetView asset={asset} provider={this.props.provider}/>\n        return <div>unknown type</div>\n    }\n}\n","import * as ToasterManager from './ToasterManager'\nimport {getAssetsURL} from '../TreeItemProvider'\nimport {ASSET_TYPES, MIME_TYPES, TOTAL_OBJ_TYPES} from './Common'\nimport {fetchGraphObject} from '../syncgraph/utils'\nimport {AuthModule} from './AuthModule'\n\nexport function addImageAssetFromExpandedURL(assetId, url,format,title, prov) {\n    if(!AuthModule.supportsAssetUpload()) assetId = title\n\n    const asset = prov.accessObject(prov.getDataGraph().createObject({\n        type:TOTAL_OBJ_TYPES.ASSET,\n        subtype:ASSET_TYPES.IMAGE,\n        assetId:assetId,\n        format:format,\n        src:url,\n        width:100,\n        height:100,\n        title:title,\n        parent:0\n    }))\n    prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n    prov.requestImageCache(prov.assetsManager.getAssetURL(asset)).then(img => {\n        asset.set('width',img.width)\n        asset.set('height',img.height)\n    })\n}\n\nexport function addGeoAnchorAsset(info,title,prov) {\n    const asset = prov.accessObject(prov.getDataGraph().createObject({\n        type:TOTAL_OBJ_TYPES.ASSET,\n        subtype:ASSET_TYPES.GEOLOCATION,\n        title:title,\n        latitude:info.latitude,\n        longitude:info.longitude,\n        altitude:info.altitude,\n        useAltitude:info.useAltitude,\n        parent:0\n    }))\n    prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n}\n\nexport function addImageAssetFromFile (file, prov) {\n    ToasterManager.add('uploading ' + file.name)\n    AuthModule.uploadFile(file).then((ans)=>{\n        ToasterManager.add('uploaded')\n        if(ans.success === false) return console.log(\"there was an error uploading! :(\")\n        return addImageAssetFromExpandedURL(null,getAssetsURL()+ans.asset.id, ans.asset.mimeType, file.name, prov)\n    })\n}\nexport function addImageAssetFromURL  (url, prov) {\n    //TODO: make this format detection code more robust\n    const name = url.substring(url.lastIndexOf('/') + 1)\n    const type = name.substring(name.lastIndexOf(\".\") + 1)\n    let fileType = \"image/unknown\"\n    if (type.toLowerCase() === 'png') fileType = MIME_TYPES.PNG\n    if (type.toLowerCase() === 'jpg') fileType = MIME_TYPES.JPEG\n    if (type.toLowerCase() === 'jpeg') fileType = MIME_TYPES.JPEG\n    return addImageAssetFromExpandedURL(null,url, fileType, name, prov)\n}\nexport function addGLBAssetFromFile (file, prov) {\n    ToasterManager.add('uploading '+ file.name)\n    prov.uploadFile(file).then((ans)=>{\n        ToasterManager.add('uploaded')\n        if(ans.success === false) return console.log(\"there was an error uploading! :(\")\n        const url = getAssetsURL()+ans.asset.id\n        const graph = prov.getDataGraph()\n        const asset = fetchGraphObject(graph,graph.createObject({\n            type:TOTAL_OBJ_TYPES.ASSET,\n            subtype:ASSET_TYPES.GLTF,\n            format:MIME_TYPES.GLB,\n            src:url,\n            title:file.name,\n            parent:0\n        }))\n        prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n    })\n}\n\nexport function addAudioAssetFromFile (file, prov) {\n    ToasterManager.add('uploading')\n    prov.uploadFile(file).then((ans)=>{\n        ToasterManager.add('uploaded')\n        console.log(\"uploaded file with answer\",ans)\n        if(ans.success === false) return console.log(\"there was an error uploading! :(\")\n        const url = getAssetsURL()+ans.asset.id\n        const graph = prov.getDataGraph()\n        const asset = fetchGraphObject(graph,graph.createObject({\n            type:TOTAL_OBJ_TYPES.ASSET,\n            subtype:ASSET_TYPES.AUDIO,\n            format:ans.asset.mimeType,\n            src:url,\n            title:file.name,\n            parent:0\n        }))\n        prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n    })\n}\nexport function addAudioAssetFromURL (assetId, url, fileType, name, prov) {\n    //TODO: make this format detection code more robust\n    if(!name) {\n        name = url.substring(url.lastIndexOf('/') + 1)\n    }\n    if(!fileType) {\n        const type = name.substring(name.lastIndexOf(\".\") + 1)\n        fileType = \"audio/unknown\"\n        if(type.toLowerCase() === 'mp3') fileType = MIME_TYPES.MP3\n        if(type.toLowerCase() === 'aac') fileType = MIME_TYPES.AAC\n    }\n    if(!AuthModule.supportsAssetUpload()) assetId = name\n\n    const graph = prov.getDataGraph()\n    const asset = fetchGraphObject(graph,graph.createObject({\n        type: TOTAL_OBJ_TYPES.ASSET,\n        subtype:ASSET_TYPES.AUDIO,\n        assetId:assetId,\n        format:fileType,\n        src:url,\n        title:name,\n        parent:0\n    }))\n    prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n}\n\nexport function addVideoAssetFromURL (assetId, url, fileType, title, prov) {\n    if(!title) title = url.substring(url.lastIndexOf('/') + 1)\n    if(!AuthModule.supportsAssetUpload()) assetId = title\n    const asset = prov.accessObject(prov.getDataGraph().createObject({\n        type: TOTAL_OBJ_TYPES.ASSET,\n        subtype:ASSET_TYPES.VIDEO,\n        assetId:assetId,\n        format:fileType,\n        src:url,\n        title:title,\n        parent:0\n    }))\n    prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n}\n\n\nexport function addGLBAssetFromURL(assetId, url, fileType, title, prov) {\n    if(!title) title = url.substring(url.lastIndexOf('/') + 1)\n    if(!AuthModule.supportsAssetUpload()) assetId = title\n    const asset = prov.accessObject(prov.getDataGraph().createObject({\n        type: TOTAL_OBJ_TYPES.ASSET,\n        subtype:ASSET_TYPES.GLTF,\n        assetId:assetId,\n        format:fileType,\n        src:url,\n        title:title,\n        parent:0\n    }))\n    prov.accessObject(prov.getAssetsObject()).insertChildLast(asset)\n}","import React, {Component} from 'react'\nimport {DialogManager, HBox, VBox} from 'appy-comps'\nimport {listToArray} from '../../syncgraph/utils'\nimport {ToggleButton, Toolbar} from '../../common/GridEditorApp'\nimport {addImageAssetFromFile, addImageAssetFromURL} from '../AssetActions'\nimport {Dialog} from '../../common/Dialog'\n\nexport class AddImageAssetDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            view:'local',\n            url:\"\",\n        }\n        this.fileInput = React.createRef();\n    }\n\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        if(this.state.view === 'remote') {\n            console.log(\"adding the url\",this.state.url)\n            addImageAssetFromURL(this.state.url, this.props.provider)\n        } else {\n            console.log(\"the file input is\",this.fileInput)\n            listToArray(this.fileInput.current.files).forEach(file => {\n                addImageAssetFromFile(file, this.props.provider)\n            })\n        }\n    }\n    switchLocal = () => this.setState({view:'local'})\n    switchRemote = () => this.setState({view:'remote'})\n\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n            <VBox grow>\n                <h3>add image to assets</h3>\n                <VBox grow>\n                    <Toolbar>\n                        <ToggleButton onClick={this.switchLocal} selected={this.state.view==='local'}>local</ToggleButton>\n                        <ToggleButton onClick={this.switchRemote} selected={this.state.view==='remote'}>remote</ToggleButton>\n                    </Toolbar>\n                    {this.renderSelectedPanel()}\n                </VBox>\n                <HBox>\n                    <button onClick={this.cancel}>cancel</button>\n                    <button onClick={this.okay}>okay</button>\n                </HBox>\n            </VBox>\n        </Dialog>\n    }\n\n    selectedFile = (e) => {\n        this.setState({fileInput:e.target.value})\n    }\n\n    typedURL = (e) => {\n        this.setState({url:e.target.value})\n    }\n\n    renderSelectedPanel() {\n        if(this.state.view === 'local') {\n            return <HBox>\n                <label>File\n                    <input key=\"f1\" type=\"file\" onChange={this.selectedFile} ref={this.fileInput}/>\n                </label>\n            </HBox>\n        } else {\n            return <HBox>\n                <label>URL\n                    <input key=\"f2\" value={this.state.url} type=\"input\" onChange={this.typedURL}/>\n                </label>\n            </HBox>\n        }\n    }\n}\n","import React, {Component} from 'react'\nimport {DEFAULT_DPI, UNITS} from './Dimension'\nimport {fetchGraphObject, propToArray} from '../syncgraph/utils'\nimport SelectionManager from '../SelectionManager'\n\nexport class PageCanvasView extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            scale: 1.0,\n        }\n    }\n\n    componentDidMount() {\n        this.canvas.focus()\n        this.redraw()\n    }\n\n    componentDidUpdate(prevProps) {\n        this.redraw()\n    }\n\n    redraw = () => {\n        if (!this.canvas) return\n        const c = this.canvas.getContext('2d')\n        const size = this.props.provider.getPageSize(this.props.page).as(UNITS.PIXEL, 1, DEFAULT_DPI)\n        this.canvas.width = size.width\n        this.canvas.height = size.height\n        c.fillStyle = 'white'\n        c.fillRect(0, 0, this.canvas.width, this.canvas.height)\n        c.save()\n        c.scale(this.state.scale, this.state.scale)\n        const graph = this.props.provider.getRawGraph()\n        const page = this.props.page\n        if (page) this.drawPage(c, graph, page)\n        c.restore()\n    }\n\n    drawPage(c, g, page) {\n        propToArray(g, page.children).forEach(id => this.drawLayer(c, g, fetchGraphObject(g, id)))\n    }\n\n    drawLayer(c, g, layer) {\n        propToArray(g, layer.children).forEach(id => this.drawShape(c, g, fetchGraphObject(g, id)))\n    }\n\n    drawShape(c, g, shape) {\n        const def = this.props.provider.getShapeDef(shape.type)\n        if (def) def.draw(c, g, shape, SelectionManager.getSelection() === shape.id, this.props.provider)\n    }\n\n    render() {\n        return <canvas\n            tabIndex={-1}\n            width={100} height={100} ref={(e) => this.canvas = e}\n            style={{\n                width: '100vw',\n            }}\n            onClick={this.props.onNext}\n            onKeyDown={this.handleKeypress}\n        ></canvas>\n    }\n\n    handleKeypress = (e) => {\n        if (e.key === 'ArrowRight') this.props.onNext()\n        if (e.key === 'ArrowLeft') this.props.onPrev()\n    }\n}","import React, {Component} from 'react'\nimport {TREE_ITEM_PROVIDER} from '../TreeItemProvider'\nimport {PageCanvasView} from './PageCanvasView'\n\n\nexport default class PresentationApp extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            pageIndex:-1\n        }\n    }\n\n    componentDidMount() {\n        this.props.provider.on(TREE_ITEM_PROVIDER.DOCUMENT_SWAPPED, this.docSwapped)\n    }\n\n    docSwapped = () => this.setState({pageIndex:0})\n\n    getPages() {\n        const provider = this.props.provider\n        const root = provider.accessObject(provider.getSceneRoot())\n        return root.array('children').map(ch => provider.accessObject(ch) ).filter(ch => ch.type === 'page')\n    }\n\n    render() {\n        const provider = this.props.provider\n        const pages = this.getPages()\n        if(this.state.pageIndex < 0) return <div>no pages loaded</div>\n        const page = pages[this.state.pageIndex]\n        return <PageCanvasView page={page} provider={provider} onNext={this.onNext} onPrev={this.onPrev}/>\n    }\n\n    onNext = () => {\n        const pages = this.getPages()\n        if(this.state.pageIndex === pages.length-1) this.state.pageIndex = -1\n        this.setState({pageIndex:this.state.pageIndex+1})\n    }\n\n    onPrev = () => {\n        const pages = this.getPages()\n        if(this.state.pageIndex === 0) this.state.pageIndex = pages.length\n        this.setState({pageIndex:this.state.pageIndex-1})\n    }\n}\n\n","function cloneObjectDeep(shapeid, graph, newParent) {\n    const id = shapeid\n    const id2 = graph.createObject()\n    const props = graph.getPropertiesForObject(id)\n    props.forEach(key => {\n        if(key === 'children') {\n            const children = graph.getPropertyValue(id, key)\n            const children2 = cloneArrayDeep(children, graph, id2)\n            graph.createProperty(id2, key, children2)\n        } else {\n            let value = graph.getPropertyValue(id, key)\n            if(key === 'parent') value = newParent\n            graph.createProperty(id2, key, value)\n        }\n    })\n    return id2\n}\n\nfunction cloneArrayDeep(arr,graph,newParent) {\n    const arr2 = graph.createArray()\n    const len = graph.getArrayLength(arr)\n    for (let i = 0; i < len; i++) {\n        const ch = graph.getElementAt(arr,i)\n        const ch2 = cloneObjectDeep(ch,graph,newParent)\n        graph.insertElement(arr2,i,ch2)\n    }\n    return arr2\n}\n\nexport default class GraphAccessor {\n    constructor(graph) {\n        this.graph = graph\n    }\n    object(id) {\n        if(id && id.id && id.exists && id.exists()) {\n            console.log(\"someone created a graphaccessor on an existing object\")\n            return id\n        }\n        if(this.graph.hasObject(id)) {\n            const obj = {}\n            this.graph.getPropertiesForObject(id).forEach(key => {\n                obj[key] = this.graph.getPropertyValue(id, key)\n            })\n            obj.id = id\n            obj.exists = function() { return true }\n            obj.set = (key, value) => {\n                this.graph.setProperty(id,key,value)\n                return obj\n            }\n            obj.props = () => {\n                const o = {}\n                this.graph.getPropertiesForObject(id).forEach(key => {\n                    o[key] = this.graph.getPropertyValue(id, key)\n                })\n                return o\n            }\n            obj.array = (key) => {\n                // console.log(\"looking at key\",key)\n                // console.log(\"self is\",obj)\n                const CH = obj[key]\n                // console.log(\"children id is\",CH)\n                const len = this.graph.getArrayLength(CH)\n                const ch = []\n                for (let i = 0; i < len; i++) {\n                    ch.push(this.graph.getElementAt(CH, i))\n                }\n                return ch\n            }\n            obj.getChildren = () => {\n                if(obj.children) return obj.array('children').map(id => this.object(id))\n                return []\n            }\n            obj.insertChildLast = (child) => {\n                this.graph.setProperty(child.id,'parent',obj.id)\n                const CH = this.graph.getPropertyValue(obj.id,'children')\n                const len = this.graph.getArrayLength(CH)\n                const prev = this.graph.getElementAt(CH,len-1)\n                this.graph.insertAfter(CH,prev,child.id)\n            }\n            obj.insertFirstChild = (child) => {\n                this.graph.setProperty(child.id,'parent',obj.id)\n                const ch = this.graph.getPropertyValue(obj.id,'children')\n                this.graph.insertAfter(ch,null,child.id)\n            }\n            obj.child = (index) => this.object(obj.array('children')[index])\n            obj.removeFromParent = () => {\n                const parent = this.object(obj.parent)\n                const n = parent.array('children').findIndex(ch => ch === obj.id)\n                // const n = indexOf(graph, parent.children, obj.id)\n                if (n >= 0) {\n                    this.graph.removeElement(parent.children, n)\n                } else {\n                    console.error(\"could not find index for child\", obj, 'in children', parent.children)\n                }\n            }\n            obj.getParent = () => {\n                return this.object(obj.parent)\n            }\n            obj.clone = () => {\n                const id2 = cloneObjectDeep(obj.id,this.graph,obj.parent)\n                return this.object(id2)\n            }\n            obj.find = (match,list) => {\n                if(!list) list = []\n                if(match(obj)) list.push(obj)\n                if(obj.children) obj.getChildren().forEach(ch => {\n                    ch.find(match,list)\n                })\n                return list\n            }\n            return obj\n        } else {\n            return {\n                exists: function() { return false }\n            }\n        }\n    }\n}\n","import React, {Component} from 'react'\nimport GridEditorApp, {MenuPopup, Panel, Spacer, Toolbar} from '../common/GridEditorApp'\nimport PropSheet from '../common/PropSheet'\nimport TreeTable from '../common/TreeTable'\nimport SelectionManager, {SELECTION_MANAGER} from '../SelectionManager'\nimport {MetadocCanvas} from \"./MetadocCanvas\";\nimport SyncGraphProvider from '../syncgraph/SyncGraphProvider'\nimport {\n    cloneShape,\n    createGraphObjectFromObject,\n    fetchGraphObject,\n    insertAsFirstChild, insertAsLastChild, listToArray,\n    propToArray,\n    removeFromParent\n} from \"../syncgraph/utils\";\nimport {DialogManager, HBox, PopupManager} from \"appy-comps\";\nimport InputManager from \"../common/InputManager\";\nimport {getAssetsURL, TREE_ITEM_PROVIDER} from '../TreeItemProvider'\nimport {\n    HORIZONTAL_ALIGNMENT,\n    ICONS,\n    isShapeType,\n    PROP_DEFS,\n    SHAPE_DEFS,\n    STANDARD_FONTS,\n    VERTICAL_ALIGNMENT\n} from \"./Common\";\nimport AssetView from './AssetView'\nimport {AddImageAssetDialog} from '../vr/dialogs/AddImageAssetDialog'\nimport {DEFAULT_DPI, parseDimension, UNITS} from \"./Dimension\"\nimport {EnumEditor} from \"../common/EnumEditor\";\nimport PresentationApp from './PresentationApp'\nimport GraphAccessor from '../syncgraph/GraphAccessor'\n\n\nconst EnumTitleRenderer = (props) => {\n    let value = \"---\"\n    if(props.value && props.provider) {\n        const graph = props.provider.getDataGraph()\n        value = graph.getPropertyValue(props.value,'title')\n    }\n    return <b>{value}</b>\n}\n\nconst STANDARD_PAGE_SIZES = [\n    {\n        name:\"1024 x 768 pixels\",\n        value:'1024x768px',\n    },\n    {\n        name:\"VGA (640x480)\",\n        value:\"640x480px\"\n    },\n    {\n        name:\"A4 paper\",\n        value:\"210x297mm\"\n    },\n    {\n        name:\"16:9\",\n        value:\"300x169mm\"\n    },\n    {\n        name:\"4:3\",\n        value:\"225x169mm\"\n    },\n]\nconst PageSizeRenderer = (props) => {\n    let value = \"---\"\n    if(props.value && props.provider) {\n        const size = STANDARD_PAGE_SIZES.find(s => s.value === props.value)\n        if(size) {\n            value = size.name\n        } else {\n            value = props.value\n        }\n    }\n    return <b>{value}</b>\n}\n\nexport default class MetadocEditor extends  SyncGraphProvider {\n    constructor(options) {\n        super(options)\n        this.imagecache = {}\n    }\n    getDocType() { return \"metadoc\" }\n    getApp = () => {\n        if(this.mode === 'view') return <PresentationApp provider={this}/>\n        return <MetadocApp provider={this}/>\n    }\n    getTitle = () => \"MetaDoc\"\n\n    makeEmptyRoot(doc) {\n        //create root and children\n        const root = fetchGraphObject(doc,doc.createObject({ type:'root', title:'root', pageSize:'640 x 480 px', children: doc.createArray(), parent:0}))\n        //create page and children\n        const page = fetchGraphObject(doc,doc.createObject({ type:'page', title:'page 1', children: doc.createArray(),parent:0}))\n        //create layer and children\n        const layer = fetchGraphObject(doc,doc.createObject({type:'layer',title:'layer 1', children: doc.createArray(),parent:0}))\n        //create rect\n        const rect1 = SHAPE_DEFS.rect.make(doc,layer)\n        // create assets\n        const assets = fetchGraphObject(doc,doc.createObject({type:'assets',title:'Assets', children: doc.createArray(), parent:0}))\n        //connect it all together\n        insertAsFirstChild(doc,layer,rect1)\n        insertAsFirstChild(doc,page,layer)\n        insertAsFirstChild(doc,root,page)\n        insertAsLastChild(doc,root,assets)\n    }\n\n    getRendererForItem = (item) => {\n        if(!this.getDataGraph().getObjectById(item)) return <div>???</div>\n        const type = this.getDataGraph().getPropertyValue(item,'type')\n        const title = this.getDataGraph().getPropertyValue(item,'title')\n        if(ICONS[type]) return <div><i className={`fa fa-${ICONS[type]}`}/> {title}</div>\n        return <div>{title}</div>\n    }\n\n    setPropertyValue(item, def, value) {\n        super.setPropertyValue(item,def,value)\n        if(def.key === PROP_DEFS.asset.key) {\n            const asset = fetchGraphObject(this.getDataGraph(),value)\n            super.setPropertyValue(item,{key:'width'},asset.width)\n            super.setPropertyValue(item,{key:'height'},asset.height)\n        }\n    }\n\n\n    getProperties(item) {\n        function copyPropDef(def,value) {\n            const out = {};\n            Object.keys(def).forEach((key) => out[key] = def[key])\n            out.value = value\n            return out;\n        }\n        let defs = []\n        if(!item) return defs\n\n        const props = this.syncdoc.getPropertiesForObject(item)\n        if(props) {\n            props.forEach(key => {\n                if(key === 'type') return\n                if(key === 'children') return\n                if(key === 'parent') return\n                const value = this.syncdoc.getPropertyValue(item,key)\n                if(PROP_DEFS[key]) return defs.push(copyPropDef(PROP_DEFS[key],value))\n                console.log(\"unknown property\",key)\n            })\n        }\n\n        return defs\n    }\n\n    createCustomEditor(item,def,provider, value, onChange) {\n        if(def.key === PROP_DEFS.fillColor.key) return <HBox>\n            {\n                [\"#ffffff\",\"#ff0000\",\"#ffff00\",\"#00ff00\",\"#00ffff\",\"#0000ff\",\"#ff00ff\",\"#000000\"]\n                    .map(c => <button\n                        key={c}\n                        onClick={()=>onChange(c)}\n                        style={{color:c, padding:'1px', margin:0, borderWidth:0,}}\n                        className={\"fa fa-square\"}/> )\n            }\n        </HBox>\n        if(def.key === PROP_DEFS.pageSize.key) {\n            const obj = fetchGraphObject(this.getDataGraph(),item)\n            return <EnumEditor def={def} provider={this} obj={item} value={obj.pageSize} onChange={onChange}/>\n        }\n        return <i>no custom editor for {def.key}</i>\n    }\n\n    getValuesForEnum(key,obj) {\n        if(key === PROP_DEFS.asset.key) {\n            const children = this.getDataGraph().getPropertyValue(this.getAssetsObject(),'children')\n            return propToArray(this.getDataGraph(),children)\n        }\n        if(key === PROP_DEFS.fontFamily.key) {\n            return Object.keys(STANDARD_FONTS).map(key => STANDARD_FONTS[key])\n        }\n        if(key === PROP_DEFS.verticalAlign.key) {\n            return Object.keys(VERTICAL_ALIGNMENT).map(key => VERTICAL_ALIGNMENT[key])\n        }\n        if(key === PROP_DEFS.horizontalAlign.key) {\n            return Object.keys(HORIZONTAL_ALIGNMENT).map(key => HORIZONTAL_ALIGNMENT[key])\n        }\n        if(key === PROP_DEFS.pageSize.key) {\n            return STANDARD_PAGE_SIZES.map(s => s.value)\n        }\n    }\n    getRendererForEnum(key,obj) {\n        if(key === PROP_DEFS.asset.key) return EnumTitleRenderer\n        if(key === PROP_DEFS.pageSize.key) return PageSizeRenderer\n    }\n\n\n    getPageSize(page) {\n        const root = this.getSceneRoot()\n        const rootobj = fetchGraphObject(this.getDataGraph(),root)\n        console.log(\"parsing\",rootobj)\n        return parseDimension(rootobj.pageSize)\n    }\n\n\n\n    getShapeDef(type) {\n        return SHAPE_DEFS[type]\n    }\n    getSelectedRoot() {\n        return fetchGraphObject(this.getDataGraph(),this.getSceneRoot())\n    }\n    getSelectedPage() {\n        let sel = SelectionManager.getSelection()\n        if(!sel) return null\n        while(true) {\n            const type = this.getDataGraph().getPropertyValue(sel, 'type')\n            if(type === 'root') return null\n            if(type === 'page') return fetchGraphObject(this.getDataGraph(),sel)\n            sel = this.getDataGraph().getPropertyValue(sel,'parent')\n            if(!sel) break\n        }\n    }\n\n    getSelectedLayer() {\n        let sel = SelectionManager.getSelection()\n        if(!sel) return null\n        while(true) {\n            const type = this.getDataGraph().getPropertyValue(sel, 'type')\n            if(type === 'root') return null\n            if(type === 'layer') return fetchGraphObject(this.getDataGraph(),sel)\n            sel = this.getDataGraph().getPropertyValue(sel,'parent')\n            if(!sel) break\n        }\n        console.log(fetchGraphObject(this.getDataGraph(),sel))\n    }\n\n    getSelectedShape() {\n        let sel = SelectionManager.getSelection()\n        if(!sel) return null\n        const type = this.getDataGraph().getPropertyValue(sel, 'type')\n        if(SHAPE_DEFS[type]) return fetchGraphObject(this.getDataGraph(),sel)\n        return null\n    }\n\n    calculateContextMenu(item) {\n        const obj = fetchGraphObject(this.getDataGraph(),item)\n        if(obj.type === 'assets') {\n            return [{\n                title:'Add Image',\n                icon:'image',\n                fun:this.showAddImageAssetDialog\n            }]\n        }\n        if(obj.type === 'asset') {\n            return [{\n                title:'delete',\n                icon:'close',\n                fun: this.deleteSelectedAsset\n            }]\n        }\n        const cmds =  [\n            {\n                title:'delete',\n                icon:'close',\n                fun: this.deleteSelection\n            },\n            {\n                title:'rect',\n                icon:ICONS.rect,\n                fun: this.addRect\n            },\n            {\n                title:'circle',\n                icon:ICONS.circle,\n                fun: this.addCircle\n            },\n            {\n                title:'text',\n                icon:ICONS.text,\n                fun: this.addText\n            },\n            {\n                title:'image',\n                icon: ICONS.image,\n                fun: this.addImage\n            },\n            {\n                title:'cut',\n                icon: ICONS.cut,\n                fun:this.cutSelection\n            },\n            {\n                title:'copy',\n                icon: ICONS.copy,\n                fun:this.copySelection\n            },\n            {\n                title:'paste',\n                icon: ICONS.paste,\n                fun:this.pasteSelection\n            },\n        ]\n        return cmds\n    }\n\n    addShape = (def) => {\n        const graph = this.getDataGraph()\n        const layer = this.getSelectedLayer()\n        if(!layer) return console.error(\"no layer!\")\n        const shape = def.make(graph,layer)\n        insertAsFirstChild(graph,layer,shape)\n    }\n    addRect   = () => this.addShape(this.getShapeDef('rect'))\n    addCircle = () => this.addShape(this.getShapeDef('circle'))\n    addText   = () => this.addShape(this.getShapeDef('text'))\n    addImage   = () => this.addShape(this.getShapeDef('image'))\n\n    addImageAssetFromFile = (file) => {\n        this.uploadFile(file).then((ans)=>{\n            console.log(\"uploaded file with answer\",ans)\n            const url = getAssetsURL()+ans.id\n            const graph = this.getDataGraph()\n            const asset = fetchGraphObject(graph,graph.createObject({\n                type:'asset',\n                subtype:'image',\n                format:file.type,\n                src:url,\n                width:100,\n                height:100,\n                title:file.name,\n                parent:0\n            }))\n            const assets = fetchGraphObject(graph,this.getAssetsObject())\n            insertAsLastChild(graph,assets,asset)\n            this.requestImageCache(url).then(img => {\n                graph.setProperty(asset.id,'width',img.width)\n                graph.setProperty(asset.id,'height',img.height)\n            })\n        })\n    }\n\n    addImageAssetFromURL = (url) => {\n        //TODO: make this format detection code more robust\n        const name = url.substring(url.lastIndexOf('/')+1)\n        const type = name.substring(name.lastIndexOf(\".\")+1)\n        let fileType = \"image/unknown\"\n        if(type.toLowerCase() === 'png') fileType = 'image/png'\n        if(type.toLowerCase() === 'jpg') fileType = 'image/jpeg'\n        if(type.toLowerCase() === 'jpeg') fileType = 'image/jpeg'\n\n        const graph = this.getDataGraph()\n        const asset = fetchGraphObject(graph,graph.createObject({\n            type:'asset',\n            subtype:'image',\n            format:fileType,\n            src:url,\n            width:100,\n            height:100,\n            title:name,\n            parent:0\n        }))\n        const assets = fetchGraphObject(graph,this.getAssetsObject())\n        insertAsLastChild(graph,assets,asset)\n        this.requestImageCache(url).then(img => {\n            graph.setProperty(asset.id,'width',img.width)\n            graph.setProperty(asset.id,'height',img.height)\n        })\n    }\n    deleteSelection = () => {\n        const graph = this.getDataGraph()\n        // const layer = this.getSelectedLayer()\n        const shape = this.getSelectedShape()\n        if(!shape) return\n        removeFromParent(graph,shape)\n        SelectionManager.clearSelection()\n    }\n    deleteSelectedAsset = () => {\n        const graph = this.getDataGraph()\n        const sel = SelectionManager.getSelection()\n        const obj = fetchGraphObject(graph,sel)\n        removeFromParent(graph,obj)\n        SelectionManager.clearSelection()\n    }\n    cutSelection = () => {\n        const graph = this.getDataGraph()\n        let sel = SelectionManager.getSelection()\n        if(!sel) return\n        const obj = fetchGraphObject(graph,sel)\n        SelectionManager.setClipboard(obj.id)\n        removeFromParent(graph,obj)\n        SelectionManager.clearSelection()\n    }\n    copySelection = () => {\n        const graph = this.getDataGraph()\n        let sel = SelectionManager.getSelection()\n        if(!sel) return\n        const obj = fetchGraphObject(graph,sel)\n        SelectionManager.setClipboard(obj.id)\n    }\n    pasteSelection = (e) => {\n        if(e.target && e.target.getAttribute('type') === 'input') return console.log(\"pasting into an input field. don't intercept\")\n        const graph = this.getDataGraph()\n        const shapeid = SelectionManager.getClipboard()\n        const obj1 = fetchGraphObject(graph,shapeid)\n\n        let parent = null\n        if(isShapeType(obj1.type)) parent = this.getSelectedLayer()\n        if(obj1.type === 'layer') parent = this.getSelectedPage()\n        if(obj1.type === 'page') parent = fetchGraphObject(graph,this.getSceneRoot())\n        if (!parent) return console.error(\"no parent to ad too! bad obj type?\",obj1.type)\n\n        const obj2 = cloneShape(graph,obj1)\n        graph.setProperty(obj2.id, 'parent', parent.id)\n        insertAsFirstChild(graph, parent, obj2)\n        return\n    }\n\n    exportSVG = () => {\n        const page = this.getSelectedPage()\n\n        const svg = this.renderSVGWrapper(this.renderSVGChildren(page))\n        const link = document.createElement('a');\n        link.href = 'data:image/svg+xml,'+encodeURIComponent(svg)\n        link.download = 'test.svg'\n        document.body.appendChild(link)\n        link.click()\n    }\n    renderSVGWrapper(str) {\n        return `<svg id=\"svg-canvas\" viewBox=\"0 0 1000 1000\" \n                xmlns=\"http://www.w3.org/2000/svg\" \n                xmlnsXlink=\"http://www.w3.org/1999/xlink\">\n                ${str}</svg>`\n    }\n    renderSVGChildren(obj) {\n        if(obj.type === 'page') return propToArray(this.getDataGraph(),obj.children)\n            .map((layer) => `<g>${this.renderSVGChildren(fetchGraphObject(this.getDataGraph(),layer))}</g>`).join(\"\")\n        if(obj.type === 'layer') return propToArray(this.getDataGraph(),obj.children)\n            .map(shape => this.renderSVGChildren(fetchGraphObject(this.getDataGraph(),shape))).join(\"\")\n        if(SHAPE_DEFS[obj.type]) return SHAPE_DEFS[obj.type].toSVGString(obj,this)\n        return \"\";\n    }\n\n    exportPNG = () => {\n        const page = this.getSelectedPage()\n        const canvas = document.createElement('canvas')\n        const c = canvas.getContext('2d')\n        const g = this.getRawGraph()\n        const size = this.getPageSize(page).as(UNITS.PIXEL, 1, DEFAULT_DPI)\n        canvas.width = size.width\n        canvas.height = size.height\n        c.fillStyle = 'white'\n        c.fillRect(0, 0, canvas.width, canvas.height)\n        if(page) {\n            this.accessObject(page.id).getChildren().forEach(layer => {\n                layer.getChildren().forEach(shape => {\n                    const def = this.getShapeDef(shape.type)\n                    if (def) def.draw(c, g, shape, false, this)\n                })\n            })\n        }\n\n        const link = document.createElement('a');\n        link.href = canvas.toDataURL('image/png')\n        link.download = 'test.png'\n        document.body.appendChild(link)\n        link.click()\n    }\n\n\n    canAddChild(parent,child) {\n        const p = fetchGraphObject(this.getDataGraph(),parent)\n        const c = fetchGraphObject(this.getDataGraph(),child)\n        if(p.type === 'layer' && isShapeType(c.type)) return true\n        if(p.type === 'page' && c.type === 'layer') return true\n        if(p.type === 'root' && c.type === 'page') return true\n        return false\n    }\n    canBeSibling(src,tgt) {\n        const s = fetchGraphObject(this.getDataGraph(),src)\n        const t = fetchGraphObject(this.getDataGraph(),tgt)\n        if(s.type === 'layer' && t.type === 'layer') return true\n        if(s.type === 'page' && t.type === 'page') return true\n        if(isShapeType(s.type) && isShapeType(t.type)) return true\n        return false\n    }\n    canAddExternalChild(parent,child) {\n        const pobj = fetchGraphObject(this.getDataGraph(),parent)\n        // console.log('parent is',pobj)\n        if(pobj.type === 'assets') return true\n        return false\n    }\n    acceptDrop(e,tgt) {\n        const obj = fetchGraphObject(this.getDataGraph(),tgt)\n        if(obj.type === 'assets') {\n            listToArray(e.dataTransfer.files).forEach(file => this.addImageAssetFromFile(file))\n        }\n    }\n\n\n    newView = () => window.open( `./?mode=metadoc&doctype=${this.getDocType()}&doc=${this.getDocId()}`)\n    openPresentationView = () => window.open( `./?mode=view&doctype=${this.getDocType()}&doc=${this.getDocId()}`)\n\n\n    isImageCached(src) {\n        if(this.imagecache[src]) return this.imagecache[src].complete\n        return false\n    }\n    requestImageCache(src) {\n        const img = new Image()\n        this.imagecache[src] = img\n        return new Promise((res,rej) => {\n            img.src = src\n            img.onload = () => {\n                this.fire(TREE_ITEM_PROVIDER.STRUCTURE_CHANGED,{ provider: this })\n                res(img)\n            }\n        })\n    }\n    getCachedImage(src) {\n        return this.imagecache[src]\n    }\n\n    getAssetsObject = () => this.getDataGraph().getObjectByProperty('type','assets')\n\n    showAddImageAssetDialog = () => DialogManager.show(<AddImageAssetDialog provider={this}/>)\n\n    accessObject = (id) => {\n        return new GraphAccessor(this.getDataGraph()).object(id)\n    }\n\n}\n\n\n\nclass MetadocApp extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            connected:false,\n            zoom: 0,\n            mode:'canvas'\n        }\n\n        this.im = new InputManager()\n        this.im.addKeyBinding({ id:'save',  key:InputManager.KEYS.S, modifiers:[InputManager.MODIFIERS.COMMAND]})\n        this.im.addKeyBinding({ id:'undo', key:InputManager.KEYS.Z,  modifiers:[InputManager.MODIFIERS.COMMAND]})\n        this.im.addKeyBinding({ id:'redo', key:InputManager.KEYS.Z,  modifiers:[InputManager.MODIFIERS.COMMAND, InputManager.MODIFIERS.SHIFT]})\n        this.im.addListener('save',this.props.provider.save)\n        this.im.addListener('undo',this.props.provider.performUndo)\n        this.im.addListener('redo',this.props.provider.performRedo)\n\n        this.im.addKeyBinding({id:'cut', key:InputManager.KEYS.X, modifiers:[InputManager.MODIFIERS.COMMAND]})\n        this.im.addKeyBinding({id:'copy', key:InputManager.KEYS.C, modifiers:[InputManager.MODIFIERS.COMMAND]})\n        this.im.addKeyBinding({id:'paste', key:InputManager.KEYS.V, modifiers:[InputManager.MODIFIERS.COMMAND]})\n\n        this.im.addListener('cut',this.props.provider.cutSelection)\n        this.im.addListener('copy',this.props.provider.copySelection)\n        this.im.addListener('paste',this.props.provider.pasteSelection)\n    }\n\n    componentDidMount() {\n        this.im.attachKeyEvents(document)\n        this.props.provider.on('CONNECTED',()=> this.setState({connected: this.props.provider.isConnected()}))\n        SelectionManager.on(SELECTION_MANAGER.CHANGED,()=>{\n            const sel = SelectionManager.getSelection()\n            if(sel) {\n                const item = fetchGraphObject(this.props.provider.getDataGraph(),sel)\n                if(item.type === PROP_DEFS.asset.key) {\n                    this.setState({mode:'asset'})\n                    return\n                }\n            }\n            this.setState({mode:'canvas'})\n        })\n    }\n\n    canvasSelected = (rect) => SelectionManager.setSelection(rect)\n\n\n    showAddPopup = (e) => {\n        const acts = [\n            {\n                title: 'page',\n                icon: ICONS.page,\n                fun: () => this.addPage()\n            },\n            {\n                title: 'layer',\n                icon: ICONS.layer,\n                fun: () => this.addLayer()\n            },\n            {\n                title: 'rect',\n                icon: ICONS.rect,\n                fun: () => this.props.provider.addRect()\n            },\n            {\n                title: 'circle',\n                icon: ICONS.circle,\n                fun: () => this.props.provider.addCircle()\n            },\n            {\n                title: 'text',\n                icon: ICONS.text,\n                fun: () => this.props.provider.addText()\n            },\n            {\n                title:'image',\n                icon: ICONS.image,\n                fun: () => this.props.provider.addImage()\n            },\n        ]\n        PopupManager.show(<MenuPopup actions={acts}/>,e.target)\n    }\n    addPage = () => {\n        const graph = this.props.provider.getDataGraph()\n        const root = this.props.provider.getSelectedRoot()\n        const page = fetchGraphObject(graph,createGraphObjectFromObject(graph,{\n            type:'page',\n            title:'new page',\n            parent:root.id,\n            children: graph.createArray()\n        }))\n        insertAsFirstChild(graph,root,page)\n    }\n    addLayer = () => {\n        const graph = this.props.provider.getDataGraph()\n        const page = this.props.provider.getSelectedPage()\n        const layer = fetchGraphObject(graph,createGraphObjectFromObject(graph,{\n            type:'layer',\n            title:'new layer',\n            parent:page.id,\n            children:graph.createArray()\n        }))\n        insertAsFirstChild(graph,page,layer)\n    }\n\n    zoomIn  = () => this.setState({zoom:this.state.zoom+1})\n    zoomOut = () => this.setState({zoom:this.state.zoom-1})\n\n    render() {\n        const prov = this.props.provider\n        return <GridEditorApp>\n            <Toolbar left top><label>{prov.getTitle()}</label></Toolbar>\n            <Panel scroll left middle>\n                <TreeTable root={prov.getSceneRoot()} provider={prov}/>\n            </Panel>\n\n            <Toolbar left bottom>\n                <button className=\"fa fa-plus\" onClick={this.showAddPopup}/>\n                <button className=\"fa fa-close\" onClick={prov.deleteSelection}/>\n                <button className=\"fa fa-file-image-o\" onClick={prov.showAddImageAssetDialog}/>\n            </Toolbar>\n\n            <Toolbar center top>\n                <button className=\"fa fa-save\" onClick={prov.save}/>\n                <button className=\"fa fa-download\" onClick={prov.exportSVG}> SVG</button>\n                <button className=\"fa fa-download\" onClick={prov.exportPNG}> PNG</button>\n                <button className=\"fa fa-undo\" onClick={prov.performUndo}/>\n                <button className=\"fa fa-repeat\" onClick={prov.performRedo}/>\n                <button className=\"fa fa-search-plus\" onClick={this.zoomIn}/>\n                <button className=\"fa fa-search-minus\" onClick={this.zoomOut}/>\n                <Spacer/>\n                <button className=\"fa fa-cut\" onClick={prov.cutSelection}/>\n                <button className=\"fa fa-copy\" onClick={prov.copySelection}/>\n                <button className=\"fa fa-paste\" onClick={prov.pasteSelection}/>\n                <Spacer/>\n                <button className=\"fa fa-play\" onClick={prov.openPresentationView}/>\n                <button className=\"fa fa-plus\" onClick={prov.newView}> view</button>\n                <button className=\"fa fa-superpowers\" onClick={prov.toggleConnected}>{this.state.connected?\"disconnect\":\"connect\"}</button>\n            </Toolbar>\n\n            <Panel center middle scroll>\n                {this.renderCenterPane(this.state.mode)}\n            </Panel>\n\n            <Panel scroll right><PropSheet provider={prov}/></Panel>\n\n            <Toolbar right top/>\n            <Toolbar right bottom/>\n\n        </GridEditorApp>\n    }\n\n    renderCenterPane(mode) {\n        if (mode === 'canvas') {\n            return <MetadocCanvas prov={this.props.provider} onSelect={this.canvasSelected} scale={Math.pow(2, this.state.zoom)}/>\n        } else {\n            const sel = SelectionManager.getSelection()\n            return <AssetView provider={this.props.provider} asset={sel}/>\n        }\n    }\n}\n\n\n","/* eslint-disable */\nconst THREE = require('three');//requireimport * as THREE from 'three'\n\n/**\n * @author arodic / https://github.com/arodic\n */\n\nconst TransformControls = function ( camera, domElement ) {\n\n    THREE.Object3D.call( this );\n\n    domElement = ( domElement !== undefined ) ? domElement : document;\n\n    this.visible = false;\n\n    var _gizmo = new TransformControlsGizmo();\n    this.add( _gizmo );\n\n    var _plane = new TransformControlsPlane();\n    this.add( _plane );\n\n    var scope = this;\n\n    // Define properties with getters/setter\n    // Setting the defined property will automatically trigger change event\n    // Defined properties are passed down to gizmo and plane\n\n    defineProperty( \"camera\", camera );\n    defineProperty( \"object\", undefined );\n    defineProperty( \"enabled\", true );\n    defineProperty( \"axis\", null );\n    defineProperty( \"mode\", \"translate\" );\n    defineProperty( \"translationSnap\", null );\n    defineProperty( \"rotationSnap\", null );\n    defineProperty( \"space\", \"world\" );\n    defineProperty( \"size\", 1 );\n    defineProperty( \"dragging\", false );\n    defineProperty( \"showX\", true );\n    defineProperty( \"showY\", true );\n    defineProperty( \"showZ\", true );\n\n    var changeEvent = { type: \"change\" };\n    var mouseDownEvent = { type: \"mouseDown\" };\n    var mouseUpEvent = { type: \"mouseUp\", mode: scope.mode };\n    var objectChangeEvent = { type: \"objectChange\" };\n\n    // Reusable utility variables\n\n    var ray = new THREE.Raycaster();\n\n    var _tempVector = new THREE.Vector3();\n    var _tempVector2 = new THREE.Vector3();\n    var _tempQuaternion = new THREE.Quaternion();\n    var _unit = {\n        X: new THREE.Vector3( 1, 0, 0 ),\n        Y: new THREE.Vector3( 0, 1, 0 ),\n        Z: new THREE.Vector3( 0, 0, 1 )\n    };\n    var _identityQuaternion = new THREE.Quaternion();\n    var _alignVector = new THREE.Vector3();\n\n    var pointStart = new THREE.Vector3();\n    var pointEnd = new THREE.Vector3();\n    var rotationAxis = new THREE.Vector3();\n    var rotationAngle = 0;\n\n    var cameraPosition = new THREE.Vector3();\n    var cameraQuaternion = new THREE.Quaternion();\n    var cameraScale = new THREE.Vector3();\n\n    var parentPosition = new THREE.Vector3();\n    var parentQuaternion = new THREE.Quaternion();\n    var parentScale = new THREE.Vector3();\n\n    var worldPositionStart = new THREE.Vector3();\n    var worldQuaternionStart = new THREE.Quaternion();\n    var worldScaleStart = new THREE.Vector3();\n\n    var worldPosition = new THREE.Vector3();\n    var worldQuaternion = new THREE.Quaternion();\n    var worldScale = new THREE.Vector3();\n\n    var eye = new THREE.Vector3();\n\n    var _positionStart = new THREE.Vector3();\n    var _quaternionStart = new THREE.Quaternion();\n    var _scaleStart = new THREE.Vector3();\n\n    // TODO: remove properties unused in plane and gizmo\n\n    defineProperty( \"parentQuaternion\", parentQuaternion );\n    defineProperty( \"worldPosition\", worldPosition );\n    defineProperty( \"worldPositionStart\", worldPositionStart );\n    defineProperty( \"worldQuaternion\", worldQuaternion );\n    defineProperty( \"worldQuaternionStart\", worldQuaternionStart );\n    defineProperty( \"cameraPosition\", cameraPosition );\n    defineProperty( \"cameraQuaternion\", cameraQuaternion );\n    defineProperty( \"pointStart\", pointStart );\n    defineProperty( \"pointEnd\", pointEnd );\n    defineProperty( \"rotationAxis\", rotationAxis );\n    defineProperty( \"rotationAngle\", rotationAngle );\n    defineProperty( \"eye\", eye );\n\n\n\n        domElement.addEventListener( \"mousedown\", onPointerDown, false );\n        domElement.addEventListener( \"touchstart\", onPointerDown, false );\n        domElement.addEventListener( \"mousemove\", onPointerHover, false );\n        domElement.addEventListener( \"touchmove\", onPointerHover, false );\n        domElement.addEventListener( \"touchmove\", onPointerMove, false );\n        document.addEventListener( \"mouseup\", onPointerUp, false );\n        domElement.addEventListener( \"touchend\", onPointerUp, false );\n        domElement.addEventListener( \"touchcancel\", onPointerUp, false );\n        domElement.addEventListener( \"touchleave\", onPointerUp, false );\n        domElement.addEventListener( \"contextmenu\", onContext, false );\n\n\n\n    this.dispose = function () {\n\n        domElement.removeEventListener( \"mousedown\", onPointerDown );\n        domElement.removeEventListener( \"touchstart\", onPointerDown );\n        domElement.removeEventListener( \"mousemove\", onPointerHover );\n        domElement.removeEventListener( \"touchmove\", onPointerHover );\n        domElement.removeEventListener( \"touchmove\", onPointerMove );\n        document.removeEventListener( \"mouseup\", onPointerUp );\n        domElement.removeEventListener( \"touchend\", onPointerUp );\n        domElement.removeEventListener( \"touchcancel\", onPointerUp );\n        domElement.removeEventListener( \"touchleave\", onPointerUp );\n        domElement.removeEventListener( \"contextmenu\", onContext );\n\n    };\n\n    // Set current object\n    this.attach = function ( object ) {\n\n        this.object = object;\n        this.visible = true;\n\n    };\n\n    // Detatch from object\n    this.detach = function () {\n\n        this.object = undefined;\n        this.visible = false;\n        this.axis = null;\n\n    };\n\n    // Defined getter, setter and store for a property\n    function defineProperty( propName, defaultValue ) {\n\n        var propValue = defaultValue;\n\n        Object.defineProperty( scope, propName, {\n\n            get: function() {\n\n                return propValue !== undefined ? propValue : defaultValue;\n\n            },\n\n            set: function( value ) {\n\n                if ( propValue !== value ) {\n\n                    propValue = value;\n                    _plane[ propName ] = value;\n                    _gizmo[ propName ] = value;\n\n                    scope.dispatchEvent( { type: propName + \"-changed\", value: value } );\n                    scope.dispatchEvent( changeEvent );\n\n                }\n\n            }\n\n        });\n\n        scope[ propName ] = defaultValue;\n        _plane[ propName ] = defaultValue;\n        _gizmo[ propName ] = defaultValue;\n\n    }\n\n    // updateMatrixWorld  updates key transformation variables\n    this.updateMatrixWorld = function () {\n\n        if ( this.object !== undefined ) {\n\n            this.object.updateMatrixWorld();\n            this.object.parent.matrixWorld.decompose( parentPosition, parentQuaternion, parentScale );\n            this.object.matrixWorld.decompose( worldPosition, worldQuaternion, worldScale );\n\n        }\n\n        this.camera.updateMatrixWorld();\n        this.camera.matrixWorld.decompose( cameraPosition, cameraQuaternion, cameraScale );\n\n        if ( this.camera instanceof THREE.PerspectiveCamera ) {\n\n            eye.copy( cameraPosition ).sub( worldPosition ).normalize();\n\n        } else if ( this.camera instanceof THREE.OrthographicCamera ) {\n\n            eye.copy( cameraPosition ).normalize();\n\n        }\n\n        THREE.Object3D.prototype.updateMatrixWorld.call( this );\n\n    };\n\n    this.pointerHover = function( pointer ) {\n\n        if ( this.object === undefined || this.dragging === true || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;\n\n        ray.setFromCamera( pointer, this.camera );\n\n        var intersect = ray.intersectObjects( _gizmo.picker[ this.mode ].children, true )[ 0 ] || false;\n\n        if ( intersect ) {\n\n            this.axis = intersect.object.name;\n\n        } else {\n\n            this.axis = null;\n\n        }\n\n    };\n\n    this.pointerDown = function( pointer ) {\n\n        if ( this.object === undefined || this.dragging === true || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;\n\n        if ( ( pointer.button === 0 || pointer.button === undefined ) && this.axis !== null ) {\n\n            ray.setFromCamera( pointer, this.camera );\n\n            var planeIntersect = ray.intersectObjects( [ _plane ], true )[ 0 ] || false;\n\n            if ( planeIntersect ) {\n\n                var space = this.space;\n\n                if ( this.mode === 'scale') {\n\n                    space = 'local';\n\n                } else if ( this.axis === 'E' ||  this.axis === 'XYZE' ||  this.axis === 'XYZ' ) {\n\n                    space = 'world';\n\n                }\n\n                if ( space === 'local' && this.mode === 'rotate' ) {\n\n                    var snap = this.rotationSnap;\n\n                    if ( this.axis === 'X' && snap ) this.object.rotation.x = Math.round( this.object.rotation.x / snap ) * snap;\n                    if ( this.axis === 'Y' && snap ) this.object.rotation.y = Math.round( this.object.rotation.y / snap ) * snap;\n                    if ( this.axis === 'Z' && snap ) this.object.rotation.z = Math.round( this.object.rotation.z / snap ) * snap;\n\n                }\n\n                this.object.updateMatrixWorld();\n                this.object.parent.updateMatrixWorld();\n\n                _positionStart.copy( this.object.position );\n                _quaternionStart.copy( this.object.quaternion );\n                _scaleStart.copy( this.object.scale );\n\n                this.object.matrixWorld.decompose( worldPositionStart, worldQuaternionStart, worldScaleStart );\n\n                pointStart.copy( planeIntersect.point ).sub( worldPositionStart );\n\n                if ( space === 'local' ) pointStart.applyQuaternion( worldQuaternionStart.clone().inverse() );\n\n            }\n\n            this.dragging = true;\n            mouseDownEvent.mode = this.mode;\n            this.dispatchEvent( mouseDownEvent );\n\n        }\n\n    };\n\n    this.pointerMove = function( pointer ) {\n\n        var axis = this.axis;\n        var mode = this.mode;\n        var object = this.object;\n        var space = this.space;\n\n        if ( mode === 'scale') {\n\n            space = 'local';\n\n        } else if ( axis === 'E' ||  axis === 'XYZE' ||  axis === 'XYZ' ) {\n\n            space = 'world';\n\n        }\n\n        if ( object === undefined || axis === null || this.dragging === false || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;\n\n        ray.setFromCamera( pointer, this.camera );\n\n        var planeIntersect = ray.intersectObjects( [ _plane ], true )[ 0 ] || false;\n\n        if ( planeIntersect === false ) return;\n\n        pointEnd.copy( planeIntersect.point ).sub( worldPositionStart );\n\n        if ( space === 'local' ) pointEnd.applyQuaternion( worldQuaternionStart.clone().inverse() );\n\n        if ( mode === 'translate' ) {\n\n            if ( axis.search( 'X' ) === -1 ) {\n                pointEnd.x = pointStart.x;\n            }\n            if ( axis.search( 'Y' ) === -1 ) {\n                pointEnd.y = pointStart.y;\n            }\n            if ( axis.search( 'Z' ) === -1 ) {\n                pointEnd.z = pointStart.z;\n            }\n\n            // Apply translate\n\n            if ( space === 'local' ) {\n                object.position.copy( pointEnd ).sub( pointStart ).applyQuaternion( _quaternionStart );\n            } else {\n                object.position.copy( pointEnd ).sub( pointStart );\n            }\n\n            object.position.add( _positionStart );\n\n            // Apply translation snap\n\n            if ( this.translationSnap ) {\n\n                if ( space === 'local' ) {\n\n                    object.position.applyQuaternion(_tempQuaternion.copy( _quaternionStart ).inverse() );\n\n                    if ( axis.search( 'X' ) !== -1 ) {\n                        object.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\n                    }\n\n                    if ( axis.search( 'Y' ) !== -1 ) {\n                        object.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\n                    }\n\n                    if ( axis.search( 'Z' ) !== -1 ) {\n                        object.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\n                    }\n\n                    object.position.applyQuaternion( _quaternionStart );\n\n                }\n\n                if ( space === 'world' ) {\n\n                    if ( object.parent ) {\n                        object.position.add( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\n                    }\n\n                    if ( axis.search( 'X' ) !== -1 ) {\n                        object.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\n                    }\n\n                    if ( axis.search( 'Y' ) !== -1 ) {\n                        object.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\n                    }\n\n                    if ( axis.search( 'Z' ) !== -1 ) {\n                        object.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\n                    }\n\n                    if ( object.parent ) {\n                        object.position.sub( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\n                    }\n\n                }\n\n            }\n\n        } else if ( mode === 'scale' ) {\n\n            if ( axis.search( 'XYZ' ) !== -1 ) {\n\n                var d = pointEnd.length() / pointStart.length();\n\n                if ( pointEnd.dot( pointStart ) < 0 ) d *= -1;\n\n                _tempVector.set( d, d, d );\n\n            } else {\n\n                _tempVector.copy( pointEnd ).divide( pointStart );\n\n                if ( axis.search( 'X' ) === -1 ) {\n                    _tempVector.x = 1;\n                }\n                if ( axis.search( 'Y' ) === -1 ) {\n                    _tempVector.y = 1;\n                }\n                if ( axis.search( 'Z' ) === -1 ) {\n                    _tempVector.z = 1;\n                }\n\n            }\n\n            // Apply scale\n\n            object.scale.copy( _scaleStart ).multiply( _tempVector );\n\n        } else if ( mode === 'rotate' ) {\n\n            var ROTATION_SPEED = 20 / worldPosition.distanceTo( _tempVector.setFromMatrixPosition( this.camera.matrixWorld ) );\n\n            var quaternion = this.space === \"local\" ? worldQuaternion : _identityQuaternion;\n\n            var unit = _unit[ axis ];\n\n            if ( axis === 'E' ) {\n\n                _tempVector.copy( pointEnd ).cross( pointStart );\n                rotationAxis.copy( eye );\n                rotationAngle = pointEnd.angleTo( pointStart ) * ( _tempVector.dot( eye ) < 0 ? 1 : -1 );\n\n            } else if ( axis === 'XYZE' ) {\n\n                _tempVector.copy( pointEnd ).sub( pointStart ).cross( eye ).normalize();\n                rotationAxis.copy( _tempVector );\n                rotationAngle = pointEnd.sub( pointStart ).dot( _tempVector.cross( eye ) ) * ROTATION_SPEED;\n\n            } else if ( axis === 'X' || axis === 'Y' || axis === 'Z' ) {\n\n                _alignVector.copy( unit ).applyQuaternion( quaternion );\n\n                rotationAxis.copy( unit );\n\n                _tempVector = unit.clone();\n                _tempVector2 = pointEnd.clone().sub( pointStart );\n                if ( space === 'local' ) {\n                    _tempVector.applyQuaternion( quaternion );\n                    _tempVector2.applyQuaternion( worldQuaternionStart );\n                }\n                rotationAngle = _tempVector2.dot( _tempVector.cross( eye ).normalize() ) * ROTATION_SPEED;\n\n            }\n\n            // Apply rotation snap\n\n            if ( this.rotationSnap ) rotationAngle = Math.round( rotationAngle / this.rotationSnap ) * this.rotationSnap;\n\n            this.rotationAngle = rotationAngle;\n\n            // Apply rotate\n\n            if ( space === 'local' ) {\n\n                object.quaternion.copy( _quaternionStart );\n                object.quaternion.multiply( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) );\n\n            } else {\n\n                object.quaternion.copy( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) );\n                object.quaternion.multiply( _quaternionStart );\n\n            }\n\n        }\n\n        this.dispatchEvent( changeEvent );\n        this.dispatchEvent( objectChangeEvent );\n\n    };\n\n    this.pointerUp = function( pointer ) {\n\n        if ( pointer.button !== undefined && pointer.button !== 0 ) return;\n\n        if ( this.dragging && ( this.axis !== null ) ) {\n\n            mouseUpEvent.mode = this.mode;\n            this.dispatchEvent( mouseUpEvent );\n\n        }\n\n        this.dragging = false;\n\n        if ( pointer.button === undefined ) this.axis = null;\n\n    };\n\n    // normalize mouse / touch pointer and remap {x,y} to view space.\n\n    function getPointer( event ) {\n\n        var pointer = event.changedTouches ? event.changedTouches[ 0 ] : event;\n\n        var rect = domElement.getBoundingClientRect();\n\n        return {\n            x: ( pointer.clientX - rect.left ) / rect.width * 2 - 1,\n            y: - ( pointer.clientY - rect.top ) / rect.height * 2 + 1,\n            button: event.button\n        };\n\n    }\n\n    // mouse / touch event handlers\n\n    function onContext( event ) {\n\n        event.preventDefault();\n\n    }\n\n    function onPointerHover( event ) {\n\n        if ( !scope.enabled ) return;\n\n        scope.pointerHover( getPointer( event ) );\n\n    }\n\n    function onPointerDown( event ) {\n\n        if ( !scope.enabled ) return;\n\n        event.preventDefault();\n\n        document.addEventListener( \"mousemove\", onPointerMove, false );\n\n        scope.pointerHover( getPointer( event ) );\n        scope.pointerDown( getPointer( event ) );\n\n    }\n\n    function onPointerMove( event ) {\n\n        if ( !scope.enabled ) return;\n\n        event.preventDefault();\n\n        scope.pointerMove( getPointer( event ) );\n\n    }\n\n    function onPointerUp( event ) {\n\n        if ( !scope.enabled ) return;\n\n        event.preventDefault(); // Prevent MouseEvent on mobile\n\n        document.removeEventListener( \"mousemove\", onPointerMove, false );\n\n        scope.pointerUp( getPointer( event ) );\n\n    }\n\n    // TODO: depricate\n\n    this.getMode = function () {\n\n        return scope.mode;\n\n    };\n\n    this.setMode = function ( mode ) {\n\n        scope.mode = mode;\n\n    };\n\n    this.setTranslationSnap = function ( translationSnap ) {\n\n        scope.translationSnap = translationSnap;\n\n    };\n\n    this.setRotationSnap = function ( rotationSnap ) {\n\n        scope.rotationSnap = rotationSnap;\n\n    };\n\n    this.setSize = function ( size ) {\n\n        scope.size = size;\n\n    };\n\n    this.setSpace = function ( space ) {\n\n        scope.space = space;\n\n    };\n\n    this.update = function () {\n\n        console.warn( 'TransformControls: update function has been depricated.' );\n\n    };\n\n};\n\nTransformControls.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\n\n    constructor: TransformControls,\n\n    isTransformControls: true\n\n} );\n\n\nconst TransformControlsGizmo = function () {\n\n\n    THREE.Object3D.call( this );\n\n    this.type = 'TransformControlsGizmo';\n\n    // shared materials\n\n    var gizmoMaterial = new THREE.MeshBasicMaterial({\n        depthTest: false,\n        depthWrite: false,\n        transparent: true,\n        side: THREE.DoubleSide,\n        fog: false\n    });\n\n    var gizmoLineMaterial = new THREE.LineBasicMaterial({\n        depthTest: false,\n        depthWrite: false,\n        transparent: true,\n        linewidth: 1,\n        fog: false\n    });\n\n    // Make unique material for each axis/color\n\n    var matInvisible = gizmoMaterial.clone();\n    matInvisible.opacity = 0.15;\n\n    var matHelper = gizmoMaterial.clone();\n    matHelper.opacity = 0.33;\n\n    var matRed = gizmoMaterial.clone();\n    matRed.color.set( 0xff0000 );\n\n    var matGreen = gizmoMaterial.clone();\n    matGreen.color.set( 0x00ff00 );\n\n    var matBlue = gizmoMaterial.clone();\n    matBlue.color.set( 0x0000ff );\n\n    var matWhiteTransperent = gizmoMaterial.clone();\n    matWhiteTransperent.opacity = 0.25;\n\n    var matYellowTransparent = matWhiteTransperent.clone();\n    matYellowTransparent.color.set( 0xffff00 );\n\n    var matCyanTransparent = matWhiteTransperent.clone();\n    matCyanTransparent.color.set( 0x00ffff );\n\n    var matMagentaTransparent = matWhiteTransperent.clone();\n    matMagentaTransparent.color.set( 0xff00ff );\n\n    var matYellow = gizmoMaterial.clone();\n    matYellow.color.set( 0xffff00 );\n\n    var matLineRed = gizmoLineMaterial.clone();\n    matLineRed.color.set( 0xff0000 );\n\n    var matLineGreen = gizmoLineMaterial.clone();\n    matLineGreen.color.set( 0x00ff00 );\n\n    var matLineBlue = gizmoLineMaterial.clone();\n    matLineBlue.color.set( 0x0000ff );\n\n    var matLineCyan = gizmoLineMaterial.clone();\n    matLineCyan.color.set( 0x00ffff );\n\n    var matLineMagenta = gizmoLineMaterial.clone();\n    matLineMagenta.color.set( 0xff00ff );\n\n    var matLineYellow = gizmoLineMaterial.clone();\n    matLineYellow.color.set( 0xffff00 );\n\n    var matLineGray = gizmoLineMaterial.clone();\n    matLineGray.color.set( 0x787878);\n\n    var matLineYellowTransparent = matLineYellow.clone();\n    matLineYellowTransparent.opacity = 0.25;\n\n    // reusable geometry\n\n    var arrowGeometry = new THREE.CylinderBufferGeometry( 0, 0.05, 0.2, 12, 1, false);\n\n    var scaleHandleGeometry = new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125);\n\n    var lineGeometry = new THREE.BufferGeometry( );\n    lineGeometry.addAttribute('position', new THREE.Float32BufferAttribute( [ 0, 0, 0,\t1, 0, 0 ], 3 ) );\n\n    var CircleGeometry = function( radius, arc ) {\n\n        var geometry = new THREE.BufferGeometry( );\n        var vertices = [];\n\n        for ( var i = 0; i <= 64 * arc; ++i ) {\n\n            vertices.push( 0, Math.cos( i / 32 * Math.PI ) * radius, Math.sin( i / 32 * Math.PI ) * radius );\n\n        }\n\n        geometry.addAttribute('position', new THREE.Float32BufferAttribute( vertices, 3 ) );\n\n        return geometry;\n\n    };\n\n    // Special geometry for transform helper. If scaled with position vector it spans from [0,0,0] to position\n\n    var TranslateHelperGeometry = function( radius, arc ) {\n\n        var geometry = new THREE.BufferGeometry()\n\n        geometry.addAttribute('position', new THREE.Float32BufferAttribute( [ 0, 0, 0, 1, 1, 1 ], 3 ) );\n\n        return geometry;\n\n    };\n\n    // Gizmo definitions - custom hierarchy definitions for setupGizmo() function\n\n    var gizmoTranslate = {\n        X: [\n            [ new THREE.Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, -Math.PI / 2 ], null, 'fwd' ],\n            [ new THREE.Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, Math.PI / 2 ], null, 'bwd' ],\n            [ new THREE.Line( lineGeometry, matLineRed ) ]\n        ],\n        Y: [\n            [ new THREE.Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], null, null, 'fwd' ],\n            [ new THREE.Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], [ Math.PI, 0, 0 ], null, 'bwd' ],\n            [ new THREE.Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ] ]\n        ],\n        Z: [\n            [ new THREE.Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ Math.PI / 2, 0, 0 ], null, 'fwd' ],\n            [ new THREE.Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ -Math.PI / 2, 0, 0 ], null, 'bwd' ],\n            [ new THREE.Line( lineGeometry, matLineBlue ), null, [ 0, -Math.PI / 2, 0 ] ]\n        ],\n        XYZ: [\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.1, 0 ), matWhiteTransperent ), [ 0, 0, 0 ], [ 0, 0, 0 ] ]\n        ],\n        XY: [\n            [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.295, 0.295 ), matYellowTransparent ), [ 0.15, 0.15, 0 ] ],\n            [ new THREE.Line( lineGeometry, matLineYellow ), [ 0.18, 0.3, 0 ], null, [ 0.125, 1, 1 ] ],\n            [ new THREE.Line( lineGeometry, matLineYellow ), [ 0.3, 0.18, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ]\n        ],\n        YZ: [\n            [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.295, 0.295 ), matCyanTransparent ), [ 0, 0.15, 0.15 ], [ 0, Math.PI / 2, 0 ] ],\n            [ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.18, 0.3 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ],\n            [ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.3, 0.18 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]\n        ],\n        XZ: [\n            [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.295, 0.295 ), matMagentaTransparent ), [ 0.15, 0, 0.15 ], [ -Math.PI / 2, 0, 0 ] ],\n            [ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.18, 0, 0.3 ], null, [ 0.125, 1, 1 ] ],\n            [ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.3, 0, 0.18 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]\n        ]\n    };\n\n    var pickerTranslate = {\n        X: [\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0.6, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ]\n        ],\n        Y: [\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0.6, 0 ] ]\n        ],\n        Z: [\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0, 0.6 ], [ Math.PI / 2, 0, 0 ] ]\n        ],\n        XYZ: [\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.2, 0 ), matInvisible ) ]\n        ],\n        XY: [\n            [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0.2, 0.2, 0 ] ]\n        ],\n        YZ: [\n            [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0, 0.2, 0.2 ], [ 0, Math.PI / 2, 0 ] ]\n        ],\n        XZ: [\n            [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0.2, 0, 0.2 ], [ -Math.PI / 2, 0, 0 ] ]\n        ]\n    };\n\n    var helperTranslate = {\n        START: [\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\n        ],\n        END: [\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\n        ],\n        DELTA: [\n            [ new THREE.Line( TranslateHelperGeometry(), matHelper ), null, null, null, 'helper' ]\n        ],\n        X: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ -1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n        ],\n        Y: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, -1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\n        ],\n        Z: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, 0, -1e3 ], [ 0, -Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\n        ]\n    };\n\n    var gizmoRotate = {\n        X: [\n            [ new THREE.Line( CircleGeometry( 1, 0.5 ), matLineRed ) ],\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.04, 0 ), matRed ), [ 0, 0, 0.99 ], null, [ 1, 3, 1 ] ],\n        ],\n        Y: [\n            [ new THREE.Line( CircleGeometry( 1, 0.5 ), matLineGreen ), null, [ 0, 0, -Math.PI / 2 ] ],\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.04, 0 ), matGreen ), [ 0, 0, 0.99 ], null, [ 3, 1, 1 ] ],\n        ],\n        Z: [\n            [ new THREE.Line( CircleGeometry( 1, 0.5 ), matLineBlue ), null, [ 0, Math.PI / 2, 0 ] ],\n            [ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.04, 0 ), matBlue ), [ 0.99, 0, 0 ], null, [ 1, 3, 1 ] ],\n        ],\n        E: [\n            [ new THREE.Line( CircleGeometry( 1.25, 1 ), matLineYellowTransparent ), null, [ 0, Math.PI / 2, 0 ] ],\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 1.17, 0, 0 ], [ 0, 0, -Math.PI / 2 ], [ 1, 1, 0.001 ]],\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ -1.17, 0, 0 ], [ 0, 0, Math.PI / 2 ], [ 1, 1, 0.001 ]],\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, -1.17, 0 ], [ Math.PI, 0, 0 ], [ 1, 1, 0.001 ]],\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, 1.17, 0 ], [ 0, 0, 0 ], [ 1, 1, 0.001 ]],\n        ],\n        XYZE: [\n            [ new THREE.Line( CircleGeometry( 1, 1 ), matLineGray ), null, [ 0, Math.PI / 2, 0 ] ]\n        ]\n    };\n\n    var helperRotate = {\n        AXIS: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ -1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n        ]\n    };\n\n    var pickerRotate = {\n        X: [\n            [ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, -Math.PI / 2, -Math.PI / 2 ] ],\n        ],\n        Y: [\n            [ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ Math.PI / 2, 0, 0 ] ],\n        ],\n        Z: [\n            [ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ],\n        ],\n        E: [\n            [ new THREE.Mesh( new THREE.TorusBufferGeometry( 1.25, 0.1, 2, 24 ), matInvisible ) ]\n        ],\n        XYZE: [\n            [ new THREE.Mesh( new THREE.SphereBufferGeometry( 0.7, 10, 8 ), matInvisible ) ]\n        ]\n    };\n\n    var gizmoScale = {\n        X: [\n            [ new THREE.Mesh( scaleHandleGeometry, matRed ), [ 0.8, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ],\n            [ new THREE.Line( lineGeometry, matLineRed ), null, null, [ 0.8, 1, 1 ] ]\n        ],\n        Y: [\n            [ new THREE.Mesh( scaleHandleGeometry, matGreen ), [ 0, 0.8, 0 ] ],\n            [ new THREE.Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ], [ 0.8, 1, 1 ] ]\n        ],\n        Z: [\n            [ new THREE.Mesh( scaleHandleGeometry, matBlue ), [ 0, 0, 0.8 ], [ Math.PI / 2, 0, 0 ] ],\n            [ new THREE.Line( lineGeometry, matLineBlue ), null, [ 0, -Math.PI / 2, 0 ], [ 0.8, 1, 1 ] ]\n        ],\n        XY: [\n            [ new THREE.Mesh( scaleHandleGeometry, matYellowTransparent ), [ 0.85, 0.85, 0 ], null, [ 2, 2, 0.2 ] ],\n            [ new THREE.Line( lineGeometry, matLineYellow ), [ 0.855, 0.98, 0 ], null, [ 0.125, 1, 1 ] ],\n            [ new THREE.Line( lineGeometry, matLineYellow ), [ 0.98, 0.855, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ]\n        ],\n        YZ: [\n            [ new THREE.Mesh( scaleHandleGeometry, matCyanTransparent ), [ 0, 0.85, 0.85 ], null, [ 0.2, 2, 2 ] ],\n            [ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.855, 0.98 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ],\n            [ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.98, 0.855 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]\n        ],\n        XZ: [\n            [ new THREE.Mesh( scaleHandleGeometry, matMagentaTransparent ), [ 0.85, 0, 0.85 ], null, [ 2, 0.2, 2 ] ],\n            [ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.855, 0, 0.98 ], null, [ 0.125, 1, 1 ] ],\n            [ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.98, 0, 0.855 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]\n        ],\n        XYZX: [\n            [ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransperent ), [ 1.1, 0, 0 ] ],\n        ],\n        XYZY: [\n            [ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransperent ), [ 0, 1.1, 0 ] ],\n        ],\n        XYZZ: [\n            [ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransperent ), [ 0, 0, 1.1 ] ],\n        ]\n    };\n\n    var pickerScale = {\n        X: [\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0.5, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ]\n        ],\n        Y: [\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0.5, 0 ] ]\n        ],\n        Z: [\n            [ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0, 0.5 ], [ Math.PI / 2, 0, 0 ] ]\n        ],\n        XY: [\n            [ new THREE.Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0.85, 0 ], null, [ 3, 3, 0.2 ] ],\n        ],\n        YZ: [\n            [ new THREE.Mesh( scaleHandleGeometry, matInvisible ), [ 0, 0.85, 0.85 ], null, [ 0.2, 3, 3 ] ],\n        ],\n        XZ: [\n            [ new THREE.Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0, 0.85 ], null, [ 3, 0.2, 3 ] ],\n        ],\n        XYZX: [\n            [ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 1.1, 0, 0 ] ],\n        ],\n        XYZY: [\n            [ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 1.1, 0 ] ],\n        ],\n        XYZZ: [\n            [ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 0, 1.1 ] ],\n        ]\n    };\n\n    var helperScale = {\n        X: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ -1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n        ],\n        Y: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, -1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\n        ],\n        Z: [\n            [ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, 0, -1e3 ], [ 0, -Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\n        ]\n    };\n\n    // Creates an Object3D with gizmos described in custom hierarchy definition.\n\n    var setupGizmo = function( gizmoMap ) {\n\n        var gizmo = new THREE.Object3D();\n\n        for ( var name in gizmoMap ) {\n\n            for ( var i = gizmoMap[ name ].length; i --; ) {\n\n                var object = gizmoMap[ name ][ i ][ 0 ].clone();\n                var position = gizmoMap[ name ][ i ][ 1 ];\n                var rotation = gizmoMap[ name ][ i ][ 2 ];\n                var scale = gizmoMap[ name ][ i ][ 3 ];\n                var tag = gizmoMap[ name ][ i ][ 4 ];\n\n                // name and tag properties are essential for picking and updating logic.\n                object.name = name;\n                object.tag = tag;\n\n                if (position) {\n                    object.position.set(position[ 0 ], position[ 1 ], position[ 2 ]);\n                }\n                if (rotation) {\n                    object.rotation.set(rotation[ 0 ], rotation[ 1 ], rotation[ 2 ]);\n                }\n                if (scale) {\n                    object.scale.set(scale[ 0 ], scale[ 1 ], scale[ 2 ]);\n                }\n\n                object.updateMatrix();\n\n                var tempGeometry = object.geometry.clone();\n                tempGeometry.applyMatrix(object.matrix);\n                object.geometry = tempGeometry;\n\n                object.position.set( 0, 0, 0 );\n                object.rotation.set( 0, 0, 0 );\n                object.scale.set(1, 1, 1);\n\n                gizmo.add(object);\n\n            }\n\n        }\n\n        return gizmo;\n\n    };\n\n    // Reusable utility variables\n\n    var tempVector = new THREE.Vector3( 0, 0, 0 );\n    var tempEuler = new THREE.Euler();\n    var alignVector = new THREE.Vector3( 0, 1, 0 );\n    var zeroVector = new THREE.Vector3( 0, 0, 0 );\n    var lookAtMatrix = new THREE.Matrix4();\n    var tempQuaternion = new THREE.Quaternion();\n    var tempQuaternion2 = new THREE.Quaternion();\n    var identityQuaternion = new THREE.Quaternion();\n\n    var unitX = new THREE.Vector3( 1, 0, 0 );\n    var unitY = new THREE.Vector3( 0, 1, 0 );\n    var unitZ = new THREE.Vector3( 0, 0, 1 );\n\n    // Gizmo creation\n\n    this.gizmo = {};\n    this.picker = {};\n    this.helper = {};\n\n    this.add( this.gizmo[ \"translate\" ] = setupGizmo( gizmoTranslate ) );\n    this.add( this.gizmo[ \"rotate\" ] = setupGizmo( gizmoRotate ) );\n    this.add( this.gizmo[ \"scale\" ] = setupGizmo( gizmoScale ) );\n    this.add( this.picker[ \"translate\" ] = setupGizmo( pickerTranslate ) );\n    this.add( this.picker[ \"rotate\" ] = setupGizmo( pickerRotate ) );\n    this.add( this.picker[ \"scale\" ] = setupGizmo( pickerScale ) );\n    this.add( this.helper[ \"translate\" ] = setupGizmo( helperTranslate ) );\n    this.add( this.helper[ \"rotate\" ] = setupGizmo( helperRotate ) );\n    this.add( this.helper[ \"scale\" ] = setupGizmo( helperScale ) );\n\n    // Pickers should be hidden always\n\n    this.picker[ \"translate\" ].visible = false;\n    this.picker[ \"rotate\" ].visible = false;\n    this.picker[ \"scale\" ].visible = false;\n\n    // updateMatrixWorld will update transformations and appearance of individual handles\n\n    this.updateMatrixWorld = function () {\n\n        var space = this.space;\n\n        if ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation\n\n        var quaternion = space === \"local\" ? this.worldQuaternion : identityQuaternion;\n\n        // Show only gizmos for current transform mode\n\n        this.gizmo[ \"translate\" ].visible = this.mode === \"translate\";\n        this.gizmo[ \"rotate\" ].visible = this.mode === \"rotate\";\n        this.gizmo[ \"scale\" ].visible = this.mode === \"scale\";\n\n        this.helper[ \"translate\" ].visible = this.mode === \"translate\";\n        this.helper[ \"rotate\" ].visible = this.mode === \"rotate\";\n        this.helper[ \"scale\" ].visible = this.mode === \"scale\";\n\n\n        var handles = [];\n        handles = handles.concat( this.picker[ this.mode ].children );\n        handles = handles.concat( this.gizmo[ this.mode ].children );\n        handles = handles.concat( this.helper[ this.mode ].children );\n\n        for ( var i = 0; i < handles.length; i++ ) {\n\n            var handle = handles[i];\n\n            // hide aligned to camera\n\n            handle.visible = true;\n            handle.rotation.set( 0, 0, 0 );\n            handle.position.copy( this.worldPosition );\n\n            var eyeDistance = this.worldPosition.distanceTo( this.cameraPosition);\n            handle.scale.set( 1, 1, 1 ).multiplyScalar( eyeDistance * this.size / 7 );\n\n            // TODO: simplify helpers and consider decoupling from gizmo\n\n            if ( handle.tag === 'helper' ) {\n\n                handle.visible = false;\n\n                if ( handle.name === 'AXIS' ) {\n\n                    handle.position.copy( this.worldPositionStart );\n                    handle.visible = !!this.axis;\n\n                    if ( this.axis === 'X' ) {\n\n                        tempQuaternion.setFromEuler( tempEuler.set( 0, 0, 0 ) );\n                        handle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n                        if ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n                            handle.visible = false;\n                        }\n\n                    }\n\n                    if ( this.axis === 'Y' ) {\n\n                        tempQuaternion.setFromEuler( tempEuler.set( 0, 0, Math.PI / 2 ) );\n                        handle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n                        if ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n                            handle.visible = false;\n                        }\n\n                    }\n\n                    if ( this.axis === 'Z' ) {\n\n                        tempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );\n                        handle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n                        if ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n                            handle.visible = false;\n                        }\n\n                    }\n\n                    if ( this.axis === 'XYZE' ) {\n\n                        tempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );\n                        alignVector.copy( this.rotationAxis );\n                        handle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( zeroVector, alignVector, unitY ) );\n                        handle.quaternion.multiply( tempQuaternion );\n                        handle.visible = this.dragging;\n\n                    }\n\n                    if ( this.axis === 'E' ) {\n\n                        handle.visible = false;\n\n                    }\n\n\n                } else if ( handle.name === 'START' ) {\n\n                    handle.position.copy( this.worldPositionStart );\n                    handle.visible = this.dragging;\n\n                } else if ( handle.name === 'END' ) {\n\n                    handle.position.copy( this.worldPosition );\n                    handle.visible = this.dragging;\n\n                } else if ( handle.name === 'DELTA' ) {\n\n                    handle.position.copy( this.worldPositionStart );\n                    handle.quaternion.copy( this.worldQuaternionStart );\n                    tempVector.set( 1e-10, 1e-10, 1e-10 ).add( this.worldPositionStart ).sub( this.worldPosition ).multiplyScalar( -1 );\n                    tempVector.applyQuaternion( this.worldQuaternionStart.clone().inverse() );\n                    handle.scale.copy( tempVector );\n                    handle.visible = this.dragging;\n\n                } else {\n\n                    handle.quaternion.copy( quaternion );\n\n                    if ( this.dragging ) {\n\n                        handle.position.copy( this.worldPositionStart );\n\n                    } else {\n\n                        handle.position.copy( this.worldPosition );\n\n                    }\n\n                    if ( this.axis ) {\n\n                        handle.visible = this.axis.search( handle.name ) !== -1;\n\n                    }\n\n                }\n\n                // If updating helper, skip rest of the loop\n                continue;\n\n            }\n\n            // Align handles to current local or world rotation\n\n            handle.quaternion.copy( quaternion );\n\n            if ( this.mode === 'translate' || this.mode === 'scale' ) {\n\n                // Hide translate and scale axis facing the camera\n\n                var AXIS_HIDE_TRESHOLD = 0.99;\n                var PLANE_HIDE_TRESHOLD = 0.2;\n                var AXIS_FLIP_TRESHOLD = -0.4;\n\n\n                if ( handle.name === 'X' || handle.name === 'XYZX' ) {\n                    if ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n                    }\n                }\n                if ( handle.name === 'Y' || handle.name === 'XYZY' ) {\n                    if ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n                    }\n                }\n                if ( handle.name === 'Z' || handle.name === 'XYZZ' ) {\n                    if ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n                    }\n                }\n                if ( handle.name === 'XY' ) {\n                    if ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n                    }\n                }\n                if ( handle.name === 'YZ' ) {\n                    if ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n                    }\n                }\n                if ( handle.name === 'XZ' ) {\n                    if ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n                    }\n                }\n\n                // Flip translate and scale axis ocluded behind another axis\n\n                if ( handle.name.search( 'X' ) !== -1 ) {\n                    if ( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n                        if ( handle.tag === 'fwd' ) {\n                            handle.visible = false;\n                        } else {\n                            handle.scale.x *= -1;\n                        }\n                    } else if ( handle.tag === 'bwd' ) {\n                        handle.visible = false;\n                    }\n                }\n\n                if ( handle.name.search( 'Y' ) !== -1 ) {\n                    if ( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n                        if ( handle.tag === 'fwd' ) {\n                            handle.visible = false;\n                        } else {\n                            handle.scale.y *= -1;\n                        }\n                    } else if ( handle.tag === 'bwd' ) {\n                        handle.visible = false;\n                    }\n                }\n\n                if ( handle.name.search( 'Z' ) !== -1 ) {\n                    if ( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n                        if ( handle.tag === 'fwd' ) {\n                            handle.visible = false;\n                        } else {\n                            handle.scale.z *= -1;\n                        }\n                    } else if ( handle.tag === 'bwd' ) {\n                        handle.visible = false;\n                    }\n                }\n\n            } else if ( this.mode === 'rotate' ) {\n\n                // Align handles to current local or world rotation\n\n                tempQuaternion2.copy( quaternion );\n                alignVector.copy( this.eye ).applyQuaternion( tempQuaternion.copy( quaternion ).inverse() );\n\n                if ( handle.name.search( \"E\" ) !== - 1 ) {\n\n                    handle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( this.eye, zeroVector, unitY ) );\n\n                }\n\n                if ( handle.name === 'X' ) {\n\n                    tempQuaternion.setFromAxisAngle( unitX, Math.atan2( -alignVector.y, alignVector.z ) );\n                    tempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n                    handle.quaternion.copy( tempQuaternion );\n\n                }\n\n                if ( handle.name === 'Y' ) {\n\n                    tempQuaternion.setFromAxisAngle( unitY, Math.atan2( alignVector.x, alignVector.z ) );\n                    tempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n                    handle.quaternion.copy( tempQuaternion );\n\n                }\n\n                if ( handle.name === 'Z' ) {\n\n                    tempQuaternion.setFromAxisAngle( unitZ, Math.atan2( alignVector.y, alignVector.x ) );\n                    tempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n                    handle.quaternion.copy( tempQuaternion );\n\n                }\n\n            }\n\n            // Hide disabled axes\n            handle.visible = handle.visible && ( handle.name.indexOf( \"X\" ) === -1 || this.showX );\n            handle.visible = handle.visible && ( handle.name.indexOf( \"Y\" ) === -1 || this.showY );\n            handle.visible = handle.visible && ( handle.name.indexOf( \"Z\" ) === -1 || this.showZ );\n            handle.visible = handle.visible && ( handle.name.indexOf( \"E\" ) === -1 || ( this.showX && this.showY && this.showZ ) );\n\n            // highlight selected axis\n\n            handle.material._opacity = handle.material._opacity || handle.material.opacity;\n            handle.material._color = handle.material._color || handle.material.color.clone();\n\n            handle.material.color.copy( handle.material._color );\n            handle.material.opacity = handle.material._opacity;\n\n            if ( !this.enabled ) {\n\n                handle.material.opacity *= 0.5;\n                handle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n            } else if ( this.axis ) {\n\n                if ( handle.name === this.axis ) {\n\n                    handle.material.opacity = 1.0;\n                    handle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n                } else if ( this.axis.split('').some( function( a ) { return handle.name === a; } ) ) {\n\n                    handle.material.opacity = 1.0;\n                    handle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n                } else {\n\n                    handle.material.opacity *= 0.25;\n                    handle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n                }\n\n            }\n\n        }\n\n        THREE.Object3D.prototype.updateMatrixWorld.call( this );\n\n    };\n\n};\n\nTransformControlsGizmo.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\n\n    constructor: TransformControlsGizmo,\n\n    isTransformControlsGizmo: true\n\n} );\n\n\nconst TransformControlsPlane = function () {\n\n\n    THREE.Mesh.call( this,\n        new THREE.PlaneBufferGeometry( 100000, 100000, 2, 2 ),\n        new THREE.MeshBasicMaterial( { visible: false, wireframe: true, side: THREE.DoubleSide, transparent: true, opacity: 0.1 } )\n    );\n\n    this.type = 'TransformControlsPlane';\n\n    var unitX = new THREE.Vector3( 1, 0, 0 );\n    var unitY = new THREE.Vector3( 0, 1, 0 );\n    var unitZ = new THREE.Vector3( 0, 0, 1 );\n\n    var tempVector = new THREE.Vector3();\n    var dirVector = new THREE.Vector3();\n    var alignVector = new THREE.Vector3();\n    var tempMatrix = new THREE.Matrix4();\n    var identityQuaternion = new THREE.Quaternion();\n\n    this.updateMatrixWorld = function() {\n\n        var space = this.space;\n\n        this.position.copy( this.worldPosition );\n\n        if ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation\n\n        unitX.set( 1, 0, 0 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n        unitY.set( 0, 1, 0 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n        unitZ.set( 0, 0, 1 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n\n        // Align the plane for current transform mode, axis and space.\n\n        alignVector.copy( unitY );\n\n        switch ( this.mode ) {\n            case 'translate':\n            case 'scale':\n                switch ( this.axis ) {\n                    case 'X':\n                        alignVector.copy( this.eye ).cross( unitX );\n                        dirVector.copy( unitX ).cross( alignVector );\n                        break;\n                    case 'Y':\n                        alignVector.copy( this.eye ).cross( unitY );\n                        dirVector.copy( unitY ).cross( alignVector );\n                        break;\n                    case 'Z':\n                        alignVector.copy( this.eye ).cross( unitZ );\n                        dirVector.copy( unitZ ).cross( alignVector );\n                        break;\n                    case 'XY':\n                        dirVector.copy( unitZ );\n                        break;\n                    case 'YZ':\n                        dirVector.copy( unitX );\n                        break;\n                    case 'XZ':\n                        alignVector.copy( unitZ );\n                        dirVector.copy( unitY );\n                        break;\n                    case 'XYZ':\n                    case 'E':\n                        dirVector.set( 0, 0, 0 );\n                        break;\n                    default:\n                        break;\n                }\n                break;\n            case 'rotate':\n            default:\n                // special case for rotate\n                dirVector.set( 0, 0, 0 );\n        }\n\n        if ( dirVector.length() === 0 ) {\n\n            // If in rotate mode, make the plane parallel to camera\n            this.quaternion.copy( this.cameraQuaternion );\n\n        } else {\n\n            tempMatrix.lookAt( tempVector.set( 0, 0, 0 ), dirVector, alignVector );\n\n            this.quaternion.setFromRotationMatrix( tempMatrix );\n\n        }\n\n        THREE.Object3D.prototype.updateMatrixWorld.call( this );\n\n    };\n\n};\n\nTransformControlsPlane.prototype = Object.assign( Object.create( THREE.Mesh.prototype ), {\n\n    constructor: TransformControlsPlane,\n\n    isTransformControlsPlane: true\n\n} );\n\nexport default TransformControls\n","import {createGraphObjectFromObject, fetchGraphObject} from \"../../syncgraph/utils\";\nimport {\n    Group,\n    Mesh,\n    MeshLambertMaterial,\n    PlaneBufferGeometry\n} from 'three'\nimport {OBJ_TYPES, PROP_DEFS} from '../Common'\n\nlet COUNTER = 0\n\nfunction isAnchorType(type) {\n    if(type === OBJ_TYPES.geoanchor) return true\n    if(type === OBJ_TYPES.localanchor) return true\n    if(type === OBJ_TYPES.imageanchor) return true\n    if(type === OBJ_TYPES.hudanchor) return true\n    return false\n}\n\nfunction generateUniqueTitle(prefix,count, root) {\n    const title = prefix + ' ' + count\n    const dup = root.getChildren().find(sc =>  sc.title == title)\n    if(dup) {\n        return generateUniqueTitle(prefix,count+1,root)\n    } else {\n        return title\n    }\n}\n\nexport default class SceneDef {\n    make(graph, root) {\n        if(!root.id) throw new Error(\"can't create scene w/ missing parent\")\n        let title = generateUniqueTitle('Scene ',0,root)\n        return fetchGraphObject(graph,createGraphObjectFromObject(graph,{\n            type:'scene',\n            title:title,\n            autoRecenter:true,\n            defaultFloor: false,\n            parent:root.id,\n            children:graph.createArray()\n        }))\n    }\n    makeNode(obj,provider) {\n        const scene = new Group()\n        scene.name = obj.title\n        this.setDefaultFloor(scene,obj.defaultFloor)\n        scene.start = () => {\n            scene.userData.sceneAnchor = new Group()\n            scene.userData.sceneAnchor.name = \"SceneAnchor\"\n            scene.children.slice().forEach(chNode => {\n                const chObj = provider.accessObject(chNode.userData.graphid)\n                if(!chObj.exists()) return\n                if(isAnchorType(chObj.type)) return\n                if(chObj.type === OBJ_TYPES.geoanchor) return\n                if(chObj.type === OBJ_TYPES.localanchor) return\n                if(chObj.type === OBJ_TYPES.imageanchor) return\n                if(chObj.type === OBJ_TYPES.hudanchor) return\n                scene.userData.sceneAnchor.add(chNode)\n            })\n            scene.add(scene.userData.sceneAnchor)\n        }\n        scene.stop = () => {\n            const toMove = scene.userData.sceneAnchor.children.slice()\n            toMove.forEach(chNode => scene.add(chNode))\n            scene.remove(scene.userData.sceneAnchor)\n        }\n        return scene\n    }\n\n    updateProperty(node, obj, op, provider) {\n        console.log(\"update property\",node.name,op.name,op.value)\n        if(op.name === PROP_DEFS.defaultFloor.key) {\n            console.log('setting the floor too',op.value)\n            this.setDefaultFloor(node,op.value)\n        }\n    }\n\n    setDefaultFloor(scene,val) {\n        if (val === true) {\n            const floor = new Mesh(\n                new PlaneBufferGeometry(100, 100, 10, 10),\n                new MeshLambertMaterial({color: 'blue'})\n            )\n            floor.name = 'defaultFloor'\n            floor.rotation.x = -90 * Math.PI / 180\n            scene.parts = {}\n            scene.parts.floor = floor\n            scene.add(floor)\n        } else {\n            if (scene.parts && scene.parts.floor) {\n                scene.remove(scene.parts.floor)\n                delete scene.parts.floor\n            }\n        }\n    }\n\n    getFloorPart(node) {\n        if(!node) return null\n        if(!node.parts) return null\n        return node.parts.floor\n    }\n\n}\n","import React, {Component} from 'react'\nimport * as ToasterManager from './ToasterManager'\n\nexport class ToasterNotification extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            notification:'saved',\n            visible:false\n        }\n    }\n\n    add = (payload) => {\n        this.setState({notification:payload, visible:true})\n        setTimeout(this.hide,2000)\n    }\n\n    hide = () => this.setState({visible:false})\n\n    componentWillMount() {\n        ToasterManager.onAdd(this.add)\n    }\n    componentWillUnmount() {\n        ToasterManager.offAdd(this.add)\n    }\n\n    render() {\n        return <div style={{\n            position:'absolute',\n            bottom:'10px',\n            left:'10px',\n            backgroundColor:'rgba(0,0,0,0.6)',\n            borderRadius:'1em',\n            color:'white',\n            fontSize:'24pt',\n            padding:'1em',\n            display:this.state.visible?'block':'none'\n        }}>{this.state.notification}</div>\n    }\n}\n","import {TOTAL_OBJ_TYPES} from './Common'\nimport * as THREE from \"three\"\nimport WebLayer3D from 'three-web-layer'\nimport GPUParticles from './defs/GPUParticles'\nimport GLTFLoader from './GLTFLoader'\n\nexport class SceneGraphProvider {\n    //return the current scene. provider is in charge of tracking which scene is considered 'current'\n    //including the default scene when the project loads\n    getCurrentScene() { throw new Error(\"getCurrentScene not implemented\")}\n    getSceneObjects(scene) { throw new Error(\"getSceneObjects not implemented\")}\n    getBehaviorsForObject(obj) { throw new Error(\"getBehaviorsForObject(obj) not implemented\")}\n    //return threejs object for the id of the graph object\n    getThreeObject(id) { throw new Error(\"getThreeObject(id) not implemented\")}\n    getParsedBehaviorAsset(beh) { throw new Error(\"getParsedBehaviorAsset(behavior) not implemented\")}\n    getAllBehaviors() { throw new Error(\"getAllBehaviors() not implemented\")}\n    getAllScenes() { throw new Error(\"getAllScenes not implemented\")}\n\n    //navigate to the specified scene. id is a graph object id\n    navigateScene(id) { throw new Error(\"navigateScene(id) not implemented\")}\n\n    playMediaAsset(id) { throw new Error(\"playMediaAsset(id) not implemented\")}\n    stopMediaAsset(id) { throw new Error(\"stopMediaAsset(id) not implemented\")}\n    getGraphObjectByName(name) { throw new Error(\"getGraphObjectByName(name) not implemented\")}\n    getGraphObjectById(id) { throw new Error(\"getGraphObjectById(id) not implemented\")}\n    getCamera() { throw new Error(\"getCamera() not implemented\")}\n    getTweenManager() { throw new Error(\"getTweenManager() not implemented\")}\n    startLocalAnchor(info) { throw new Error(\"startLocalAnchor not implemented\")}\n    stopLocalAnchor(info) { throw new Error(\"stopLocalAnchor not implemented\")}\n    startImageRecognizer(info) { throw new Error(\"startImageRecognizer not implemented\")}\n    stopImageRecognizer(info) { throw new Error(\"stopImageRecognizer not implemented\")}\n    startGeoTracker(info) { throw new Error(\"startGeoTracker not implemented\")}\n    stopGeoTracker(info) { throw new Error(\"stopGeoTracker not implemented\")}\n    startWorldInfo(info) { throw new Error(\"startWorldInformation not implemented\")}\n    stopWorldInfo(info) { throw new Error(\"stopWorldInformation not implemented\")}\n\n}\n\nclass SystemFacade {\n\n    constructor(manager, sgp, behavior) {\n        this.manager = manager\n        this.sgp = sgp\n        this.logger = this.manager.logger\n        this.tween = sgp.getTweenManager()\n        this.camera = sgp.getCamera()\n        this.globalStorage = this.manager.storage\n        this.behavior = behavior\n    }\n\n    get globals () {\n        return {\n            THREE:THREE,\n            GLTFLoader: GLTFLoader,\n            GPUParticles: GPUParticles,\n            WebLayer3D: WebLayer3D\n        }\n    }\n\n    get properties () {\n        return this.behavior.props()\n    }\n    getThreeObjectByTitle(title) {\n        const obj = this.sgp.getGraphObjectByName(title)\n        if(!obj) throw new Error(`three object '${title}' not found`)\n        return this.sgp.getThreeObject(obj)\n    }\n    getObjectByTitle(title) {\n        const obj = this.sgp.getGraphObjectByName(title)\n        if(!obj || !obj.exists()) throw new Error(`object '${title}' not found`)\n        return obj\n    }\n    getAssetByTitle(title) {\n        const obj = this.sgp.getGraphObjectByName(title)\n        if(!obj || !obj.exists()) throw new Error(`asset '${title}' not found`)\n        let trusted = this._event && this._event.data && this._event.data.event && this._event.data.event.isTrusted\n        return new AssetFacade(this.manager,obj, trusted)\n    }\n    getAssetById(id) {\n        const obj = this.getObjectById(id)\n        if(!obj || !obj.exists()) throw new Error(`asset '${id}' not found`)\n        let trusted = this._event && this._event.data && this._event.data.event && this._event.data.event.isTrusted\n        return new AssetFacade(this.manager,obj,trusted)\n    }\n    getObjectById(id) {\n        const obj = this.sgp.getGraphObjectById(id)\n        if(!obj || !obj.exists()) throw new Error(`object '${id}' not found`)\n        return obj\n    }\n    getThreeObjectById(id) {\n        return this.sgp.getThreeObject(id)\n    }\n    playSound(id) {\n        this.playMedia(id)\n    }\n\n    playMedia(id) {\n        const asset = this.sgp.getGraphObjectById(id)\n        if(!asset || !asset.exists()) throw new Error(`asset '${id}' not found`)\n        let trusted = this._event && this._event.data && this._event.data.event && this._event.data.event.isTrusted\n        this.manager.sgp.playMediaAsset(asset, trusted)\n    }\n\n    stopMedia(id) {\n        const asset = this.sgp.getGraphObjectById(id)\n        if(!asset || !asset.exists()) throw new Error(`asset '${id}' not found`)\n        this.manager.sgp.stopMediaAsset(asset)\n    }\n\n    getCurrentScene() {\n        const obj = this.sgp.getCurrentScene()\n        if(!obj || !obj.exists()) throw new Error(`current scene not found`)\n        return obj\n    }\n    navigateScene(id) {\n        this.manager.fireSceneLifecycleEvent('exit',this.getCurrentScene())\n        this.sgp.navigateScene(id)\n        this.manager.fireSceneLifecycleEvent('enter',this.getCurrentScene())\n    }\n    fireEvent(type,payload,target=null) {\n        // this.manager.fireEventFromTarget(target,type,payload)\n        if (target == null) {\n            target = this.sgp.getGraphObjectById(this.behavior.parent)\n        }\n        this.manager.fireEventAtTarget(target,type,payload)\n    }\n    sendMessage(name,payload,target=null) {\n        if (target == null) {\n            target = this.sgp.getGraphObjectById(this.behavior.parent)\n        }\n        this.manager.fireMessageAtTarget(target,name,payload)\n    }\n    captureEvent() {\n        this.manager.captureEvent()\n    }\n}\n\nexport default class ScriptManager {\n    constructor(sceneGraphProvider, logger) {\n        this.sgp = sceneGraphProvider\n        this.logger = logger\n        this.running = false\n        this.storage = {}\n        this.logger = logger\n        this.logger.log(\"ScriptManager created\")\n        this.system_cache = {}\n\n        this.bubbling = true;\n\n        if (!window.THREE) window.THREE = THREE\n        if (!window.GLTFLoader) window.GLTFLoader = GLTFLoader\n        if (!window.GPUParticles) window.GPUParticles = GPUParticles\n        if (!window.WebLayer3D) window.WebLayer3D = WebLayer3D\n    }\n\n\n    fireLifecycleEvent(type) {\n        this.logger.log(`doing ${type} event`)\n        const evt = {\n            type:type\n        }\n        this.sgp.getAllScenes().forEach(scene => {\n            scene.find(child => {\n                if(child.type === TOTAL_OBJ_TYPES.BEHAVIOR) {\n                    evt.target = this.sgp.getThreeObject(child.parent)\n                    evt.graphTarget = this.sgp.getGraphObjectById(child.parent)\n                    const asset = this.sgp.getParsedBehaviorAsset(child)\n                    const system = this.getSystemFacadeFromCache(child)\n                    system.code = asset\n                    if (asset[type]) asset[type].call(system,evt)\n                } else {\n                    evt.target = this.sgp.getThreeObject(child)\n                    evt.graphTarget = child\n                    if(evt.target && evt.target[type]) evt.target[type](evt, this)\n                }\n            })\n        })\n    }\n\n    fireSceneLifecycleEvent(type, scene, time) {\n        if(type!=='tick') this.logger.log(`doing ${type} event`)\n\n        const evt = {\n            type: type,\n            time: time ? time - this.startTime : -1,\n            deltaTime: time ? time - this.lastTime : 0,\n            session: this.session\n        }\n        if (time) {\n            this.lastTime = time\n        }\n        scene.find(child => {\n            if(type!=='tick') this.logger.log(`calling ${type} on ${child.type} ${child.id}`)\n            if(child.type === TOTAL_OBJ_TYPES.BEHAVIOR) {\n                evt.target = this.sgp.getThreeObject(child.parent)\n                evt.graphTarget = this.sgp.getGraphObjectById(child.parent)\n                //evt.props = child.props()\n                const asset = this.sgp.getParsedBehaviorAsset(child)\n                const system = this.getSystemFacadeFromCache(child)\n                system.code = asset\n                if (asset[type]) asset[type].call(system,evt)\n                // if(asset[type]) asset[type](evt)\n            } else {\n                evt.target = this.sgp.getThreeObject(child)\n                evt.graphTarget = child\n                if(evt.target && evt.target[type]) {\n                    evt.target[type](evt, this)\n                }\n            }\n        })\n    }\n\n    tick(time, session) {\n        if(!this.running) return\n        if(this.startTime ===0) {\n            this.startTime = time\n            this.lastTime = time\n        }\n        try {\n            this.session = session\n            this.fireSceneLifecycleEvent('tick',this.sgp.getCurrentScene(),time)\n        } catch (err) {\n            this.logger.error(\"error in script\",err.message)\n            this.logger.log(err)\n            this.stopRunning()\n        }\n    }\n\n\n    startRunning() {\n        this.running = true\n        this.startTime = 0\n        this.lastTime = 0\n        this.storage = {}\n        this.logger.log(\"ScriptManager starting\")\n        try {\n            this.fireLifecycleEvent('start')\n        } catch(err) {\n            this.logger.error(\"error in script\",err.message)\n            this.logger.error(err)\n            this.stopRunning()\n        }\n    }\n\n    startFirstScene() {\n        try {\n            this.fireSceneLifecycleEvent('enter',this.sgp.getCurrentScene())\n        } catch(err) {\n            this.logger.error(\"error in script\",err.message)\n            this.logger.error(err)\n            this.stopRunning()\n        }\n    }\n    \n\n    stopRunning() {\n        try {\n            this.fireSceneLifecycleEvent('exit',this.sgp.getCurrentScene())\n            this.fireLifecycleEvent('stop')\n            this.running = false\n            this.storage = {}\n            this.destroyListeners()\n        } catch(err) {\n            this.running = false\n            this.logger.error(\"error stopping scripts\",err.message)\n            this.logger.error(err)\n        }\n        this.logger.log(\"script manager stopping\")\n    }\n    isRunning() {\n        return this.running\n    }\n\n    fireMessageAtTarget(target, name, payload) {\n        if(!this.running) return\n        try { \n            const evt = {\n                type: 'message',\n                name: name,\n                data: payload,\n                time: this.lastTime,\n                target: this.sgp.getThreeObject(target),\n                graphTarget: target,\n            }\n            const behaviors = this.sgp.getBehaviorsForObject(target)\n            behaviors.forEach(b => {\n                const system = this.getSystemFacadeFromCache(b)\n                const asset = this.sgp.getParsedBehaviorAsset(b)\n                system._event = evt   // want to be able to look for this later\n                system.code = asset\n                if (asset.message) asset.message.call(system,evt)\n                system._event = null\n            })\n        } catch (error) {\n            this.logger.error(\"error in '\" + name + \"' message\",error.message)\n            this.logger.error(error)\n            this.stopRunning()\n        }\n    }\n\n    performClickAction(target, e) {\n        this.fireEventAtTarget(target, \"click\", {event: e})\n    }\n\n    captureEvent() {\n        this.bubbling = false\n    }\n\n    fireEventAtTarget(target, type, payload) {\n        if(!this.running) return\n        try { \n            this.bubbling = true\n\n            const evt = {\n                type: type,\n                data: payload,\n                time: this.lastTime,\n                target: this.sgp.getThreeObject(target),\n                graphTarget: target,\n            }\n\n            let scene = this.sgp.getCurrentScene()\n            while (this.bubbling && target.id !== scene.id && target.type !== TOTAL_OBJ_TYPES.SCENE) {\n                //console.log(\"getting behaviors for the object\",target)\n                const behaviors = this.sgp.getBehaviorsForObject(target)\n                //this.logger.log(\"firing \" + type + \" at target \" + target.id + \", \" + behaviors.length + \" behaviors\")\n\n                behaviors.forEach(b => {\n                    const system = this.getSystemFacadeFromCache(b)\n                    const asset = this.sgp.getParsedBehaviorAsset(b)\n                    system._event = evt\n                    if (asset[type]) {\n                        system.code = asset\n                        // this.logger.log(\"found message on behavior\")\n                        asset[type].call(system,evt)\n                    } else {\n                        // this.logger.log(\"didn't find message on behavior\")\n                    }\n                    system._event = null\n                })\n                target = this.sgp.getGraphObjectById(target.parent)\n            }\n        } catch (error) {\n            this.logger.error(\"error in '\" + type + \"' event\",error.message)\n            this.logger.error(error)\n            this.stopRunning()\n        }\n    }\n\n    destroyListeners() {\n        this.listeners = {}\n    }\n\n    on(target,type,cb) {\n        if(!this.listeners) this.listeners = {}\n        if(!this.listeners[target.id]) this.listeners[target.id] = {}\n        if(!this.listeners[target.id][type]) this.listeners[target.id][type] = []\n        this.listeners[target.id][type].push(cb)\n    }\n\n    getSystemFacadeFromCache(behavior) {\n        if(!this.system_cache[behavior.id]) {\n            this.system_cache[behavior.id] = new SystemFacade(this, this.sgp, behavior)\n        }\n        return this.system_cache[behavior.id]\n    }\n}\n\n\nclass AssetFacade {\n    constructor(manager,obj, trusted) {\n        this.manager = manager\n        this.obj = obj\n        this.trusted = trusted\n    }\n    play() {\n        this.manager.sgp.playMediaAsset(this.obj, this.trusted)\n    }\n    stop() {\n        this.manager.sgp.stopMediaAsset(this.obj)\n    }\n}\n","import * as THREE from 'three'\n\nclass Tween {\n    constructor() {\n        this.running = false\n    }\n    update(time) {\n        throw new Error(\"update not implemented\")\n    }\n    start() {\n        this.running = true\n    }\n    isAlive() {\n        return this.running\n    }\n    kill() {\n        this.running = false\n    }\n}\n\nclass WaitTween extends Tween {\n    constructor(dur) {\n        super()\n        this.type = 'wait'\n        this.duration = dur\n    }\n    update(time) {\n        time = time/1000\n        if(!this.startTime) this.startTime = time\n        const diff = time - this.startTime\n        let t = diff/this.duration\n        if(t >= 1) {\n            this.running = false\n        }\n    }\n}\n\nclass ActionTween extends Tween {\n    constructor(fn) {\n        super()\n        this.type = 'action'\n        this.fn = fn\n    }\n    start() {\n        const res = this.fn()\n        this.running = false\n        return res\n    }\n}\n\nclass ForeverTween extends Tween {\n    constructor(fn) {\n        super()\n        this.type = 'forever'\n        this.fn = fn\n    }\n    start() {\n        this.running = true\n        this.startTime = Date.now()/1000\n    }\n    update(time) {\n        const diff = time/1000 - this.startTime\n        this.fn(diff)\n    }\n}\n\nexport const PROP_TYPES = {\n    SINGLE:'single',\n    COMPOUND:'compound',\n}\nexport const LERP_TYPES = {\n    LINEAR:'linear',\n    ELASTIC:'elastic'\n}\n\nfunction easeOutElastic(t) {\n    var p = 0.3;\n    return Math.pow(2,-10*t) * Math.sin((t-p/4)*(2*Math.PI)/p) + 1;\n}\nfunction easeLinear(from,to,t) {\n    return (to - from) * t + from\n}\nclass PropTween extends Tween {\n    constructor(opts) {\n        super()\n        this.type = 'prop'\n        this.target = opts.target\n        this.duration = opts.duration\n        if(typeof this.duration === 'undefined') throw new Error(\"duration is missing\")\n        this.property = opts.property\n        if(typeof this.property === 'undefined') throw new Error(\"property is missing\")\n        this.propertyType = opts.propertyType || PROP_TYPES.SINGLE\n        this.from = opts.from\n        this.to = opts.to\n        this.lerp_type = opts.lerpType || LERP_TYPES.LINEAR\n\n        this.loop = opts.loop\n        if(typeof this.loop === 'undefined') this.loop = 1\n        this.loopCount = 0\n        this.reversed = false\n        this.autoReverse = opts.autoReverse\n        if(typeof this.autoReverse === 'undefined') this.autoReverse = false\n    }\n    update(time) {\n        time = time/1000\n        if(!this.startTime) this.startTime = time\n        const diff = time - this.startTime\n\n        let t = diff/this.duration\n        if(t > 1.0) {\n            t = 1.0\n        }\n        this.setPropertyValue(this.from,this.to,t)\n        if(t === 1.0) {\n            this.loopCount++\n            if(this.autoReverse) {\n                this.reversed = !this.reversed\n            }\n            if(this.loop !== -1) {\n                if(this.loopCount >= this.loop) {\n                    this.running = false\n                    return\n                }\n            }\n            this.startTime = time\n        }\n    }\n\n    setPropertyValue(from,to,t,target,name) {\n        if(this.propertyType === PROP_TYPES.SINGLE) {\n            this.target[this.property] = this.lerp(this.from, this.to, this.reversed ? (1 - t) : t)\n        }\n        if(this.propertyType === PROP_TYPES.COMPOUND) {\n            Object.keys(this.from).forEach(name => {\n                this.target[this.property][name] = this.lerp(this.from[name], this.to[name], this.reversed ? (1 - t) : t)\n            })\n        }\n    }\n\n    lerp(from,to,t) {\n        if(this.lerp_type === LERP_TYPES.LINEAR)  return easeLinear(from,to,t)\n        if(this.lerp_type === LERP_TYPES.ELASTIC) return easeLinear(from,to,easeOutElastic(t))\n        console.log(\"invalid LERP_TYPE\")\n        return from\n    }\n}\n\nclass ClipTween extends Tween {\n    constructor(opts) {\n        super()\n        this.type = 'clip'\n        this.target = opts.target\n        this.name = opts.name\n        this.loop = opts.loop\n        this.autoReverse = opts.autoReverse\n        if(typeof this.autoReverse === 'undefined') this.autoReverse = false\n        if(typeof this.loop === 'undefined') this.loop = 1\n        if(typeof this.name === 'undefined') throw new Error(\"name is missing\")\n        this.speed = opts.speed\n        if(typeof this.speed === 'undefined') this.speed = 1\n    }\n    start() {\n        this.running = true\n        this.mixer = new THREE.AnimationMixer(this.target.scene)\n        this.action = this.mixer.clipAction(THREE.AnimationClip.findByName(this.target.animations,this.name))\n        if(this.loop === 1) {\n            this.action.setLoop(THREE.LoopOnce, 1)\n        }\n        if(this.loop === -1) {\n            this.action.setLoop(this.autoReverse?THREE.LoopPingPong:THREE.LoopRepeat, Infinity)\n        }\n        if(this.loop > 1) {\n            this.action.setLoop(THREE.LoopRepeat, this.loop)\n        }\n        this.action.play()\n        this.action.setEffectiveTimeScale(this.speed)\n        this.startTime = Date.now()/1000\n        this.prevTime = this.startTime\n    }\n    update(time) {\n        const diff = time/1000 - this.prevTime\n        this.mixer.update(diff)\n        this.prevTime = time/1000\n    }\n    kill() {\n        this.action.stop()\n        this.running = false\n    }\n}\n\nclass ParallelTween extends Tween {\n    constructor() {\n        super()\n        this.subs = []\n    }\n    and(obj) {\n        if(obj instanceof Tween) {\n            this.subs.push(obj)\n        } else {\n            this.subs.push(new ActionTween(obj))\n        }\n        return this\n    }\n    start() {\n        // console.log(\"starting parallel\")\n        this.running = true\n        this.subs.forEach(s=>s.start())\n        // console.log('started')\n        // console.log(this.subs)\n        return this\n    }\n    update(time) {\n        this.subs.forEach(s => {\n            if(s.isAlive()) s.update(time)\n        })\n    }\n    isAlive() {\n        const first = this.subs.find(s => s.isAlive() === true)\n        // console.log(\"first alive is\",first)\n        return first !== undefined\n    }\n}\n\nclass SequentialTween extends Tween {\n    constructor() {\n        super()\n        this.subs = []\n        this.n = -1\n    }\n    then(obj) {\n        if(obj instanceof Tween) {\n            this.subs.push(obj)\n        } else {\n            this.subs.push(new ActionTween(obj))\n        }\n        return this\n    }\n    wait(dur) {\n        this.subs.push(new WaitTween(dur))\n        return this\n    }\n    start() {\n        this.running = true\n        this._startNext()\n        return this\n    }\n    _startNext() {\n        this.n = this.n + 1\n\n        //if at the end of everything\n        if(this.n > this.subs.length-1) {\n            this.running = false\n            this.n = -1\n            return null\n        }\n\n\n        const cur = this.subs[this.n]\n        const res = cur.start()\n        if(!cur.isAlive()) {\n            if(res) {\n                console.log(\"the next swapped itself\", res)\n                //swap in the result\n                this.subs[this.n] = res\n                //backup\n                this.n = this.n -1\n                //recurse\n                return this._startNext()\n            } else {\n                // console.log(\"the next didn't swap. just move on\")\n                return this._startNext()\n            }\n        }\n        return cur\n    }\n    update(time) {\n        // console.log('updating')\n        const cur = this.subs[this.n]\n        cur.update(time)\n        // console.log(\"updated cur\",cur, cur.isAlive())\n        if(!cur.isAlive()) this._startNext()\n\n    }\n    isAlive() {\n        const first = this.subs.find(s => s.isAlive() === true)\n        // console.log(\"first alive is\",first)\n        // console.log(this.subs)\n        return first !== undefined\n    }\n}\n\nexport class TweenManager {\n    constructor() {\n        this.subs = []\n    }\n    parallel() {\n        const t = new ParallelTween()\n        this.subs.push(t)\n        return t\n    }\n    sequence() {\n        const t =  new SequentialTween()\n        this.subs.push(t)\n        return t\n    }\n    action(fn) {\n        const t = new ActionTween(fn)\n        this.subs.push(t)\n        return t\n    }\n    prop(opts) {\n        const t = new PropTween(opts)\n        this.subs.push(t)\n        return t\n    }\n    isAlive() {\n        return this.subs.find((s => s.isAlive() === true))\n    }\n    update(time) {\n        const now = Date.now()\n        this.subs.forEach(s => {\n            if(s.isAlive()) s.update(now)\n        })\n    }\n    forever(fn) {\n        const t = new ForeverTween(fn)\n        this.subs.push(t)\n        return t\n    }\n    clip(opts) {\n        const t = new ClipTween(opts)\n        this.subs.push(t)\n        return t\n    }\n    wait(dur) {\n        const t = new WaitTween(dur)\n        this.subs.push(t)\n        return t\n    }\n}\n\n/*\n\nconst obj = { x: -1, y: -1, z: 0, w: 0}\n\nconst para = t2.parallel()\n    .and(t2.prop({ target:obj, property:'x', from:10, to:0, duration: 1}))\n    .and(()=>console.log(\"inside the parallel action\"))\n    .start()\n\nconst seq = t2.sequence()\n    .then(()=>console.log(\"first is an action\"))\n    .then(t2.prop({ target:obj, property:'y', from:10, to:0, duration: 1}))\n    .then(()=> console.log(\"inside the sequential action\"))\n    .then(t2.prop({target:obj, property:'y', from:0, to:10, duration:1 }))\n    .then(()=>{\n        console.log(\"done with part 1. calculating part 2\")\n        return t2.prop({target:obj, property:'x', from: 0, to:-8, duration:1})\n    })\n    .then(() => {\n        console.log(\"now we're going to insert a new parallel tween\")\n        return t2.parallel()\n            .and(t2.prop({target:obj, property:'z', from:-1,to:1, duration:1}))\n            .and(t2.prop({target:obj, property:'w', from:-1,to:1, duration:1}))\n    })\n    .start()\n\nfunction update() {\n    console.log(\"tick\")\n    t2.update()\n    console.log(obj)\n    if(t2.isAlive()) {\n        setTimeout(update,250)\n    } else {\n        console.log(\"done with everything. check it out!\")\n        console.log(obj.z === 1)\n    }\n}\nupdate()\n*/\n","import * as THREE from 'three'\n\nimport * as mat4 from 'gl-matrix/src/gl-matrix/mat4'\nimport * as vec3 from 'gl-matrix/src/gl-matrix/vec3'\n\nvar meshMap = new Map()\n\nconst workingMatrix = mat4.create()\nvar savedOrigin = [0,0,0]\nvar savedDirection = [0,0,-1]\nvar reticleParent = null\nvar reticle = null\n            \nvar reticleTrackedColor = new THREE.Color( 0xDDFFDD );\nvar reticleNotTrackedColor = new THREE.Color( 0xFF6666 );\nvar reticleMaterial = new THREE.MeshStandardMaterial({ color: reticleTrackedColor })\nvar requestNextHit = true\nlet singleton = 0\n\nexport class XRWorldInfo extends THREE.Group {\n\n    constructor(engine,logger) {\n\n        super()\n\n        // run as a singleton\n        if(singleton) {\n            logger.error(\"XRWorldInfo called more than once - very bad\")\n            return singleton\n        }\n        singleton = this\n\n        this.engine = engine\n        this.session = engine.session\n        this.logger = logger\n\n        this._floorPos = vec3.create()\n\n        // enable extended world sensing\n        this.session.updateWorldSensingState({\n            illuminationDetectionState : {\n                enabled : true\n            },\n            meshDetectionState : {\n                enabled : true,\n                normals: true\n            }\n        })\n\n        // don't waste time remaking this every frame\n        this._handleHitResults = this.handleHitResults.bind(this)\n\n        // a reticule\n        reticle = new THREE.Mesh( new THREE.RingGeometry(0.04, 0.05, 36, 64), reticleMaterial)\n        reticle.geometry.applyMatrix(new THREE.Matrix4().makeRotationX(THREE.Math.degToRad(-90)))\n        reticleParent = new THREE.Object3D()\n        reticleParent.add(reticle)\n        reticleParent.matrixAutoUpdate = false\n        reticleParent.visible = false\n\n    }\n\n    refreshWorldInfo(frame) {\n\n        if(!this.visible) {\n            return\n        }\n\n        let worldInfo = frame.worldInformation\n        if(!worldInfo || !worldInfo.meshes) {\n            return\n        }\n\n        // mark\n        meshMap.forEach(object => { object.seen = false })\n\n        // update meshes\n        worldInfo.meshes.forEach(worldMesh => {\n            var object = meshMap.get(worldMesh.uid);\n            if (object) {\n                this.handleUpdateNode(worldMesh, object)\n            } else {\n                this.handleNewNode(worldMesh)\n            }\n        })\n\n        // sweep\n        meshMap.forEach(object => { \n            if (!object.seen) {\n                this.handleRemoveNode(object)\n            } \n        })\n\n        // update frame of reference when ready to do so\n        if (requestNextHit) {\n            requestNextHit = false\n            this.session.requestFrameOfReference('head-model').then(headFrameOfReference => {\n                this.session.requestFrameOfReference('eye-level').then((eyeLevelFrameOfReference)=>{\n\n                    // update floor estimation\n                    this.floorUpdate(headFrameOfReference,eyeLevelFrameOfReference)\n\n                    // update reticule\n                    this.session.requestHitTest(savedOrigin, savedDirection, headFrameOfReference)\n                        .then(this._handleHitResults)\n                        .catch(err => {\n                            this.logger.error('Error testing hits', err)\n                        })\n\n                    //(TODO done elsewhere because I am unsure about asyncronity of handleHitResults)\n                    //requestNextHit = true\n                })\n            })\n        }\n    }\n\n    // handle hit testing slightly differently than other samples, since we're doing\n    // it per frame.  The \"boiler plate\" code below is slightly different, setting \n    // requestNextHit on tap instead of executing the hit test.  The custom XREngineHits\n    // does a hit test each frame if the previous one has resolved\n    // TODO unsure why this has to request these frames of reference again\n    handleHitResults(hits) {\n        if (hits && hits.length > 0) {\n            let hit = hits[0]\n            this.session.requestFrameOfReference('head-model').then(headFrameOfReference => {\n                this.session.requestFrameOfReference('eye-level').then((eyeLevelFrameOfReference)=>{\n                    // convert hit matrices from head to eye level coordinate systems\n                    headFrameOfReference.getTransformTo(eyeLevelFrameOfReference, workingMatrix)\n                    mat4.multiply(workingMatrix, workingMatrix, hit.hitMatrix)\n                    const node = reticleParent\n                    node.matrix.fromArray(workingMatrix)\n                    reticleParent.visible = true   // it starts invisible\n                    reticle.material.color = reticleTrackedColor\n                    node.updateMatrixWorld(true)\n                })\n            })\n        } else {\n            reticle.material.color = reticleNotTrackedColor\n        }\n        requestNextHit = true\n    }\n\n    handleUpdateNode(worldMesh, object) {\n        object.seen = true\n        // we don't need to do anything if the timestamp isn't updated\n        if (worldMesh.timeStamp <= object.ts) {\n            return;\n        }\n        if (worldMesh.vertexCountChanged) {\n            let newMesh = this.newMeshNode(worldMesh)\n            object.threeMesh.geometry.dispose()\n            object.node.remove(object.threeMesh)\n            object.node.add(newMesh)\n            object.threeMesh = newMesh\n        } else {\n            if (worldMesh.vertexPositionsChanged) {\n                let position = object.threeMesh.geometry.attributes.position\n                if (position.array.length != worldMesh.vertexPositions.length) {\n                    this.logger.error(\"position and vertex arrays are different sizes\", position, worldMesh)\n                }\n                position.setArray(worldMesh.vertexPositions);\n                position.needsUpdate = true;\n            }\n            if (worldMesh.textureCoordinatesChanged) {\n                let uv = object.threeMesh.geometry.attributes.uv\n                if (uv.array.length != worldMesh.textureCoordinates.length) {\n                    this.logger.error(\"uv and vertex arrays are different sizes\", uv, worldMesh)\n                }\n                uv.setArray(worldMesh.textureCoordinates);\n                uv.needsUpdate = true;\n            }\n            if (worldMesh.triangleIndicesChanged) {\n                let index = object.threeMesh.geometry.index\n                if (index.array.length != worldMesh.triangleIndices) {\n                    this.logger.error(\"uv and vertex arrays are different sizes\", index, worldMesh)\n                }\n                index.setArray(worldMesh.triangleIndices);\n                index.needsUpdate = true;\n            }\n            if (worldMesh.vertexNormalsChanged && worldMesh.vertexNormals.length > 0) {\n                // normals are optional\n                let normals = object.threeMesh.geometry.attributes.normals\n                if (normals.array.length != worldMesh.vertexNormals) {\n                    this.logger.error(\"uv and vertex arrays are different sizes\", normals, worldMesh)\n                }\n                normals.setArray(worldMesh.vertexNormals);\n                normals.needsUpdate = true;\n            }\n        }\n    }\n\n    handleRemoveNode(object) {\n        this.remove(object.node)\n        object.threeMesh.geometry.dispose()\n        this.engine._removeAnchorForNode(object.node,this.logger)\n        meshMap.delete(object.worldMesh.uid)\n    }\n\n    handleNewNode(worldMesh) {\n        let worldMeshGroup = new THREE.Group();\n        var mesh = this.newMeshNode(worldMesh)\n        worldMeshGroup.add(mesh)\n        this.add(worldMeshGroup)\n        this.engine.addAnchoredNode(worldMesh, worldMeshGroup,this.logger)\n        meshMap.set(worldMesh.uid, {\n            ts: worldMesh.timeStamp, \n            worldMesh: worldMesh, \n            node: worldMeshGroup, \n            seen: true, \n            threeMesh: mesh\n        })\n    }\n\n    newMeshNode(worldMesh) {\n        let edgeColor, polyColor\n//        if (worldMesh instanceof XRFaceMesh) {\n//            edgeColor = '#999999'\n//           polyColor = '#999900'\n//        } else\n        {\n            edgeColor = '#11FF11'\n            polyColor = '#009900'\n        }\n        let mesh = new THREE.Group();\n        let geometry = new THREE.BufferGeometry()\n        let indices = new THREE.BufferAttribute(worldMesh.triangleIndices, 1)\n        indices.dynamic = true\n        geometry.setIndex(indices)\n\n        let verticesBufferAttribute = new THREE.BufferAttribute( worldMesh.vertexPositions, 3 )\n        verticesBufferAttribute.dynamic = true\n        geometry.addAttribute( 'position', verticesBufferAttribute );\n        let uvBufferAttribute = new THREE.BufferAttribute( worldMesh.textureCoordinates, 2 )\n        uvBufferAttribute.dynamic = true\n        geometry.addAttribute( 'uv', uvBufferAttribute );\n        if (worldMesh.vertexNormals.length > 0) {\n            let normalsBufferAttribute = new THREE.BufferAttribute( worldMesh.vertexNormals, 3 )\n            normalsBufferAttribute.dynamic = true\n            geometry.addAttribute( 'normal', normalsBufferAttribute );\n        } else {\n            geometry.computeVertexNormals()\n        }\n        // transparent mesh\n        var wireMaterial = new THREE.MeshPhongMaterial({color: edgeColor, wireframe: true})\n        var material = new THREE.MeshPhongMaterial({color: polyColor, transparent: true, opacity: 0.25})\n        mesh.add(new THREE.Mesh(geometry, material))\n        mesh.add(new THREE.Mesh(geometry, wireMaterial))\n        mesh.geometry = geometry;  // for later use\n        //worldMesh.mesh = mesh;\n        return mesh\n    }\n\n    floorUpdate(headLevel,eyeLevel) {\n\n        // how close does a floor mesh extent need to be to the player to be a candidate?\n        let playerRadiusSq=3*3\n\n        // how far below a player does a floor mesh need to be to be a candidate?\n        let playerTop=-0.5\n\n        // how far below a player does a floor mesh need to be to be rejected as a candidate?\n        let playerBottom=-2\n\n        // scratch variables\n        let playerPos = vec3.create()\n        let meshPos = vec3.create()\n        let bestPos = vec3.create()\n        let bestY = 0\n\n        // get player position\n        headLevel.getTransformTo(eyeLevel, workingMatrix)\n        mat4.getTranslation(playerPos, workingMatrix)\n\n        // visit all candidate meshes\n        meshMap.forEach(object => {\n\n            let worldMesh = object.worldMesh\n\n            // skip non horizontal features\n            //if(worldMesh.alignment()) return\n\n            // where is mesh center point in world coords?\n            vec3.set(meshPos, worldMesh._center.x, worldMesh._center.y, worldMesh._center.z)\n            vec3.transformMat4(meshPos,meshPos,worldMesh.modelMatrix)\n\n            // an ideally negative number expressing the distance below the player Y\n            let distanceY = meshPos[1] - playerPos[1]\n\n            // candidate mesh is vertically to high?\n            if(distanceY > playerTop) return\n\n            // candidate mesh is vertically too low?\n            if(distanceY < playerBottom) return\n\n            // how far is a rough mesh extent from player in 2d in distance squared?\n            let distSq = (playerPos[0]-meshPos[0])*(playerPos[0]-meshPos[0])\n                       + (playerPos[2]-meshPos[2])*(playerPos[2]-meshPos[2])\n                       - worldMesh._extent[0] * worldMesh._extent[0]\n                       - worldMesh._extent[1] * worldMesh._extent[1]\n                       - playerRadiusSq;\n\n            // is too far away to be of interest?\n            if(distSq > 0) return\n\n            // distanceY fails to be the lowest acceptable candidate?\n            if(bestY < distanceY) return\n\n            // remember lowest area so far\n            bestY = distanceY\n            vec3.set(bestPos,playerPos[0],meshPos[1],playerPos[2])\n\n        })\n\n        // no new results? stick with previous state\n        if(!bestY) return\n\n        // insignificant change? stick with previous state\n        if( vec3.squaredDistance(bestPos,this._floorPos) < 0.01) return\n\n        // throw away old floor anchor and make a new one\n        vec3.copy(this._floorPos,bestPos)\n        mat4.fromTranslation(workingMatrix, this._floorPos)\n\n        // debug\n        this.logger.log(\"************** floor is at \" + this._floorPos[1] )\n\n    }\n\n    get floorPos() {\n        return this._floorPos\n    }\n\n}\n\n","import {toFlatString} from '../utils'\nimport * as ToasterManager from './ToasterManager'\nimport * as mat4 from 'gl-matrix/src/gl-matrix/mat4'\nimport * as vec3 from 'gl-matrix/src/gl-matrix/vec3'\n\nimport {XRWorldInfo} from './XRWorldInfo'\n\nlet Cesium = window.Cesium\nlet XRGeospatialAnchor = window.XRGeospatialAnchor\n\n\nexport class XRSupport {\n    constructor() {\n        this.imageDetectorMap = {}\n        this.geoAnchorMap = {}\n        this._workingMatrix = mat4.create()\n        this._identity = mat4.create()\n        this._vec = vec3.create()\n        this.lastFrameTime = 0\n        this.worldInfo = 0\n        \n        this.heightAboveFloor = 1.1; // for now\n    }\n    static supportsARKit() {\n        if (navigator.xr && navigator.xr._mozillaXRViewer) {\n            console.log(\"*** Found mozilla xr viewer\")\n            return true\n        }\n        console.log(\"*** Did not find WebXR\")\n        return false\n    }\n\n    getContext(canvas = 0) {\n        this.device = 0\n        this.session = 0\n        this.xrCanvas = 0\n        this.xrContext = 0\n        this.canvas = canvas\n        this.context = 0\n        this.xrCanvas = document.createElement('canvas')\n        this.xrContext = this.xrCanvas.getContext('xrpresent')\n        this._anchoredNodes = new Map() // { XRAnchorOffset, Three.js Object3D }\n        this.projectionMatrix = 0\n\n        let that = this\n        let prom = new Promise((resolve, reject) => {\n            // document.body.insertBefore(this.xrCanvas, document.body.firstChild) <- not needed?\n            navigator.xr.requestDevice().then((xrDevice) => {\n                that.device = xrDevice\n                that.device.requestSession({\n                    outputContext: that.xrContext,\n                    alignEUS: true,\n                    geolocation: true,\n                    worldSensing: true\n                }).then((xrSession) => {\n                    that.session = xrSession\n\n                    // we want to always use the estimated elevation\n                    XRGeospatialAnchor.useEstimatedElevation(true, this.heightAboveFloor)\n                    this.updateGeoElevationLoop()\n\n                    // enable smooth tracking of image targets\n                    that.session.nonStandard_setNumberOfTrackedImages(4)\n\n                    if (!that.canvas) that.canvas = document.createElement('canvas')\n                    if (!that.context) that.context = that.canvas.getContext('webgl', {compatibleXRDevice: that.device})\n                    that.session.baseLayer = new window.XRWebGLLayer(that.session, that.context)\n                    resolve(that.context)\n                }).catch(err => {\n                    console.error('Session setup error', err)\n                    reject()\n                })\n            }).catch(err => {\n                console.error('Error', err)\n                reject()\n            })\n        })\n        return prom\n    }\n\n    async updateGeoElevationLoop () {\n        let sleep = function (time) {\n            return new Promise((resolve) => setTimeout(resolve, time));\n        }\n    \n        //let deviceCarto = await XRGeospatialAnchor.getDeviceCartographic()\n        //let txt = textBox.myText + \"<p>device altitude \" + deviceCarto.height.toPrecision(6) + \"</p>\" \n        //let defElev = await XRGeospatialAnchor.getDefaultElevation(deviceCarto)\n        //txt = txt + textBox.myText + \"<p>estimated altitude \" + defElev.toPrecision(6) + \"</p>\"\n        //textBox.innerHTML = txt \n\n        await XRGeospatialAnchor.useEstimatedElevation(true, this.heightAboveFloor)\n\n        await sleep(100)\n        setTimeout(() => this.updateGeoElevationLoop(), 1)\n    }\n\n    setAnimationLoop(userAnimationCallback) {\n\n        if (!userAnimationCallback) {\n            console.error(\"Supply a callback\")\n            return\n        }\n\n        // head-model is the coordinate system that tracks the position of the display\n        this.session.requestFrameOfReference('head-model').then(frameOfReference => {\n            this.headFrameOfReference = frameOfReference\n        }).catch(err => {\n            console.error('Error finding head frame of reference', err)\n        })\n\n        // get eye level which is somehow different from head level?\n        this.session.requestFrameOfReference('eye-level').then(frameOfReference => {\n            this.eyeLevelFrameOfReference = frameOfReference\n        }).catch(err => {\n            console.error('Error finding eye frame of reference', err)\n        })\n\n        // setup callback\n        this.userAnimationCallback = userAnimationCallback\n        this.__handleAnimationFrame = this._handleAnimationFrame.bind(this)\n        this.session.requestAnimationFrame(this.__handleAnimationFrame)\n    }\n\n    _handleAnimationFrame(time = 0, frame = 0) {\n        this.lastFrameTime = time\n        if (!this.session || this.session.ended) return\n\n        this.session.requestAnimationFrame(this.__handleAnimationFrame)\n\n        if (!this.headFrameOfReference || !this.eyeLevelFrameOfReference) return\n\n        let pose = frame.getDevicePose(this.eyeLevelFrameOfReference)\n        if (!pose) {\n            console.log('No pose')\n            return\n        }\n\n        for (let view of frame.views) {\n            // paint world info in a special way for now\n            if(this.worldInfo && this.worldInfo.visible) {\n                this.worldInfo.refreshWorldInfo(frame)\n            }\n            // let higher level update itself\n            this.userAnimationCallback(\n                this.session.baseLayer.getViewport(view),\n                view.projectionMatrix,\n                pose.getViewMatrix(view),\n                time,frame,\n            )\n            this.projectionMatrix = view.projectionMatrix\n            break\n        }\n    }\n\n    getTime() { return this.lastFrameTime }\n\n    addAnchoredNode(anchor, node, logger) {\n        if (!anchor || !anchor.uid) {\n            console.error(\"not a valid anchor\", anchor)\n            logger.error(`not a valid anchor ${toFlatString(anchor)}`)\n            return\n        }\n        this._anchoredNodes.set(anchor.uid, {\n            anchor: anchor,\n            node: node\n        })\n        node.anchor = anchor\n        node.matrixAutoUpdate = false\n        node.matrix.fromArray(anchor.modelMatrix)\n        node.updateMatrixWorld(true)\n        //this._scene.add(node) -> presumably this is already done\n\n        anchor._handleAnchorUpdateCallback = this._handleAnchorUpdate.bind(this, logger)\n        anchor._handleAnchorDeleteCallback = this._handleAnchorDelete.bind(this, logger)\n\n        anchor.addEventListener(\"update\", anchor._handleAnchorUpdateCallback)\n        anchor.addEventListener(\"removed\", anchor._handleAnchorDeleteCallback)\n        logger.log(\"done adding anchored node\")\n        return node\n    }\n\n    async createSceneAnchor(sceneNode, logger) {\n        logger.log(\"Creating Scene Anchor\")\n\n        if (!this.session) {\n            logger.log(\"no session\")\n            return\n        }\n        let eyeLevel = await this.session.requestFrameOfReference('eye-level')\n        let headLevel = await this.session.requestFrameOfReference('head-model')\n\n        // get the pose of the camera in the world\n        headLevel.getTransformTo(eyeLevel, this._workingMatrix)\n\n        // get just the position\n        mat4.getTranslation(this._vec, this._workingMatrix) \n\n        // set the matrix to just the position, which means the orientation is EUS\n        mat4.fromTranslation(this._workingMatrix, this._vec)\n\n        // create that anchor\n        let newAnchor = await this.session.addAnchor(this._workingMatrix, eyeLevel)\n\n        this.addAnchoredNode(newAnchor, sceneNode, logger)\n        return newAnchor\n    }\n\n    updateAnchoredSceneNode(sceneAnchor, sceneNode, logger) {\n        logger.log(\"Replacing the scene node on the existing scene anchor\")\n        this._removeAnchorFromNode(sceneAnchor)\n        this.addAnchoredNode(sceneAnchor, sceneNode, logger)\n    }\n\n    removeSceneAnchor(sceneAnchor, logger) {\n        logger.log(\"Removing Scene Anchor\")\n        this.session.removeAnchor(sceneAnchor)\n        this._removeAnchorFromNode(sceneAnchor)\n    }\n\n    createLocalAnchorFromHitTest(info,x,y,logger) {\n\n        // TODO\n        // Right now this gets attached right away and will always fail because there is no ground detected that early\n        // However, users can call it again and then have it corrected - it should delete the previous anchor if any\n        // Philosophically I'd prefer a concept of dynamically creating nodes on the scene graph\n        //\n\n        if(!this.session) {\n            logger.error(\"no session\")\n            return\n        }\n        if(!this.projectionMatrix) {\n            logger.error(\"No projection matrix\")\n            return\n        }\n        if(!this.canvas || !this.canvas.width || !this.canvas.height) {\n            logger.error(\"No canvas or canvas size\")\n            return\n        }\n        if (!info.node) {\n            logger.error(\"missing threejs node\")\n            return\n        }\n\n        // normalize screen coords\n        let normalizedX = x / this.canvas.width * 2 - 1;\n        let normalizedY = x / this.canvas.height * 2;\n\n        // get a ray\n        var rayorigin = vec3.create();\n        mat4.invert(this._workingMatrix, this.projectionMatrix );\n        var raydir = vec3.fromValues(normalizedX, normalizedY, 0.5);\n        vec3.transformMat4(raydir,raydir,this._workingMatrix);\n        vec3.normalize(raydir, raydir);\n\n        this.session.requestFrameOfReference('head-model').then((headLevel)=>{\n            this.session.requestFrameOfReference('eye-level').then((eyeLevel)=>{\n\n                // get collidants\n                this.session.requestHitTest(rayorigin, raydir, headLevel ).then((xrhitresults)=>{\n\n                    if (xrhitresults.length < 1) {\n                        logger.error(\"No hit returned from hit test\")\n                        return\n                    }\n\n                    this.session.addAnchor(xrhitresults[0], headLevel ).then((newAnchor)=> {\n\n                        // remove previous if any\n                        this._removeAnchorForNode(info.node)\n                 \n                        // add new\n                        this.addAnchoredNode(newAnchor,info.node,logger)\n\n                        logger.log(\"made anchor in local coords: \" + info.node.position.x + \" \" + info.node.position.y + \" \" + info.node.position.z )\n                    })\n                })\n            })\n        })\n    }\n\n    createFloorAnchorFromHitTest(info,x,y,logger) {\n\n        logger.log(\"trying to make floor anchor at \" + x + \" \" + y)\n\n        // TODO\n        // Right now this gets attached right away and will always fail because there is no ground detected that early\n        // However, users can call it again and then have it corrected - it should delete the previous anchor if any\n        // Philosophically I'd prefer a concept of dynamically creating nodes on the scene graph\n        //\n\n        if(!this.worldInfo) {\n            logger.error(\"no world info\")\n            return\n        }\n\n        if(!this.session) {\n            logger.error(\"no session\")\n            return\n        }\n        if(!this.projectionMatrix) {\n            logger.error(\"No projection matrix\")\n            return\n        }\n        if(!this.canvas || !this.canvas.width || !this.canvas.height) {\n            logger.error(\"No canvas or canvas size\")\n            return\n        }\n        if (!info.node) {\n            logger.error(\"missing threejs node\")\n            return\n        }\n\n        let floorPos = this.worldInfo.floorPos\n\n        // compute a ray intersection with the floor elevation of an infinite plane\n        // (actually for now, just use a point directly beneath player)\n\n        // var rayorigin = vec3.create();\n        // mat4.invert(this._workingMatrix, this.projectionMatrix );\n        // var raydir = vec3.fromValues(normalizedX, normalizedY, 0.5);\n        // vec3.transformMat4(raydir,raydir,this._workingMatrix);\n        // vec3.normalize(raydir, raydir);\n        // TODO compute plane intersection\n\n        // get coordinate system\n        this.session.requestFrameOfReference('head-model').then((headLevel)=>{\n            this.session.requestFrameOfReference('eye-level').then((eyeLevel)=>{\n                headLevel.getTransformTo(eyeLevel, this._workingMatrix)\n                mat4.fromTranslation(this._workingMatrix,this.worldInfo.floorPos)\n                this.session.addAnchor(this._workingMatrix,eyeLevel).then((newAnchor)=>{\n                    // remove previous if any\n                    this._removeAnchorForNode(info.node)\n             \n                    // add new\n                    this.addAnchoredNode(newAnchor,info.node,logger)\n\n                    // done\n                    logger.log(\"made floor anchor\" )\n                })\n            })\n        })\n    }\n\n    stopLocalAnchor(info, logger) {\n        console.log(\"Stopping local anchor\")\n        if(!this._anchoredNodes) return\n\n        if (!info.node) {\n            logger.error(\"missing threejs node\")\n            return\n        }\n\n        this._removeAnchorFromNode(info.node)\n    }\n\n    sleeper(time) {\n        return new Promise((resolve) => setTimeout(resolve, time))\n    }\n\n    _fetchImage(info,logger) {\n        return new Promise((res,rej) => {\n            const img = new Image()\n            img.crossOrigin = \"Anonymous\"\n            img.src = info.image.src\n            logger.log(\"Loading image\",img.src)\n            img.onload = () => {\n                res(img)\n            }\n        })\n    }\n\n    createDetectionImage(info, logger) {\n        logger.log(\"creating/find an image recognizer\")\n        return new Promise((res,rej) => {            \n            if (!info.image || !info.node) {\n                logger.log(\"createDetectionImage: missing image or threejs node\")\n                rej(\"createDetectionImage: missing image or threejs node\")\n                return\n            }\n\n            if (!this.session) {\n                logger.log(\"no session\")\n                rej(\"no session\")\n                return\n            }\n\n            let imageRealworldWidth = info.imageRealworldWidth || 1\n\n            if (this.imageDetectorMap[info.image.src]) {\n                let det = this.imageDetectorMap[info.image.src]\n                if (imageRealworldWidth != det.realWorldWidth) {\n                    logger.log(\"can't create the same image with different real world width\")\n                    rej(\"can't create the same image with different real world width\")\n                    return\n                }\n                logger.log(\"createDetectionImage: already created, returning it\")\n                res(det.name)\n                return\n            }\n\n            this._fetchImage(info,logger).then(image => {\n                logger.log(\"got the image\",toFlatString(image))\n    \n                //info contains\n                // * callback: to call when the image is found\n                // * image: info about the image to recognize. src is at image.src\n                // * imageRealworldWidth: width of the image in meters\n                // * object: the anchor object\n                // * node: the ThreeJS group which represents the anchor. It should be updated as the scene changes\n                // * recType: current set to SCENE_START, meaning we should recognize as soon as the scene starts up\n    \n        \n                // random name from https://gist.github.com/6174/6062387\n                let name = [...Array(10)].map(i => (~~(Math.random() * 36)).toString(36)).join('')\n        \n                // Get ImageData\n                let canvas = document.createElement('canvas')\n                let context = canvas.getContext('2d')\n                canvas.width = image.width\n                canvas.height = image.height\n        \n                context.drawImage(image, 0, 0)\n                let idata\n                try {\n                    idata = context.getImageData(0, 0, image.width, image.height)\n                } catch (e) {\n                    logger.log(`error drawing image ${toFlatString(e)}`)\n                    logger.log(`name ${e.name}`)\n                    logger.log(`name ${e.message}`)\n                    logger.log(\"local url is \" + document.documentURI)\n                    logger.log(\"image url from \" + image.src)\n                    ToasterManager.add(\"error drawing image\", e.toString())\n                    rej( new Error(\"foo\"))\n                }\n                logger.log(`calling createDetectionImage with image width and height ${image.width} ${image.height}`)\n        \n                // Attach image observer handler\n                this.session.nonStandard_createDetectionImage(name, idata.data, image.width, image.height, imageRealworldWidth).then(() => {\n                    this.imageDetectorMap[info.image.src] = {\n                        name: name,\n                        realWorldWidth: imageRealworldWidth,\n                        anchor: null\n                    }\n                    res(name)\n                }).catch(error => {\n                    logger.error(`error creating detection image: ${error}`)\n                    rej(error)\n                })\n            }).catch(error => {\n                logger.error(`error creating detection image: ${error}`)\n                rej(error)\n            })\n        })\n    }\n\n    startImageRecognizer(info, name, logger) {\n        logger.log(\"starting Image Recognizer\")\n\n        if (!info.image || !info.node) {\n            logger.log(\"missing image or threejs node\")\n            return\n        }\n\n        if (!this.session) {\n            logger.log(\"no session\")\n            return\n        }\n\n        //info contains\n        // * callback: to call when the image is found\n        // * image: info about the image to recognize. src is at image.src\n        // * imageRealworldWidth: width of the image in meters\n        // * object: the anchor object\n        // * node: the ThreeJS group which represents the anchor. It should be updated as the scene changes\n        // * recType: current set to SCENE_START, meaning we should recognize as soon as the scene starts up\n\n        let callback = info.callback\n\n        let node = info.node\n        //let recType = 0 // unused. currently set to SCENE_START -> meaning we should recognize as soon as the scene starts up\n\n        if (!this.imageDetectorMap[info.image.src]) {\n            logger.error(\"not detection object for image\", info.image.src)\n            return\n        }\n\n        let det = this.imageDetectorMap[info.image.src]\n\n        // there is already an anchor tracking this image, either from this\n        // scene or another\n        if (det.anchor) {\n            if (info.reactivate) {\n                logger.log(\"Found existing anchor: reactivate\")\n                // we want to reactivate.  So destroy the anchor, remove it from\n                // the node it was tracking, and continue below to reactivate\n                this.session.removeAnchor(det.anchor)\n                logger.log(\"remove from previous node\")\n                this._removeAnchorFromNode(det.anchor)\n                det.anchor = null\n            } else {\n                logger.log(\"Found existing anchor: use it\")\n                // we want to reuse, likely from some previous scene.\n                // So, remove the relationship to whatever node is in the \n                // anchor map, and reset it to this node.   \n                logger.log(\"remove from previous node\")\n                this._removeAnchorFromNode(det.anchor)\n                logger.log(\"add our node\")\n                this.addAnchoredNode(det.anchor, node, logger)\n                if (callback) {\n                    callback(info)\n                }\n                return\n            }\n        } \n\n        node.anchorName = null\n        logger.log(\"activate detection image\")\n        this.session.nonStandard_activateDetectionImage(det.name).then(anchor => {\n            logger.log(\"found detection image\")\n            // this gets invoked after the image is seen for the first time\n            node.anchorName = name\n            node.anchorStyle = \"image\"\n            this.addAnchoredNode(anchor, node, logger)\n            if (callback) {\n                callback(info)\n            }\n        }).catch(error => {\n            logger.error(`error activating detection image: ${error}`)\n        })\n    }\n\n    stopImageRecognizer(info, logger) {\n        console.log(\"Stopping image recognizer\")\n        if(!this._anchoredNodes) return\n\n        if (!this.imageDetectorMap[info.image.src]) {\n            logger.error(\"no detection object for image\", info.image.src)\n            return\n        }\n\n        let det = this.imageDetectorMap[info.image.src]\n\n        if (det.anchor) {\n            console.log(\"already found the image, removing it\")\n            this._removeAnchorFromNode(det.anchor)\n            det.anchor = null\n        }\n\n        console.log(\"deactivating the image\")\n        this.session.nonStandard_deactivateDetectionImage(det.name).then(() => {\n        }).catch(error => {\n            logger.error(`error deactivating detection image: ${error}`)\n        })\n    }\n\n\n    createGeoAnchor(info, logger) {        \n        logger.log(\"creating or reusing a geospatial anchor\")\n        return new Promise((res,rej) => {            \n            if (!info.node) {\n                logger.log(\"Missing threejs node\")\n                rej(\"Missing threejs node\")\n                return\n            }\n\n            if (!this.session) {\n                logger.log(\"no session\")\n                rej(\"no session\")\n                return\n            }\n\n            if (this.geoAnchorMap[info.location.id]) {\n                //let det = this.geoAnchorMap[info.location.id]\n                logger.log(\"found geoanchor: already created, returning it\")\n                res()\n                return\n            }\n\n            /*\n            info contains\n            location:  a geo location asset, has properties for latitude, longitude, altitude, useAltitude\n            recType: the recognition type. for now always SCENE_START\n            object: the anchor object. It reresents the anchor in the 3D scene. has tx,ty,tz, rotation, etc.\n            node: the actual ThreeJS object that mirrors the propertites of the `object` above\n            callback: a function to be called once the geo anchor is recognized. By default this callback will fire a 'recognized' event and make the anchor visible in the scene\n            */\n\n            let location = info.location\n            //let object = info.object // object that represents anchor variables that users can edit in general-editor\n            //let node = info.node\n            //let recType = 0 // unused. currently set to SCENE_START -> meaning we should recognize as soon as the scene starts up\n\n            // As a slight hack, look for any non zero value in latitude or longitude as a hint to not use your current location\n\n            // these values are 0 by default, we need to change at least one of them by a bit!\n            if (location.latitude != 0 || location.longitude != 0) {\n                // use supplied altitude?\n\n                let lla = new Cesium.Cartographic(location.longitude * Math.PI / 180, location.latitude * Math.PI / 180, location.altitude)\n\n                if (location.useAltitude) {\n                    logger.log(\"XRGeoAnchor: Placing an object at specified lla and specified altitude\")\n                    logger.log(toFlatString(lla))\n                    XRGeospatialAnchor.createGeoAnchor(lla).then(anchor => {\n                        this.geoAnchorMap[info.location.id] = {\n                            anchor: anchor\n                        }\n                        res()\n                        return;\n                    }).catch(error => {\n                        logger.error(`error creating geospatial anchor: ${error}`)\n                        rej(error)\n                    })\n                } else {\n                    XRGeospatialAnchor.getDefaultElevation(lla).then(altitude => {\n                        lla.height = altitude\n                        logger.log(\"XRGeoAnchor: Placing an object at specified lla and estimated altitude\")\n                        logger.log(toFlatString(lla))\n                        XRGeospatialAnchor.createGeoAnchor(lla).then(anchor => {\n                            this.geoAnchorMap[info.location.id] = {\n                                anchor: anchor\n                            }\n                            res()\n                            return;\n                        }).catch(error => {\n                            logger.error(`error creating geospatial anchor: ${error}`)\n                            rej(error)\n                        })\n                    }).catch(error => {\n                        logger.error(`error getting default elevation: ${error}`)\n                        rej(error)\n                    })\n                }\n            }\n\n            // else find current position and altitude\n            else {\n                XRGeospatialAnchor.getDeviceCartographic().then(cartographic => {\n                    // probably don't need to explicitly do this, but to be safe ...\n                    XRGeospatialAnchor.getDefaultElevation().then(altitude => {\n                        let lla = new Cesium.Cartographic(cartographic.longitude, cartographic.latitude, altitude)\n                        logger.log(\"XRGeoAnchor: Placing an object at your lla\")\n                        logger.log(toFlatString(lla))\n                        XRGeospatialAnchor.createGeoAnchor(lla).then(anchor => {\n                            this.geoAnchorMap[info.location.id] = {\n                                anchor: anchor\n                            }\n                            res()\n                            return;\n                        }).catch(error => {\n                            logger.error(`error creating geospatial anchor: ${error}`)\n                            rej(error)\n                        })\n                    }).catch(error => {\n                        logger.error(`error getting default elevation: ${error}`)\n                        rej(error)\n                    })\n                }).catch(error => {\n                    logger.error(`error getting device cartographic location: ${error}`)\n                    rej(error)\n                })\n            }\n        })\n    }\n\n\n    addGeoAnchoredNode(info, logger) {\n        logger.log(\"adding a geotracked node\")\n\n        if (!info.node) {\n            logger.log(\"Missing threejs node\")\n            return\n        }\n\n        if (!this.session) {\n            logger.log(\"no session\")\n            return\n        }\n\n        if (!this.geoAnchorMap[info.location.id]) {\n            logger.error(\"not geolocation anchor for object\", info.location.id)\n            return\n        }\n\n        let det = this.geoAnchorMap[info.location.id]\n\n        /*\n        info contains\n         location:  a geo location asset, has properties for latitude, longitude, altitude, useAltitude\n         recType: the recognition type. for now always SCENE_START\n         object: the anchor object. It reresents the anchor in the 3D scene. has tx,ty,tz, rotation, etc.\n         node: the actual ThreeJS object that mirrors the propertites of the `object` above\n         callback: a function to be called once the geo anchor is recognized. By default this callback will fire a 'recognized' event and make the anchor visible in the scene\n         */\n\n        let callback = info.callback\n        let node = info.node\n        //let recType = 0 // unused. currently set to SCENE_START -> meaning we should recognize as soon as the scene starts up\n\n\n        this._removeAnchorFromNode(det.anchor)\n        logger.log(\"add our node\")\n        this.addAnchoredNode(det.anchor, node, logger)\n        if (callback) {\n            callback(info)\n        }\n    }\n\n    /// BLAIR:  Need a way to destroy geo Anchors!\n    stopGeoTracker(info, logger) {\n        // info.node may be destroyed before we get here\n        if (info && info.node) {\n            this._removeAnchorForNode(info.node)\n        }\n    }\n\n    _handleAnchorDelete(logger, details) {\n        logger.log(\"delete anchor\")\n        let anchor = details.source\n        this._removeAnchorFromNode(anchor)\n    }\n\n    _removeAnchorForNode(node) {\n        this._anchoredNodes.forEach( (value) => {\n            if(value.node == node) {\n                this._removeAnchorFromNode(node.anchor)\n                return\n            }\n        })\n    }\n\n    _removeAnchorFromNode(anchor) {\n        const anchoredNode = this._anchoredNodes.get(anchor.uid)\n        if (anchoredNode) {\n            const node = anchoredNode.node\n            node.anchor = null\n\n            anchor.removeEventListener(\"update\", anchor._handleAnchorUpdateCallback)\n            anchor.removeEventListener(\"removed\", anchor._handleAnchorDeleteCallback)\n            anchor._handleAnchorUpdateCallback = null\n            anchor._handleAnchorDeleteCallback = null\n\n            // NOTIFY SOMEBODY? TODO\n            this._anchoredNodes.delete(anchor.uid)\n        }\n    }\n\n    _handleAnchorUpdate(logger, details) {\n        // logger.log(\"anchor update\")\n        const anchor = details.source\n        const anchoredNode = this._anchoredNodes.get(anchor.uid)\n        if (anchoredNode) {\n            const node = anchoredNode.node\n            node.matrixAutoUpdate = false\n            node.matrix.fromArray(anchor.modelMatrix)\n            node.updateMatrixWorld(true)\n        }\n    }\n\n    startWorldInfo(logger) {\n        // make if needed\n        if(!this.worldInfo) {\n            this.worldInfo = new XRWorldInfo(this,logger)\n        }\n        // visible = true determines if the world info is updated\n        this.worldInfo.visible = true\n        // return as a threejs group to caller\n        return this.worldInfo\n    }\n\n    stopWorldInfo() {\n        if(this.worldInfo) {\n            // stop but do not delete\n            this.worldInfo.visible = false\n        }\n    }\n\n}","import React, {Component} from 'react'\nimport * as THREE from 'three'\nimport {TREE_ITEM_PROVIDER} from '../TreeItemProvider'\nimport SelectionManager, {SELECTION_MANAGER} from '../SelectionManager'\nimport TransformControls from './TransformControls.js'\nimport SceneDef from \"./defs/SceneDef\"\nimport {ASSET_TYPES, get3DObjectDef, is3DObjectType, OBJ_TYPES, TOTAL_OBJ_TYPES} from './Common'\nimport {ToasterNotification} from './ToasterNotification'\nimport ScriptManager, {SceneGraphProvider} from './ScriptManager'\nimport {TweenManager} from '../common/tween'\nimport {toFlatString} from '../utils'\nimport {XRSupport} from './XRSupport'\nimport OrbitControls from './OrbitControls'\n\nconst {SET_PROPERTY, INSERT_ELEMENT, DELETE_ELEMENT} = require(\"syncing_protocol\");\n\n\n// ================  SGP implementation =====================\nclass Adapter extends SceneGraphProvider {\n    constructor(canvas) {\n        super()\n        this.canvas = canvas\n    }\n    logger() {\n        return this.canvas.props.provider.getLogger()\n    }\n\n    getCurrentScene() {\n        const scene = this.canvas.props.provider.getSelectedSceneObject()\n        if(!scene || !scene.exists()) {\n            this.logger.error(\"the current scene is null\")\n            return null\n        }\n        return scene\n    }\n    getSceneObjects(scene) {\n        return scene.getChildren().filter(ch => is3DObjectType(ch.type))\n    }\n    getBehaviorsForObject(scene) {\n        return scene.getChildren().filter(ch => ch.type === TOTAL_OBJ_TYPES.BEHAVIOR)\n    }\n    getThreeObject(obj) {\n        if(obj.id) return this.canvas.findNode(obj.id)\n        return this.canvas.findNode(obj)\n    }\n    getParsedBehaviorAsset(beh) {\n        const prov = this.canvas.props.provider\n        const asset = prov.accessObject(beh.behavior)\n        return prov.getCachedBehaviorAsset(asset.id)\n    }\n\n    getAllBehaviors() {\n        return this.canvas.props.provider.accessObject(this.canvas.props.provider.getSceneRoot())\n            .find((obj)=> obj.type === TOTAL_OBJ_TYPES.BEHAVIOR)\n    }\n    getAllScenes() {\n        return this.canvas.props.provider.accessObject(this.canvas.props.provider.getSceneRoot())\n            .find((obj)=>obj.type === TOTAL_OBJ_TYPES.SCENE)\n    }\n\n    navigateScene(id) {\n        const obj = this.canvas.props.provider.accessObject(id)\n        if(obj.exists()) {\n            SelectionManager.setSelection(id)\n        } else {\n            const logger = this.canvas.props.provider.getLogger()\n            logger.error(\"cannot navigate to a scene that doesn't exist\",id)\n        }\n    }\n\n\n    playMediaAsset(asset, trusted=false) {\n        this.canvas.props.provider.assetsManager.playMediaAsset(asset, trusted)\n    }\n\n    stopMediaAsset(asset) {\n        this.canvas.props.provider.assetsManager.stopMediaAsset(asset)\n    }\n    getGraphObjectByName(title) {\n        const list = this.canvas.props.provider.accessObject(this.canvas.props.provider.getSceneRoot()).find((o)=>o.title === title)\n        if(!list || list.length<1) return null\n        return list[0]\n    }\n\n    getGraphObjectById(id) {\n        return this.canvas.props.provider.accessObject(id)\n    }\n\n\n    getCamera() {\n        return this.canvas.camera\n    }\n    \n    getTweenManager() {\n        return this.canvas.tweenManager\n    }\n    startLocalAnchor(info) {\n        return this.canvas.startLocalAnchor(info)\n    }\n    stopLocalAnchor(info) {\n        return this.canvas.stopLocalAnchor(info)\n    }\n    startImageRecognizer(info) {\n        return this.canvas.startImageRecognizer(info)\n    }\n    stopImageRecognizer(info) {\n        return this.canvas.stopImageRecognizer(info)\n    }\n    startGeoTracker(info) {\n        return this.canvas.startGeoTracker(info)\n    }\n    stopGeoTracker(info) {\n        return this.canvas.stopGeoTracker(info)\n    }\n}\n\n\nconst MOVE_SPEED = 0.1\nexport class VRCanvas extends Component {\n    moveCameraForward = () => {\n        this.camera.position.z += -MOVE_SPEED\n    }\n    moveCameraBackward = () => {\n        this.camera.position.z += MOVE_SPEED\n    }\n    handleKeyPress = (e) => {\n        if(e.key === 'ArrowUp') {\n            this.camera.position.z -= MOVE_SPEED\n        }\n        if(e.key === 'ArrowDown') {\n            this.camera.position.z += MOVE_SPEED\n        }\n        if(e.key === 'a') {\n            this.camera.position.x -= MOVE_SPEED\n        }\n        if(e.key === 'd') {\n            this.camera.position.x += MOVE_SPEED\n        }\n        if(e.key === 'ArrowLeft') {\n            this.camera.rotation.y += 0.1\n        }\n        if(e.key === 'ArrowRight') {\n            this.camera.rotation.y -= 0.1\n        }\n    }\n    recenterOnSelection = () => {\n        const sel = SelectionManager.getSelection()\n        if(!sel) return\n        const obj = this.props.provider.accessObject(sel)\n        if(is3DObjectType(obj.type)) {\n            const node = this.findNode(sel)\n            if(!node) return\n            this.orbitControls.target0.copy(node.position)\n            const cam = node.position.clone().sub(new THREE.Vector3(0,0,-2))\n            this.orbitControls.position0.copy(cam)\n            this.orbitControls.reset()\n        }\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) {\n            this.orbitControls.saveState()\n            this.orbitControls.target0.set(0,0,0)\n            this.orbitControls.position0.set(1,6,6)\n            this.orbitControls.reset()\n        }\n    }\n\n    constructor(props) {\n        super(props)\n        this.obj_node_map = {}\n        this.previewUpdateNodes = []\n        this.scenes = []\n        this.state = {\n            scene: -1,\n            running:props.running\n        }\n        this.current_scene_wrapper = null\n        this.scriptManager = new ScriptManager(new Adapter(this),this.props.provider.getLogger())\n    }\n\n    pauseQueue = (e) => {\n        this.props.provider.pauseQueue()\n    }\n    unpauseQueue = (e) => {\n        this.props.provider.unpauseQueue()\n    }\n    transformChanged = (e) => {\n        const sel = SelectionManager.getSelection()\n        if(sel) {\n            const obj = this.props.provider.accessObject(sel)\n            if(!is3DObjectType(obj.type)) return\n            if(obj.type === OBJ_TYPES.bg360) return\n            const node = this.findNode(sel)\n            if(!node) return\n            const prov = this.props.provider\n            prov.quick_setPropertyValue(sel,'tx',node.position.x)\n            prov.quick_setPropertyValue(sel,'ty',node.position.y)\n            prov.quick_setPropertyValue(sel,'tz',node.position.z)\n        }\n    }\n    transformDraggingChanged = (e) => {\n        this.orbitControls.enabled = ! e.value\n    }\n\n    docSwapped = (e) => {\n        //nuke all the old stuff\n        this.scenes.forEach(sc => this.scene.remove(sc))\n        this.scenes = []\n        this.obj_node_map = {}\n        this.setState({scene: -1})\n        //make new stuff\n        const graph = this.props.provider.getDocGraph()\n        this.rebuildNode(graph,\"\")\n\n        const sceneObj = this.props.provider.getSelectedSceneObject()\n        if(!sceneObj.exists()) return this.props.provider.getLogger().error(\"no selected scene found\")\n        const sceneNode = this.findNode(sceneObj.id)\n        this.setCurrentSceneWrapper(sceneNode, false)\n    }\n    rebuildNode(obj, inset) {\n        // console.log(inset,\"rebuilding\",obj.type)\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) {\n            const node = new SceneDef().makeNode(obj,this.props.provider)\n            this.insertNodeMapping(obj.id,node)\n            this.addSceneWrapper(node)\n        }\n        if(is3DObjectType(obj.type)) {\n            const node = get3DObjectDef(obj.type).makeNode(obj,this.props.provider)\n            this.insertNodeMapping(obj.id,node)\n            const parent = this.findNode(obj.parent)\n            parent.add(node)\n        }\n        if(obj.children) {\n            obj.children.forEach(ch => {\n                this.rebuildNode(ch,inset+\"   \")\n            })\n        }\n    }\n    selectionChanged = () => {\n        this.transformControls.detach()\n        const sel = SelectionManager.getSelection()\n        if(!sel) return\n        const obj = this.props.provider.accessObject(sel)\n\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) return this.setCurrentSceneWrapper(this.findNode(sel),true)\n\n        if(is3DObjectType(obj.type)) {\n            const sc = this.props.provider.findSceneObjectParent(obj)\n            this.setCurrentSceneWrapper(this.findNode(sc.id),true)\n            const node = this.findNode(sel)\n            if (!node) return\n            this.transformControls.attach(node)\n            return\n        }\n        console.log(\"selected something not an object or scene\")\n    }\n\n    checkAspectRatio() {\n        if(!this.canvas) return\n        const w = this.wrapper.clientWidth\n        const h = this.wrapper.clientHeight\n        const aspect = w/h\n        if(Math.abs(this.camera.aspect - aspect) > 0.001 ) {\n            this.camera.aspect = aspect\n            this.camera.updateProjectionMatrix()\n            this.renderer.setSize(w-4,h-4)\n        }\n    }\n\n    componentDidMount() {\n        const canvas = this.canvas\n        const logger = this.props.provider.getLogger()\n        logger.log(\"mounting VRCanvas\")\n        if(XRSupport.supportsARKit()) {\n            this.xr = new XRSupport()\n            this.xr.getContext(canvas).then((context) => {\n                this.setupRenderer(canvas,context)\n                this.xr.setAnimationLoop( this.animationLoopWithCamera.bind(this) )\n            }).catch(err => {\n                console.error('Error', err)\n            })\n        } else {\n            this.setupRenderer(canvas,0)\n            this.renderer.setAnimationLoop( this.animationLoop.bind(this) )\n        }\n    }\n\n    componentWillUnmount() {\n        this.saveOrbitControlsState()\n        this.transformControls.removeEventListener('change',this.transformChanged)\n        this.transformControls.removeEventListener('mouseDown',this.pauseQueue)\n        this.transformControls.removeEventListener('mouseUp',this.unpauseQueue)\n        this.props.provider.off(TREE_ITEM_PROVIDER.DOCUMENT_SWAPPED,this.docSwapped)\n        SelectionManager.off(SELECTION_MANAGER.CHANGED,this.selectionChanged)\n    }\n\n    setupRenderer(canvas,context) {\n        this.scene = new THREE.Scene();\n        this.camera = new THREE.PerspectiveCamera(50, canvas.width / canvas.height, 0.1, 1000);\n        this.renderer = new THREE.WebGLRenderer({antialias: false, canvas: canvas, context:context});\n        this.renderer.setPixelRatio( window.devicePixelRatio );\n        this.renderer.gammaOutput = true\n        this.audioListener = new THREE.AudioListener()\n        this.props.provider.setAudioListener(this.audioListener)\n        this.camera.add(this.audioListener)\n        //only set a background if there is no XR active\n        if(!this.xr) this.scene.background = new THREE.Color(0x000000);\n        // this.camera.matrixAutoUpdate = false\n        this.scene.add(this.camera)\n        this.camera.position.set(1,6,6)\n\n        this.transformControls = new TransformControls(this.camera, this.renderer.domElement)\n        this.transformControls.addEventListener('change',this.transformChanged)\n        this.transformControls.addEventListener('dragging-changed', this.transformDraggingChanged)\n        this.transformControls.addEventListener('mouseDown',this.pauseQueue)\n        this.transformControls.addEventListener('mouseUp',this.unpauseQueue)\n        this.scene.add(this.transformControls)\n\n        this.orbitControls = new OrbitControls(this.camera,this.renderer.domElement)\n        this.orbitControls.update()\n        // this.orbitControls.autoRotate = true\n        this.raycaster = new THREE.Raycaster();\n\n        const light = new THREE.DirectionalLight(0xffffff, 1.0);\n        light.position.set(1, 1, 1).normalize();\n        this.scene.add(light);\n\n        this.scene.add(new THREE.AmbientLight(0xffffff,0.4))\n        \n        this.tweenManager = new TweenManager()\n\n        this.props.provider.onRawChange(op => this.updateScene(op))\n        this.props.provider.on(TREE_ITEM_PROVIDER.DOCUMENT_SWAPPED, this.docSwapped)\n        SelectionManager.on(SELECTION_MANAGER.CHANGED, this.selectionChanged)\n\n        this.docSwapped()\n    }\n\n    animationLoop(time, frame) {\n        this.checkAspectRatio()\n        let session = null\n        if(this.xr) session = this.xr.session\n        if(this.state.running) this.scriptManager.tick(time, session)\n        if(this.tweenManager) this.tweenManager.update(time)\n        if(this.orbitControls) this.orbitControls.update()\n        this.previewUpdateNodes.forEach(n => n.previewUpdate())\n        this.renderer.render(this.scene, this.camera)\n    }\n\n    animationLoopWithCamera(bounds,projectionMatrix,viewMatrix, time,frame) {\n        if(!this.scene || !this.camera) return\n        this.camera.matrix.fromArray(viewMatrix)\n        this.camera.matrixWorldNeedsUpdate = true\n        this.camera.updateMatrixWorld()\n        this.camera.projectionMatrix.fromArray(projectionMatrix)\n        this.animationLoop(time,frame)\n    }\n\n    insertNodeMapping(id, node) {\n        if (typeof id !== 'string') throw new Error(\"cannot map an object to an object. invalid call in insertNodeMapping\")\n        this.obj_node_map[id] = node\n        node.userData.graphid = id\n        if(node.previewUpdate) this.previewUpdateNodes.push(node)\n    }\n    removeNodeMapping(id,node) {\n        delete this.obj_node_map[id]\n        delete node.userData.graphid\n        this.previewUpdateNodes = this.previewUpdateNodes.filter(n => n !== node)\n    }\n\n\n    findNode(id) {\n        if (!this.obj_node_map[id]) console.warn(\"could not find node for id\", id)\n        return this.obj_node_map[id]\n    }\n\n    updateScene(op) {\n        const prov = this.props.provider\n        if (op.type === INSERT_ELEMENT) {\n            const objid = op.value\n            const obj = prov.accessObject(op.value)\n            if(obj.type === TOTAL_OBJ_TYPES.SCENE) return this.populateNode(objid)\n            if (is3DObjectType(obj.type)) return this.populateNode(objid)\n            if(obj.type === TOTAL_OBJ_TYPES.ASSET) return\n            if(obj.type === TOTAL_OBJ_TYPES.ASSETS_LIST) return\n            if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) return\n            if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR) return\n            if(obj.type === TOTAL_OBJ_TYPES.BEHAVIORS_LIST) return\n            console.warn(\"unknown object type\", obj)\n            return\n        }\n        if (op.type === SET_PROPERTY) {\n            //skip setting parents. done through insert_element\n            if(op.name === 'parent') return\n            const node = this.findNode(op.object)\n            if (node) {\n                const obj = prov.accessObject(op.object)\n                if(obj.type === 'scene') {\n                    new SceneDef().updateProperty(node,obj,op,this.props.provider)\n                    return\n                }\n                if(is3DObjectType(obj.type)) return get3DObjectDef(obj.type).updateProperty(node,obj,op, this.props.provider)\n            } else {\n                console.log(\"could not find the node for object id:\", op)\n            }\n            return\n        }\n        if (op.type === DELETE_ELEMENT) {\n            this.transformControls.detach()\n            const node = this.findNode(op.value)\n            if(node) {\n                this.removeNodeMapping(op.value,node)\n                const obj = prov.accessObject(op.value)\n                if(is3DObjectType(obj.type)) node.parent.remove(node)\n            }\n            return\n        }\n        // console.log('skipping', op.type)\n    }\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\n        if('running' in nextProps) {\n            if(nextProps.running !== this.props.running) {\n                this.setState({running:nextProps.running})\n                if(nextProps.running === false) {\n                    this.scriptManager.stopRunning()\n                    this.stopAllMedia()\n                    this.resetSceneGraph()\n                    this.stopRecognizers()\n                } else {\n                    //start the script manager\n                    this.startRecognizers()\n                    this.scriptManager.startRunning()\n                    this.scriptManager.startFirstScene();\n                }\n                return false\n            }\n        }\n        return false\n    }\n\n    render() {\n        return <div style={{\n            borderWidth:0,\n            boxSizing:'border-box',\n            height:'100%',\n            display:'flex',\n            flexDirection:'column'\n        }}>\n            <button onClick={this.recenterOnSelection}>recenter on selection</button>\n            <div style={{\n                boxSizing:'border-box',\n                borderWidth:0,\n                margin:0,\n                padding:0,\n                flex:1.0,\n                overflow:'auto',\n            }}\n                 ref={c => this.wrapper = c}\n            >\n                <canvas ref={c => this.canvas = c}\n                        style={{\n                            boxSizing:'border-box',\n                            margin:0,\n                            padding:0,\n                            width:'100px',\n                            height:'100px',\n                            borderWidth:0,\n                        }}\n                        onClick={this.clickedCanvas}\n                        className=\"editable-canvas\"\n                        onKeyDown={this.handleKeyPress}\n                        tabIndex={0}\n                />\n                <ToasterNotification/>\n            </div>\n        </div>\n    }\n\n    populateNode(nodeid) {\n        const obj = this.props.provider.accessObject(nodeid)\n        if (is3DObjectType(obj.type)) {\n            const obj3d = get3DObjectDef(obj.type).makeNode(obj,this.props.provider)\n            this.insertNodeMapping(nodeid, obj3d)\n            const parent = this.findNode(obj.parent)\n            if(!parent) {\n                //this must be a nested pasted child. we can fix the parent links later\n                return null\n            }\n            parent.add(obj3d)\n            this.rebuildParentLink(obj)\n            return obj3d\n        }\n        if (obj.type === TOTAL_OBJ_TYPES.SCENE) {\n            const scene = new SceneDef().makeNode(obj,this.props.provider)\n            this.insertNodeMapping(nodeid, scene)\n            this.addSceneWrapper(scene)\n            this.setCurrentSceneWrapper(scene,true)\n            return scene\n        }\n\n        console.warn(\"cannot populate node for type\", obj.type)\n    }\n\n    rebuildParentLink(obj) {\n        obj.getChildren().forEach((ch)=>{\n            const ch3 = this.findNode(ch.id)\n            if(!ch3.parent) this.findNode(obj.id).add(ch3)\n            this.rebuildParentLink(ch)\n        })\n    }\n\n    addSceneWrapper(scene) {\n        this.scenes.push(scene)\n        this.scene.add(scene)\n    }\n\n    saveOrbitControlsState() {\n        const scene = this.scenes.find(sc => sc.visible)\n        this.orbitControls.saveState()\n        const id = scene.userData.graphid\n        this.props.provider.orbit_state[id] = {\n            target: this.orbitControls.target0.clone(),\n            position:this.orbitControls.position0.clone(),\n        }\n    }\n    restoreOrbitControlsState(scene) {\n        const id = scene.userData.graphid\n        if(this.props.provider.orbit_state[id]) {\n            const state = this.props.provider.orbit_state[id]\n            this.orbitControls.target0.copy(state.target)\n            this.orbitControls.position0.copy(state.position)\n            this.orbitControls.reset()\n        }\n    }\n    setCurrentSceneWrapper(scene, saveState) {\n        if(!scene) return this.props.provider.getLogger().error(\"invalid scene. cannot setCurrentSceneWrapper\")\n        const cur = this.getCurrentSceneWrapper()\n        const changed = (scene !== cur)\n        if(changed && saveState) this.saveOrbitControlsState()\n        this.current_scene_wrapper = scene\n        this.scenes.forEach(sc => {\n            if(sc === scene) {\n                sc.visible = true\n            } else {\n                sc.visible = false\n            }\n        })\n        if(changed) this.restoreOrbitControlsState(scene)\n    }\n\n    dumpScenes() {\n        this.scenes.forEach(sc => {\n            console.log(\"scene\")\n            this.dump(sc,'')\n        })\n    }\n    dump(sc,inset) {\n        console.log(inset+\"\",sc.type,sc.id,  'vis', sc.visible)\n        if(sc.type === 'Mesh') console.log(inset+'  ',sc.geometry.type)\n        // console.log(sc)\n        if(sc.children) {\n            sc.children.forEach((ch) => this.dump(ch, inset + '  '))\n        }\n    }\n\n    getCurrentSceneWrapper() {\n        return this.current_scene_wrapper\n    }\n\n    clickedCanvas = (e) => {\n        this.canvas.focus()\n        const rect = this.canvas.getBoundingClientRect();\n        const pointer = {\n            x: ( e.clientX - rect.left ) / rect.width * 2 - 1,\n            y: - ( e.clientY - rect.top ) / rect.height * 2 + 1,\n        }\n\n        function findKnownParent(node) {\n            if(!node) return null\n            if(node.userData.graphid) return node\n            return findKnownParent(node.parent)\n        }\n\n        this.raycaster.setFromCamera(pointer, this.camera);\n        const intersect = this.raycaster.intersectObjects(this.getCurrentSceneWrapper().children, true)\n        if(intersect && intersect.length >= 1) {\n            let obj = findKnownParent(intersect[0].object)\n            if(this.state.running) {\n                this.scriptManager.performClickAction(this.props.provider.accessObject(obj.userData.graphid), e)\n            } else {\n                SelectionManager.setSelection(obj.userData.graphid)\n            }\n        } else {\n            SelectionManager.clearSelection()\n        }\n    }\n\n\n    resetSceneGraph() {\n        Object.keys(this.obj_node_map).forEach(id => {\n            const graphObj = this.props.provider.accessObject(id)\n            const threeObj = this.obj_node_map[id]\n            if(graphObj.type === 'scene') {\n                // new SceneDef().updateProperty(node,obj,op,this.props.provider)\n                return\n            }\n            if(is3DObjectType(graphObj.type)) {\n                const def = get3DObjectDef(graphObj.type)\n                if(def.reset) {\n                    def.reset(threeObj,graphObj,this.props.provider.getDataGraph())\n                }\n            }\n        })\n    }\n\n    stopAllMedia() {\n        this.props.provider.assetsManager.stopAllMedia()\n    }\n\n    startRecognizers() {\n        //called when script running is started\n    }\n\n    stopRecognizers() {\n        //called when script running is started\n    }\n\n    startLocalAnchor(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO start local anchor\")\n    }\n\n    stopLocalAnchor(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO stop local anchor\")\n    }\n\n    startImageRecognizer(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO start image recognizer\")\n    }\n\n    stopImageRecognizer(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO stop image recognizer\")\n    }\n\n    startGeoTracker(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO start geo recognizer\")\n    }\n\n    stopGeoTracker(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO stop geo recognizer\")\n    }\n\n    startWorldInfo(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO start world info\")\n    }\n\n    stopWorldInfo(info) {\n        this.props.provider.getLogger().log(\"NOTHING DONE TO stop world info\")\n    }\n\n}\n","import * as THREE from 'three'\nimport {POINTER_ENTER, POINTER_EXIT, POINTER_MOVE, POINTER_PRESS, POINTER_RELEASE} from 'webxr-boilerplate'\n\n\n\nconst on = (elem,type,cb) => elem.addEventListener(type,cb)\nconst off = (elem,type,cb) => elem.removeEventListener(type,cb)\nconst toRad = (degrees) => degrees*Math.PI/180\n\nexport default class TranslationArrow extends THREE.Group {\n    constructor(axis, control) {\n        super()\n        this.axis = axis\n        this.control = control\n        this.makePlane()\n        this.makeArrow()\n        this.makeInputGrabber()\n    }\n\n    makePlane() {\n        this.plane = new THREE.Mesh(\n            new THREE.PlaneBufferGeometry(100, 100, 100, 100),\n            new THREE.MeshBasicMaterial({visible: true, wireframe: true, side: THREE.DoubleSide})\n        )\n        if (this.axis === 'Z') this.plane.rotation.y = toRad(90)\n        this.plane.userData.draggable = true\n        this.plane.visible = false\n        this.add(this.plane)\n    }\n\n    makeArrow() {\n        this.arrow = new THREE.Mesh(\n            new THREE.CylinderBufferGeometry(0.02, 0.02, 4),\n            new THREE.MeshLambertMaterial({color: 'yellow'})\n        )\n        if (this.axis === 'X') this.arrow.rotation.z = toRad(90)\n        if (this.axis === 'Y') this.arrow.rotation.z = toRad(180)\n        if (this.axis === 'Z') this.arrow.rotation.x = toRad(90)\n        this.add(this.arrow)\n    }\n\n    makeInputGrabber() {\n        this.input = new THREE.Mesh(\n            new THREE.CylinderBufferGeometry(0.1, 0.1, 4),\n            new THREE.MeshLambertMaterial({color: 'green', visible: false})\n        )\n        if (this.axis === 'X') this.input.rotation.z = toRad(90)\n        if (this.axis === 'Y') this.input.rotation.z = toRad(180)\n        if (this.axis === 'Z') this.input.rotation.x = toRad(90)\n        this.input.userData.clickable = true\n        this.add(this.input)\n    }\n\n    attach() {\n        on(this.input, POINTER_ENTER, this.startHover)\n        on(this.input, POINTER_EXIT, this.endHover)\n        on(this.input, POINTER_PRESS, this.beginDrag)\n    }\n\n    detach() {\n        off(this.input, POINTER_ENTER, this.startHover)\n        off(this.input, POINTER_EXIT, this.endHover)\n        off(this.input, POINTER_PRESS, this.beginDrag)\n    }\n\n    startHover = () => this.arrow.material.color.set(0xffffff)\n    endHover = () => this.arrow.material.color.set(0xffff00)\n\n    beginDrag = (e) => {\n        this.startPoint = this.parent.position.clone()\n        this.startPoint.copy(e.intersection.point)\n        this.parent.target.parent.worldToLocal(this.startPoint)\n        this.oldFilter = this.parent.pointer.intersectionFilter\n        this.parent.pointer.intersectionFilter = (obj) => obj.userData.draggable\n        this.startPosition = this.parent.target.position.clone()\n        this.plane.visible = true\n        on(this.plane, POINTER_MOVE, this.updateDrag)\n        on(this.plane, POINTER_RELEASE, this.endDrag)\n    }\n    updateDrag = (e) => {\n        this.endPoint = e.intersection.point.clone()\n        this.parent.target.parent.worldToLocal(this.endPoint)\n        //neutralize y and z\n        if (this.axis === 'X') {\n            this.endPoint.y = this.startPoint.y\n            this.endPoint.z = this.startPoint.z\n        }\n        if (this.axis === 'Y') {\n            this.endPoint.x = this.startPoint.x\n            this.endPoint.z = this.startPoint.z\n        }\n        if (this.axis === 'Z') {\n            this.endPoint.x = this.startPoint.x\n            this.endPoint.y = this.startPoint.y\n        }\n        const diff = this.endPoint.clone().sub(this.startPoint)\n        const finalPoint = this.startPosition.clone().add(diff)\n        this.parent.target.position.copy(finalPoint)\n        this.parent.position.copy(finalPoint)\n    }\n    endDrag = (e) => {\n        off(this.plane, POINTER_MOVE, this.updateDrag)\n        off(this.plane, POINTER_RELEASE, this.endDrag)\n        this.parent.pointer.intersectionFilter = this.oldFilter\n        this.plane.visible = false\n        this.parent.dispatchEvent({\n            type: 'change',\n            start: this.startPosition.clone(),\n            end: this.parent.position.clone()\n        })\n    }\n}\n","import * as THREE from 'three'\nimport TranslationArrow from './TranslationArrow'\n\nexport class TranslateControl extends THREE.Group {\n    constructor() {\n        super()\n        this.handles = []\n        this.handles.push(new TranslationArrow('X', this))\n        this.handles.push(new TranslationArrow('Y', this))\n        this.handles.push(new TranslationArrow('Z', this))\n        this.handles.forEach(h => this.add(h))\n        this.visible = false\n    }\n\n    attach(target, pointer) {\n        this.target = target\n        this.pointer = pointer\n        this.position.copy(target.position)\n        this.visible = true\n        this.handles.forEach(h => h.attach())\n    }\n\n    detach() {\n        this.target = null\n        this.pointer = null\n        this.visible = false\n        this.handles.forEach(h => h.attach())\n    }\n}\n","import * as THREE from 'three'\n\nimport {POINTER_RELEASE, POINTER_CLICK, POINTER_ENTER, POINTER_EXIT, POINTER_PRESS, POINTER_MOVE} from 'webxr-boilerplate'\n\n// const $ = (sel) => document.querySelector(sel)\nconst on = (elem, type, cb) => elem.addEventListener(type,cb)\n// const toRad = (deg) => deg * Math.PI/180\n\nexport default class Panel2D extends THREE.Object3D {\n    constructor(scene,camera) {\n        super()\n\n        if(!scene) throw new Error(\"cannot pass empty scene to Panel2D()\")\n        if(!camera) throw new Error(\"cannot pass empty camera to Panel2D()\")\n        this.type = 'panel2d'\n        this.listeners = {}\n        this.scene = scene\n        this.camera = camera\n        this.canvas = document.createElement('canvas')\n        this.canvas.width = 256\n        this.canvas.height = 512\n        this.canvasTexture = new THREE.CanvasTexture(this.canvas)\n        this.redrawHandler = (e) => this.redraw()\n\n        const c = this.canvas.getContext('2d')\n        c.fillStyle = 'red'\n        c.fillRect(0,0,this.canvas.width,this.canvas.height)\n\n        this.mesh = new THREE.Mesh(\n            new THREE.PlaneGeometry(1,2),\n            new THREE.MeshBasicMaterial({color:'white',map:this.canvasTexture})\n        )\n        this.mesh.userData.clickable = true\n        this.comps = []\n\n        this.add(this.mesh)\n\n        let inside = null\n        on(this.mesh,POINTER_MOVE,(e)=>{\n            const uv = e.intersection.uv\n            const fpt = new THREE.Vector2(uv.x*256, 512-uv.y*512)\n            if(inside && !inside.contains(fpt)) {\n                inside.fire(POINTER_EXIT)\n                inside = null\n            }\n            const comp = this.findAt(fpt)\n            // for(let i=0; i<this.comps.length; i++) {\n            //     const comp = this.comps[i]\n            //     if(comp.contains(fpt)) {\n            if(inside !== comp){\n                if(inside) inside.fire(POINTER_EXIT)\n                inside = null\n            }\n            if(comp) comp.fire(POINTER_ENTER)\n            inside = comp\n            // }\n            // }\n        })\n        on(this.mesh,POINTER_CLICK,(e)=>{\n            const uv = e.intersection.uv\n            const fpt = new THREE.Vector2(uv.x*256, 512-uv.y*512)\n            const comp = this.findAt(fpt)\n            if(comp) comp.fire(POINTER_CLICK)\n            // for(let i=0; i<this.comps.length; i++) {\n            //     const comp = this.comps[i]\n            //     if(comp.contains(fpt)) {\n            //         comp.fire(POINTER_CLICK)\n            //     }\n            // }\n        })\n\n        this.header = new THREE.Mesh(\n            new THREE.BoxGeometry(1.0,0.1,0.1),\n            new THREE.MeshBasicMaterial({color:'goldenrod'})\n        )\n        this.header.userData.clickable = true\n        this.header.position.set(0,1.1,0)\n        this.add(this.header)\n\n        on(this.header,POINTER_ENTER, e => this.header.material.color.set('yellow'))\n        on(this.header,POINTER_EXIT,  e => this.header.material.color.set('goldenrod'))\n        on(this.header,POINTER_PRESS, e => this.startDrag())\n    }\n\n    fire(type,payload) {\n        if(!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].forEach(cb => cb(payload))\n    }\n\n    findAt(pt) {\n        for(let i=0; i<this.comps.length; i++) {\n            const comp = this.comps[i]\n            const res = comp.findAt({x:pt.x-comp.x,y:pt.y-comp.y})\n            if(res) return res\n        }\n        return null\n    }\n\n    add(comp) {\n        if(comp instanceof THREE.Object3D) {\n            super.add(comp)\n        } else {\n            this.comps.push(comp)\n            on(comp, 'changed', this.redrawHandler)\n        }\n    }\n\n    redraw() {\n        const ctx = this.canvas.getContext('2d')\n        ctx.fillStyle = 'white'\n        ctx.fillRect(0,0,this.canvas.width,this.canvas.height)\n        this.comps.forEach(comp => comp.draw(ctx))\n        this.canvasTexture.needsUpdate = true\n    }\n\n    startDrag() {\n        this.header.userData.clickable = false\n        this.mesh.userData.clickable = false\n\n        this.dragSphere = new THREE.Mesh(\n            new THREE.SphereGeometry(4,32,32),\n            new THREE.MeshLambertMaterial({\n                color:'green',\n                wireframe:true,\n                side: THREE.BackSide\n            })\n        )\n        this.dragSphere.userData.clickable = true\n        this.scene.add(this.dragSphere)\n\n        on(this.dragSphere,POINTER_MOVE,(e)=> this.moveDrag(e))\n        on(this.dragSphere,POINTER_RELEASE,(e)=> this.endDrag(e))\n\n    }\n    endDrag() {\n        this.scene.remove(this.dragSphere)\n        this.dragSphere.userData.clickable = false\n        this.header.userData.clickable = true\n        this.mesh.userData.clickable = true\n    }\n\n\n    moveDrag(e) {\n        this.position.copy(e.point)\n        this.position.add(new THREE.Vector3(0,-1,0))\n        this.lookAt(this.camera.position)\n    }\n}\n","export default class Component2D {\n    constructor() {\n        this.listeners = {}\n    }\n    set(key,value) {\n        this[key] = value\n        this.fire('changed',{type:'changed',target:this})\n        return this\n    }\n    get(key) {\n        return this[key]\n    }\n    addEventListener(type,cb) {\n        if(!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].push(cb)\n        return this\n    }\n    on(type,cb) {\n        this.addEventListener(type,cb)\n        return this\n    }\n    setAll(props) {\n        Object.keys(props).forEach(key => this.set(key, props[key]))\n        return this\n    }\n    fire(type,payload) {\n        if(!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].forEach(cb => cb(payload))\n    }\n\n}","import {POINTER_ENTER, POINTER_EXIT} from 'webxr-boilerplate'\nimport Component2D from \"./component2d\";\n\n\nexport default class Button2D extends Component2D {\n    constructor() {\n        super()\n        this.type = 'button'\n        this.text = 'foo'\n        this.x = 0\n        this.y = 0\n        this.fsize = 20\n        this.w = this.text.length * this.fsize\n        this.h = 20\n        this.normalBg = 'white'\n        this.hoverBg = 'red'\n        this.bg = this.normalBg\n        this.on(POINTER_ENTER, () => {\n            this.bg = this.hoverBg\n            this.fire('changed', {type: 'changed', target: this})\n        })\n        this.on(POINTER_EXIT, () => {\n            this.bg = this.normalBg\n            this.fire('changed', {type: 'changed', target: this})\n        })\n    }\n\n    draw(ctx) {\n        ctx.font = `${this.fsize}px sans-serif`\n        const metrics = ctx.measureText(this.text)\n        this.w = 5 + metrics.width + 5\n        this.h = 0 + this.fsize + 4\n        ctx.fillStyle = this.bg\n        ctx.fillRect(this.x, this.y, this.w, this.h)\n        ctx.fillStyle = 'black'\n        ctx.fillText(this.text, this.x + 3, this.y + this.fsize - 2)\n        ctx.strokeStyle = 'black'\n        ctx.strokeRect(this.x, this.y, this.w, this.h)\n    }\n\n    contains(pt) {\n        if (pt.x < this.x) return false\n        if (pt.x > this.x + this.w) return false\n        if (pt.y < this.y) return false\n        if (pt.y > this.y + this.h) return false\n        return true\n    }\n\n    findAt(pt) {\n        if (pt.x < 0) return null\n        if (pt.x > 0 + this.w) return null\n        if (pt.y < 0) return null\n        if (pt.y > 0 + this.h) return null\n        return this\n    }\n\n    set(key, value) {\n        super.set(key, value)\n        if (key === 'normalBg') this.bg = this.normalBg\n    }\n}\n","import Component2D from \"./component2d\";\n\nexport default class Group2D extends Component2D {\n    constructor() {\n        super()\n        this.type = 'group'\n        this.x = 0\n        this.y = 0\n        this.w = 100\n        this.h = 100\n        this.bg = 'gray'\n        this.visible = true\n        this.comps = []\n        this.padding = 5\n        this.border = 1\n\n        this.layout = (comp) => {\n            console.log(\"not laying out anything\")\n        }\n    }\n    draw(ctx) {\n        if(!this.visible) return\n        this.layout(this)\n        ctx.fillStyle = this.bg\n        ctx.fillRect(this.x,this.y,this.w,this.h)\n        if(this.border > 0) {\n            ctx.strokeStyle = 'black'\n            ctx.strokeRect(this.x, this.y, this.w, this.h)\n        }\n        ctx.save()\n        ctx.translate(this.x+this.padding,this.y+this.padding)\n        this.comps.forEach(comp => comp.draw(ctx))\n        ctx.restore()\n    }\n\n    contains(pt) {\n        if(pt.x < this.x) return false\n        if(pt.x > this.x + this.w) return false\n        if(pt.y < this.y) return false\n        if(pt.y > this.y + this.h) return false\n        return true\n    }\n    findAt(pt) {\n        if(!this.visible) return null\n        for(let i=0; i<this.comps.length; i++) {\n            const comp = this.comps[i]\n            const res = comp.findAt({x:pt.x-comp.x-5,y:pt.y-comp.y-5})\n            if(res) return res\n        }\n        return null\n    }\n\n    childSet(key,value) {\n        this.childProps[key] = value\n        this.comps.forEach(ch=>ch.set(key,value))\n        return this\n    }\n\n    add(comp) {\n        this.comps.push(comp)\n        this.fire('changed',{type:'changed',target:this})\n        return this\n    }\n}\n","import * as THREE from 'three'\n\nconst toRad = (deg) => Math.PI/180*deg\nconst YAXIS = new THREE.Vector3(0,1,0)\n\n\nexport default class ThreeDOFController {\n\n\n    constructor(stagePos, stageRot) {\n        this.stagePos = stagePos\n        this.stageRot = stageRot\n        this.states = { touchpad: false}\n        this.listeners = {}\n        this.keystates = {\n            ArrowLeft:{current:false, previous:false},\n            ArrowRight:{current:false, previous:false},\n            ArrowUp:{current:false, previous:false},\n            ArrowDown:{current:false, previous:false}\n        }\n        this.dir = new THREE.Vector3(0,0,1)\n\n\n        document.addEventListener('keydown',(e)=>{\n            if(this.keystates[e.key]) {\n                this.keystates[e.key].current = true\n            }\n        })\n        document.addEventListener('keyup',(e)=>{\n            if(this.keystates[e.key]) {\n                this.keystates[e.key].current = false\n            }\n        })\n\n    }\n\n    addEventListener(type, cb) {\n        if (!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].push(cb)\n    }\n\n    _fire(type,payload) {\n        if (!this.listeners[type]) this.listeners[type] = []\n        this.listeners[type].forEach(cb => cb(payload))\n    }\n\n\n\n\n    updateKeys() {\n        if(this.keystates.ArrowLeft.current === false && this.keystates.ArrowLeft.previous === true) {\n            this.rotateLeft()\n        }\n        if(this.keystates.ArrowRight.current === false && this.keystates.ArrowRight.previous === true) {\n            this.rotateRight()\n        }\n        if(this.keystates.ArrowUp.current === false && this.keystates.ArrowUp.previous === true) {\n            this.moveForward()\n        }\n        if(this.keystates.ArrowDown.current === false && this.keystates.ArrowDown.previous === true) {\n            this.moveBackward()\n        }\n\n        Object.keys(this.keystates).forEach(key => {\n            this.keystates[key].previous = this.keystates[key].current\n        })\n    }\n\n    rotateLeft() {\n        this.dir.applyAxisAngle(YAXIS,toRad(30))\n        this.stageRot.rotation.y -= toRad(30)\n    }\n\n    rotateRight() {\n        this.dir.applyAxisAngle(YAXIS,-toRad(30))\n        this.stageRot.rotation.y += toRad(30)\n    }\n\n    moveForward() {\n        this.stagePos.position.add(this.dir)\n        this._fire('move',this.stagePos.position)\n    }\n\n    moveBackward() {\n        this.stagePos.position.sub(this.dir)\n        this._fire('move',this.stagePos.position)\n    }\n\n    update() {\n        this.scanGamepads()\n        this.updateKeys()\n    }\n\n    scanGamepads() {\n        // console.log(\"gamepads\",navigator.getGamepads())\n        const gamepads = navigator.getGamepads()\n        for(let i=0; i<gamepads.length; i++) {\n            const gamepad = gamepads[i]\n            if ( gamepad && ( gamepad.id === 'Daydream Controller' ||\n                gamepad.id === 'Gear VR Controller' || gamepad.id === 'Oculus Go Controller' ||\n                gamepad.id === 'OpenVR Gamepad' || gamepad.id.startsWith( 'Oculus Touch' ) ||\n                gamepad.id.startsWith( 'Spatial Controller' ) ) ) {\n                //we should have at least two buttons\n                if(gamepad.buttons.length < 2) return\n\n                const touchpad = gamepad.buttons[0]\n                if(touchpad.pressed && gamepad.axes && gamepad.axes.length === 2) {\n                    const left = gamepad.axes[0] < -0.5\n                    const right = gamepad.axes[0] > 0.5\n                    const down = gamepad.axes[1] < -0.5\n                    const up = (gamepad.axes[1] > 0.5)\n\n\n                    if (down && this.states.touchpad === false && touchpad.pressed === true) {\n                        this.moveForward()\n                    }\n                    if (up && this.states.touchpad === false && touchpad.pressed === true) {\n                        this.moveBackward()\n                    }\n                    if (left && this.states.touchpad === false && touchpad.pressed === true) {\n                        this.rotateLeft()\n                    }\n                    if (right && this.states.touchpad === false && touchpad.pressed === true) {\n                        this.rotateRight()\n                    }\n                }\n\n                const trigger = gamepad.buttons[1]\n                if(trigger.pressed) console.log(\"trigger\")\n                if(this.states.touchpad === false && touchpad.pressed === true) {\n                    console.log(\"pressed\")\n                }\n                if(this.states.touchpad === true && touchpad.pressed === false) {\n                    console.log(\"released\")\n                }\n                this.states.touchpad = touchpad.pressed\n            }\n\n        }\n    }\n\n}\n","import SceneDef from './defs/SceneDef'\nimport SelectionManager from '../SelectionManager'\nimport {toQueryString} from '../utils'\nimport {ITEM_ICONS, OBJ_TYPES} from './Common'\nimport {PopupManager} from 'appy-comps'\nimport {MenuPopup} from '../common/GridEditorApp'\nimport React from 'react'\nimport {AuthModule} from './AuthModule'\n\nexport function addScene(provider) {\n    const root = provider.accessObject(provider.getSceneRoot())\n    const scene = new SceneDef().make(provider.getDataGraph(),root)\n    root.insertFirstChild(scene)\n    SelectionManager.setSelection(scene.id)\n}\n\n\nexport function deleteObject(provider) {\n    if(SelectionManager.isEmpty()) return\n    provider.accessObject(SelectionManager.getSelection()).removeFromParent()\n    SelectionManager.clearSelection()\n}\n\nexport function newDoc(provider) {\n    const opts = Object.assign({},provider.options,\n        {mode:'edit', switcher:false, doc:provider.genID('doc')})\n    document.location =  `./?${toQueryString(opts)}`\n}\n\n\nexport function showAddPopup (e, provider) {\n    let item = provider.getSelectedSceneObject()\n    const acts = Object.keys(OBJ_TYPES).map(type => {\n        return {\n            title: type,\n            icon: ITEM_ICONS[type],\n            fun: () => provider.add3DObject(type,item)\n        }\n    })\n    PopupManager.show(<MenuPopup actions={acts}/>, e.target)\n}\n\nexport function showAddAssetPopup(e, provider) {\n    const acts = generateAddAssetPopup(provider)\n    PopupManager.show(<MenuPopup actions={acts}/>, e.target)\n}\n\nexport function generateAddAssetPopup(provider) {\n    let acts = []\n    // console.log(\"Auth mod\",AuthModule.supportsAssetUpload())\n    if(AuthModule.supportsAssetUpload()) {\n        acts = acts.concat([\n            {\n                title: 'image',\n                enabled: AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.image,\n                fun: () => provider.showAddImageAssetDialog()\n            },\n            {\n                title: 'server image',\n                enabled: AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.image,\n                fun: () => provider.showAddServerImageDialog()\n            },\n            {divider: true},\n            {\n                title: 'GLTF model',\n                enabled: AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.model,\n                fun: () => provider.showAddGLTFAssetDialog()\n            },\n            {\n                title: 'GLB model',\n                enabled: AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.model,\n                fun: () => provider.showAddGLBAssetDialog()\n            },\n            {divider: true},\n            {\n                title: 'audio file',\n                enabled: AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.audio,\n                fun: () => provider.showAddAudioAssetDialog()\n            },\n            {\n                title: 'existing asset on server',\n                enabled: AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.assets,\n                fun: () => provider.showOpenAssetDialog()\n            }])\n    } else {\n        acts.push({\n            title: 'add asset from glitch',\n            icon: ITEM_ICONS.assets,\n            fun: () => provider.showOpenAssetDialog()\n        })\n    }\n\n    acts.push({\n        title:'geo location',\n        icon: ITEM_ICONS.geoanchor,\n        fun: () => provider.showAddGeoLocationAssetDialog()\n    })\n\n    return acts\n}\n\nexport function showAddBehaviorPopup (e, provider) {\n    const acts = [\n        {\n            title:'Add Behavior from Server',\n            enabled: AuthModule.isLoggedIn(),\n            icon: ITEM_ICONS.behavior_script,\n            fun: () => provider.showOpenBehaviorDialog()\n        },\n    ]\n    if(AuthModule.supportsScriptEdit()) {\n        acts.push({\n            title: 'custom behavior',\n            enabled: AuthModule.isLoggedIn(),\n            icon: ITEM_ICONS.behavior_script,\n            fun: () => provider.addCustomBehaviorAsset()\n        })\n    }\n    PopupManager.show(<MenuPopup actions={acts}/>, e.target)\n}\n","import React, {Component} from 'react'\nimport {\n    AmbientLight,\n    Audio,\n    AudioLoader,\n    AudioListener,\n    Color,\n    CylinderBufferGeometry,\n    DirectionalLight,\n    Group,\n    Mesh,\n    MeshLambertMaterial,\n    PerspectiveCamera,\n    Scene,\n    WebGLRenderer\n} from 'three'\n\nimport './VREditor.css'\n\nimport {Pointer, POINTER_CLICK, VR_DETECTED, VRManager, VRStats} from \"webxr-boilerplate\"\n\nimport {TREE_ITEM_PROVIDER} from '../TreeItemProvider'\nimport SelectionManager, {SELECTION_MANAGER} from '../SelectionManager'\nimport {TranslateControl} from './TranslateControl'\nimport panel2d from \"./panel2d/panel2d\"\nimport button2d from \"./panel2d/button2d\"\nimport group2d from \"./panel2d/group2d\"\nimport SceneDef from \"./defs/SceneDef\"\nimport {on, parseOptions, toFlatString} from \"../utils\"\nimport {TweenManager} from \"../common/tween\"\nimport {ASSET_TYPES, get3DObjectDef, is3DObjectType, OBJ_TYPES, SIMPLE_COLORS, toRad, TOTAL_OBJ_TYPES} from './Common'\n//use the oculus go controller\nimport ThreeDOFController from \"./3dof.js\"\nimport ScriptManager, {SceneGraphProvider} from './ScriptManager'\nimport {deleteObject} from './Actions'\nimport {DialogContainer} from 'appy-comps'\nimport {PubnubLogger} from '../syncgraph/PubnubSyncWrapper'\n\nconst {SET_PROPERTY, CREATE_OBJECT, INSERT_ELEMENT, DELETE_ELEMENT} = require(\"syncing_protocol\");\n\nclass Adapter extends SceneGraphProvider {\n    constructor(editor, provider) {\n        super()\n        this.editor = editor\n        this.provider = provider\n    }\n    getCurrentScene ()  {\n        return this.provider.accessObject(this.editor.currentScene)\n    }\n    getSceneObjects (scene)  {\n        return scene.getChildren().filter(ch => is3DObjectType(ch.type))\n    }\n    getBehaviorsForObject (obj)  {\n        return obj.getChildren().filter(ch => ch.type === TOTAL_OBJ_TYPES.BEHAVIOR)\n    }\n    getThreeObject(id) {\n        return this.editor.findNode(id)\n    }\n    getParsedBehaviorAsset (beh) {\n        const asset = this.provider.accessObject(beh.behavior)\n        return this.provider.getCachedBehaviorAsset(asset.id)\n    }\n    getAllBehaviors ()  {\n        return this.provider.accessObject(this.provider.getSceneRoot())\n            .find((obj)=> obj.type === TOTAL_OBJ_TYPES.BEHAVIOR)\n    }\n\n    getAllScenes() {\n        return this.provider.accessObject(this.provider.getSceneRoot())\n            .find((obj)=>obj.type === TOTAL_OBJ_TYPES.SCENE)\n    }\n\n    navigateScene(id) {\n        const obj = this.provider.accessObject(id)\n        if(obj.exists()) {\n            return this.editor.swapScene(id)\n        } else {\n            const logger = this.provider.getLogger()\n            logger.error(\"cannot navigate to scene that does not exist\",id)\n        }\n    }\n    playMediaAsset(asset, trusted) {\n        this.provider.assetsManager.playMediaAsset(asset, trusted)\n    }\n\n    stopMediaAsset(asset) {\n        this.provider.assetsManager.stopMediaAsset(asset)\n    }\n\n    getGraphObjectByName(title) {\n        const list = this.provider.accessObject(this.provider.getSceneRoot()).find((o)=>o.title === title)\n        if(!list || list.length<1) return null\n        return list[0]\n    }\n    getGraphObjectById(id) {\n        return this.provider.accessObject(id)\n    }\n\n    getCamera() {\n        return this.editor.camera\n    }\n    \n\n    getTweenManager() {\n        return this.editor.tweenManager\n    }\n\n    startLocalAnchor(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO start local anchor\")\n    }\n\n    stopLocalAnchor(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO stop local anchor\")\n    }\n\n    startImageRecognizer(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO start image recognizer\")\n    }\n\n    stopImageRecognizer(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO stop image recognizer\")\n    }\n\n    startGeoTracker(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO start geo recognizer\")\n    }\n\n    stopGeoTracker(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO stop geo recognizer\")\n    }\n\n    startWorldInformation(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO start world information\")\n        return 0\n    }\n\n    stopWorldInformation(info) {\n        this.provider.getLogger().log(\"NOTHING DONE TO stop world information\")\n        return 0\n    }\n\n}\n\nexport default class ImmersiveVREditor extends Component {\n    constructor(props) {\n        super(props)\n        this.obj_node_map = {}\n        this.previewUpdateNodes = []\n        const opts = parseOptions({})\n        if(!opts.doc) throw new Error(\"doc not specified\")\n        this.logger = new PubnubLogger(opts.doc)\n        this.scriptManager = new ScriptManager(new Adapter(this, this.props.provider), this.logger)\n    }\n\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\n        return false\n    }\n\n\n    render() {\n        return <div>\n            <div id=\"overlay\">\n                <div id=\"inner\">\n                    <h1>Application Name</h1>\n                    <div id=\"loading-indicator\">\n                        <label>loading...</label><br></br>\n                        <progress max=\"100\" value=\"0\" id=\"progress\"></progress>\n                    </div>\n                    <button id=\"enter-button\" disabled>VR not supported, play anyway</button>\n                </div>\n            </div>\n            <div ref={c => this.wrapper = c}></div>\n            <DialogContainer/>\n        </div>\n    }\n\n\n    componentDidMount() {\n        this.sceneWrappers = {}\n        this.initScene()\n        this.renderer.setAnimationLoop(this.render3.bind(this))\n    }\n\n    render3(time) {\n        //update the pointer and stats, if configured\n        if(this.tweenManager) this.tweenManager.update(time)\n        this.previewUpdateNodes.forEach(n => n.previewUpdate())\n        if(this.pointer) this.pointer.tick(time)\n        if(this.stats) this.stats.update(time)\n        if(this.controller) this.controller.update(time)\n        if(this.scriptManager.isRunning()) this.scriptManager.tick(time)\n        this.renderer.render( this.scene, this.camera );\n    }\n\n    initScene() {\n\n        const $ = (sel) => document.querySelector(sel)\n        const on = (elem, type, cb) => elem.addEventListener(type,cb)\n\n        const container = this.wrapper\n        this.tweenManager = new TweenManager()\n        this.scene = new Scene();\n        this.stageRot = new Group()\n        this.scene.add(this.stageRot)\n        this.stagePos = new Group()\n        this.stageRot.add(this.stagePos)\n        this.camera = new PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 0.1, 50 );\n        this.renderer = new WebGLRenderer( { antialias: true } );\n        const renderer = this.renderer\n        renderer.setPixelRatio( window.devicePixelRatio );\n        renderer.setSize( window.innerWidth, window.innerHeight );\n        renderer.gammaOutput = true\n        renderer.vr.enabled = true;\n        container.appendChild( renderer.domElement );\n        this.vrmanager = new VRManager(renderer)\n\n        this.audioListener = new AudioListener()\n        this.props.provider.setAudioListener(this.audioListener)\n        this.camera.add(this.audioListener)\n\n        this.initContent()\n\n        window.addEventListener( 'resize', ()=>{\n            this.camera.aspect = window.innerWidth / window.innerHeight;\n            this.camera.updateProjectionMatrix();\n            this.renderer.setSize( window.innerWidth, window.innerHeight );\n        }, false );\n\n\n        on($(\"#enter-button\"),'click',()=>{\n            $(\"#overlay\").style.display = 'none'\n            //we can start playing sound now\n        })\n\n        this.vrmanager.addEventListener(VR_DETECTED,()=>{\n            console.log(\"VR detected\")\n            $(\"#enter-button\").removeAttribute('disabled',false)\n            $(\"#enter-button\").innerText = \"enter vr\"\n            on($(\"#enter-button\"),'click',()=> this.vrmanager.enterVR())\n        })\n\n        const WAIT_FOR_LOAD = false\n\n        if(!WAIT_FOR_LOAD) {\n            $(\"#loading-indicator\").style.display = 'none'\n            $(\"#enter-button\").style.display = 'block'\n            $(\"#enter-button\").removeAttribute('disabled')\n        }\n\n        this.props.provider.onRawChange(this.updateSceneOp.bind(this))\n        this.props.provider.on(TREE_ITEM_PROVIDER.DOCUMENT_SWAPPED, this.documentSwapped.bind(this))\n        SelectionManager.on(SELECTION_MANAGER.CHANGED, this.selectionChanged.bind(this))\n        //clear selection when click on the bg\n        on(this.pointer,POINTER_CLICK,()=> SelectionManager.clearSelection())\n\n        this.controller = new ThreeDOFController(this.stagePos, this.stageRot)\n        // on(this.controller,'move', this.standardProximityHandler)\n\n        this.loadScene()\n    }\n\n    selectionChanged() {\n        const sel = SelectionManager.getSelection()\n        if (sel === null && this.controls) return this.controls.detach(this.selectedNode)\n        const node = this.findNode(sel)\n        if(this.selectedNode !== node && this.controls) this.controls.detach(this.selectedNode)\n        this.selectedNode = node\n        if (this.selectedNode && this.controls) this.controls.attach(this.selectedNode, this.pointer)\n    }\n\n    standardViewClickHandler = (e)  => {\n        if(this.scriptManager.isRunning()) {\n            this.scriptManager.performClickAction(this.props.provider.accessObject(e.target.userData.graphid), e)\n        } else {\n            SelectionManager.setSelection(e.target.userData.graphid)\n        }\n    }\n\n\n    initContent() {\n        if(!this.xr) this.scene.background = new Color(0x000000);\n        const light = new DirectionalLight( 0xffffff, 1.0 );\n        light.position.set( 1, 1, 1 ).normalize();\n        this.scene.add( light );\n        this.scene.add(new AmbientLight(0xffffff,0.2))\n\n        // enable stats visible inside VR\n        this.stats = new VRStats({renderer:this.renderer})\n        if(this.props.editable) {\n            this.camera.add(this.stats)\n        }\n        this.scene.add(this.camera)\n        this.camera.matrixAutoUpdate = false\n\n        //class which handles mouse and VR controller \n        this.pointer = new Pointer(this, {\n            intersectionFilter: ((o) => o.userData.clickable),\n            cameraFollowMouse:false,\n            mouseSimulatesController:false,\n            enableLaser: true,\n            laserLength: 20,\n        })\n\n\n        const STICK_HEIGHT = 1.0\n        const stick = new Mesh(\n            new CylinderBufferGeometry(0.1,0.1,STICK_HEIGHT),\n            new MeshLambertMaterial({color:'aqua'})\n        )\n        stick.position.z = -STICK_HEIGHT/2;\n        stick.rotation.x = toRad(-90)\n        this.pointer.controller1.add(stick)\n\n\n        if(this.props.editable) {\n            this.controls = new TranslateControl()\n            this.controls.name = 'Controls'\n            on(this.controls, 'change', (e) => {\n                const sel = SelectionManager.getSelection()\n                if (sel) {\n                    const node = this.findNode(sel)\n                    const prov = this.props.provider\n                    prov.quick_setPropertyValue(sel, 'tx', node.position.x)\n                    prov.quick_setPropertyValue(sel, 'ty', node.position.y)\n                    prov.quick_setPropertyValue(sel, 'tz', node.position.z)\n                }\n            })\n        }\n\n        if(this.props.editable) {\n            this.tools = new panel2d(this.scene, this.camera)\n            this.tools.position.set(-1, 0, -3)\n            this.scene.add(this.tools)\n\n\n            this.tools.add(new button2d()\n                .setAll({x: 5, y: 5, text: 'add box'})\n                .on(POINTER_CLICK, () => {\n                    const scene = this.props.provider.accessObject(this.currentScene)\n                    this.props.provider.add3DObject(OBJ_TYPES.cube,scene)\n                }))\n            this.tools.add(new button2d()\n                .setAll({x: 5, y: 5 + 30, text: 'add sphere'})\n                .on(POINTER_CLICK, () => {\n                    const scene = this.props.provider.accessObject(this.currentScene)\n                    this.props.provider.add3DObject(OBJ_TYPES.sphere,scene)\n                }))\n            this.tools.add(new button2d()\n                .setAll({x: 5, y: 5 + 30 + 30, text: 'delete'})\n                .on(POINTER_CLICK, ()=>{\n                    deleteObject(this.props.provider)\n                }))\n            this.tools.add(new button2d()\n                .setAll({x: 5, y: 5 + 30 + 30 + 30, text: 'save'})\n                .on(POINTER_CLICK, this.props.provider.save))\n            const runButton = new button2d()\n                .setAll({x:5, y: 5+30*4, text:'run'})\n                .on(POINTER_CLICK,() => {\n                    if(this.scriptManager.isRunning()) {\n                        runButton.set('text','run')\n                        this.scriptManager.stopRunning()\n                    } else {\n                        runButton.set('text','stop')\n                        this.scriptManager.startRunning()\n                        this.scriptManager.startFirstScene()\n                    }\n                })\n            this.tools.add(runButton)\n\n            const rowLayout = (panel) => {\n                let x = 0\n                panel.comps.forEach((c) => {\n                    c.x = x\n                    c.y = 0\n                    x += c.w + panel.padding\n                })\n            }\n\n            const color_group = new group2d().setAll({x: 5, y: 5 + 30 * 5, w: 235, h: 35, layout: rowLayout})\n            SIMPLE_COLORS.forEach(c => {\n                color_group.add(new button2d()\n                    .setAll({text: ' ', normalBg: c})\n                    .on(POINTER_CLICK, () => this.props.provider.setColor(c))\n                )\n            })\n\n            this.tools.add(color_group)\n\n            this.tools.redraw()\n        }\n\n    }\n\n\n    updateSceneOp(op) {\n        //only do scenes with create_object\n        if (op.type === CREATE_OBJECT) {\n            if(op.defaults) {\n                //console.log(\"creating object with defaults\",op.defaults)\n                if(op.defaults.type === 'scene') {\n                    let node =  this.findNode(op.id)\n                    if(node) {\n                        // console.log(\"scene already exists. skipping\", node.name)\n                    } else {\n                        // console.log(\"Making a real scene\", op)\n                        const obj = this.props.provider.accessObject(op.id)\n                        node = new SceneDef().makeNode(obj, this.props.provider)\n                        this.insertNodeMapping(op.id,node)\n                        this.sceneWrappers[op.id] = node\n                        this.stagePos.add(node)\n                        // this.scene.add(node)\n                        this.swapScene(op.id)\n                    }\n                }\n            }\n        }\n        // other objects are done with insert_element\n        if (op.type === INSERT_ELEMENT) {\n            const obj = this.props.provider.accessObject(op.value)\n            if (obj.type === 'scene') return // console.log(\"skipping insert scene\")\n            if(is3DObjectType(obj.type)) {\n                const nodeObj = get3DObjectDef(obj.type).makeNode(obj, this.props.provider)\n                on(nodeObj, POINTER_CLICK, this.standardViewClickHandler)\n                this.insertNodeMapping(obj.id, nodeObj)\n                this.findNode(obj.parent).add(nodeObj)\n                return\n            }\n            if(obj.type === TOTAL_OBJ_TYPES.ASSETS_LIST) return\n            if(obj.type === TOTAL_OBJ_TYPES.ASSET) return\n            if(obj.type === TOTAL_OBJ_TYPES.BEHAVIORS_LIST) return\n            if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR) return\n            if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) return\n            console.warn(\"unknown object type\", obj)\n            return\n        }\n        if (op.type === SET_PROPERTY) {\n            const obj = this.props.provider.accessObject(op.object)\n            if(obj.type === 'asset') return\n            if(obj.type === 'assets') return\n            const node = this.findNode(op.object)\n            if (node) {\n                if(op.name === 'parent') return\n                if(obj.type === 'scene') return new SceneDef().updateProperty(node,obj,op,this.props.provider)\n                if(is3DObjectType(obj.type)) return get3DObjectDef(obj.type).updateProperty(node,obj,op, this.props.provider)\n            } else {\n                console.log(\"could not find the node for object id:\", op)\n                //console.log(\"objects are\",this.obj_node_map)\n            }\n            return\n        }\n        if(op.type === DELETE_ELEMENT) {\n            const obj = this.props.provider.accessObject(op.value)\n            if(is3DObjectType(obj.type)) {\n                const node = this.findNode(obj.id)\n                this.findNode(obj.parent).remove(node)\n            }\n            return\n        }\n        // console.log('skipping', op.type)\n    }\n    documentSwapped() {\n        console.log(\"totally new document!\")\n        //nuke all the old stuff\n        Object.keys(this.sceneWrappers).forEach(key => {\n            const scene = this.sceneWrappers[key]\n            if(this.controls) scene.remove(this.controls)\n            this.stagePos.remove(scene)\n        })\n        this.sceneWrappers = {}\n        this.obj_node_map = {}\n        // this.setState({scene: -1})\n        //make new stuff\n        const graph = this.props.provider.getDocGraph()\n        console.log(\"we are building the graph\")\n        //console.log(\"we are rebuilding using this graph\",graph)\n        this.rebuildNode(graph,\"\")\n    }\n\n    rebuildNode(obj, inset) {\n        console.log(inset,\"rebuilding\",obj.type)\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) {\n            const node = new SceneDef().makeNode(obj, this.props.provider)\n            this.insertNodeMapping(obj.id,node)\n            this.sceneWrappers[obj.id] = node\n            this.stagePos.add(node)\n            this.swapScene(obj.id)\n        }\n        if(is3DObjectType(obj.type)) {\n            const node = get3DObjectDef(obj.type).makeNode(obj, this.props.provider)\n            on(node, POINTER_CLICK, this.standardViewClickHandler)\n            this.insertNodeMapping(obj.id, node)\n            this.findNode(obj.parent).add(node)\n        }\n        if(obj.children) {\n            obj.children.forEach(ch => {\n                this.rebuildNode(ch,inset+\"   \")\n            })\n        }\n    }\n\n    swapScene(id) {\n        this.currentScene = id\n        console.log(\"swapping to the scene\",id)\n        //make all scenes invisible except the right one\n        Object.keys(this.sceneWrappers).forEach(key => {\n            const scene = this.sceneWrappers[key]\n            scene.visible = (key === id)\n            if(this.controls) scene.remove(this.controls)\n        })\n        if(this.controls) this.sceneWrappers[id].add(this.controls)\n        this.sceneWrappers[id].position.x = 0\n        this.sceneWrappers[id].position.z = 0\n    }\n\n\n    loadScene() {\n    }\n\n    insertNodeMapping(id, node) {\n        if (typeof id !== 'string') throw new Error(\"cannot map an object to an object. invalid call in insertNodeMapping\")\n        this.obj_node_map[id] = node\n        if(node.previewUpdate) this.previewUpdateNodes.push(node)\n        node.userData.graphid = id\n    }\n\n    findNode(id) {\n        if (!this.obj_node_map[id]) console.warn(\"could not find node for id\", id)\n        return this.obj_node_map[id]\n    }\n\n\n}\n\n\n","import React, {Component} from 'react'\nimport {DialogManager, HBox, VBox} from 'appy-comps'\nimport {listToArray} from '../../syncgraph/utils'\nimport {Dialog} from '../../common/Dialog'\n\nexport class AddGLTFAssetDialog extends Component {\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        listToArray(this.fileinput.files).forEach(file => {\n            console.log(\"got the file\", file)\n        })\n    }\n\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n            <VBox>\n                <h3>add GLTF file assets</h3>\n                <p>\n                    chose <b>the directory</b> containing the GLTF file\n                </p>\n                <input type=\"file\" ref={(obj) => this.fileinput = obj} onChange={this.selectedFile} multiple={true}\n                       webkitdirectory=\"true\"/>\n                <HBox>\n                    <button onClick={this.cancel}>cancel</button>\n                    <button onClick={this.okay}>okay</button>\n                </HBox>\n            </VBox>\n        </Dialog>\n    }\n\n    selectedFile = (e) => {\n        console.log(\"selected a file\", e.target)\n    }\n}\n","import React, {Component} from 'react'\nimport {DialogManager, HBox, VBox} from 'appy-comps'\nimport {listToArray} from '../../syncgraph/utils'\nimport {addGLBAssetFromFile} from '../AssetActions'\nimport {Dialog} from '../../common/Dialog'\n\nexport class AddGLBAssetDialog extends Component {\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        listToArray(this.fileinput.files).forEach(file => {\n            addGLBAssetFromFile(file, this.props.provider)\n        })\n    }\n\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n            <VBox>\n                <h3>add GLB to assets</h3>\n                <p>\n                    choose a GLB file\n                </p>\n                <input type=\"file\" ref={(obj) => this.fileinput = obj} onChange={this.selectedFile} multiple={true}/>\n                <HBox>\n                    <button onClick={this.cancel}>cancel</button>\n                    <button onClick={this.okay}>okay</button>\n                </HBox>\n            </VBox>\n        </Dialog>\n    }\n\n    selectedFile = (e) => {\n        console.log(\"selected a file\", e.target)\n    }\n}\n","import React, {Component} from 'react'\nimport {DialogManager, HBox, VBox} from 'appy-comps'\nimport {listToArray} from '../../syncgraph/utils'\nimport {ToggleButton, Toolbar} from '../../common/GridEditorApp'\nimport {addAudioAssetFromFile, addAudioAssetFromURL} from '../AssetActions'\nimport {Dialog} from '../../common/Dialog'\n\nexport class AddAudioAssetDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            view:'local',\n            url:\"\",\n        }\n        this.fileInput = React.createRef();\n    }\n\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        if(this.state.view === 'remote') {\n            console.log(\"adding the url\",this.state.url)\n            addAudioAssetFromURL(null,this.state.url, this.props.provider)\n        } else {\n            console.log(\"the file input is\",this.fileInput)\n            listToArray(this.fileInput.current.files).forEach(file => {\n                addAudioAssetFromFile(file, this.props.provider)\n            })\n        }\n    }\n    switchLocal = () => this.setState({view:'local'})\n    switchRemote = () => this.setState({view:'remote'})\n\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n            <VBox grow>\n                <h3>add audio to assets</h3>\n                <VBox grow>\n                    <Toolbar>\n                        <ToggleButton onClick={this.switchLocal} selected={this.state.view==='local'}>local</ToggleButton>\n                        <ToggleButton onClick={this.switchRemote} selected={this.state.view==='remote'}>remote</ToggleButton>\n                    </Toolbar>\n                    {this.renderSelectedPanel()}\n                </VBox>\n                <HBox>\n                    <button onClick={this.cancel}>cancel</button>\n                    <button onClick={this.okay}>okay</button>\n                </HBox>\n            </VBox>\n        </Dialog>\n    }\n\n    selectedFile = (e) => {\n        //console.log(\"selected a file\", e.target)\n        this.setState({fileInput:e.target.value})\n    }\n\n    typedURL = (e) => {\n        this.setState({url:e.target.value})\n    }\n\n    renderSelectedPanel() {\n        if(this.state.view === 'local') {\n            return <HBox>\n                <label>File\n                    <input key=\"f1\" type=\"file\" onChange={this.selectedFile} ref={this.fileInput}/>\n                </label>\n            </HBox>\n        } else {\n            return <HBox>\n                <label>URL\n                    <input key=\"f2\" value={this.state.url} type=\"input\" onChange={this.typedURL}/>\n                </label>\n            </HBox>\n        }\n    }\n}\n","import React, {Component} from 'react'\nimport {DialogManager, HBox, VBox} from 'appy-comps'\nimport {Dialog} from '../../common/Dialog'\n\nexport class UnsavedDocumentDialog extends Component {\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        this.props.onAnyway()\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel} width=\"600px\" height=\"auto\">\n            <VBox grow>\n                <h3>Warning. Your document has unsaved changes.</h3>\n                <p>Press cancel to go back</p>\n                <p>Press continue to continue anyway and lose the unsaved changes</p>\n                <HBox>\n                    <button onClick={this.cancel}>cancel</button>\n                    <button onClick={this.okay}>continue!</button>\n                </HBox>\n            </VBox>\n        </Dialog>\n    }\n}\n\n","import React, {Component} from 'react'\nimport {DialogManager, HBox, VBox} from 'appy-comps'\nimport {toQueryString} from '../../utils'\nimport {AuthModule} from '../AuthModule'\nimport {Dialog} from '../../common/Dialog'\n\n\nexport class OpenFileDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            docList:[]\n        }\n    }\n    refreshList = () => {\n        this.props.provider.loadDocList().then((docs) => this.setState({docList:docs}))\n    }\n    componentDidMount() {\n        this.refreshList()\n    }\n    generateDocUrl(doc) {\n        const opts = Object.assign({},this.props.provider.options,{\n            mode:'edit',\n            switcher:false,\n            doc:doc.id\n        })\n        const url = `./?${toQueryString(opts)}`\n        return url\n    }\n    deleteDoc(info) {\n        return this.props.provider.removeDoc(info).then((res)=>{\n            console.log('removed?',res)\n            this.refreshList()\n        })\n    }\n\n    dismiss = () => {\n        DialogManager.hide()\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.dismiss}>\n            <h3>Open document</h3>\n            <VBox scroll style={{flex:1}}>\n                <ul>{this.state.docList.map((doc, i) => {\n\n                    return <li key={i}>\n                        <b>{doc.title}</b>\n                        <a className={\"button\"} href={this.generateDocUrl(doc)}>open</a>\n                        {this.renderDeleteButton(doc)}\n                    </li>\n                })}\n                </ul>\n            </VBox>\n            <HBox className={\"footer\"}>\n                <button onClick={this.dismiss}>dismiss</button>\n            </HBox>\n        </Dialog>\n    }\n\n    renderDeleteButton(doc) {\n        if(!AuthModule.supportsDocDelete()) return \"\"\n        return <button onClick={()=>this.deleteDoc(doc)}>delete</button>\n\n    }\n\n}\n","import React, {Component} from 'react'\nimport {DialogManager, HBox, VBox} from 'appy-comps'\nimport {isAudioType, isGLTFType, isImageType, isVideoType} from '../Common'\nimport {AuthModule} from '../AuthModule'\nimport {\n    addAudioAssetFromURL,\n    addGLBAssetFromURL,\n    addImageAssetFromExpandedURL,\n    addVideoAssetFromURL\n} from '../AssetActions'\nimport {Dialog} from '../../common/Dialog'\n\nexport class OpenAssetDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            assetList:[]\n        }\n    }\n    refreshList = () => {\n        this.props.provider.loadAssetList()\n            .then((assets) => {\n                if(this.props.filter) assets = assets.filter(this.props.filter)\n                this.setState({assetList:assets})\n            })\n    }\n    componentDidMount() {\n        this.refreshList()\n    }\n    addAsset(info) {\n        DialogManager.hide()\n        if(isImageType(info.mimeType)) {\n            return addImageAssetFromExpandedURL(info.id, info.url,info.mimeType, info.title, this.props.provider)\n        }\n        if(isAudioType(info.mimeType)) {\n            return addAudioAssetFromURL(info.id, info.url, info.mimeType, info.title, this.props.provider)\n        }\n        if(isVideoType(info.mimeType)) {\n            return addVideoAssetFromURL(info.id, info.url, info.mimeType, info.title, this.props.provider)\n        }\n        if(isGLTFType(info.mimeType)) {\n            return addGLBAssetFromURL(info.id, info.url, info.mimeType, info.title, this.props.provider)\n        }\n        console.log(\"can't add this type\",info.mimeType)\n    }\n    deleteAsset(info) {\n        return this.props.provider.removeAssetSource(info).then((res)=>{\n            console.log('removed?',res)\n            this.refreshList()\n        })\n    }\n\n    okay = () => {\n        DialogManager.hide()\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.okay}>\n            <h3>Add Asset</h3>\n            <VBox scroll grow>\n                <ul>{this.state.assetList.map((doc, i) => {\n                    return <li key={i}>\n                        <b>{doc.title} </b>\n                        <i> {doc.mimeType}</i>\n                        <button onClick={()=>this.addAsset(doc)}>add</button>\n                        {this.renderDeleteButton(doc)}\n                    </li>\n                })}\n                </ul>\n            </VBox>\n            <HBox className={\"footer\"}>\n                <button onClick={this.okay}>close</button>\n            </HBox>\n        </Dialog>\n    }\n\n    renderDeleteButton(doc) {\n        if(!AuthModule.supportsAssetUpload()) return \"\"\n        return <button onClick={()=>this.deleteAsset(doc)}>delete</button>\n\n    }\n}\n","import React, {Component} from \"react\"\nimport {TREE_ITEM_PROVIDER} from '../TreeItemProvider'\nimport selMan, {SELECTION_MANAGER} from '../SelectionManager'\nimport {TOTAL_OBJ_TYPES} from './Common'\nimport AceEditor from 'react-ace'\nimport 'brace/mode/javascript'\nimport 'brace/theme/github'\n\nexport default class ScriptEditor extends Component {\n    constructor(props) {\n        super(props)\n        this.refresh = () => {\n            const id = selMan.getSelection()\n            const obj = this.props.provider.accessObject(id)\n            console.log('id',id,obj.exists(), obj.type)\n            if(obj.exists() && obj.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) {\n                this.props.provider.fetchBehaviorAssetContents(id).then(text => {\n                    this.setState({id:id, text:text})\n                })\n            } else {\n            }\n        }\n        this.state = {\n            id:null,\n            text:'empty',\n        }\n    }\n    componentDidMount() {\n        this.refresh()\n        this.props.provider.on(TREE_ITEM_PROVIDER.PROPERTY_CHANGED,this.refresh)\n        selMan.on(SELECTION_MANAGER.CHANGED,this.swap)\n    }\n\n    componentWillUnmount() {\n        this.props.provider.off(TREE_ITEM_PROVIDER.PROPERTY_CHANGED,this.refresh)\n        selMan.off(SELECTION_MANAGER.CHANGED,this.swap)\n    }\n    swap = () => {\n        const obj = this.props.provider.accessObject(selMan.getSelection())\n        if(obj.exists()  && obj.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) {\n            this.refresh()\n        }\n    }\n    changeText = (value) => this.setState({text:value})\n    save = (e) => {\n        this.props.provider.updateBehaviorAssetContents(this.state.id,this.state.text)\n    }\n    render() {\n        if(this.state.id === null) return <div>loading</div>\n        return <AceEditor mode=\"javascript\"\n                          theme=\"github\"\n                          name=\"script-editor\"\n                          value={this.state.text}\n                          onChange={this.changeText}\n                          onBlur={this.save}\n                          showGutter={true}\n                          width={'100%'}\n                          height={'100%'}\n        />\n    }\n\n}","import React, {Component} from 'react'\nimport {DialogManager, HBox, VBox} from 'appy-comps'\nimport {Spacer} from '../../common/GridEditorApp'\nimport {AuthModule} from '../AuthModule'\nimport {Dialog} from '../../common/Dialog'\n\nexport class OpenScriptDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            scripts:[]\n        }\n    }\n    refreshList = () => {\n        this.props.provider.loadScriptList()\n            .then((scripts) => this.setState({scripts:scripts}))\n    }\n    componentDidMount() {\n        this.refreshList()\n    }\n    addScript(info) {\n        DialogManager.hide()\n        console.log(\"URL is\",info.url)\n        info.url = info.name\n        console.log(\"Now URL is\",info.url)\n        const beh = this.props.provider.addBehaviorAssetFromURL(info)\n        if(this.props.onAdd) this.props.onAdd(beh)\n    }\n    deleteScript(info) {\n        return this.props.provider.removeBehaviorAssetSource(info.name)\n            .then(()=> this.refreshList())\n    }\n\n    okay = () => DialogManager.hide()\n\n    render() {\n        return <Dialog visible={true} onScrimClick={this.okay}>\n            <h3>Choose Behavior Script</h3>\n            <VBox scroll>\n                <ul className=\"behaviors-list\">{this.state.scripts.map((doc, i) => {\n                    return <HBox key={doc.name}>\n                        <VBox>\n                            <div>\n                                <i>{doc.name}</i> -  <b>{doc.title}</b>\n                            </div>\n\n                            <p>{doc.description}</p>\n                        </VBox>\n                        <Spacer/>\n                        <button onClick={()=>this.addScript(doc)}>add</button>\n                        {this.renderDeleteButton(doc)}\n                    </HBox>\n                })}\n                </ul>\n            </VBox>\n            <HBox className={\"footer\"}>\n                <button onClick={this.okay}>close</button>\n            </HBox>\n        </Dialog>\n    }\n\n    renderDeleteButton(doc) {\n        if(!AuthModule.supportsScriptEdit()) return \"\"\n        return <button onClick={()=>this.deleteScript(doc)}>delete</button>\n    }\n\n}\n","export const CUSTOM_BEHAVIOR_SCRIPT = `\n/*\n #title untitled behavior\n #description does something\n*/\n({\n  // defines a target property. must be a scene\n    properties: {\n        scene: { \n            type:'enum', \n            title: 'target scene', \n            value:null, \n            hints: {\n                type:'node',\n                nodeType:'scene'\n            }\n        },\n    },\n    start: function(evt) {\n        //called when the program starts\n    },\n    click: function(evt) {\n        //called when object is clicked on\n        //this.navigateScene(this.properties.scene)\n    }\n})\n`\n\n\n\nexport const CUSTOM_SCENE_SCRIPT = `\n/*\n #title scene script\n #description does something\n*/\n({\n    // defines a target property. must be a scene\n    properties: {\n        scene: { \n            type:'enum', \n            title: 'target scene', \n            value:null, \n            hints: {\n                type:'node',\n                nodeType:'scene'\n            }\n        },\n    },\n    start: function(evt) {\n        //called when the program starts\n    },\n    enter: function(evt) {\n        //called when entering a scene\n    },\n    tick: function(evt) {\n        //called on every frame\n    },\n    exit: function(evt) {\n        //called when exiting a scene\n    },\n    stop: function(evt) {\n        //called when the program stops\n    },\n})\n`","import React, {Component} from 'react'\nimport QRCode from 'qrcode'\n\nexport default class QRCanvas extends Component {\n    componentDidMount() {\n        if (this.canvas) this.redraw()\n    }\n\n    componentWillReceiveProps(newProps) {\n        if (this.canvas) this.redraw()\n    }\n\n    redraw() {\n        QRCode.toCanvas(this.canvas, this.props.url, {width: this.props.width, height: this.props.height})\n    }\n\n    render() {\n        let style = {}\n        if (this.props.style) Object.assign(style, this.props.style)\n        return <canvas width={this.props.width} height={this.props.height} ref={(canvas) => this.canvas = canvas} style={style}/>\n    }\n}","import React, {Component} from 'react'\nimport {DialogManager, HBox, VBox} from 'appy-comps'\nimport QRCanvas from '../../common/QRCanvas'\nimport {Dialog} from '../../common/Dialog'\n\nexport class QRDialog extends Component {\n\n    okay = () => {\n        DialogManager.hide()\n    }\n\n    render() {\n        let url = null\n        if(this.props.url) url = this.props.url\n        let wurl = url.replace(\"https\",\"wxrv\")\n        wurl = wurl.replace(\"http\",\"wxrv\")\n        return <Dialog visible={true} onScrimClick={this.okay}>\n            <VBox grow>\n                <h3>{this.props.text?this.props.text:'Scan'}</h3>\n                <VBox grow>\n                    <label><a href={url}>{url}</a></label>\n                    <QRCanvas url={wurl} width={160} height={160}/>\n                </VBox>\n                <HBox>\n                    <button onClick={this.okay}>dismiss</button>\n                </HBox>\n            </VBox>\n        </Dialog>\n    }\n\n}\n","import React, {Component} from 'react'\nimport {DialogManager, HBox, VBox} from 'appy-comps'\nimport {AuthModule} from '../AuthModule'\nimport {Dialog} from '../../common/Dialog'\nimport {Spacer} from '../../common/GridEditorApp'\n\nexport class PasswordDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            field:\"\"\n        }\n    }\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        AuthModule.doPasswordLogin(this.state.field)\n    }\n    keyDown = (e) => {\n        if(e.key === 'Enter') this.okay()\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel} width=\"600px\" height=\"auto\">\n            <VBox grow>\n                <h3>login with the password from your env file</h3>\n                <label>password</label>\n                <input type={\"password\"} value={this.state.field}\n                       onKeyDown={this.keyDown}\n                       onChange={(e)=>{\n                    this.setState({field:e.target.value})\n                }}/>\n                <HBox>\n                    <Spacer/>\n                    <button onClick={this.cancel}>cancel</button>\n                    <button onClick={this.okay}>okay</button>\n                </HBox>\n            </VBox>\n        </Dialog>\n    }\n}\n\n","import React, {Component} from 'react'\nimport {DialogManager, HBox, VBox} from 'appy-comps'\nimport {AuthModule} from '../AuthModule'\nimport {getLoginURL} from '../../TreeItemProvider'\nimport {Dialog} from '../../common/Dialog'\n\nexport class GithubAuthDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            data:null\n        }\n    }\n    componentDidMount() {\n        console.log(\"opening dialog\")\n        AuthModule.getJSON(getLoginURL()).then(data => {\n            console.log(\"got the data\",data)\n            this.setState({data:data})\n        })\n    }\n\n    cancel = () => {\n        DialogManager.hide()\n    }\n    okay = () => {\n        DialogManager.hide()\n        console.log(\"opening window with the data\",this.state.data)\n        AuthModule.login(this.state.data)\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n            <VBox grow>\n                <h3>Github Auth</h3>\n                <p>To log into MrEd you need a github account. Press the button\n                below to log into github and approve MrEd's access. The app will only use\n                Github for authentication. It does not have access to any of your projects or code.\n                </p>\n                <button onClick={this.okay}>Open Github</button>\n                <HBox>\n                    <button onClick={this.cancel}>cancel</button>\n                </HBox>\n            </VBox>\n        </Dialog>\n    }\n}\n\n","import React, {Component} from 'react'\n\nexport class ErrorCatcher extends Component {\n\n\n    constructor(props, context) {\n        super(props, context)\n        this.state = {error:false }\n    }\n\n    componentDidCatch(error, errorInfo) {\n        this.setState({error:true})\n        const logger = this.props.logger\n        if(!logger) {\n            console.log(\"NO LOGGER!\")\n            return\n        }\n        logger.error(\"an error occurred at the react level\")\n        logger.error(error)\n        logger.error(errorInfo)\n    }\n\n    render() {\n        if(this.state.error === true) {\n            return <div><h1>An error happened. Please look at the console</h1></div>\n        }\n\n        return this.props.children\n    }\n\n}","import {LinearFilter, NearestFilter, sRGBEncoding, Texture} from 'three'\nimport {AuthModule} from './AuthModule'\n\n/**\n *\n * Gif parser by @gtk2k\n * https://github.com/gtk2k/gtk2k.github.io/tree/master/animation_gif\n *\n */\n\nconst parseGIF = function(gif) {\n    console.log(\"parsing\",gif)\n    let pos = 0;\n    const delayTimes = [];\n    let graphicControl = null;\n    const frames = [];\n    const disposals = [];\n    const transparencies = [];\n    const transparentColors= [];\n    let loopCnt = 0;\n    if (\n        gif[0] === 0x47 &&\n        gif[1] === 0x49 &&\n        gif[2] === 0x46 && // 'GIF'\n        gif[3] === 0x38 &&\n        (gif[4] === 0x39 || gif[4] === 0x37) && \n        gif[5] === 0x61\n    ) {\n        // '89a'\n        pos += 13 + +!!(gif[10] & 0x80) * Math.pow(2, (gif[10] & 0x07) + 1) * 3;\n        const gifHeader = gif.subarray(0, pos);\n        while (gif[pos] && gif[pos] !== 0x3b) {\n            const offset = pos,\n                blockId = gif[pos];\n            if (blockId === 0x21) {\n                const label = gif[++pos];\n                if ([0x01, 0xfe, 0xf9, 0xff].indexOf(label) !== -1) {\n                    label === 0xf9 && delayTimes.push((gif[pos + 3] + (gif[pos + 4] << 8)) * 10);\n                    label === 0xff && (loopCnt = gif[pos + 15] + (gif[pos + 16] << 8));\n                    while (gif[++pos]) pos += gif[pos];\n                    if (label === 0xf9) {\n                        graphicControl = gif.subarray(offset, pos + 1);\n                        disposals.push((graphicControl[3] >> 2) & 0x07);\n                        transparencies.push((graphicControl[3]) & 0x01);\n                        transparentColors.push(graphicControl[6]);\n                    }\n                } else {\n                    throw new Error(\"parseGIF: unknown label\");\n                }\n            } else if (blockId === 0x2c) {\n                pos += 9;\n                pos += 1 + +!!(gif[pos] & 0x80) * (Math.pow(2, (gif[pos] & 0x07) + 1) * 3);\n                while (gif[++pos]) pos += gif[pos];\n                const imageData = gif.subarray(offset, pos + 1);\n                frames.push(URL.createObjectURL(new Blob([gifHeader, graphicControl, imageData])));\n            } else {\n                throw new Error(\"parseGIF: unknown blockId\");\n            }\n            pos++;\n        }\n    } else {\n        throw new Error(\"parseGIF: no GIF89a\");\n    }\n    return { delayTimes, loopCnt, frames, disposals, transparencies, transparentColors };\n};\n\n//\n// self.onmessage = msg => {\n//     try {\n//         const result = parseGIF(new Uint8Array(msg.data.payload));\n//         self.postMessage({ id: msg.data.id, result });\n//     } catch (e) {\n//         self.postMessage({ id: msg.data.id, err: e.message });\n//     }\n// };\n//\n\nclass GIFTexture extends Texture {\n    constructor(frames, delays, disposals, transparencies, transparentColors) {\n        super(document.createElement(\"canvas\"));\n        this.image.width = frames[0].width;\n        this.image.height = frames[0].height;\n\n        this._ctx = this.image.getContext(\"2d\");\n\n        this.generateMipmaps = false;\n        this.isVideoTexture = true;\n        this.minFilter = NearestFilter;\n\n        this.frames = frames;\n        this.delays = delays;\n        this.disposals = disposals;\n        this.transparencies = transparencies // is each frame transparent or not\n\n        this.transparent = false\n        this.transparencies.forEach( (value) => {\n            if (value) this.transparent = true\n        })\n \n        this.transparentColors = transparentColors // the color index for transparent colors\n        this.frame = 0;\n        this.frameStartTime = Date.now();\n        this.firstDrawCount = 0\n        this.playing = true\n    }\n\n    update() {\n        if (!this.frames || !this.delays || !this.disposals) return;\n        if(this.firstDrawCount > this.frames.length && !this.playing) return;\n        const now = Date.now();\n        if (now - this.frameStartTime > this.delays[this.frame]) {\n            if (this.disposals[this.frame] === 2) {\n                this._ctx.clearRect(0, 0, this.image.width, this.image.width);\n            }\n            this.frame = (this.frame + 1) % this.frames.length;\n            this.frameStartTime = now;\n            this._ctx.drawImage(this.frames[this.frame], 0, 0, this.image.width, this.image.height);\n            this.needsUpdate = true;\n            this.firstDrawCount+=1\n        }\n    }\n}\n\n\nexport function createGIFTexture(url, prov) {\n    return new Promise((resolve, reject) => {\n        fetch(url,{ mode: \"cors\" })\n            .then(r => r.arrayBuffer())\n            .then(r => new Uint8Array(r))\n            .then(r => {\n                if(prov) {\n                    if(r.length < 100) {\n                        prov.getLogger().log(\"array length is too short\", String.fromCharCode(115))\n                        let str = \"\"\n                        for(let i=0; i<r.length; i++) {\n                            str += String.fromCharCode(r[i])\n                        }\n                        prov.getLogger().log(str)\n                    }\n                }\n                return r\n            })\n            .then(rawImageData => parseGIF(rawImageData, [rawImageData]))\n            .then(result => {\n                console.log(\"result of gif parsing is\",result)\n                const { frames, delayTimes, disposals, transparencies, transparentColors } = result;\n                let loadCnt = 0;\n                for (let i = 0; i < frames.length; i++) {\n                    const img = new Image();\n                    img.crossOrigin = \"anonymous\"\n                    img.onload = e => {\n                        loadCnt++;\n                        frames[i] = e.target;\n                        if (loadCnt === frames.length) {\n                            const texture = new GIFTexture(frames, delayTimes, disposals, transparencies, transparentColors);\n                            texture.image.src = url;\n                            texture.encoding = sRGBEncoding;\n                            texture.minFilter = LinearFilter;\n                            resolve(texture);\n                        }\n                    };\n                    img.src = frames[i];\n                }\n            })\n            .catch(reject);\n    });\n}","import {ASSET_TYPES} from './Common'\nimport {TextureLoader, VideoTexture, Audio, AudioLoader} from 'three'\nimport {AuthModule} from './AuthModule'\nimport {getAssetsURL} from '../TreeItemProvider'\nimport {createGIFTexture} from './GifSupport'\nimport GLTFLoader from './GLTFLoader'\nimport DRACOLoader from './DRACOLoader'\n\nexport class AssetsManager {\n    constructor(provider) {\n        this.provider = provider\n        this.assets_url_map = {}\n        this.videocache = {}\n        this.audiocache = {}\n    }\n\n    cacheAssetsList() {\n        return AuthModule.getJSON(`${getAssetsURL()}list`).then(assets => {\n            if(!assets || !assets.forEach) return\n            if(AuthModule.supportsAssetUpload()) {\n                //doc server version\n                assets.forEach(asset => {\n                    this.assets_url_map[asset.id] = getAssetsURL()+asset.id\n                })\n            } else {\n                //glitch server version\n                assets.forEach(asset => {\n                    this.assets_url_map[asset.title] = asset.url\n                })\n                console.log(\"cached the assets\",this.assets_url_map)\n            }\n        })\n    }\n\n    getAssetURL(asset) {\n        if(AuthModule.supportsAssetUpload() && !AuthModule.isLoggedIn()) {\n            //TODO: Josh hack to work around listing assets when not logged in on docserver\n            return getAssetsURL()+asset.assetId\n        }\n        if(asset.assetId) {\n            return this.assets_url_map[asset.assetId]\n        } else {\n            return asset.src\n        }\n    }\n\n\n    playMediaAsset(asset, trusted=false) {\n        const lg = this.provider.getLogger()\n        if(asset.subtype === ASSET_TYPES.AUDIO) {\n            lg.log(\"playing the audio asset\",asset)\n            const url = this.getAssetURL(asset)\n            lg.log(\"playing the audio from the url\",url)\n            if(this.audiocache[asset.id]) {\n                //already loaded\n                const sound = this.audiocache[asset.id]\n                if(sound.isPlaying) sound.stop()\n                sound.play()\n            } else {\n                const sound = new Audio(this.provider.getAudioListener())\n                const audioLoader = new AudioLoader()\n                audioLoader.load(url, function (buffer) {\n                    sound.setBuffer(buffer);\n                    sound.setLoop(false);\n                    sound.setVolume(0.5);\n                    sound.play();\n                });\n                this.audiocache[asset.id] = sound\n            }\n        }\n        if(asset.subtype === ASSET_TYPES.VIDEO) {\n            lg.log(\"playing the media asset\", asset)\n            const url = this.getAssetURL(asset)\n            lg.log(\"playing the url yaeah\", url)\n            const video = this.videocache[url]\n            if (video) {\n                if(trusted) video.muted = false\n                video.play()\n            }\n        }\n\n    }\n\n    stopMediaAsset(asset) {\n        if(asset.subtype === ASSET_TYPES.AUDIO) {\n            if(this.audiocache[asset.id]) {\n                this.audiocache[asset.id].stop()\n                delete this.audiocache[asset.id]\n                this.audiocache[asset.id] = null\n            }\n        }\n        if(asset.subtype === ASSET_TYPES.VIDEO) {\n            if(this.videocache[asset.id]) {\n                this.videocache[asset.id].stop()\n                delete this.videocache[asset.id]\n                this.videocache[asset.id] = null\n            }\n        }\n    }\n\n    stopAllMedia() {\n        const cache = this.videocache\n        Object.keys(cache).forEach(key => {\n            const item = cache[key]\n            if(item.pause) {\n                item.pause()\n            }\n        })\n        Object.keys(this.audiocache).forEach(key => {\n            if(this.audiocache[key].stop) {\n                this.audiocache[key].stop()\n            }\n        })\n\n    }\n\n\n    getTexture(id) {\n        const asset = this.provider.accessObject(id)\n        if(!asset.exists()) {\n            this.provider.getLogger().error(\"==== invalid asset reference\",id)\n            return Promise.resolve(null)\n        }\n        const url = this.getAssetURL(asset)\n        if(!url) {\n            this.provider.getLogger().error(\"==== null url from asset\",asset)\n            return Promise.resolve(null)\n        }\n        this.provider.getLogger().log(\"loading asset url\",url)\n        if(asset.subtype === ASSET_TYPES.IMAGE) {\n            this.provider.getLogger().log(\"asset info\",asset)\n            if(asset.format === 'image/gif') {\n                return createGIFTexture(url,this.provider)\n            } else {\n                return new Promise((res,rej)=>{\n                    new TextureLoader().load(url,\n                        (tex)=>res(tex),\n                        (p)=>console.log(\"Progress\",p),\n                        (e)=>{\n                            this.provider.getLogger().error(\"error loading texture\",e)\n                            rej(e)\n                        })\n                    })\n            }\n        }\n        if(asset.subtype === ASSET_TYPES.VIDEO) {\n            let video\n            if(!this.videocache[url]) {\n                video = document.createElement('video')\n                video.crossOrigin = 'anonymous'\n                video.preload = \"auto\"\n                // video will only play inline on mobile devices if it's muted\n                // we will loop video\n                video.muted = true;\n                //video.loop = true;\n                video.setAttribute( 'playsinline', '' );\n\n                video.src = url\n                this.videocache[url] = video\n            } else {\n                video = this.videocache[url]\n            }\n            return Promise.resolve(new VideoTexture(video))\n        }\n        return Promise.resolve(null)\n    }\n\n    getGLTF(id) {\n        const asset = this.provider.accessObject(id)\n        if(!asset.exists()) {\n            this.provider.getLogger().error(\"==== invalid asset reference\",id)\n            return Promise.resolve(null)\n        }\n\n        const url = this.getAssetURL(asset)\n        if(!url) {\n            this.provider.getLogger().error(\"==== null url from asset\",asset)\n            return Promise.resolve(null)\n        }\n        this.provider.getLogger().log(\"ModelDef loading the model asset url\",url)\n\n        const loader = new GLTFLoader()\n        loader.setCrossOrigin('anonymous');\n        const draco = new DRACOLoader()\n        DRACOLoader.setDecoderPath( './draco/' );\n        loader.setDRACOLoader( draco );\n        return new Promise((res,rej)=>{\n            loader.load(url, (gltf)=> res(gltf),\n                (xhr)=> console.log('Progress',xhr),\n                (error)=>{\n                    this.provider.getLogger().error(\"error loading texture\",error)\n                    rej(error)\n                })\n        })\n\n    }\n}","import React, {Component} from 'react'\nimport {DialogManager, HBox} from 'appy-comps'\nimport {Dialog} from '../../common/Dialog'\nimport {Spacer} from '../../common/GridEditorApp'\n\n\nexport class SaveDocumentAsDialog extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            newTitle:\"Copy of \" + props.provider.getDocTitle()\n        }\n    }\n    edited = (e) => {\n        this.setState({newTitle:e.target.value})\n    }\n    dismiss = () => {\n        DialogManager.hide()\n    }\n    saveAs = () => {\n        DialogManager.hide()\n        this.props.provider.duplicateDocument(this.state.newTitle)\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.dismiss} width=\"600px\" height=\"auto\">\n            <h3>Save Document As</h3>\n            <HBox>\n                <label>title</label>\n                <input type=\"text\" value={this.state.newTitle} onChange={this.edited} style={{flex:1.0}}/>\n            </HBox>\n            <HBox className={\"footer\"}>\n                <Spacer/>\n                <button onClick={this.dismiss}>cancel</button>\n                <button onClick={this.saveAs}>save as</button>\n            </HBox>\n        </Dialog>\n    }\n\n}\n","import React, {Component} from 'react'\nimport {DialogManager, HBox, VBox} from 'appy-comps'\nimport {Dialog} from '../../common/Dialog'\n\nexport class BadAssetsDialog extends Component {\n    dismiss = () => {\n        DialogManager.hide()\n    }\n    render() {\n        return <Dialog visible={true} onScrimClick={this.cancel}>\n            <VBox grow>\n                <h3>Warning. There were errors loading some assets</h3>\n                <ul>\n                {this.props.provider.badAssets.map((asset,i) => {\n                    return <li key={i}><b>{asset.title}</b>\n                        <br/>{asset.src}\n                    </li>\n                })}\n                </ul>\n                <HBox>\n                    <button onClick={this.dismiss}>keep going anyway</button>\n                </HBox>\n            </VBox>\n        </Dialog>\n    }\n}\n\n","import SyncGraphProvider from '../syncgraph/SyncGraphProvider'\nimport React, {Component} from 'react'\nimport GridEditorApp, {MenuPopup, Panel, Spacer, Toolbar} from '../common/GridEditorApp'\nimport TreeTable from '../common/TreeTable'\nimport PropSheet, {TYPES} from '../common/PropSheet'\nimport SelectionManager, {SELECTION_MANAGER} from '../SelectionManager'\nimport {VRCanvas} from './VRCanvas'\nimport {getAssetsURL, getDocsURL, getScriptsURL, TREE_ITEM_PROVIDER} from '../TreeItemProvider'\nimport ImmersiveVREditor from './ImmersiveVREditor'\nimport {fetchGraphObject, insertAsFirstChild, insertAsLastChild, listToArray} from '../syncgraph/utils'\nimport CubeDef from \"./defs/CubeDef\"\nimport SceneDef from \"./defs/SceneDef\"\nimport InputManager from \"../common/InputManager\"\nimport {DialogContainer, DialogManager, HBox, PopupContainer, PopupManager, VBox} from \"appy-comps\"\nimport {\n    ASSET_TYPES,\n    canBeDeleted,\n    canHaveBehavior,\n    canHaveScene,\n    canHaveShape,\n    get3DObjectDef,\n    HORIZONTAL_ALIGNMENT,\n    is3DObjectType,\n    isGLTFFile,\n    isImageType,\n    ITEM_ICONS,\n    NONE_ASSET,\n    OBJ_TYPES,\n    parseBehaviorScript,\n    PROP_DEFS,\n    REC_TYPES,\n    SIMPLE_COLORS,\n    TOTAL_OBJ_TYPES\n} from './Common'\nimport {AddImageAssetDialog} from './dialogs/AddImageAssetDialog'\nimport {AddGLTFAssetDialog} from './dialogs/AddGLTFAssetDialog'\nimport {AddGLBAssetDialog} from './dialogs/AddGLBAssetDialog'\nimport {AddAudioAssetDialog} from './dialogs/AddAudioAssetDialog'\nimport {UnsavedDocumentDialog} from \"./dialogs/UnsavedDocumentDialog\"\nimport AssetView from '../metadoc/AssetView'\nimport * as ToasterMananager from './ToasterManager'\nimport GraphAccessor from \"../syncgraph/GraphAccessor\"\nimport {toQueryString} from '../utils'\nimport {OpenFileDialog} from './dialogs/OpenFileDialog'\nimport {AuthModule, CONNECTED, USER_CHANGE} from './AuthModule'\nimport {OpenAssetDialog} from './dialogs/OpenAssetDialog'\nimport ScriptEditor from './ScriptEditor'\nimport {OpenScriptDialog} from './dialogs/OpenScriptDialog'\nimport {CUSTOM_BEHAVIOR_SCRIPT, CUSTOM_SCENE_SCRIPT} from './Templates'\nimport {\n    addScene,\n    deleteObject,\n    generateAddAssetPopup,\n    newDoc,\n    showAddAssetPopup,\n    showAddBehaviorPopup,\n    showAddPopup\n} from './Actions'\nimport {addGeoAnchorAsset, addGLBAssetFromFile, addImageAssetFromFile} from './AssetActions'\nimport {QRDialog} from './dialogs/QRDialog'\nimport {PasswordDialog} from './dialogs/PasswordDialog'\nimport {GithubAuthDialog} from './dialogs/GithubAuthDialog'\nimport {ErrorCatcher} from './ErrorCatcher'\nimport {AssetsManager} from './AssetsManager'\nimport {ConsoleLogger} from '../syncgraph/PubnubSyncWrapper'\nimport {SaveDocumentAsDialog} from './dialogs/SaveDocumentAsDialog'\nimport {BadAssetsDialog} from './dialogs/BadAssetsDialog'\n\n\nexport default class VREditor extends SyncGraphProvider {\n    constructor(options) {\n        super(options)\n        this.imagecache = {}\n        this.behaviorCache = {}\n        this.orbit_state = {}\n        this.badAssets = []\n        this.assetsManager = new AssetsManager(this)\n    }\n    getDocType() { return \"vr\" }\n    getApp = () => {\n        if(this.mode === 'edit') return <VREditorApp provider={this}/>\n        if(this.mode === 'vredit') return <ImmersiveVREditor provider={this} editable={true}/>\n        if(this.mode === 'embed-view') return <ImmersiveVREditor provider={this} editable={false}/>\n        if(this.mode === 'vrview') return <ImmersiveVREditor provider={this} editable={false}/>\n        console.log(\"no mode!\")\n    }\n    getTitle = () => \"MrEd\"\n    getDocTitle = () => this.accessObject(this.getSceneRoot()).title\n    setDocTitle = (title) => this.accessObject(this.getSceneRoot()).set('title',title)\n    getLogger = () => {\n        if(this.pubnub) return this.pubnub.getLogger()\n        return new ConsoleLogger()\n    }\n\n    makeEmptyRoot(doc) {\n        //make root\n        const root = fetchGraphObject(doc,doc.createObject({\n            type:TOTAL_OBJ_TYPES.ROOT,\n            title:'Untitled Project',\n            splashImage:NONE_ASSET.id,\n            defaultScene:NONE_ASSET.id,\n            children:doc.createArray()\n        }))\n        const rootObj = new GraphAccessor(doc).object(root.id)\n        //make scene\n        const scene1 = new SceneDef().make(doc,rootObj)\n        //make cube\n        const obj = new CubeDef().make(doc,scene1)\n        //make assets\n        const assets = fetchGraphObject(doc,doc.createObject({type:TOTAL_OBJ_TYPES.ASSETS_LIST,\n            title:'Assets', children: doc.createArray(), parent:0}))\n        //make behaviors\n        const behaviors = fetchGraphObject(doc,doc.createObject({type:TOTAL_OBJ_TYPES.BEHAVIORS_LIST,\n            title:'Behaviors', children: doc.createArray(), parent:0}))\n        //tie it all together\n        insertAsFirstChild(doc,root,scene1)\n        insertAsFirstChild(doc,scene1,obj)\n        insertAsLastChild(doc,root,behaviors)\n        insertAsLastChild(doc,root,assets)\n    }\n    docLoaded = () => {\n        //pre-cache all of the behaviors\n        this.accessObject(this.getBehaviorsObject()).getChildren()\n            .filter(a => a.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT)\n            .forEach((b)=>{\n                this.fetchBehaviorAssetContents(b.id).then((contents)=> {\n                    try {\n                        const info = parseBehaviorScript(contents)\n                        info.text = contents\n                        this.setCachedBehaviorAsset(b.id, info)\n                    } catch (e) {\n                        console.error(e)\n                    }\n                })\n            })\n        // if(this.syncdoc.getHistory().length > 300) {\n        //     throw new Error(\"pretending to crash loading the doc \" + this.syncdoc.getHistory().length)\n        // }\n        //get a list of assets for calculating the correct URLS.\n        return this.assetsManager.cacheAssetsList()\n            .then(()=>{\n                Promise.all(this.accessObject(this.getAssetsObject()).getChildren()\n                    .map(asset => {\n                        // this.getLogger().log(\"checking asset\",asset)\n                        if(asset.subtype === ASSET_TYPES.VIDEO) {\n                            return this.assetsManager.getTexture(asset.id).then(tex => {\n                                if (!tex) {\n                                    this.getLogger().error(\"error loading a texture\", asset)\n                                    this.addAssetLoadingError(asset)\n                                }\n                            })\n                        }\n                        if(asset.subtype === ASSET_TYPES.IMAGE) {\n                            return this.assetsManager.getTexture(asset.id).then(tex => {\n                                if (!tex) {\n                                    this.getLogger().error(\"error loading a texture\", asset)\n                                    this.addAssetLoadingError(asset)\n                                }\n                            })\n                        }\n                        if(asset.subtype === ASSET_TYPES.GLTF) {\n                            return this.assetsManager.getGLTF(asset.id).then(model => {\n                                if (!model) {\n                                    this.getLogger().error(\"error loading a model\", asset)\n                                    this.addAssetLoadingError(asset)\n                                }\n                            })\n                        }\n                        return Promise.resolve(\"all good\")\n                    })).then((answers)=>{\n                        console.log(\"fully loaded all assets now\")\n                        console.log(\"error count is\",this.badAssets.length)\n                    if(this.badAssets.length > 0) {\n                        this.showBadAssetsDialog()\n                    }\n                })\n            })\n    }\n\n    addAssetLoadingError(asset) {\n        this.badAssets.push(asset)\n    }\n\n    getRendererForItem = (item) => {\n        const obj = this.accessObject(item)\n        if(!obj.exists()) return <div>???</div>\n        if(obj.type === TOTAL_OBJ_TYPES.ASSET) return <div><i className={`fa fa-${ITEM_ICONS[obj.subtype]}`}/> {obj.title}</div>\n        if(ITEM_ICONS[obj.type]) return <div><i className={`fa fa-${ITEM_ICONS[obj.type]}`}/> {obj.title}</div>\n        return <div>{obj.title}</div>\n    }\n\n    getProperties(item) {\n        function copyPropDef(def,value) {\n            const out = {};\n            Object.keys(def).forEach((key) => out[key] = def[key])\n            out.value = value\n            return out;\n        }\n        let defs = []\n        if(!item) return defs\n\n        //show the ID for all objects\n        defs.push({\n            key:'id',\n            name:\"ID\",\n            type:TYPES.STRING,\n            value:item,\n            locked:true\n        })\n\n        const obj = this.accessObject(item)\n        //if a behavior object is selected, get the defs from the root behavior asset\n        if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR) {\n            const behaviorProps = this.getCachedBehaviorPropDefs(obj.behavior)\n            if(behaviorProps) {\n                Object.keys(behaviorProps).forEach(pname => {\n                    const propdef = behaviorProps[pname]\n                    const ndef = {\n                        key: pname,\n                        name: pname,\n                        type: propdef.type,\n                        value: obj[pname]\n                    }\n                    if(propdef.hints) ndef.hints = propdef.hints\n                    defs.push(ndef)\n                })\n            } else {\n                console.warn(\"Missing prop defs for behavior object\")\n            }\n            defs.push({\n                key:'behavior',\n                name:\"Script\",\n                type:TYPES.STRING,\n                value:obj.behavior,\n                locked:true,\n                custom:true,\n            })\n        }\n\n        const props = this.syncdoc.getPropertiesForObject(item)\n        if(props) {\n            props.forEach(key => {\n                if(key === 'type') return\n                if(key === 'children') return\n                if(key === 'parent') return\n                const value = this.syncdoc.getPropertyValue(item,key)\n                if(PROP_DEFS[key]) {\n                    const def = copyPropDef(PROP_DEFS[key],value)\n                    if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) {\n                        if(key === 'title' || key === 'description') def.locked = true\n                    }\n                    if(obj.type === TOTAL_OBJ_TYPES.ASSET && obj.subtype === ASSET_TYPES.IMAGE) {\n                        if(key === 'width' || key === 'height') def.locked = true\n                    }\n                    return defs.push(def)\n                }\n                // console.log(\"unknown property\",key)\n            })\n        }\n\n\n\n        if(is3DObjectType(obj.type)) {\n            defs.push({\n                key: 'scale',\n                name: 'Scale',\n                type: TYPES.GROUP,\n                group: ['sx','sy','sz'],\n                custom:true,\n            })\n            defs.push({\n                key: 'translation',\n                name: 'Translation',\n                type: TYPES.GROUP,\n                group: ['tx','ty','tz'],\n                custom:true,\n            })\n            defs.push({\n                key: 'rotation',\n                name: 'Rotation',\n                type: TYPES.GROUP,\n                group: ['rx','ry','rz'],\n                custom:true,\n            })\n        }\n\n        return defs\n    }\n    setPropertyValue(item, def, value) {\n        if(def.key === 'scale' || def.key === 'translation' || def.key === 'rotation') {\n            def.group.forEach(key => super.setPropertyValue(item,{key:key}, value[key]))\n            return\n        }\n        super.setPropertyValue(item,def,value)\n        //size the plane to match the aspect ratio of the asset\n        if(def.key === PROP_DEFS.asset.key) {\n            const asset = this.accessObject(value)\n            if(asset.subtype === ASSET_TYPES.IMAGE) {\n                let height = (asset.height / asset.width) * this.accessObject(item).width\n                super.setPropertyValue(item, {key: 'height'}, height)\n            }\n            if(asset.subtype === ASSET_TYPES.GLTF) {\n                console.log(\"adjusting to a gtlf\")\n            }\n        }\n    }\n    getValuesForEnum(key,obj,def) {\n        const realobj = this.accessObject(obj)\n        //if this is a property on a behavior, then use the hints to generate a target list\n        if(realobj.exists() && realobj.type === TOTAL_OBJ_TYPES.BEHAVIOR) {\n            if(def.hasHints()) {\n                const hints = def.getHints()\n                if(hints.type === 'node') {\n                    return this.accessObject(this.getSceneRoot())\n                        .find(obj => obj.type === hints.nodeType)\n                        .map(ch => ch.id)\n                }\n                if(hints.type === 'audio') {\n                    return this.accessObject(this.getAssetsObject()).getChildren().filter(a => a.subtype === ASSET_TYPES.AUDIO).map(a => a.id)\n                }\n                if(hints.type === 'video') {\n                    return this.accessObject(this.getAssetsObject()).getChildren().filter(a => a.subtype === ASSET_TYPES.VIDEO).map(a => a.id)\n                }\n                if(hints.type === 'media') {\n                    return this.accessObject(this.getAssetsObject()).getChildren().filter(a => a.subtype === ASSET_TYPES.AUDIO || a.subtype === ASSET_TYPES.VIDEO).map(a => a.id)\n                }\n            }\n        }\n\n        if (key === PROP_DEFS.asset.key) {\n            const assets = this.accessObject(this.getAssetsObject()).getChildren()\n            if(acceptsImageAsset(realobj.type) && acceptsVideoAsset(realobj.type)) return withNone(assets.filter(a => a.subtype === ASSET_TYPES.VIDEO || a.subtype === ASSET_TYPES.IMAGE).map(a => a.id))\n            if(acceptsVideoAsset(realobj.type)) return withNone(assets.filter(a => a.subtype === ASSET_TYPES.VIDEO).map(a => a.id))\n            if(acceptsModelAsset(realobj.type)) return withNone(assets.filter(a => a.subtype === ASSET_TYPES.GLTF).map(a => a.id))\n            if(acceptsImageAsset(realobj.type)) return withNone(assets.filter(a => a.subtype === ASSET_TYPES.IMAGE).map(a => a.id))\n        }\n        if(key === PROP_DEFS.horizontalAlign.key) {\n            return Object.keys(HORIZONTAL_ALIGNMENT).map(key => HORIZONTAL_ALIGNMENT[key])\n        }\n        if(key === PROP_DEFS.defaultScene.key) {\n            return withNone(this.accessObject(this.getSceneRoot()).getChildren()\n                .filter(ch => ch.type === TOTAL_OBJ_TYPES.SCENE)\n                .map(ch => ch.id))\n        }\n        if(key === PROP_DEFS.texture.key) {\n            let assets = this.accessObject(this.getAssetsObject()).getChildren()\n            assets = assets.filter(a => a.subtype === ASSET_TYPES.IMAGE).map(a => a.id)\n            return withNone(assets)\n        }\n        if(key === PROP_DEFS.targetImage.key) {\n            let assets = this.accessObject(this.getAssetsObject()).getChildren()\n            assets = assets.filter(a => a.subtype === ASSET_TYPES.IMAGE).map(a => a.id)\n            return assets\n        }\n        if(key === PROP_DEFS.targetGeoLocation.key) {\n            let assets = this.accessObject(this.getAssetsObject()).getChildren()\n            assets = assets.filter(a => a.subtype === ASSET_TYPES.GEOLOCATION).map(a => a.id)\n            return assets\n        }\n        if(key === PROP_DEFS.recType.key) {\n            return Object.keys(REC_TYPES)\n        }\n        if(key === PROP_DEFS.splashImage.key) {\n            let assets = this.accessObject(this.getAssetsObject())\n                .getChildren()\n                .filter(a => a.subtype === ASSET_TYPES.IMAGE)\n                .map(a => a.id)\n            return withNone(assets)\n        }\n    }\n    getRendererForEnum(key,obj) {\n        const realobj = this.accessObject(obj)\n        if(realobj.exists() && realobj.type === TOTAL_OBJ_TYPES.BEHAVIOR) return EnumTitleRenderer\n        switch(key) {\n            case PROP_DEFS.asset.key: return EnumTitleRenderer\n            case PROP_DEFS.defaultScene.key: return EnumTitleRenderer\n            case PROP_DEFS.texture.key: return EnumTitleRenderer\n            case PROP_DEFS.targetImage.key: return EnumTitleRenderer\n            case PROP_DEFS.targetGeoLocation.key: return EnumTitleRenderer\n            case PROP_DEFS.splashImage.key: return EnumTitleRenderer\n            default: return null\n        }\n    }\n\n    getSelectedSceneObject() {\n        const sel = SelectionManager.getSelection()\n        if(sel === null) return this.getFirstSceneObject()\n        const selected = this.accessObject(sel)\n        if(!selected.exists()) return selected\n        if(selected.type === TOTAL_OBJ_TYPES.SCENE) return selected\n        if(is3DObjectType(selected.type))  return this.findSceneObjectParent(selected)\n        if(selected.type === TOTAL_OBJ_TYPES.BEHAVIOR) return this.findSceneObjectParent(selected)\n        this.getLogger().error(\"We shouldn't ever get here\")\n        return this.accessObject(0)\n    }\n    getFirstSceneObject() {\n        return this.accessObject(this.getSceneRoot()).getChildren()[0]\n    }\n    findSceneObjectParent(obj) {\n        if(obj === null) return null\n        if(!obj.exists()) return null\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) return obj\n        obj = this.accessObject(obj.parent)\n        return this.findSceneObjectParent(obj)\n    }\n\n    getAssetsObject = () => this.getDataGraph().getObjectByProperty('type',TOTAL_OBJ_TYPES.ASSETS_LIST)\n    getBehaviorsObject = () => this.getDataGraph().getObjectByProperty('type',TOTAL_OBJ_TYPES.BEHAVIORS_LIST)\n\n    quick_setPropertyValue(item, key, value) {\n        const ov = this.getDataGraph().getPropertyValue(item,key)\n        const op = this.cmd.setProperty(item,key,value)\n        op.prevValue = ov\n        if(op.value === op.prevValue) return\n        this.getRawGraph().process(op)\n        //TODO: this should be fired through the graph already. I shouldn't need to fire this\n        this.fire(TREE_ITEM_PROVIDER.PROPERTY_CHANGED,{\n            provider: this,\n            child:item,\n            propKey:key,\n            oldValue:ov,\n            newValue:value\n        })\n    }\n\n    editIn2D = () => {\n        this.save().then(()=>{\n            const opts = Object.assign({},this.options,{mode:'edit', switcher:false, doc:this.getDocId()})\n            const loc = document.location\n            const url = `${loc.protocol}//${loc.host}${loc.pathname}?${toQueryString(opts)}`\n            DialogManager.show(<QRDialog text={\"Edit in 2D\"} url={url}/>)\n        })\n    }\n\n    editInVR = () => {\n        this.save().then(()=>{\n            const opts = Object.assign({},this.options,{mode:'vredit', switcher:false, doc:this.getDocId()})\n            const loc = document.location\n            const url = `${loc.protocol}//${loc.host}${loc.pathname}?${toQueryString(opts)}`\n            DialogManager.show(<QRDialog text={\"Edit in AR/VR\"} url={url}/>)\n        })\n    }\n\n    viewInVR = () => {\n        this.save().then(()=> {\n            const opts = Object.assign({}, this.options, {mode: 'play', switcher: false, doc:this.getDocId()})\n            const loc = document.location\n            const url = `${loc.protocol}//${loc.host}${loc.pathname}?${toQueryString(opts)}`\n            DialogManager.show(<QRDialog text={\"View in AR/VR\"} url={url}/>)\n        })\n    }\n\n\n    add3DObject = (type, parent) => {\n        const obj = get3DObjectDef(type).make(this.getDataGraph(),parent)\n        parent.insertFirstChild(obj)\n        SelectionManager.setSelection(obj.id)\n        ToasterMananager.add('added '+type)\n    }\n\n    calculateContextMenu(item) {\n        const cmds = []\n        const obj = this.accessObject(item)\n        if(canBeDeleted(obj.type)) {\n            cmds.push({title: 'delete', icon: ITEM_ICONS.delete, fun: () => deleteObject(this)});\n        }\n        if(obj.type === TOTAL_OBJ_TYPES.ASSETS_LIST) {\n            return generateAddAssetPopup(this)\n        }\n        if(obj.type === TOTAL_OBJ_TYPES.BEHAVIORS_LIST) {\n            cmds.push({\n                title:'Add Behavior from Server',\n                enabled:AuthModule.isLoggedIn(),\n                icon: ITEM_ICONS.behavior_script,\n                fun: () => this.showOpenBehaviorDialog()\n            })\n        }\n        if(canHaveShape(obj.type)) {\n            cmds.push({ divider:true })\n            Object.keys(OBJ_TYPES).forEach(type => cmds.push({\n                title: type,\n                icon: ITEM_ICONS[type],\n                fun: () => this.add3DObject(type,obj)\n            }))\n        }\n        if(canHaveScene(obj.type)) {\n            cmds.push({title: 'scene', icon: ITEM_ICONS.scene, fun: ()=>addScene(this)})\n        }\n\n        if(canHaveBehavior(obj.type)) {\n            cmds.push({ divider:true })\n            this.accessObject(this.getBehaviorsObject()).getChildren()\n                .filter(a => a.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT)\n                .forEach((b) => {\n                    cmds.push({\n                        title: b.title,\n                        icon: ITEM_ICONS.behavior_script,\n                        fun: () => this.addBehaviorToObject(b, item)\n                    })\n                })\n                cmds.push({\n                    title: 'Add Behavior from server',\n                    icon: ITEM_ICONS.behavior_script,\n                    enabled:AuthModule.isLoggedIn(),\n                    fun: () => {\n                        DialogManager.show(<OpenScriptDialog provider={this} onAdd={(beh)=>{\n                            this.addBehaviorToObject(beh,item).then(b=>{\n                                SelectionManager.setSelection(b.id)\n                            })\n                        }}/>)\n                    }\n                })\n        }\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) {\n            cmds.push({ divider:true })\n            if(AuthModule.scriptEditingSupported) {\n                cmds.push({title: 'Add Scene script', icon: ITEM_ICONS.behavior, fun: () => this.addSceneScript(item)})\n            }\n        }\n\n\n        if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR) {\n            cmds.push({ divider:true })\n            cmds.push({title:'view code', icon: ITEM_ICONS.behavior, fun: ()=>SelectionManager.setSelection(obj.behavior)})\n        }\n\n        if(canBeDeleted(obj.type)) {\n            cmds.push({divider: true})\n            cmds.push({title: 'cut', icon: ITEM_ICONS.cut, fun: this.cutSelection})\n            cmds.push({title: 'copy', icon: ITEM_ICONS.copy, fun: this.copySelection})\n            cmds.push({title: 'paste', icon: ITEM_ICONS.paste, fun: this.pasteSelection})\n        }\n        return cmds\n    }\n\n    cutSelection = (e) => {\n        if(e && e.target) {\n            if (e.target.getAttribute('type') === 'input') return\n            if (e.target.nodeName === 'INPUT') return\n            if (e.target.nodeName === 'TEXTAREA') return\n        }\n        if(SelectionManager.isEmpty()) return\n        const obj = this.accessObject(SelectionManager.getSelection())\n        SelectionManager.setClipboard(obj.id)\n        obj.removeFromParent()\n        SelectionManager.clearSelection()\n    }\n    copySelection = (e) => {\n        if(e && e.target) {\n            if (e.target.getAttribute('type') === 'input') return\n            if (e.target.nodeName === 'INPUT') return\n            if (e.target.nodeName === 'TEXTAREA') return\n        }\n        if(SelectionManager.isEmpty()) return\n        const obj = this.accessObject(SelectionManager.getSelection())\n        SelectionManager.setClipboard(obj.id)\n    }\n    pasteSelection = (e) => {\n        //don't intercept if this is a paste into a text field\n        if(e && e.target) {\n            if (e.target.getAttribute('type') === 'input') return\n            if (e.target.nodeName === 'INPUT') return\n            if (e.target.nodeName === 'TEXTAREA') return\n        }\n        const obj1 = this.accessObject(SelectionManager.getClipboard())\n        let parent = null\n        if(is3DObjectType(obj1.type)) parent = this.getSelectedSceneObject()\n        if(obj1.type === 'scene') parent = this.accessObject(this.getSceneRoot())\n        if (!parent) return console.error(\"no parent to ad too! bad obj type?\",obj1.type)\n        parent.insertChildLast(obj1.clone())\n    }\n\n    // ============ drag and drop ============\n    canBeMoved(node) {\n        const p = this.accessObject(node)\n        if(p.type === TOTAL_OBJ_TYPES.ROOT) return false\n        if(p.type === TOTAL_OBJ_TYPES.BEHAVIORS_LIST) return false\n        if(p.type === TOTAL_OBJ_TYPES.ASSETS_LIST) return false\n        return true\n    }\n    canAddChild(parent,child) {\n        const p = this.accessObject(parent)\n        const c = this.accessObject(child)\n        if(p.type === TOTAL_OBJ_TYPES.ROOT && c.type === TOTAL_OBJ_TYPES.SCENE) return true\n        if(p.type === TOTAL_OBJ_TYPES.SCENE && is3DObjectType(c.type)) return true\n        if(is3DObjectType(p.type) && c.type === TOTAL_OBJ_TYPES.BEHAVIOR) return true\n        if(canHaveShape(p.type) && is3DObjectType(c.type)) return true\n        return false\n    }\n    canBeSibling(src,tgt) {\n        const s = this.accessObject(src)\n        const t = this.accessObject(tgt)\n        if(s.type === TOTAL_OBJ_TYPES.SCENE && t.type === TOTAL_OBJ_TYPES.SCENE) return true\n        if(is3DObjectType(s.type) && is3DObjectType(t.type)) return true\n        return false\n    }\n    canAddExternalChild(parent,child) {\n        const obj = this.accessObject(parent)\n        if(obj.type === TOTAL_OBJ_TYPES.ASSETS_LIST) return true\n        return false\n    }\n    acceptDrop(e,tgt) {\n        const obj = this.accessObject(tgt)\n        if(obj.type === TOTAL_OBJ_TYPES.ASSETS_LIST) {\n            listToArray(e.dataTransfer.files).forEach(file => {\n                if(isImageType(file.type)) return addImageAssetFromFile(file,this)\n                if(isGLTFFile(file)) return addGLBAssetFromFile(file,this)\n            })\n        }\n    }\n    requestImageCache(src) {\n        const img = new Image()\n        img.crossOrigin = \"anonymous\"\n        this.imagecache[src] = img\n        return new Promise((res,rej) => {\n            img.src = src\n            img.onload = () => {\n                this.fire(TREE_ITEM_PROVIDER.STRUCTURE_CHANGED,{ provider: this })\n                res(img)\n            }\n        })\n    }\n\n    createCustomEditor(item,def,provider, value, onChange) {\n        if(def.key === PROP_DEFS.color.key\n            || def.key === PROP_DEFS.backgroundColor.key\n            || def.key === PROP_DEFS.borderColor.key\n            || def.key === PROP_DEFS.textColor.key\n            || def.key === PROP_DEFS.startColor.key\n            || def.key === PROP_DEFS.endColor.key\n        ) return <ColorEditor def={def} item={item} onChange={onChange} value={value}/>\n\n        if(def.key === 'scale') return <GroupPropertyEditor def={def} item={item} onChange={onChange} provider={this}/>\n        if(def.key === 'translation') return <GroupPropertyEditor def={def} item={item} onChange={onChange} provider={this}/>\n        if(def.key === 'rotation') return <GroupPropertyEditor def={def} item={item} onChange={onChange} provider={this}/>\n        if(def.key === 'behavior') return <button onClick={()=>SelectionManager.setSelection(value)}>view code</button>\n        return <i>no custom editor for {def.key}</i>\n    }\n\n    setColor = (color) => {\n        if(SelectionManager.isEmpty()) return\n        this.accessObject(SelectionManager.getSelection()).set('color',color)\n    }\n\n    showAddImageAssetDialog = () => DialogManager.show(<AddImageAssetDialog provider={this}/>)\n    showAddAudioAssetDialog = () => DialogManager.show(<AddAudioAssetDialog provider={this}/>)\n    showAddGLTFAssetDialog  = () => DialogManager.show(<AddGLTFAssetDialog provider={this}/>)\n    showAddGLBAssetDialog   = () => DialogManager.show(<AddGLBAssetDialog provider={this}/>)\n    showOpenDocumentDialog  = () => DialogManager.show(<OpenFileDialog provider={this}/>)\n    showOpenAssetDialog     = () => DialogManager.show(<OpenAssetDialog provider={this}/>)\n    showAddServerImageDialog= () => DialogManager.show(<OpenAssetDialog provider={this} filter={a => isImageType(a.mimeType)}/>)\n    showOpenBehaviorDialog  = () => DialogManager.show(<OpenScriptDialog provider={this}/>)\n    showAddGeoLocationAssetDialog = () => {\n        addGeoAnchorAsset({\n            latitude:0,\n            longitude:0,\n            altitude:0,\n            useAltitude:false,\n        },\"new geo location\",this)\n    }\n    showPasswordDialog = () => DialogManager.show(<PasswordDialog provider={this}/>)\n    showGithubDialog = () => DialogManager.show(<GithubAuthDialog provider={this}/>)\n\n    accessObject = (id) => {\n        return new GraphAccessor(this.getDataGraph()).object(id)\n    }\n\n    loadDocList() {\n        return AuthModule.getJSON(`${getDocsURL()}list`)\n    }\n    removeDoc(doc) {\n        return AuthModule.fetch(`${getDocsURL()}delete/${doc.id}`,{\n            method:'POST',\n            body:doc.id,\n        }).then(res => res.json())\n    }\n    loadAssetList() {\n        return AuthModule.getJSON(`${getAssetsURL()}list`)\n    }\n    removeAssetSource(info) {\n        return AuthModule.fetch(`${getAssetsURL()}delete/${info.id}`,{\n            method:'POST',\n            body:info.id,\n        }).then(res => res.json())\n    }\n    loadScriptList() {\n        return AuthModule.getJSON(`${getScriptsURL()}list`)\n    }\n\n\n    // ======== behaviors ===============\n    addBehaviorAssetFromURL = (info) => {\n        const graph = this.getDataGraph()\n        const behavior = fetchGraphObject(graph,graph.createObject({\n            type:TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT,\n            title:info.title,\n            description:info.description,\n            src:info.url,\n            parent:0\n        }))\n        this.accessObject(this.getBehaviorsObject()).insertChildLast(behavior)\n        SelectionManager.setSelection(behavior.id)\n        return behavior\n    }\n    removeBehaviorAssetSource(name) {\n        const url = `${getScriptsURL()}delete/${name}`\n        console.log(\"removing\",url)\n        return AuthModule.fetch(url,{\n            method:'POST',\n            body:name,\n        }).then(res => res.json())\n    }\n    addCustomBehaviorAsset = (TEMPLATE) => {\n        const randi = (Math.floor(Math.random()*100000000))\n        const fname =`behavior_${randi}.js`\n        const url = `${getScriptsURL()}${fname}`;\n        const contents = TEMPLATE?TEMPLATE:CUSTOM_BEHAVIOR_SCRIPT\n        console.log(\"posting it to\",url)\n        return AuthModule.fetch(url,{\n            method:'POST',\n            body:contents,\n        })\n            .then(res => res.json())\n            .then(ans => {\n                console.log(\"got back the answer\",ans)\n                const graph = this.getDataGraph()\n                const behavior = fetchGraphObject(graph,graph.createObject({\n                    type:TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT,\n                    title:ans.script.title,\n                    description:ans.script.description,\n                    src:fname,\n                    parent:0\n                }))\n                this.accessObject(this.getBehaviorsObject()).insertChildLast(behavior)\n                SelectionManager.setSelection(behavior.id)\n                return behavior\n\n            })\n            .catch(err => console.error(err))\n    }\n    addSceneScript = (obj) => {\n        this.addCustomBehaviorAsset(CUSTOM_SCENE_SCRIPT)\n            .then((b)=>this.addBehaviorToObject(b,obj))\n    }\n    addBehaviorToObject = (b,item) => {\n        return this.fetchBehaviorAssetContents(b.id).then((contents)=>{\n            try {\n                const def = {\n                    type: TOTAL_OBJ_TYPES.BEHAVIOR,\n                    title: b.title,\n                    description: b.description,\n                    parent: 0,\n                    behavior:b.id,\n                }\n                const obj = parseBehaviorScript(contents)\n                this.setCachedBehaviorAsset(b.id,obj)\n                //copy properties to the behavior def\n                if(obj.properties) {\n                    Object.keys(obj.properties).forEach(name => {\n                        def[name] = obj.properties[name].value\n                    })\n                }\n                const graph = this.getDataGraph()\n                const behavior = fetchGraphObject(graph, graph.createObject(def))\n                this.accessObject(item).insertChildLast(behavior)\n                return behavior\n            } catch (e) {\n                console.error(e)\n            }\n        })\n    }\n    fetchBehaviorAssetContents(id) {\n        const obj = this.accessObject(id)\n        const url = getScriptsURL()+obj.src\n        return AuthModule.fetch(url,{\n            method:'GET',\n        }).then(res => res.text())\n    }\n    updateBehaviorAssetContents(id,text) {\n        if(!AuthModule.supportsScriptEdit()) return\n        //update the cache first\n        try {\n            const info = parseBehaviorScript(text)\n            info.text = text\n            this.setCachedBehaviorAsset(id, info)\n\n            const obj = this.accessObject(id)\n            const url = getScriptsURL() + obj.src\n            return AuthModule.fetch(url, {\n                method: 'POST',\n                body: text,\n            }).then(res => res.json())\n                .then(ans => {\n                    obj.set('title', ans.script.title)\n                    obj.set('description', ans.script.description)\n                })\n        } catch(e) {\n            console.error(\"error parsing the script\",e)\n            ToasterMananager.add('error parsing')\n        }\n    }\n    getCachedBehaviorPropDefs(behavior) {\n        if(!this.behaviorCache[behavior]) {\n            console.error(\"no parsed behavior in the cache\",behavior)\n            return null\n        }\n        return this.behaviorCache[behavior].properties;\n    }\n    getCachedBehaviorAsset(id) {\n        return this.behaviorCache[id]\n    }\n    setCachedBehaviorAsset(id, asset) {\n        this.behaviorCache[id] = asset\n    }\n\n    setAudioListener(al) {\n        this.audioListener = al\n    }\n    getAudioListener() {\n        return this.audioListener\n    }\n\n    showBadAssetsDialog() {\n        DialogManager.show(<BadAssetsDialog provider={this}/>)\n    }\n}\n\nclass VREditorApp extends Component {\n    showSaveAsDialog = () => {\n        DialogManager.show(<SaveDocumentAsDialog provider={this.props.provider}/>)\n    }\n\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            mode:'canvas',\n            user:null,\n            running:false,\n            connected:false,\n            dirty:true\n        }\n\n        this.im = new InputManager()\n        this.im.addKeyBinding({id: 'save', key: InputManager.KEYS.S, modifiers: [InputManager.MODIFIERS.COMMAND]})\n        this.im.addKeyBinding({id: 'undo', key: InputManager.KEYS.Z, modifiers: [InputManager.MODIFIERS.COMMAND]})\n        this.im.addKeyBinding({\n            id: 'redo',\n            key: InputManager.KEYS.Z,\n            modifiers: [InputManager.MODIFIERS.COMMAND, InputManager.MODIFIERS.SHIFT]\n        })\n        this.im.addListener('save', this.props.provider.save)\n        this.im.addListener('undo', this.props.provider.performUndo)\n        this.im.addListener('redo', this.props.provider.performRedo)\n\n        this.im.addKeyBinding({id: 'cut', key: InputManager.KEYS.X, modifiers: [InputManager.MODIFIERS.COMMAND]})\n        this.im.addKeyBinding({id: 'copy', key: InputManager.KEYS.C, modifiers: [InputManager.MODIFIERS.COMMAND]})\n        this.im.addKeyBinding({id: 'paste', key: InputManager.KEYS.V, modifiers: [InputManager.MODIFIERS.COMMAND]})\n\n        this.im.addListener('cut', this.props.provider.cutSelection)\n        this.im.addListener('copy', this.props.provider.copySelection)\n        this.im.addListener('paste', this.props.provider.pasteSelection)\n\n    }\n\n    componentDidMount() {\n        this.im.attachKeyEvents(document)\n        SelectionManager.on(SELECTION_MANAGER.CHANGED,this.selectionChanged)\n        AuthModule.on(USER_CHANGE,()=>this.setState({user:AuthModule.getUsername()}))\n        AuthModule.on(CONNECTED,()=>this.setState({connected:true}))\n        if(AuthModule.isConnected()) this.setState({connected:true})\n        this.props.provider.on(TREE_ITEM_PROVIDER.CLEAR_DIRTY,()=>{\n            this.setState({dirty:false})\n        })\n        this.props.provider.on(TREE_ITEM_PROVIDER.PROPERTY_CHANGED, () => {\n            this.setState({dirty:true})\n        })\n        this.props.provider.on(TREE_ITEM_PROVIDER.SAVED, () => {\n            this.setState({dirty:false})\n        })\n    }\n    componentWillUnmount() {\n        SelectionManager.off(SELECTION_MANAGER.CHANGED,this.selectionChanged)\n    }\n\n    selectionChanged = () => {\n        if(!SelectionManager.isEmpty()) {\n            const item = this.props.provider.accessObject(SelectionManager.getSelection())\n            if(item.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) return this.setState({mode:'script'})\n            if(item.type === PROP_DEFS.asset.key) return this.setState({mode:'asset'})\n        }\n        this.setState({mode:'canvas'})\n    }\n\n    toggleRunning = () => {\n        this.setState({running:!this.state.running})\n    }\n\n    newDoc = () => {\n        if(this.state.dirty) {\n            console.log(\"can't create new becausue dirty\")\n            DialogManager.show(<UnsavedDocumentDialog onAnyway={()=>{\n                console.log(\"we are doing it anyway\")\n                newDoc(this.props.provider)\n            }}/>)\n\n        } else {\n            newDoc(this.props.provider)\n        }\n    }\n\n    showOpenDocumentDialog = () => {\n        if(this.state.dirty) {\n            DialogManager.show(<UnsavedDocumentDialog onAnyway={()=>{\n                console.log(\"we are doing it anyway\")\n                this.props.provider.showOpenDocumentDialog()\n            }}/>)\n        } else {\n            this.props.provider.showOpenDocumentDialog()\n        }\n    }\n\n    render() {\n        if(this.state.connected === false) {\n            return <div>\n                <h1>connecting to server</h1>\n                <DialogContainer/>\n            </div>\n        }\n        const prov = this.props.provider\n        const bot = <div>\n            doc id: <b>{prov.getDocId()}</b>\n        </div>\n        let logger = null\n        if(prov.pubnub) logger = prov.getLogger()\n        if(!prov.getDataGraph()) {\n            return <div>\n                <h1>connecting to server</h1>\n                <DialogContainer/>\n            </div>\n        }\n        return <ErrorCatcher logger={logger}><GridEditorApp bottomText={bot}>\n            <Toolbar left top><label>{prov.getTitle()} {this.state.dirty?\"dirty\":\"clean\"}</label></Toolbar>\n            <Panel scroll left middle><TreeTable root={prov.getSceneRoot()} provider={prov}/></Panel>\n\n            <Toolbar left bottom>\n                <button className=\"fa fa-cube\"        onClick={(e)=>showAddPopup(e,prov)}/>\n                <button className=\"fa fa-globe\"       onClick={(e)=>addScene(prov)}/>\n                <button className=\"fa fa-archive\"     onClick={(e)=>showAddAssetPopup(e,prov)}/>\n                <button className=\"fa fa-superpowers\" onClick={(e)=>showAddBehaviorPopup(e,prov)}/>\n            </Toolbar>\n\n\n            <Toolbar center top>\n                <button className=\"fa fa-file\" onClick={this.newDoc} title={'new project'}></button>\n                <button className=\"fa fa-save\" onClick={() => prov.save()} title={'save project'}></button>\n                <button className=\"fa fa-clone\" onClick={this.showSaveAsDialog} title={\"duplicate project\"}></button>\n                <button onClick={() => prov.editIn2D()}>2D Edit</button>\n                <button onClick={() => prov.editInVR()}>AR Edit</button>\n                <button onClick={() => prov.viewInVR()}>XR View</button>\n                <Spacer/>\n                <RunButton onClick={this.toggleRunning} active={this.state.running}/>\n                <Spacer/>\n                <button className=\"fa fa-cut\" onClick={prov.cutSelection}/>\n                <button className=\"fa fa-copy\" onClick={prov.copySelection}/>\n                <button className=\"fa fa-paste\" onClick={prov.pasteSelection}/>\n                <button className=\"fa fa-undo\" onClick={prov.performUndo}/>\n                <button className=\"fa fa-repeat\" onClick={prov.performRedo}/>\n            </Toolbar>\n\n\n            <Panel center middle scroll transparent>\n                {this.renderCenterPane(this.state.mode)}\n            </Panel>\n\n            <Panel scroll right><PropSheet provider={prov}/></Panel>\n\n\n            <Toolbar right top>\n                {this.renderLoginButton()}\n            </Toolbar>\n            <Toolbar right bottom>\n            </Toolbar>\n            <DialogContainer/>\n            <PopupContainer/>\n\n        </GridEditorApp></ErrorCatcher>\n    }\n    renderCenterPane(mode) {\n        if (mode === 'script') return <ScriptEditor provider={this.props.provider}/>\n        if (mode === 'canvas') return <VRCanvas provider={this.props.provider} running={this.state.running}/>\n        return <AssetView provider={this.props.provider} asset={SelectionManager.getSelection()}/>\n    }\n\n    renderLoginButton() {\n        const buttons = []\n\n        if(AuthModule.supportsAuth()) {\n            if(AuthModule.isLoggedIn()) {\n                buttons.push(<button key=\"logout\" className=\"fa fa-user\" onClick={AuthModule.logout} title={'logout'}>logout</button>)\n            } else {\n                buttons.push(<button key=\"login\" className=\"fa fa-user\" onClick={()=>{\n                    if(AuthModule.supportsPassword()) {\n                        this.props.provider.showPasswordDialog()\n                    } else {\n                        this.props.provider.showGithubDialog()\n//                        AuthModule.login()\n                    }\n                }} title={'login'}/>)\n            }\n        }\n        if(AuthModule.supportsDocList()) {\n            buttons.push(<button key=\"open\" className=\"fa fa-folder-open\" onClick={this.showOpenDocumentDialog} title={\"open\"}/>)\n        }\n        return buttons\n    }\n}\nconst EnumTitleRenderer = (props) => {\n    let value = \"---\"\n    if(props.value && props.provider)  value = props.provider.accessObject(props.value).title\n    if(props.value === NONE_ASSET.id)  value = NONE_ASSET.title\n    return <b>{value}</b>\n}\n\nclass GroupPropertyEditor extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            sync:false,\n        }\n    }\n    syncChanged = (e) => this.setState({sync: !this.state.sync})\n    changed = (e, key) =>{\n        const obj = this.props.provider.accessObject(this.props.item)\n        const keys = this.props.def.getGroupKeys()\n        const newvals = {}\n        keys.forEach(key=> newvals[key] = obj[key])\n        const val = parseFloat(e.target.value)\n        newvals[key] = val\n        if(this.state.sync) {\n            keys.forEach(key => newvals[key] = val)\n        }\n        this.props.onChange(newvals)\n    }\n    render() {\n        const obj = this.props.provider.accessObject(this.props.item)\n        const keys = this.props.def.getGroupKeys()\n        const boxes = keys.map(key => {\n            return <input key={key}\n                          type=\"number\"\n                          value={obj[key]}\n                          onChange={(e)=>{ this.changed(e,key)}}\n                          step={0.1}/>\n        })\n        return <HBox className=\"scale-editor\">\n            <input type=\"checkbox\" checked={this.state.sync} onChange={this.syncChanged}/>\n            {boxes}\n        </HBox>\n    }\n}\n\nfunction acceptsModelAsset(type) {\n    if(type=== OBJ_TYPES.model) return true\n    return false\n}\nfunction acceptsImageAsset(type) {\n    if(type === OBJ_TYPES.plane\n        || type === OBJ_TYPES.bg360\n        || type === OBJ_TYPES.img2d\n        || type === OBJ_TYPES.cube\n        || type === OBJ_TYPES.sphere\n    ) return true\n    return false\n}\nfunction acceptsVideoAsset(type) {\n    if(type === OBJ_TYPES.plane\n        || type === OBJ_TYPES.bg360\n        || type === OBJ_TYPES.img2d\n    ) return true\n    return false\n}\n\nconst RunButton = (props) => {\n    const clss = props.active?\"run-button active fa fa-stop\":\"run-button fa fa-play\"\n    return <button onClick={props.onClick} className={clss}/>\n}\n\nfunction withNone(array) {\n    array.push(NONE_ASSET.id)\n    return array\n}\n\nclass ColorEditor extends Component {\n    showPopup = (e) =>{\n        PopupManager.show(<ColorPopup onChange={this.props.onChange} value={this.props.value}/>, e.target)\n    }\n    render() {\n        return <button\n            style={{backgroundColor:this.props.value}}\n            onClick={this.showPopup}\n        >{this.props.value}</button>\n\n    }\n}\n\nclass ColorPopup extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            value:props.value\n        }\n    }\n    onChange = (e) => {\n        this.setState({value:e.target.value})\n        const v = e.target.value\n        if(v.indexOf('#')>=0 && v.length === 7) this.props.onChange(v)\n    }\n    done = () => {\n        this.props.onChange(this.state.value)\n        PopupManager.hide()\n    }\n    render() {\n        return <VBox style={{\n            width: '130px',\n            height: '100px',\n            backgroundColor: 'white'\n        }}>\n            <HBox>\n                {\n                    SIMPLE_COLORS\n                        .map(c => <button\n                            key={c}\n                            onClick={() => {\n                                this.props.onChange(c)\n                            }}\n                            style={{color: c, padding: '1px', margin: 0, borderWidth: 0,}}\n                            className={\"fa fa-square\"}/>)\n                }\n            </HBox>\n            <input type=\"text\" value={this.state.value}\n                   onChange={this.onChange}/>\n            <button onClick={this.done}>done</button>\n        </VBox>\n    }\n}\n","import React, {Component} from 'react'\nimport ScriptManager, {SceneGraphProvider} from './ScriptManager'\nimport TreeItemProvider, {getAssetsURL, getDocsURL, getScriptsURL} from '../TreeItemProvider'\nimport {on, parseOptions, toFlatString} from '../utils'\nimport {TweenManager} from '../common/tween'\nimport * as THREE from 'three'\nimport {Group} from \"three\"\nimport {VRManager, VR_DETECTED, Pointer} from 'webxr-boilerplate'\nimport SceneDef from './defs/SceneDef'\nimport {ASSET_TYPES, get3DObjectDef, is3DObjectType, NONE_ASSET, parseBehaviorScript, TOTAL_OBJ_TYPES} from './Common'\nimport {AuthModule} from './AuthModule'\nimport {XRSupport} from './XRSupport'\nimport {PubnubLogger} from '../syncgraph/PubnubSyncWrapper'\nimport {ErrorCatcher} from './ErrorCatcher'\nimport {AssetsManager} from './AssetsManager'\n\nimport startupsound from \"./startup-sound.m4a\"\n\nconst $ = (sel) => document.querySelector(sel)\n\n\nfunction attachUtilFunctions(obj, obj_map) {\n    obj.find = (match,list) => {\n        if(!list) list = []\n        if(match(obj)) list.push(obj)\n        if(obj.children) obj.children.forEach(ch => {\n            ch.find(match,list)\n        })\n        return list\n    }\n    obj.exists = ()=>true\n    obj.getParent = () => {\n        return obj_map[obj.parent]\n    }\n}\n\nexport class ImmersivePlayer extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            docLoaded:false,\n            title:'Loading...',\n            showErrors:false,\n            splashImage:null\n        }\n        const opts = parseOptions({})\n        if(!opts.doc) throw new Error(\"doc not specified\")\n        new TreeItemProvider(props.options)\n        this.obj_map = {}\n        this.three_map = {}\n        this.title_map = {}\n        this.previewUpdateNodes = []\n        this.current_scene = null\n        this.root = null\n        this.behavior_map = {}\n        this.behavior_assets = {}\n        this.assets_url_map = {}\n        this.pendingAssets = []\n        this.badAssets = []\n\n        this.sceneAnchor = null\n\n        this.logger = new PubnubLogger(opts.doc)\n        this.scriptManager = new ScriptManager(new Adapter(this),this.logger)\n        this.provider = {\n            accessObject:(id)=>{\n                if(!this.obj_map[id]) return {\n                    exists:()=>false,\n                }\n                return this.obj_map[id]\n            },\n            getLogger:() => this.logger,\n            getAudioListener:() => this.audioListener,\n        }\n        this.assetsManager = new AssetsManager(this.provider)\n        this.provider.assetsManager = this.assetsManager\n    }\n    getLogger() {\n        return this.logger\n    }\n\n    componentDidMount() {\n        this.logger.log(\"mounted ImmersivePlayer\")\n        this.loadDocument()\n        $(\"#progress\").value = 0\n    }\n\n    loadDocument() {\n        const opts = parseOptions({})\n        this.logger.log(\"loading assets\")\n        this.assetsManager.cacheAssetsList().then(()=> {\n            this.logger.log(\"loading document\")\n            AuthModule.getJSON(getDocsURL() + opts.doc).then((payload) => {\n                this.logger.log(\"loaded payload\", this.root)\n                this.root = payload.graph\n                this.root.children.forEach(ch => {\n                    if(ch.type === TOTAL_OBJ_TYPES.ASSETS_LIST) return this.initAssets(ch)\n                })\n\n                this.logger.log(\"the title is\",this.root.title)\n                if(this.root.splashImage && this.root.splashImage !== NONE_ASSET.id) {\n                    this.logger.log(\"the splash image is\",this.root.splashImage)\n                    const asset = this.provider.accessObject(this.root.splashImage)\n                    this.logger.log(\"the asset is\",asset)\n                    const url = this.assetsManager.getAssetURL(asset)\n                    this.logger.log(\"the url is\",url)\n                    this.setState({\n                        splashImage:url\n                    })\n                }\n\n                this.setState({\n                    title:this.root.title,\n                })\n\n                const assetsRoot = this.root.children.find(ch => ch.type === TOTAL_OBJ_TYPES.ASSETS_LIST)\n                this.validateAssets(assetsRoot).then(()=>{\n                    console.log(\"fully validated!\")\n                    $(\"#progress\").value = 100\n                    $(\"#loading-indicator\").style.display = 'none'\n                    this.setState({\n                        docLoaded:true,\n                    })\n                })\n            })\n        })\n    }\n\n    startScene() {\n        this.buildRoot(this.root)\n        this.logger.log(this.root)\n        Promise.all(this.pendingAssets).then(() => {\n            this.logger.log(\"all assets loaded now. starting script manager\")\n            this.scriptManager.startRunning()\n            if (this.root.defaultScene && this.root.defaultScene !== NONE_ASSET.id) {\n                const sc = this.root.children.find(ch => ch.id === this.root.defaultScene)\n                if(!sc) return this.logger.error(\"cannot find the default scene\")\n                this.setCurrentScene(sc)\n            } else {\n                const sc = this.root.children[0]\n                this.setCurrentScene(sc)\n            }\n            this.scriptManager.startFirstScene()\n        })\n    }\n\n    clickedStart = () => {\n        console.log(\"clicked. play the sample audio\")\n        $(\"#overlay\").style.display = 'none'\n        $(\"#test-audio\").play()\n\n        const canvas = this.canvas\n        if(XRSupport.supportsARKit()) {\n            this.xr = new XRSupport()\n            this.xr.getContext(canvas).then((context) => {\n                this.initThreeJS(canvas,context)\n                this.xr.setAnimationLoop( this.renderThreeWithCamera.bind(this))\n                this.startScene()\n            }).catch(err => {\n                console.error('Error', err)\n            })\n        } else {\n            this.initThreeJS(canvas,0)\n            this.renderer.setAnimationLoop(this.renderThree.bind(this))\n            this.startScene()\n        }\n\n    }\n\n    // start-sound is from https://freesound.org/people/soneproject/sounds/244356/\n    // old one: https://vr.josh.earth/assets/sounds/clang.mp3\n    render() {\n        return <div>\n            <audio id={\"test-audio\"} src={startupsound}/>\n            <div id=\"overlay\">\n                <div id=\"inner\">\n                    <h1 id=\"title\">{this.state.title}</h1>\n                    <h2><button onClick={this.clickedStart} disabled={!this.state.docLoaded}>click to start</button></h2>\n                    \n                    <div id=\"loading-indicator\">\n                        <label>loading...</label><br></br>\n                        <progress max=\"100\" value=\"0\" id=\"progress\"/>\n                    </div>\n                    {this.renderSplashImage()}\n                </div>\n                {this.renderErrors()}\n            </div>\n            <ErrorCatcher logger={this.logger}>\n                <canvas ref={c => this.canvas = c} width={600} height={400}\n                    onClick={this.clickedCanvas}\n                />\n            </ErrorCatcher>\n        </div>\n    }\n\n    clickedCanvas = (e) => {\n        function findKnownParent(node) {\n            if(!node) return null\n            if(node.userData.graphid) return node\n            return findKnownParent(node.parent)\n        }\n\n        this.logger.log(\"clicked on the canvas\")\n        this.canvas.focus()\n        const rect = this.canvas.getBoundingClientRect();\n        const pointer = {\n            x: ( e.clientX - rect.left ) / rect.width * 2 - 1,\n            y: - ( e.clientY - rect.top ) / rect.height * 2 + 1,\n        }\n        this.raycaster.setFromCamera(pointer, this.camera);\n        const scene = this.three_map[this.current_scene.id]\n        const intersect = this.raycaster.intersectObjects(scene.children, true)\n        if(intersect && intersect.length >= 1) {\n            const inter = intersect.find(inter => inter.distance > 0)\n            if(inter) {\n                //this.logger.log(\"found the interesction\", inter)\n                //this.logger.log(\"intersections\", intersect)\n                // let obj = inter.object\n                let obj = findKnownParent(inter.object)\n\n                //this.logger.log(\"obj\", obj)\n               // if (obj.userData && obj.userData.graphid) { \n                    const gobj = this.obj_map[obj.userData.graphid]\n                    //this.logger.log(\"jobj\", gobj)\n                 //   if (gobj) {\n                        this.scriptManager.performClickAction(gobj, e)\n                  // }\n               // }\n            }\n        }\n    }\n\n    buildRoot(graph) {\n        //init assets first\n        graph.children.forEach(ch => {\n            attachUtilFunctions(ch, this.obj_map)\n            if(ch.type === TOTAL_OBJ_TYPES.SCENE) return this.initObject(ch)\n            if(ch.type === TOTAL_OBJ_TYPES.BEHAVIORS_LIST) return this.initBehaviors(ch)\n        })\n    }\n\n    initObject(obj) {\n        attachUtilFunctions(obj, this.obj_map)\n        this.obj_map[obj.id] = obj\n        if(obj.title) this.title_map[obj.title] = obj\n        let node = null\n        if(obj.type === TOTAL_OBJ_TYPES.SCENE) {\n            const scene = new SceneDef().makeNode(obj, this.provider)\n            this.three_map[obj.id] = scene\n            scene.userData.graphid = obj.id\n            this.scenes.add(scene)\n            scene.visible = false\n            node = scene\n        }\n        obj.props = () => obj\n\n        if(is3DObjectType(obj.type)) {\n            node = get3DObjectDef(obj.type).makeNode(obj, this.provider)\n            if(node.previewUpdate) this.previewUpdateNodes.push(node)\n            this.three_map[obj.id] = node\n            node.userData.graphid = obj.id\n            on(node, 'click', (e) => {\n                this.scriptManager.performClickAction(obj, e)\n            })\n        }\n        if(obj.type === TOTAL_OBJ_TYPES.BEHAVIOR) {\n            this.behavior_map[obj.id] = obj\n        }\n\n        if(obj.children) {\n            obj.children.forEach(ch => {\n                const chnode = this.initObject(ch)\n                if(chnode) node.add(chnode)\n            })\n        }\n\n        return node\n    }\n\n    initThreeJS(canvas, context) {\n        this.tweenManager = new TweenManager()\n        this.scene = new THREE.Scene();\n        this.camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 0.1, 50 );\n        this.renderer = new THREE.WebGLRenderer( { antialias: true, canvas:canvas, context:context } );\n        this.renderer.setPixelRatio( window.devicePixelRatio );\n        this.renderer.setSize( window.innerWidth, window.innerHeight );\n        this.renderer.gammaOutput = true\n        this.renderer.vr.enabled = true;\n        // this.sceneContainer.appendChild( this.renderer.domElement );\n        this.vrmanager = new VRManager(this.renderer)\n        this.audioListener = new THREE.AudioListener()\n        this.camera.add(this.audioListener)\n        if(!this.xr) this.scene.background = new THREE.Color(0x000000);\n        this.camera.matrixAutoUpdate = false\n        this.scene.add(this.camera)\n        window.addEventListener( 'resize', ()=>{\n            const body = document.documentElement\n            this.camera.aspect = body.clientWidth / body.clientHeight;\n            this.camera.updateProjectionMatrix();\n            this.renderer.setSize( body.clientWidth, body.clientHeight);\n        }, false );\n        const light = new THREE.DirectionalLight( 0xffffff, 1.0 );\n        light.position.set( 1, 1, 1 ).normalize();\n        this.scene.add( light );\n        this.scene.add(new THREE.AmbientLight(0xffffff,0.2))\n\n        this.scenes = new Group()\n        this.scene.add(this.scenes)\n\n        this.raycaster = new THREE.Raycaster();\n    }\n\n    renderThreeWithCamera = (bounds,projectionMatrix,viewMatrix, time,frame) => {\n        if(!this.scene || !this.camera) return\n        this.camera.matrix.fromArray(viewMatrix)\n        this.camera.matrixWorldNeedsUpdate = true\n        this.camera.updateMatrixWorld()\n        this.camera.projectionMatrix.fromArray(projectionMatrix)\n        this.renderThree(time,frame)\n    }\n\n    renderThree = (time, frame) => {\n        if(this.tweenManager) this.tweenManager.update(time)\n        this.previewUpdateNodes.forEach(n => n.previewUpdate())\n        if(this.pointer) this.pointer.tick(time)\n        if(this.stats) this.stats.update(time)\n        if(this.controller) this.controller.update(time)\n        let session = null\n        if(this.xr) session = this.xr.session\n        this.scriptManager.tick(time, session)\n        this.renderer.render( this.scene, this.camera );\n    }\n\n    initAssets(assets) {\n        assets.children.forEach(obj => {\n            this.logger.log(\"initing asset\",obj)\n            attachUtilFunctions(obj, this.obj_map)\n            this.obj_map[obj.id] =  obj\n            if(obj.title) this.title_map[obj.title] = obj\n            this.assets_url_map[obj.id] = obj.url\n        })\n    }\n\n    initBehaviors(behaviors) {\n        behaviors.children.forEach(ch => {\n            attachUtilFunctions(ch, this.obj_map)\n            this.obj_map[ch.id] =  ch\n            if(ch.type === TOTAL_OBJ_TYPES.BEHAVIOR_SCRIPT) {\n                const url = getScriptsURL()+ch.src\n                this.logger.log(\"loading behavior\",ch,'from',url)\n                const prom = AuthModule.fetch(url,{ method:'GET' })\n                    .then(res => res.text())\n                    .then(text => {\n                        const info = parseBehaviorScript(text)\n                        info.text = text\n                        this.behavior_assets[ch.id] = info\n                        return text\n                    }).catch((e)=>{\n                        this.logger.error(\"error loading behavior\",e)\n                    })\n                this.pendingAssets.push(prom)\n            }\n        })\n    }\n\n    setCurrentScene(scene) {\n        // @blair\n        const sceneNode = this.three_map[scene.id]\n        // this.logger.log(\"the scene node is\",sceneNode)\n        // this.logger.log(\"if it exists, scene anchor is\", sceneNode.userData.sceneAnchor)\n        if (sceneNode  && this.xr) {\n            const sceneAnchorNode = sceneNode.userData.sceneAnchor\n            if (!sceneAnchorNode) {\n                this.logger.error(\"no sceneNode? so no children?\")\n            } else {\n                if (sceneAnchorNode.children) {\n                    this.logger.log(\"scene has children: \", sceneNode.children.length)\n                    this.logger.log(\"scene anchor has children: \", sceneAnchorNode.children.length)\n                } else {\n                    this.logger.log(\"no sceneNode children?\")\n                }\n\n                if (!this.sceneAnchor || (this.sceneAnchor && scene.autoRecenter)) {\n                    // create a new scene anchor\n                    if (this.sceneAnchor) {\n                        this.xr.removeSceneAnchor(this.sceneAnchor, this.logger)\n                        this.sceneAnchor = null\n                    }\n                    this.xr.createSceneAnchor(sceneAnchorNode, this.logger).then(anchor => {\n                        this.sceneAnchor = anchor\n                    }).catch(error => {\n                        this.logger.error(`error creating new scene anchor: ${error}`)\n                    })\n                } else {\n                    this.xr.updateAnchoredSceneNode(this.sceneAnchor, sceneAnchorNode, this.logger)\n                }\n            }\n        }\n        this.scenes.children.forEach(sc => sc.visible = false)\n        if(this.three_map[scene.id]) this.three_map[scene.id].visible = true\n        this.current_scene = scene\n    }\n\n    renderSplashImage() {\n        if(this.state.splashImage) {\n            return <img src={this.state.splashImage} width=\"80%\" height=\"auto\"/>\n        } else {\n            return \"\"\n        }\n    }\n\n    validateAssets(assetsList) {\n        return Promise.all(assetsList.children.map(asset => {\n                // this.getLogger().log(\"checking asset\",asset)\n                if(asset.subtype === ASSET_TYPES.VIDEO) {\n                    return this.assetsManager.getTexture(asset.id).then(tex => {\n                        if (!tex) {\n                            this.getLogger().error(\"error loading a texture\", asset)\n                            this.addAssetLoadingError(asset)\n                        }\n                    })\n                }\n                if(asset.subtype === ASSET_TYPES.IMAGE) {\n                    return this.assetsManager.getTexture(asset.id).then(tex => {\n                        if (!tex) {\n                            this.getLogger().error(\"error loading a texture\", asset)\n                            this.addAssetLoadingError(asset)\n                        }\n                    })\n                }\n                if(asset.subtype === ASSET_TYPES.GLTF) {\n                    return this.assetsManager.getGLTF(asset.id).then(model => {\n                        if (!model) {\n                            this.getLogger().error(\"error loading a model\", asset)\n                            this.addAssetLoadingError(asset)\n                        }\n                    })\n                }\n                return Promise.resolve(\"all good\")\n            })).then((answers)=>{\n            console.log(\"fully loaded all assets now\")\n            console.log(\"error count is\",this.badAssets.length)\n            if(this.badAssets.length > 0) {\n                this.showBadAssetsDialog()\n            }\n        })\n    }\n\n    showBadAssetsDialog() {\n        this.logger.log(\"showing a bad assets dialog\")\n        this.setState({\n            showErrors:true\n        })\n    }\n    addAssetLoadingError(asset) {\n        this.badAssets.push(asset)\n    }\n    renderErrors() {\n        if(this.state.showErrors) {\n            return <div id=\"errors-dialog\">\n                <h3>Bad or Missing Assets</h3>\n                <ul>\n                {this.badAssets.map((asset,i) => {\n                    return <li key={i}><b>{asset.title}</b> <i>{asset.src}</i></li>\n                })}\n                </ul>\n                <button onClick={()=>this.setState({showErrors:false})}>dismiss</button>\n                </div>\n        }\n        return \"\"\n    }\n}\n\n// ================  SGP implementation =====================\n\nclass Adapter extends SceneGraphProvider {\n    constructor(player) {\n        super()\n        this.player = player\n        this.logger = this.player.logger\n    }\n\n    getCurrentScene() {\n        if(!this.player.current_scene) this.logger.error(\"the current scene is null\")\n        return this.player.current_scene\n    }\n    getSceneObjects(sc) {\n        return sc.children.filter(ch => is3DObjectType(ch.type))\n    }\n    getBehaviorsForObject (obj) {\n        if(!obj.children) return []\n        return obj.children.filter(ch => ch.type === TOTAL_OBJ_TYPES.BEHAVIOR)\n    }\n    getThreeObject (obj)  {\n        if (!obj) {\n            this.logger.error(\"getThreeObject got invalid obj\")\n        } else {\n            if(obj.id) return this.player.three_map[obj.id]\n        }\n        return this.player.three_map[obj]\n    }\n    getParsedBehaviorAsset (b) {\n        return this.player.behavior_assets[b.behavior]\n    }\n    getAllBehaviors () {\n        return Object.keys(this.player.behavior_map).map(key => this.player.behavior_map[key])\n    }\n    getAllScenes() {\n        return Object.keys(this.player.obj_map)\n            .map(key => this.player.obj_map[key])\n            .filter(obj => obj.type === TOTAL_OBJ_TYPES.SCENE)\n    }\n\n    navigateScene (sceneid) {\n        this.logger.log(\"navigating to \",sceneid)\n        const scene = this.player.obj_map[sceneid]\n        if(!scene) return this.logger.error(\"couldn't find scene for\",sceneid)\n        this.player.setCurrentScene(scene)\n    }\n    playMediaAsset (asset, trusted=false)  {\n        this.player.assetsManager.playMediaAsset(asset,trusted)\n    }\n\n    stopMediaAsset(asset) {\n        this.player.assetsManager.stopMediaAsset(asset)\n    }\n\n\n    getGraphObjectByName(title) {\n        return this.player.title_map[title]\n    }\n    getGraphObjectById (id) {\n        return this.player.obj_map[id]\n    }\n    getCamera() {\n        return this.player.camera\n    }\n\n    getTweenManager() {\n        return this.player.tweenManager\n    }\n\n    startLocalAnchor(info) {\n        this.logger.log(\"starting vanilla anchor\")\n        if(!this.player.xr || !this.player.xr.session) {\n            this.logger.log(\"XR is not active?\")\n            return\n        }\n        if(info.style == \"floor\") {\n            this.player.xr.createFloorAnchorFromHitTest(info,info.screenx || 0,info.screeny || 0,this.logger)\n        } else if(info.style == \"ray\") {\n            this.player.xr.createLocalAnchorFromHitTest(info,info.screenx || 0,info.screeny || 0,this.logger)            \n        }\n    }\n\n    stopLocalAnchor(info) {\n        this.logger.log(\"stopping vanilla anchor\")\n        if(!this.player.xr || !this.player.xr.session) {\n            this.logger.log(\"XR is not active?\")\n            return\n        }\n        this.player.xr.stopLocalAnchor(info,this.logger)\n    }\n\n    startImageRecognizer(info) {\n        this.logger.log(\"starting the image recognizer\")\n        return new Promise((res,rej) => {\n            //called when an anchor is started that wants to recognize an image\n            // WebXR loaded?\n            if(!this.player.xr || !this.player.xr.session) {\n                this.logger.log(\"XR is not active?\")\n                return\n            }\n\n            this.player.xr.createDetectionImage(info,this.logger).then((name) => {\n                // decorate the info.node with an xr anchor\n                this.player.xr.startImageRecognizer(info, name, this.logger)\n            })\n        })\n    }\n\n    stopImageRecognizer(info) {\n        this.logger.log(\"stopping the image recognizer\")\n\n        if(!this.player.xr || !this.player.xr.session) {\n            this.logger.log(\"XR is not active?\")\n            return\n        }\n\n        this.player.xr.stopImageRecognizer(info, this.logger)\n    }\n\n    startGeoTracker(info) {\n        // WebXR loaded?\n        return new Promise((res, rej) => {\n            if(!this.player.xr || !this.player.xr.session) {\n                this.logger.log(\"XR is not active?\")\n                return\n            }\n\n            this.player.xr.createGeoAnchor(info, this.logger).then(() => {\n                // decorate the info.node with an xr anchor\n                this.player.xr.addGeoAnchoredNode(info, this.logger)\n            })\n        })\n    }\n\n    stopGeoTracker(info) {\n        // WebXR loaded?\n        if(!this.player.xr || !this.player.xr.session) {\n            this.logger.log(\"XR is not active?\")\n            return\n        }\n\n        // decorate the info.node with an xr anchor\n        this.player.xr.stopGeoTracker(info, this.logger)\n    }\n\n    startWorldInfo(info) {\n        if(!this.player.xr || !this.player.xr.session) {\n            this.logger.log(\"XR is not active?\")\n            return\n        }\n        // clear any previous state\n        this.stopWorldInfo(info)\n        // start up worldInfo - which returns a threejs group\n        this.worldInfoMesh = this.player.xr.startWorldInfo(this.logger)\n        // add worldInfo as a group to the scene\n        this.player.scene.add(this.worldInfoMesh)\n    }\n\n    stopWorldInfo(info) {\n        if(!this.player.xr || !this.player.xr.session) {\n            this.logger.log(\"XR is not active?\")\n            return\n        }\n        if(this.worldInfoMesh) {\n            this.player.scene.remove(this.worldInfoMesh)\n            this.worldInfoMesh = 0\n            this.player.xr.stopWorldInfo()\n        }\n    }\n\n}\n","import React, {Component} from 'react'\nimport './App.css'\nimport {DialogContainer, PopupContainer, PopupManager, VBox} from \"appy-comps\"\n\nimport MetadocEditor from \"./metadoc/Editor1\"\nimport VREditor from './vr/VREditor'\nimport {ImmersivePlayer} from './vr/ImmersivePlayer'\n\nexport default class App extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            switcher:false,\n        }\n        this.providers = ['vr','metadoc']\n        const sw = this.props.options.switcher\n        if(typeof sw !== 'undefined' && (sw === true || sw === 'true')) {\n            this.state.switcher = true\n        }\n    }\n\n    getApp() {\n        const doctype = this.props.options.doctype || \"vr\"\n        if(doctype === 'vr') {\n            if(this.props.options.mode === 'play') {\n                return <ImmersivePlayer options={this.props.options}/>\n            }\n            this.provider = new VREditor(this.props.options)\n            return this.provider.getApp()\n        }\n        if(doctype === 'metadoc') {\n            this.provider = new MetadocEditor(this.props.options)\n            return this.provider.getApp()\n        }\n    }\n\n\n//        provider.loadDoc(this.props.options.doc)\n\n    openNewProvider(name){\n        PopupManager.hide()\n        window.open(`./?mode=edit&doctype=${name}`)\n    }\n\n    showProviderList = (e) => {\n        PopupManager.show(\n            <VBox>\n                {this.providers.map((name)=>{\n                    return <button key={name} onClick={()=>this.openNewProvider(name)}>{name}</button>\n                })}\n            </VBox>,\n            e.target\n        )\n    }\n    render() {\n        if(!this.state.switcher) return this.getApp()\n        return (\n            <VBox fill>\n                <button\n                    style={{position:'absolute',zIndex: 10,}}\n                    onClick={this.showProviderList}\n                    >\n                    <img src=\"icon.png\" alt=\"switch apps\" height=\"20\" style={{padding:'0em'}}/>\n                </button>\n                <div style={{position: 'relative', flex: '1'}}>{this.getApp()}</div>\n                <DialogContainer/>\n                <PopupContainer/>\n            </VBox>\n        );\n    }\n}\n\n\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport 'font-awesome/css/font-awesome.css'\nimport App from './App';\nimport {parseOptions} from './utils'\n\nconst default_options = {\n    mode: 'edit',\n}\nconst options = parseOptions(default_options)\nconsole.log(\"options is\",options);\n\nfunction init() {\n    return <App options={options}/>;\n}\n\nReactDOM.render(init(), document.getElementById(\"root\"));\n\n"],"sourceRoot":""}