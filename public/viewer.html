<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-122855516-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-122855516-2');
    </script>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
    <script src="./viewer.js"></script>
</head>
<body>
<a-scene>
    <a-entity camera look-controls wasd-cotnrols>
        <a-entity cursor="fuse: true; maxDistance: 30;"
                  id="cursor"
                  position="0 0 -3"
                  geometry="primitive:ring; radiusInner: 0.2; radiusOuter:0.3"
                  material="color:cyan; shader:flat"
                  >
            <a-animation begin="click" easing="ease-in" attribute="scale" dur="150"
                         fill="forwards" from="0.2 0.2 0.2" to="1 1 1"></a-animation>
            <a-animation begin="fusing" easing="ease-in" attribute="scale" dur="1500"
                         fill="backwards" from="1 1 1" to="0.2 0.2 0.2"></a-animation>

        </a-entity>
    </a-entity>
    <a-entity id="children">
    </a-entity>

    <a-entity laser-controls="hand: right"></a-entity>

</a-scene>

<script>
    function parseQuery(str) {
        if (str.startsWith('?')) str = str.substring(1)
        console.log("parsing", str)
        const parts = str.split("&")
        console.log(parts)
        const args = {}
        parts.forEach(part => {
            const p2 = part.split('=')
            args[p2[0]] = p2[1]
        })
        return args
    }
    console.log("loading from the URL string")
    const args = parseQuery(document.location.search)
    console.log("args = ", args)
    const SERVER_URL = "https://vr.josh.earth/360/doc/"
    const SERVER_URL_ASSETS = "https://vr.josh.earth/360/asset/"
    Viewer.doLoad(args.doc,SERVER_URL,SERVER_URL_ASSETS)
</script>
</body>
</html>